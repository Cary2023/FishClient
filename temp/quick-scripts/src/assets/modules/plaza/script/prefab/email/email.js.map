{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\email\\email.js"],"names":["MAIL_TYPE_ANNOUN","MAIL_TYPE_SYSTEM","MAIL_TYPE_MONEY","glGame","baseclass","extend","properties","emailListView","cc","Node","emailItem","emailDetail","emailstatus","SpriteFrame","SystemScorll","ScrollView","MoneyScorll","btn_alldelete","Button","btn_allRead","content","SystemEmail","MoneyEmail","node_noInfo","sysRedDot","coinRedDot","node_titleList","audio_coin","type","AudioClip","onLoad","registerEvent","isReceive","page","contenHeight","emailUpdate","announUpdate","getIsAllGet","getIsAllDelete","index","annPage","tipTimeOut","textIndex","fistTime","MailMax","msg","panel","showEffectPariticle","node","resetData","initReddot","emailData","user","get","active","systemUnreadCount","moneyUnreadCount","showUI","setOne","i","childrenCount","children","btnfirst","onClick","name","console","log","reqSystemEmail","reqMoneyEmail","remove","CuremailDetail","destroy","openDeleteFace","click_allread","click_delete","CuremailId","reqMailInfo","reqMailList","getChildByName","bool","strText","tips","EMAIL","DELETEALL","DELETEONE","showDialog","bind","ReqDeleMail","ReqDeleOneMail","ReqAllReadMail","emitter","on","updateEmailContent","updateEmail","updateDeleOneMail","updateDeleMail","updateReadAllMail","MESSAGE","UI","ACTION_END","unRegisterEvent","off","OnDestroy","ReqRedDot","clearMail","emailTime","time","emails","mailcontent","length","count","data","instantiate","parent","getComponent","Label","string","send_time","mail_title","Sprite","spriteFrame","status","id","email","getEmailInfo","RichText","mail_content","EmailData","alreadyLook","timestampToTime","timestamp","date","Date","Y","getFullYear","M","getMonth","D","getDate","h","getHours","m","getMinutes","destroyAllChildren","removeAllChildren","deleteEmail","attachment_status","onScrollEvent","scroll","event","EventType","SCROLL_TO_BOTTOM","cutFloat","num","getFloat","Number","div","value","isNaN","toString","Math","floor","toFixed","cutDownNum"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 邮件面板\r\n */\r\nconst MAIL_TYPE_ANNOUN = 0;\r\nconst MAIL_TYPE_SYSTEM = 1;\r\nconst MAIL_TYPE_MONEY = 2;\r\n\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        emailListView: cc.Node,     // 邮件item列表\r\n\r\n        emailItem: cc.Node,\r\n        emailDetail: cc.Node,                   //正常邮件详细内容\r\n        emailstatus: [cc.SpriteFrame],          //邮件图片状态\r\n\r\n        SystemScorll: cc.ScrollView,            //其他的scorll\r\n        MoneyScorll: cc.ScrollView,             //其他的scorll\r\n        btn_alldelete: cc.Button,\r\n        btn_allRead: cc.Button,\r\n        content: cc.Node,\r\n        SystemEmail: cc.Node,\r\n        MoneyEmail: cc.Node,\r\n\r\n        node_noInfo: cc.Node,\r\n        sysRedDot: cc.Node,\r\n        coinRedDot: cc.Node,\r\n        node_titleList: cc.Node,\r\n        audio_coin: {\r\n            type: cc.AudioClip,\r\n            default: null\r\n        },\r\n    },\r\n    onLoad() {\r\n        this.registerEvent();\r\n        this.isReceive = false;\r\n        this.page = [0, 1, 1];\r\n        this.contenHeight = 0;\r\n        this.emailUpdate = false;\r\n        this.announUpdate = false;\r\n        this.getIsAllGet = false;\r\n        this.getIsAllDelete = false;\r\n        this.index = 0;\r\n        this.annPage = 1;\r\n        this.tipTimeOut = null;\r\n        this.textIndex = 1 //控制是否能提示飘字未查看还可领取，\r\n        this.fistTime = true;\r\n        this.MailMax = 10;\r\n        this.msg = {};\r\n        glGame.panel.showEffectPariticle(this.node);\r\n        //this.reqSystemEmail();\r\n    },\r\n    // 初始化邮件数据\r\n    resetData() {\r\n        // this.emailData = glGame.user.get(\"emails\");\r\n        //console.log('======查看邮件item',this.emailData)\r\n    },\r\n    initReddot() {\r\n        let emailData = glGame.user.get(\"EmailData\");\r\n        this.sysRedDot.active = !!emailData.systemUnreadCount;\r\n        //if (!!emailData.systemUnreadCount) this.sysRedDot.getChildByName(\"num\").getComponent(cc.Label).string = emailData.systemUnreadCount;\r\n        this.coinRedDot.active = !!emailData.moneyUnreadCount;\r\n        //if (!!emailData.moneyUnreadCount) this.coinRedDot.getChildByName(\"num\").getComponent(cc.Label).string = emailData.moneyUnreadCount;\r\n    },\r\n\r\n    // UI显示\r\n    showUI() {\r\n        let setOne = true;\r\n        for (let i = 0; i < this.emailListView.childrenCount; i++) {\r\n            this.emailListView.children[i].active = true;\r\n            if (setOne) {\r\n                this.btnfirst = this.emailListView.children[i];\r\n                setOne = false;\r\n            }\r\n        }\r\n        //this.btnfirst.getComponent(cc.Toggle).isChecked = true;\r\n        //this.onClick(this.btnfirst.name, this.btnfirst);\r\n    },\r\n    onClick(name, node) {\r\n        console.log('nnnnname', name)\r\n        switch (name) {\r\n            case \"systemEmail\":\r\n                this.reqSystemEmail();\r\n                break;\r\n            case \"moneyEmail\":\r\n                this.reqMoneyEmail();\r\n                break;\r\n            case \"btn_close\":\r\n                this.remove();\r\n                break;\r\n            case \"btn_closeDetail\": this.CuremailDetail.destroy(); break;           //关闭邮件详情\r\n            case \"btn_alldelete\": this.openDeleteFace(true); break;\r\n            case \"btn_allread\": this.click_allread(); break;                         //确定删除\r\n            case \"btn_delete\": this.openDeleteFace(false); break;\r\n            case \"btn_realDelet\": this.click_delete(); break;                         //确定删除\r\n            case 'btn_canel':\r\n            default:\r\n                if (this.SystemScorll.node.active) {\r\n                    for (let i = 0; i < this.SystemEmail.childrenCount; i++) {\r\n                        if (this.SystemEmail.children[i].name == name) {\r\n                            this.CuremailId = name;\r\n                            glGame.user.reqMailInfo(name, this.type);\r\n                            break;\r\n                        }\r\n                    };\r\n                } else if (this.MoneyScorll.node.active) {\r\n                    for (let i = 0; i < this.MoneyEmail.childrenCount; i++) {\r\n                        if (this.MoneyEmail.children[i].name == name) {\r\n                            this.CuremailId = name;\r\n                            glGame.user.reqMailInfo(name, this.type);\r\n                            break;\r\n                        }\r\n                    };\r\n                }\r\n                break;\r\n        }\r\n    },\r\n    reqSystemEmail() {\r\n        this.btn_alldelete.node.active = this.SystemEmail.childrenCount > 0;\r\n        this.btn_allRead.node.active = this.SystemEmail.childrenCount > 0;\r\n        this.type = MAIL_TYPE_SYSTEM;\r\n        this.textIndex = 1;\r\n        this.SystemScorll.node.active = true;\r\n        this.MoneyScorll.node.active = false;\r\n        this.node_noInfo.active = this.SystemEmail.childrenCount == 0;\r\n        if (!this.msg[this.type]) {\r\n            glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type);\r\n        } else {\r\n            this.node.getChildByName(\"panel\").getChildByName(\"img_wujilu\").active = this.SystemEmail.childrenCount == 0;\r\n        }\r\n    },\r\n    reqMoneyEmail() {\r\n        this.type = MAIL_TYPE_MONEY;\r\n        this.textIndex = 1;\r\n        this.btn_allRead.node.active = this.MoneyEmail.childrenCount > 0;\r\n        this.btn_alldelete.node.active = this.MoneyEmail.childrenCount > 0;\r\n        this.SystemScorll.node.active = false;\r\n        this.MoneyScorll.node.active = true;\r\n        this.node_noInfo.active = this.MoneyEmail.childrenCount == 0;\r\n        if (!this.msg[this.type]) {\r\n            glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type);\r\n        } else {\r\n            this.node.getChildByName(\"panel\").getChildByName(\"img_wujilu\").active = this.MoneyEmail.childrenCount == 0;\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param {*} bool true: 全部删除 false: 指定删除\r\n     */\r\n    openDeleteFace(bool) {\r\n        let strText = \"\"\r\n        if (bool) {\r\n            strText = glGame.tips.EMAIL.DELETEALL;\r\n            this.getIsAllDelete = true;\r\n        } else {\r\n            strText = glGame.tips.EMAIL.DELETEONE;\r\n            this.getIsAllDelete = false;\r\n        }\r\n        glGame.panel.showDialog(\"\", strText, this.click_delete.bind(this));\r\n    },\r\n    //点击删除邮件\r\n    click_delete() {\r\n        if (this.getIsAllDelete) {\r\n            this.btn_allRead.node.active = false;\r\n            this.btn_alldelete.node.active = false;\r\n            glGame.user.ReqDeleMail(this.type);\r\n        } else {\r\n            this.textIndex = 1;\r\n            glGame.user.ReqDeleOneMail(this.CuremailId)\r\n        }\r\n    },\r\n\r\n    click_allread() {\r\n        //if (!glGame.user.EmailData.systemUnreadCount) return;\r\n        glGame.user.ReqAllReadMail(this.type);\r\n    },\r\n    // 注册界面监听事件\r\n    registerEvent() {\r\n        glGame.emitter.on(\"updateEmailContent\", this.updateEmailContent, this);\r\n        glGame.emitter.on(\"updateEmail\", this.updateEmail, this);\r\n        glGame.emitter.on(\"updateDeleOneMail\", this.updateDeleOneMail, this);\r\n        glGame.emitter.on(\"updateDeleMail\", this.updateDeleMail, this);\r\n        glGame.emitter.on(\"updateReadAllMail\", this.updateReadAllMail, this);\r\n        glGame.emitter.on(`${this.node.name}${MESSAGE.UI.ACTION_END}`, this.reqMoneyEmail, this);\r\n    },\r\n    // 销毁界面监听事件\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"updateEmailContent\", this);\r\n        glGame.emitter.off(\"updateEmail\", this);\r\n        glGame.emitter.off(\"updateDeleOneMail\", this);\r\n        glGame.emitter.off(\"updateDeleMail\", this);\r\n        glGame.emitter.off(\"updateReadAllMail\", this);\r\n        glGame.emitter.off(`${this.node.name}${MESSAGE.UI.ACTION_END}`, this);\r\n    },\r\n    // 界面销毁的时候, 注销事件, 刷新一下看看有没最新邮件\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n        glGame.user.ReqRedDot();\r\n        glGame.user.clearMail();\r\n    },\r\n    //邮件列表\r\n    updateEmail() {\r\n        this.node.getChildByName(\"panel\").getChildByName(\"img_wujilu\").active = false;\r\n        this.initReddot();\r\n        this.msg = glGame.user.get(\"allEmailMsg\");\r\n        if(!this.emailTime)this.emailTime = this.msg[this.type].time;\r\n        let emails = this.msg[this.type][\"maillist\"];\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        if (mailcontent.childrenCount == 0) {\r\n            this.node_noInfo.active = true;\r\n            this.btn_allRead.node.active = false;\r\n            this.btn_alldelete.node.active = false;\r\n        }\r\n        this.emailUpdate = false;\r\n\r\n        if (emails.length == 0 || this.msg.count <= emails.length) {\r\n            this.node.getChildByName(\"panel\").getChildByName(\"img_wujilu\").active = true;\r\n            return;\r\n        }\r\n        \r\n        //系统信息与资金信息\r\n        for (let i = (this.page[this.type] - 1) * this.MailMax; i < emails.length; i++) {\r\n            let data = emails[i];\r\n            let emailItem = cc.instantiate(this.emailItem);\r\n            emailItem.parent = mailcontent;\r\n            emailItem.active = true;\r\n            emailItem.getChildByName(\"email_time\").getComponent(cc.Label).string = data.send_time;\r\n            emailItem.getChildByName(\"email_title\").getComponent(cc.Label).string = data.mail_title;\r\n            emailItem.getChildByName(\"email_pic\").getComponent(cc.Sprite).spriteFrame = data.status == 1 ? this.emailstatus[1] : this.emailstatus[0];\r\n            emailItem.getChildByName(\"email_pic\").getChildByName(\"img_yuandian\").active = data.status == 0;\r\n\r\n            //emailItem.getChildByName(\"email_pic\").getChildByName(\"dian\").active = data.status != 1;\r\n            //emailItem.getChildByName(\"already\").active = data.status == 1;\r\n\r\n            emailItem.name = `${data.id}`\r\n        }\r\n\r\n        if (emails.length > 0) {\r\n            this.emailUpdate = true;\r\n        }\r\n        //if (this.page[this.type] == 1) mailcontent.scrollToTop(0.1);\r\n        this.node_noInfo.active = emails.length == 0;\r\n        this.btn_alldelete.node.active = this.emailUpdate;\r\n        this.btn_allRead.node.active = this.emailUpdate;\r\n\r\n    },\r\n\r\n    // updateEmailContent 事件回调函数, 刷新邮件显示内容\r\n    updateEmailContent(email) {\r\n        this.getEmailInfo = email;\r\n        this.CuremailDetail = cc.instantiate(this.emailDetail);\r\n        this.CuremailDetail.parent = this.node;\r\n        this.CuremailDetail.active = true;\r\n        this.CuremailDetail.getChildByName(\"title\").getComponent(cc.Label).string = email.mail_title;\r\n        this.CuremailDetail.getChildByName(\"time\").getComponent(cc.Label).string = email.send_time;\r\n        this.CuremailDetail.getChildByName(\"scrollview\").children[1].children[0].getComponent(cc.RichText).string = `       ${email.mail_content}`;\r\n        if (email.status == 0) {\r\n            if (this.type == MAIL_TYPE_MONEY) glGame.user.EmailData.moneyUnreadCount--;\r\n            else if (this.type == MAIL_TYPE_SYSTEM) glGame.user.EmailData.systemUnreadCount--;\r\n            this.initReddot();\r\n        }\r\n        this.alreadyLook(email);\r\n    },\r\n\r\n    //时间戳获取年月日时间\r\n    timestampToTime(timestamp) {\r\n        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000\r\n        var Y = date.getFullYear() + '-';\r\n        var M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '/';\r\n        var D = date.getDate() + ' ';\r\n        var h = date.getHours() + ':';\r\n        var m = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes();\r\n        return Y + M + D + h + m;\r\n    },\r\n    //删除全部邮件\r\n    updateDeleMail() {\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        mailcontent.destroyAllChildren();\r\n        mailcontent.removeAllChildren();\r\n        this.btn_alldelete.node.active = false;\r\n        this.btn_allRead.node.active = false;\r\n        this.page[this.type] = 1;\r\n        if (this.type == 2 || this.type == 1) {\r\n            this.textIndex = 0;\r\n        }\r\n        glGame.user.clearMail(this.type);\r\n        glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type);\r\n    },\r\n\r\n    //读取全部邮件\r\n    updateReadAllMail() {\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        mailcontent.destroyAllChildren();\r\n        this.page[this.type] = 1;\r\n        glGame.user.clearMail(this.type);\r\n        glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type);\r\n    },\r\n\r\n    //删除选中的邮件\r\n    updateDeleOneMail() {\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        mailcontent.destroyAllChildren();\r\n        this.page[this.type] = 1;\r\n        glGame.user.clearMail(this.type);\r\n        glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type);\r\n        this.CuremailDetail.destroy();\r\n        // this.deleteEmail();\r\n\r\n    },\r\n    //删除指定邮件\r\n    deleteEmail() {\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        for (let i = 0; i < mailcontent.childrenCount; i++) {\r\n            if (mailcontent.children[i].name == this.CuremailId) {\r\n                mailcontent.children[i].destroy();\r\n                break;\r\n            }\r\n        }\r\n        if (mailcontent.childrenCount == 1) this.btn_alldelete.node.active = false;\r\n    },\r\n    //设置当前邮件已读\r\n    alreadyLook(email) {\r\n        let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        if (email.attachment_status == 0) {\r\n            //已领取\r\n            if (email.status == 1) {\r\n                for (let i = 0; i < mailcontent.childrenCount; i++) {\r\n                    if (mailcontent.children[i].name == this.CuremailId) {\r\n                        mailcontent.children[i].getChildByName(\"email_pic\").getComponent(cc.Sprite).spriteFrame = this.emailstatus[1];\r\n                        mailcontent.children[i].getChildByName(\"email_pic\").getChildByName(\"img_yuandian\").active = false;\r\n                    }\r\n                }\r\n                return;\r\n            };\r\n        }\r\n        //已读\r\n        for (let i = 0; i < mailcontent.childrenCount; i++) {\r\n            if (mailcontent.children[i].name == this.CuremailId) {\r\n                mailcontent.children[i].getChildByName(\"email_pic\").getComponent(cc.Sprite).spriteFrame = this.emailstatus[1];\r\n                mailcontent.children[i].getChildByName(\"email_pic\").getChildByName(\"img_yuandian\").active = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    //滚动到底部请求数据\r\n    onScrollEvent(scroll, event) {\r\n        if (event == cc.ScrollView.EventType.SCROLL_TO_BOTTOM && this.emailUpdate) {\r\n            // console.log(\"获取消息数据\")\r\n        // }\r\n        // let mailcontent = this.type == MAIL_TYPE_SYSTEM ? this.SystemEmail : this.MoneyEmail;\r\n        // if (mailcontent.y >= mailcontent.height && this.emailUpdate && mailcontent.height > 220) {\r\n            this.page[this.type]++;\r\n            this.emailUpdate = false;\r\n            console.log(\"请求邮件列表\", this.page[this.type])\r\n            glGame.user.reqMailList(this.page[this.type], this.MailMax, this.type,this.emailTime);\r\n        }\r\n    },\r\n\r\n\r\n    cutFloat(num) {\r\n        return (this.getFloat(Number(num).div(100)));\r\n    },\r\n    //浮点型运算取俩位\r\n    getFloat(value, num = 2) {\r\n        value = Number(value);\r\n        if (isNaN(value)) return;\r\n        if (~~value === value) {\r\n            return value.toString();\r\n        } else {\r\n            return (Math.floor(value * 100) / 100).toFixed(num);\r\n        }\r\n    },\r\n    //截取小数点后两位\r\n    cutDownNum(value, num = 2) {\r\n        if (isNaN(value)) return;\r\n        if (~~value === value) {\r\n            return value.div(100).toString();\r\n        } else {\r\n            value = Number(value).div(100);\r\n            return (Math.floor(value * 100) / 100).toFixed(num);\r\n        }\r\n    },\r\n});\r\n"]}