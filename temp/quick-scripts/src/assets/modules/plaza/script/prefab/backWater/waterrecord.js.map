{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\backWater\\waterrecord.js"],"names":["status","glGame","baseclass","extend","properties","content","cc","Node","recorditem","noitem","today_bet","Label","today_back","Lab_CurPage","Lab_totalPage","onLoad","registerEvent","userPumpRecord","user","get","gameRecord","string","cutFloat","betCoin","rebateCoin","page","pageSize","pageTotal","record","stateColor","color","ReqRebateRecordList","start","emitter","on","updateReqRebateRecordList","unRegisterEvent","off","recordData","data","totalPage","initUI","active","length","unscheduleAllCallbacks","destroyAllChildren","removeAllChildren","len","node","getChildByName","i","schedule","instantiate","parent","timeStamp","Date","createTime","strTime","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getComponent","receiveType","allBetting","number","panel","settingTableLabelColor","stateDes","state","OnDestroy","onClick","name","pageup_click","pagedown_click","value","Number","div","toFixed","toString"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 返水记录\r\n */\r\nconst status = {\r\n    0: '定时返水',\r\n    1: '实时返水',\r\n}\r\n\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        content: cc.Node,\r\n        recorditem: cc.Node,\r\n        noitem: cc.Node,\r\n        today_bet: cc.Label,        //未返水有效投注\r\n        today_back: cc.Label,       //今日预计返水\r\n\r\n        Lab_CurPage: cc.Label,\r\n        Lab_totalPage: cc.Label,\r\n    },\r\n\r\n    onLoad() {\r\n        this.registerEvent();\r\n        let userPumpRecord = glGame.user.get(\"userPumpRecord\");\r\n        this.gameRecord = userPumpRecord;\r\n        this.today_bet.string = `${this.cutFloat(this.gameRecord.betCoin)}`;\r\n        this.today_back.string = `${this.cutFloat(this.gameRecord.rebateCoin)}`;\r\n\r\n        this.page = 1;\r\n        this.Lab_CurPage.string = this.page;\r\n        this.pageSize = 7;\r\n        this.pageTotal = 1;\r\n        this.record = [];\r\n        //  蓝 绿 红 黄 \r\n        this.stateColor = [cc.color(102, 144, 204), cc.color(0,255,24), \r\n            cc.color(244,20,36), cc.color(187,151,4)]; \r\n\r\n        glGame.user.ReqRebateRecordList(this.page, this.pageSize);\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n    registerEvent() {\r\n        glGame.emitter.on(\"updateReqRebateRecordList\", this.updateReqRebateRecordList, this);\r\n    },\r\n\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"updateReqRebateRecordList\", this);\r\n    },\r\n\r\n    updateReqRebateRecordList(recordData) {\r\n        this.record = recordData.data;\r\n        this.pageTotal = recordData.totalPage;\r\n        this.Lab_totalPage.string = recordData.totalPage;\r\n        this.initUI();\r\n        this.noitem.active = this.record.length == 0;\r\n    },\r\n    initUI() {\r\n        this.unscheduleAllCallbacks();\r\n        this.content.destroyAllChildren();\r\n        this.content.removeAllChildren();\r\n        this.Lab_CurPage.string = this.page;\r\n        let len = this.record.length;\r\n        this.node.getChildByName(\"pagelayout\").active = len > 0;\r\n        this.node.getChildByName(\"noThink\").active = len == 0;\r\n        this.node.getChildByName(\"explain\").active = len != 0;\r\n        this.node.getChildByName(\"btn_pageup\").active = len != 0;\r\n        this.node.getChildByName(\"btn_pagedown\").active = len != 0;\r\n        let i = 0;\r\n        this.schedule(()=>{\r\n            if(!this.record[i]){\r\n                return;\r\n            }\r\n            let node = cc.instantiate(this.recorditem);\r\n            node.parent = this.content;\r\n            node.active = true;\r\n            let timeStamp = new Date(this.record[i].createTime * 1000);\r\n            let strTime = `${timeStamp.getFullYear()}-${timeStamp.getMonth() + 1 >= 10 ? timeStamp.getMonth() + 1 : \"0\" + (timeStamp.getMonth() + 1)}-${timeStamp.getDate() >= 10 ? timeStamp.getDate() : '0' + timeStamp.getDate()}`\r\n            strTime += ` `\r\n            strTime += `${timeStamp.getHours() >= 10 ?timeStamp.getHours(): \"0\" + timeStamp.getHours()}:`\r\n            strTime += `${timeStamp.getMinutes() >= 10 ?timeStamp.getMinutes(): \"0\" + timeStamp.getMinutes()}:`\r\n            strTime += `${timeStamp.getSeconds() >= 10 ?timeStamp.getSeconds(): \"0\" + timeStamp.getSeconds()}`\r\n            node.getChildByName(\"time\").getComponent(cc.Label).string = strTime;\r\n            node.getChildByName(\"type\").getComponent(cc.Label).string = status[this.record[i].receiveType - 1];\r\n            node.getChildByName(\"betcoin\").getComponent(cc.Label).string = this.cutFloat(this.record[i].allBetting);\r\n            node.getChildByName(\"coin\").getComponent(cc.Label).string = this.cutFloat(this.record[i].number);\r\n            glGame.panel.settingTableLabelColor(node.getChildByName(\"coin\"));\r\n            node.getChildByName(\"status\").getComponent(cc.Label).string = this.record[i].stateDes;\r\n\r\n            // 0，未领取；1，已领取。2，审核中。3，已拒绝。12，过期作废\r\n            let color = this.stateColor[0];\r\n            let state = this.record[i].state;\r\n            switch(state) {\r\n                case 0: case 1: case 4:  // 成功\r\n                    color = this.stateColor[1];\r\n                break;\r\n\r\n                case 2: case 3:  // 处理中\r\n                    color = this.stateColor[0];\r\n                break;\r\n\r\n                case 5: case 6: case 12:  // 失败\r\n                    color = this.stateColor[2];\r\n                break;\r\n\r\n                case 11: // \r\n                    color = this.stateColor[3];\r\n                break;\r\n            }\r\n            node.getChildByName(\"status\").color = color;\r\n\r\n            node.getChildByName(\"bg\").active = i % 2 == 1;\r\n            i++;\r\n        },0.08,len-1,0.3);\r\n    },\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_pageup\": this.pageup_click(); break;\r\n            case \"btn_pagedown\": this.pagedown_click(); break;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    pageup_click() {\r\n        if (this.page <= 1) return;\r\n        this.page--;\r\n        glGame.user.ReqRebateRecordList(this.page, this.pageSize);\r\n    },\r\n\r\n    pagedown_click() {\r\n        if (this.page >= this.pageTotal) return;\r\n        this.page++;\r\n        glGame.user.ReqRebateRecordList(this.page, this.pageSize);\r\n    },\r\n\r\n    //浮点型运算取俩位\r\n    cutFloat(value) {\r\n        return Number(value).div(100).toFixed(2).toString();\r\n    },\r\n\r\n});\r\n"]}