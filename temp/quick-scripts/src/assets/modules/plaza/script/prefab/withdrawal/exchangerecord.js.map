{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\withdrawal\\exchangerecord.js"],"names":["glGame","baseclass","extend","properties","content","cc","Node","exchangeitem","curPage","Label","totalPage","onLoad","resetData","page","record","reqWithdrawLog","exchangeState","exchangeColor","color","string","updateItem","gameNet","send_msg","type","pageSize","route","data","result","pageTotal","getFloat","value","num","Number","div","isNaN","toString","Math","floor","toFixed","msg","destroyAllChildren","removeAllChildren","exchangeInfo","count","length","node","getChildByName","active","i","info","panel","instantiate","parent","bg","coin","getComponent","acc","time","state","payeeMethod","accNum","accountName","replace","substring","money","settingTableLabelColor","timeStamp","Date","rechargeTimeStamp","strTime","getFullYear","getMonth","getDate","tips","WEEKNAME","getDay","getHours","getMinutes","getSeconds","x","console","log","showEffectNode","onClick","name","click_close","upPage","downPage","error","remove","set","key","get"],"mappings":"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","sourceRoot":"/","sourcesContent":["glGame.baseclass.extend({\r\n    properties: {\r\n        content: cc.Node,\r\n        exchangeitem: cc.Node,\r\n        curPage: cc.Label,\r\n        totalPage: cc.Label,\r\n    },\r\n    onLoad() {\r\n        this.resetData();\r\n        this.page = 1\r\n        this.record = {};\r\n        this.reqWithdrawLog();\r\n    },\r\n    resetData() {\r\n        this.exchangeState = [\"处理中\", \"成功\", \"退回\", \"失败\"];\r\n        this.exchangeColor = [cc.color(102, 144, 204), cc.color(0, 255, 24), cc.color(244, 20, 36), cc.color(244, 20, 36)];\r\n    },\r\n    reqWithdrawLog() {\r\n        if (this.record[this.page]) {\r\n            this.curPage.string = this.page;\r\n            this.updateItem(this.record[this.page]);\r\n            return\r\n        }\r\n        glGame.gameNet.send_msg(\"http.reqWithdrawLog\", { type: 0, page: this.page, pageSize: 7 }, (route, data) => {\r\n            this.totalPage.string = data.result.pageTotal;\r\n            this.curPage.string = this.page;\r\n            this.record[this.page] = data;\r\n            this.updateItem(data);\r\n        })\r\n    },\r\n\r\n    //浮点型运算取俩位\r\n    getFloat(value, num = 2) {\r\n        value = Number(value).div(100);\r\n        if (isNaN(value)) return;\r\n        if (~~value === value) {\r\n            return value.toString();\r\n        } else {\r\n            return (Math.floor(value * 100) / 100).toFixed(num).toString();\r\n        }\r\n    },\r\n    updateItem(msg) {\r\n        this.content.destroyAllChildren();\r\n        this.content.removeAllChildren();\r\n        let exchangeInfo = msg.result.data;\r\n        let count = exchangeInfo.length;\r\n        this.node.getChildByName(\"img_wujilu\").active = count == 0;\r\n        this.node.getChildByName(\"pageLayout\").active = count > 0;\r\n        this.node.getChildByName(\"btn_upPage\").active = count > 0;\r\n        this.node.getChildByName(\"btn_downPage\").active = count > 0;\r\n        this.node.getChildByName(\"panel\").getChildByName(\"tip\").active = count > 0;\r\n        for (let i = 0; i < count; i++) {\r\n            let info = exchangeInfo[i];\r\n            let panel = cc.instantiate(this.exchangeitem);\r\n            panel.parent = this.content;\r\n            panel.active = false;\r\n            let bg = panel.getChildByName(\"bg\")\r\n            let coin = panel.getChildByName(\"coin\").getComponent(cc.Label);\r\n            let acc = panel.getChildByName(\"acc\").getComponent(cc.Label);\r\n            let time = panel.getChildByName(\"time\").getComponent(cc.Label);\r\n            let state = panel.getChildByName(\"state\").getComponent(cc.Label);\r\n            let type = panel.getChildByName(\"type\").getComponent(cc.Label);\r\n            bg.active = i % 2 == 0;\r\n            type.string = info.payeeMethod == 1 ? \"支付宝\" : \"银行卡\"\r\n            let accNum = info.accountName\r\n            acc.string = info.payeeMethod == 1 ? accNum.replace(accNum.substring(3, 7), \"****\") : accNum.replace(accNum.substring(4, 13), \"*********\")\r\n            coin.string = `${this.getFloat(info.money)}元`;\r\n            glGame.panel.settingTableLabelColor(panel.getChildByName(\"coin\"));\r\n            state.string = info.state\r\n            let timeStamp = new Date(exchangeInfo[i].rechargeTimeStamp * 1000);\r\n            let strTime = `${timeStamp.getFullYear()}/${timeStamp.getMonth() + 1 >= 10 ? timeStamp.getMonth() + 1 : \"0\" + (timeStamp.getMonth() + 1)}/${timeStamp.getDate() >= 10 ? timeStamp.getDate() : '0' + timeStamp.getDate()}`\r\n            strTime += `（${glGame.tips.WEEKNAME[timeStamp.getDay()]}）`\r\n            strTime += `${timeStamp.getHours() >= 10 ?timeStamp.getHours(): \"0\" + timeStamp.getHours()}:`\r\n            strTime += `${timeStamp.getMinutes() >= 10 ?timeStamp.getMinutes(): \"0\" + timeStamp.getMinutes()}:`\r\n            strTime += `${timeStamp.getSeconds() >= 10 ?timeStamp.getSeconds(): \"0\" + timeStamp.getSeconds()}`\r\n            time.string = strTime;\r\n            for (let x = 0; x < this.exchangeState.length; x++) {\r\n                if (info.state == this.exchangeState[x]) {\r\n                    state.node.color = this.exchangeColor[x]\r\n                }\r\n            }\r\n            console.log(\"兑换记录\", exchangeInfo[i]);\r\n        }\r\n        glGame.panel.showEffectNode(this,this.content,0.02,true);\r\n    },\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"close\": this.click_close(); break;\r\n            case \"btn_upPage\": this.upPage(); break;\r\n            case \"btn_downPage\": this.downPage(); break;\r\n            default: console.error(\"no find button name -> %s\", name);\r\n        }\r\n    },\r\n    upPage() {\r\n        if (this.page - 1 < 1) {\r\n            return\r\n        }\r\n        this.page--;\r\n        this.reqWithdrawLog();\r\n    },\r\n    downPage() {\r\n        if (this.page + 1 > Number(this.totalPage.string)) {\r\n            return\r\n        }\r\n        this.page++;\r\n        this.reqWithdrawLog();\r\n    },\r\n    click_close() {\r\n        this.remove();\r\n    },\r\n    set(key, value) {\r\n        this[key] = value;\r\n    },\r\n    get(key) {\r\n        return this[key];\r\n    }\r\n});\r\n"]}