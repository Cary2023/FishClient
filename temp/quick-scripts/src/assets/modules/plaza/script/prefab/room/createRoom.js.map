{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\room\\createRoom.js"],"names":["glGame","baseclass","extend","properties","content","cc","Node","labDiamonds","Label","btnContent","onLoad","registerEvent","updataInfo","start","setGameButton","gameId","gameName","scene","getSceneNameByID","selectGame","emitter","on","MESSAGE","UI","EXIT_CREATE_ROOM","remove","unRegisterEvent","off","onClick","name","node","panel","showPanelByName","string","getFixNumber","user","get","hideAllPanel","childrenCount","i","children","active","setButton","btn","getComponent","Toggle","isChecked","getGameIdByRoomNum","assetsManager","isUpdateQueue","gamelistcfg","isNeedUpdate","then","bol","showTip","room","getGameDictById","setGameUpdate","gameUpdata","gameID","manifestUrl","getChildByName","getPanelByName","panelData","parent","cutFloat","value","num","isNaN","div","toString","Number","Math","floor","toFixed","value1","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["glGame.baseclass.extend({\r\n\r\n    properties: {\r\n        content: cc.Node,\r\n        labDiamonds: cc.Label,\r\n        btnContent: cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad() {\r\n        this.registerEvent();\r\n        this.updataInfo();\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    setGameButton(gameId) {\r\n        this.gameId = gameId;\r\n        let gameName = glGame.scene.getSceneNameByID(gameId);\r\n        this.selectGame(gameName);\r\n    },\r\n\r\n    // 注册界面监听事件\r\n    registerEvent() {\r\n        glGame.emitter.on(\"updateUserData\", this.updataInfo, this);\r\n        glGame.emitter.on(MESSAGE.UI.EXIT_CREATE_ROOM, this.remove, this);\r\n    },\r\n    // 销毁界面监听事件\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"updateUserData\", this);\r\n        glGame.emitter.off(MESSAGE.UI.EXIT_CREATE_ROOM, this);\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"rqznn\":\r\n            case \"rzjh\":\r\n            case \"rsss\":\r\n            case \"rddz\":\r\n            case \"rbjl\":\r\n            case \"resyd\":\r\n            case \"rxzdd\":\r\n                this.selectGame(name);\r\n                break;\r\n            case \"btn_close\": this.remove(); break;\r\n            case \"btn_add\": glGame.panel.showPanelByName(\"exchangeDiamond\"); break;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    //刷新钻石数量\r\n    updataInfo() {\r\n        this.labDiamonds.string = this.getFixNumber(glGame.user.get(\"diamond\"));\r\n    },\r\n\r\n    //隐藏所有界面\r\n    hideAllPanel() {\r\n        if (!this.content.childrenCount) return;\r\n        for (let i = 0; i < this.content.childrenCount; i++) {\r\n            this.content.children[i].active = false;\r\n        }\r\n    },\r\n\r\n    setButton(name) {\r\n        for (let i = 0; i < this.btnContent.childrenCount; i++) {\r\n            let btn = this.btnContent.children[i];\r\n            if (btn.name === name) {\r\n                btn.getComponent(cc.Toggle).isChecked = true;\r\n            }\r\n        }\r\n    },\r\n\r\n    selectGame(name) {\r\n        this.hideAllPanel();\r\n        this.setButton(name);\r\n        this.getGameIdByRoomNum(name);\r\n        // if (name == \"rqznn\") {\r\n        //     this.getGameIdByRoomNum(name);\r\n        // } else {\r\n        //     if (this.content.getChildByName(`${name}Create`)) {\r\n        //         this.content.getChildByName(`${name}Create`).active = true;\r\n        //         return;\r\n        //     }\r\n\r\n        //     glGame.panel.getPanelByName(`${name}Create`).then(panelData => {\r\n        //         if (!panelData) return;\r\n        //         panelData.parent = this.content;\r\n        //     })\r\n        // }\r\n    },\r\n\r\n    getGameIdByRoomNum(gameName) {\r\n        // 检查当前游戏是否已经在更新队列\r\n        if (glGame.assetsManager.isUpdateQueue(this.gameId)) return;\r\n\r\n        // 检查游戏是否需要更新\r\n        glGame.gamelistcfg.isNeedUpdate(this.gameId).then(bol => {\r\n            if (bol) {\r\n                // 开始更新【%s(游戏名称)】，请耐心等待...\r\n                glGame.panel.showTip(`开始更新【${glGame.room.getGameDictById(this.gameId)}】，请耐心等待...`);\r\n                let gameName = glGame.scene.getSceneNameByID(this.gameId);\r\n                glGame.gamelistcfg.setGameUpdate(gameName, false);\r\n                glGame.assetsManager.gameUpdata({gameID: this.gameId, manifestUrl: null});\r\n                this.remove();\r\n            } else {\r\n                if (this.content.getChildByName(`${gameName}Create`)) {\r\n                    this.content.getChildByName(`${gameName}Create`).active = true;\r\n                    return;\r\n                }\r\n        \r\n                glGame.panel.getPanelByName(`${gameName}Create`).then(panelData => {\r\n                    if (!panelData) return;\r\n                    panelData.parent = this.content;\r\n                })\r\n            }\r\n        });\r\n    },\r\n\r\n    //浮点型运算取俩位\r\n    cutFloat(value, num = 2) {\r\n        if (isNaN(value)) return;\r\n        if (~~value === value) {\r\n            return value.div(100).toString();\r\n        } else {\r\n            value = Number(value).div(100);\r\n            return (Math.floor(value * 100) / 100).toFixed(num);\r\n        }\r\n    },\r\n\r\n    getFixNumber(value) {\r\n        let value1 = Number(value).div(10);\r\n        value = Number(value).div(100);\r\n        if (isNaN(value)) return;\r\n        if (~~value === value) {\r\n            return value.toString();\r\n        } else if (~~value1 === value1) {\r\n            return value.toFixed(1);\r\n        } else {\r\n            return value.toFixed(2);\r\n        }\r\n    },\r\n\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n})"]}