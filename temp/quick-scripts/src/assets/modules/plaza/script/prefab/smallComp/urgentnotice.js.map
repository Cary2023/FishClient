{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\smallComp\\urgentnotice.js"],"names":["glGame","baseclass","extend","properties","urgentnotice","cc","Node","content","Label","tip_ctr","Toggle","close_node","onLoad","initEmergent","emitter","on","newrotice","onClick","name","node","console","log","isChecked","reqIgnoreEmergentNotice","panel","showFirstEnterPanel","isfirstEnterPlaza","active","getChildByName","reqEmergentNotice","user","get","string","gameNet","send_msg","route","msg","result","setTipCtr","bol","setClose","OnDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["glGame.baseclass.extend({\r\n\r\n    properties: {\r\n        urgentnotice: cc.Node,\r\n        content: cc.Label,\r\n        tip_ctr: cc.Toggle,\r\n        close_node: cc.Node\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        // this.reqEmergentNotice();\r\n        this.initEmergent();\r\n        glGame.emitter.on(\"newrotice\", this.newrotice, this);\r\n    },\r\n    onClick(name, node) {\r\n        console.log(\"这是当前按键的按钮名字\", name)\r\n        switch (name) {\r\n            case \"Background\":\r\n                // this.reqIgnoreEmergentNotice();\r\n                break;\r\n            case \"close\":\r\n                if (this.tip_ctr.isChecked) {\r\n                    this.reqIgnoreEmergentNotice();\r\n                }\r\n\r\n                glGame.panel.showFirstEnterPanel();\r\n                glGame.isfirstEnterPlaza = false;\r\n                this.urgentnotice.active = false;\r\n                break;\r\n            case \"Tip_ctr\":\r\n                this.tip_ctr.node.getChildByName(\"Background\").active = !this.tip_ctr.isChecked;\r\n                break;\r\n        }\r\n    },\r\n    newrotice() {\r\n        this.reqEmergentNotice();\r\n    },\r\n    initEmergent() {\r\n        if (glGame.user.get('emergentNotice')) {\r\n            if (glGame.user.get('emergentNotice').content) {\r\n                this.urgentnotice.active = true;\r\n                this.content.string = `${glGame.user.get('emergentNotice').content}`\r\n            } else {\r\n                this.urgentnotice.active = false;\r\n                glGame.panel.showFirstEnterPanel();\r\n                glGame.isfirstEnterPlaza = false;\r\n            }\r\n        }\r\n    },\r\n    //紧急公告请求\r\n    reqEmergentNotice() {\r\n        glGame.gameNet.send_msg(\"http.reqEmergentNotice\", {}, (route, msg) => {\r\n            console.log(\"这是当前紧急公告的消息\", msg)\r\n            if (msg.result.content) {\r\n                this.urgentnotice.active = true;\r\n                this.content.string = `${msg.result.content}`\r\n            } else {\r\n                this.urgentnotice.active = false;\r\n                glGame.panel.showFirstEnterPanel();\r\n                glGame.isfirstEnterPlaza = false;\r\n            }\r\n        })\r\n    },\r\n\r\n    setTipCtr(bol) {\r\n        this.tip_ctr.node.active = bol;\r\n    },\r\n\r\n    setClose(bol){\r\n        this.close_node.active = bol;\r\n    },\r\n\r\n    //不显示紧急公告\r\n    reqIgnoreEmergentNotice() {\r\n        glGame.gameNet.send_msg(\"http.reqIgnoreEmergentNotice\", {}, (route, msg) => {\r\n            console.log(\"不再显示紧急公告请求成功\")\r\n        })\r\n    },\r\n    OnDestroy() {\r\n        glGame.emitter.off(\"newrotice\", this);\r\n    }\r\n});\r\n"]}