{"version":3,"sources":["assets\\modules\\public\\script\\service\\service.js"],"names":["glGame","baseclass","extend","properties","audio","type","cc","AudioClip","leftContent","Node","node_detail","prefab_Question","Prefab","prefab_phone","prefab_exclusive","node_QRcode","code_bg","node_webOnline","node_head","node_copyid","label_copyid","Label","start","registerEvent","playSoundEffect","user","ReqCustomServerConfig","setShowKefu","bFirstShowKefu","emitter","on","initCode","customServer","updateCustomServerConfig","unRegisterEvent","off","reqCustomServer","userUrlData","showUI","CustomServerConfig","get","result","count","i","length","console","log","code","getChildByName","active","setSiblingIndex","getComponent","Toggle","check","onClick","name","node","click_close","click_question","click_exclusiveService","click_onLineSevrice","saveBigQRcodeSprite","click_phone","platform","copyToClip","remove","showPanel","hideOtherPanel","QuestionPanel","webPanel","phonePanel","exclusivePanel","panelName","instantiate","parent","url","thirdUrl","panel","showChildPanel","script","customData","bRefresh","severice","third","screenshot","captureScreenshot","msg","showRemoteImage","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 客服面板, 直接webView连接到 php 指定网址, 具体功能由 php 完成\r\n */\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        audio: {\r\n            type: cc.AudioClip,\r\n            default: null\r\n        },\r\n\r\n        leftContent: cc.Node,\r\n        node_detail: cc.Node,\r\n        prefab_Question: cc.Prefab,\r\n        prefab_phone: cc.Prefab,\r\n        prefab_exclusive: cc.Prefab,\r\n        node_QRcode: cc.Node,\r\n        code_bg: cc.Node,\r\n        node_webOnline: cc.Node,\r\n        node_head: cc.Node,\r\n        node_copyid: cc.Node,\r\n        label_copyid: cc.Label,\r\n    },\r\n    start() {\r\n        this.registerEvent();\r\n        glGame.audio.playSoundEffect(this.audio)\r\n        // this.node_copyid.active = !glGame.user.isTourist();\r\n        // if (this.node_copyid.active) this.label_copyid.string = \"\" + glGame.user.get(\"logicID\");\r\n        glGame.user.ReqCustomServerConfig();\r\n        \r\n    },\r\n\r\n    setShowKefu(bFirstShowKefu){\r\n        this.bFirstShowKefu = bFirstShowKefu;\r\n    },\r\n\r\n    registerEvent() {\r\n        glGame.emitter.on(\"showWechatCode\", this.initCode, this);\r\n        glGame.emitter.on(\"updateCustomServer\", this.customServer, this);\r\n        glGame.emitter.on(\"updateCustomServerConfig\", this.updateCustomServerConfig, this);\r\n    },\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"showWechatCode\", this);\r\n        glGame.emitter.off(\"updateCustomServer\", this);\r\n        glGame.emitter.off(\"updateCustomServerConfig\", this);\r\n    },\r\n    updateCustomServerConfig() {\r\n        glGame.user.reqCustomServer(1, 1, true);\r\n    },\r\n    userUrlData() {\r\n\r\n    },\r\n    showUI() {\r\n        let CustomServerConfig = glGame.user.get(\"CustomServerConfig\").result;\r\n        let count = 1;\r\n        for (let i = 0; i < CustomServerConfig.length; i++) {\r\n            console.log(\"这是当前的code\", CustomServerConfig[i].code)\r\n            if (!this.leftContent.getChildByName(`${CustomServerConfig[i].code}`)) continue;\r\n            this.leftContent.getChildByName(`${CustomServerConfig[i].code}`).active = true;\r\n            this.leftContent.getChildByName(`${CustomServerConfig[i].code}`).setSiblingIndex(count);\r\n            count++;\r\n        }\r\n        \r\n\r\n        if(this.bFirstShowKefu && CustomServerConfig.length>=4) {\r\n            this.leftContent.getChildByName(`${CustomServerConfig[3].code}`).getComponent(cc.Toggle).check();\r\n            this.onClick(`${CustomServerConfig[3].code}`);\r\n        } else {\r\n            this.leftContent.getChildByName(`${CustomServerConfig[0].code}`).getComponent(cc.Toggle).check();\r\n            this.onClick(`${CustomServerConfig[0].code}`);\r\n        }\r\n    },\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_close\": this.click_close(); break;\r\n            case \"question\": this.click_question(); break;\r\n            case \"exclusive\": this.click_exclusiveService(); break;\r\n            case \"third\": this.click_onLineSevrice(); break;\r\n            case \"btn_saveCode\": this.saveBigQRcodeSprite(); break;\r\n            case \"phone\": this.click_phone(); break;\r\n            case \"code_bg\": this.code_bg.active = false; break;\r\n            case \"btn_cpid\": glGame.platform.copyToClip(\"\" + glGame.user.get(\"logicID\"), \"\"); break;\r\n            //default: console.error(\"no find button name -> %s\", name);\r\n        }\r\n    },\r\n    click_close() {\r\n        this.remove();\r\n    },\r\n    click_phone() {\r\n        this.showPanel('phone')\r\n    },\r\n    click_question() {\r\n        this.showPanel('Question')\r\n    },\r\n    // 专享客服\r\n    click_exclusiveService() {\r\n        this.showPanel('exclusive')\r\n    },\r\n    click_onLineSevrice() {\r\n        this.showPanel('web')\r\n    },\r\n    hideOtherPanel() {\r\n        if (this.QuestionPanel) { this.QuestionPanel.active = false }\r\n        if (this.webPanel) { this.webPanel.active = false }\r\n        if (this.phonePanel) { this.phonePanel.active = false }\r\n        if (this.exclusivePanel) { this.exclusivePanel.active = false }\r\n    },\r\n    showPanel(panelName) {\r\n        this.hideOtherPanel()\r\n        if (this[panelName + \"Panel\"]) {\r\n            this[panelName + \"Panel\"].active = true;\r\n            return;\r\n        }\r\n        if (panelName == 'web') {\r\n            this.webPanel = cc.instantiate(this.node_webOnline);\r\n            this.webPanel.active = true;\r\n            this.webPanel.parent = this.node_detail;\r\n            this.webPanel.getComponent(\"cc.WebView\").url = this.thirdUrl;\r\n            console.log(this.webPanel);\r\n        } else {\r\n            this[panelName + \"Panel\"] = glGame.panel.showChildPanel(this[`prefab_${panelName}`], this.node_detail);\r\n            this[panelName + \"Panel\"].active = true\r\n            let script = this[panelName + \"Panel\"].getComponent(this[panelName + \"Panel\"].name);\r\n            script.customData();\r\n        }\r\n\r\n    },\r\n    customServer(bRefresh) {\r\n        this.severice = glGame.user.get(\"customSever\");\r\n        if (this.severice.third) this.thirdUrl = this.severice.third.url;\r\n        if (bRefresh) this.showUI();\r\n    },\r\n    //保持二维码\r\n    saveBigQRcodeSprite() {\r\n        glGame.screenshot.captureScreenshot('shareCode', this.node_QRcode);\r\n    },\r\n\r\n\r\n    initCode(msg) {\r\n        this.code_bg.active = true;\r\n        this.node_head.active = true;\r\n        console.log('dddddd', msg)\r\n        glGame.panel.showRemoteImage(this.node_head, msg.url)\r\n\r\n    },\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n});\r\n"]}