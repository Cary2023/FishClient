{"version":3,"sources":["assets\\frames\\base\\audio.js"],"names":["Audio","resetData","audio","prototype","g_instance","lastAudioSceneName","BGMSE","glGame","storage","getItem","BGMVolume","BGMPlayState","SoundEffectVolume","SoundEffectPlayState","curBGM","curSoundEffect","curLoopSE","musicList","playBGM","curBGMPath","stopCurBGM","cc","audioEngine","play","playPathBGM","data","netMusic","audioloader","loadAudio","then","fileutil","readAudio","stop","stopAll","continueAllMusic","pauseAllMusic","closeBGM","saveVolume","openBGM","getBGM","getBGMVolume","setBGMVolume","volume","setVolume","playSoundEffectByPath","path","console","error","playSoundEffect","playLoadSoundEffectByPath","name","bool","closeCurEffect","loader","load","url","raw","err","clip","soundEffect","playSoundEffectLoop","stopLoopSE","stopEffect","setSoundEffectVolume","openSE","closeSE","stopAllMusic","checkEnterName","nodeName","key","scene","entryGame","panelName","initPlazaAodio","isHavaEntery","director","getScene","i","childrenCount","str","children","indexOf","script","getComponent","BGM","goBackPlazaAudio","onChangeScene","isHave","setItem","get","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["let\r\n    Audio = function () {\r\n        this.resetData();\r\n    },\r\n    audio = Audio.prototype,\r\n    g_instance = null;\r\n\r\naudio.lastAudioSceneName = null;\r\n\r\n/**\r\n * 初始化音量参数\r\n */\r\naudio.resetData = function () {\r\n    this.BGMSE = glGame.storage.getItem(\"BGMSE\") || { BGMVolume: 1, BGMPlayState: true, SoundEffectVolume: 1, SoundEffectPlayState: true };\r\n    this.curBGM = null;\r\n    this.curSoundEffect = null;\r\n    this.curLoopSE = null;\r\n    //默认本地音效\r\n    this.musicList = [\"Hoaprox\", \"Axero-Trip\", \"Friendships\"];\r\n};\r\n/**\r\n * 播放背景音乐\r\n * @param {cc.AudioClip} audio\r\n */\r\naudio.playBGM = function (audio) {\r\n    this.curBGMPath = audio;\r\n    if (!this.BGMSE[\"BGMPlayState\"]) return;\r\n    if (this.curBGM || this.curBGM === 0) this.stopCurBGM();\r\n    this.curBGM = cc.audioEngine.play(this.curBGMPath, true, this.BGMSE[\"BGMVolume\"]);\r\n};\r\n\r\n/**\r\n * 播放背景音乐\r\n */\r\naudio.playPathBGM = function () {\r\n    let data = glGame.storage.getItem(\"bgName\") || { audio: this.musicList[0] };\r\n\r\n    if(data.netMusic) {\r\n        glGame.audioloader.loadAudio(data.audio).then((audio)=> {\r\n            this.curBGMPath = audio;\r\n            if (!this.BGMSE[\"BGMPlayState\"]) return;\r\n            if (this.curBGM || this.curBGM === 0) this.stopCurBGM();\r\n            this.curBGM = cc.audioEngine.play(this.curBGMPath, true, this.BGMSE[\"BGMVolume\"]);\r\n        });\r\n    } else {\r\n        glGame.fileutil.readAudio(`audio/bg/${data.audio}`).then(audio => {\r\n            this.curBGMPath = audio;\r\n            if (!this.BGMSE[\"BGMPlayState\"]) return;\r\n            if (this.curBGM || this.curBGM === 0) this.stopCurBGM();\r\n            this.curBGM = cc.audioEngine.play(this.curBGMPath, true, this.BGMSE[\"BGMVolume\"]);\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * 停止当前播放的背景音乐\r\n */\r\naudio.stopCurBGM = function () {\r\n    if (this.curBGM || this.curBGM === 0) cc.audioEngine.stop(this.curBGM);\r\n    else cc.audioEngine.stopAll();\r\n    this.curBGM = null;\r\n};\r\n\r\n//继续播放所有音效\r\naudio.continueAllMusic = function () {\r\n    this.playBGM(this.curBGMPath);\r\n};\r\n//停止所有音效\r\naudio.pauseAllMusic = function () {\r\n    cc.audioEngine.stopAll();\r\n};\r\n\r\n/**\r\n * 设置背景音乐关闭\r\n */\r\naudio.closeBGM = function () {\r\n    this.BGMSE[\"BGMPlayState\"] = false;\r\n    this.stopCurBGM();\r\n    this.saveVolume();\r\n};\r\n/**\r\n * 设置背景音乐播放开启\r\n */\r\naudio.openBGM = function () {\r\n    this.BGMSE[\"BGMPlayState\"] = true;\r\n    this.playBGM(this.curBGMPath);\r\n    this.saveVolume();\r\n};\r\n\r\n/**\r\n * 获取背景音乐\r\n */\r\naudio.getBGM = function(){\r\n    return this.curBGM;\r\n}\r\n/**\r\n * 获取背景音乐音量\r\n */\r\naudio.getBGMVolume = function(){\r\n    return this.BGMSE[\"BGMVolume\"];\r\n}\r\n/**\r\n * 设置背景音量\r\n * @param volume\r\n */\r\naudio.setBGMVolume = function (volume) {\r\n    this.BGMSE[\"BGMVolume\"] = volume;\r\n    cc.audioEngine.setVolume(this.curBGM, this.BGMSE[\"BGMVolume\"]);\r\n};\r\n/**\r\n * 通过路径播放音效\r\n */\r\naudio.playSoundEffectByPath = function (path) {\r\n    if (!this.BGMSE[\"SoundEffectPlayState\"]) return;\r\n    if (!path) return console.error(\"audio.playSoundEffectByPath 参数 path 不能为空...\");\r\n    this.playSoundEffect(`res/raw-assets/${path}.mp3`);\r\n};\r\n\r\n/**\r\n * 通过路径播放音效(预加载)\r\n * @param name 名字。路径和格式函数拼接\r\n */\r\naudio.playLoadSoundEffectByPath = function (name, bool = false) {\r\n    if (!this.BGMSE[\"SoundEffectPlayState\"]) return;\r\n    if (!name) return console.error(\"audio.playLoadSoundEffectByPath 参数 name 不能为空...\");\r\n    if (bool) this.closeCurEffect();\r\n    let SoundEffectVolume = this.BGMSE[\"SoundEffectVolume\"];\r\n    cc.loader.load(cc.url.raw(`resources/audio/public/${name}.mp3`), function (err, clip) {\r\n        this.curSoundEffect = cc.audioEngine.play(clip, false, SoundEffectVolume);\r\n        if (bool) this.soundEffect = this.curSoundEffect;\r\n    });\r\n};\r\n\r\n/**\r\n * 播放音效\r\n * @param {cc.AudioClip} audio\r\n * @param bool 是否是特长音效，特长音效需要考虑秒关界面的情况，需要把音效停止\r\n */\r\naudio.playSoundEffect = function (audio, bool = false,volume = -1) {\r\n    if (!this.BGMSE[\"SoundEffectPlayState\"]) return;\r\n    if (bool) this.closeCurEffect();\r\n    if(volume != -1){\r\n        this.curSoundEffect = cc.audioEngine.play(audio, false, this.BGMSE[\"SoundEffectVolume\"],volume);\r\n        cc.audioEngine.setVolume(this.curSoundEffect, volume);\r\n\r\n    }else{\r\n        this.curSoundEffect = cc.audioEngine.play(audio, false, this.BGMSE[\"SoundEffectVolume\"]);\r\n    }\r\n    if (bool) this.soundEffect = this.curSoundEffect;\r\n};\r\n\r\n/**\r\n * 循环播放音效\r\n */\r\naudio.playSoundEffectLoop = function (audio,volume = -1) {\r\n    if (!this.BGMSE[\"SoundEffectPlayState\"]) return;\r\n    this.stopLoopSE();\r\n    if(volume != -1){\r\n        this.curLoopSE = cc.audioEngine.play(audio, true, this.BGMSE[\"SoundEffectVolume\"],volume);\r\n    }else {\r\n        this.curLoopSE = cc.audioEngine.play(audio, true, this.BGMSE[\"SoundEffectVolume\"]);\r\n    }\r\n}\r\n/**\r\n * 关闭音效\r\n * this.soundEffect 特长音效的ID\r\n */\r\naudio.closeCurEffect = function () {\r\n    if (!this.BGMSE[\"SoundEffectPlayState\"]) return;\r\n    if (this.soundEffect != null) {\r\n        cc.audioEngine.stopEffect(this.soundEffect);\r\n        this.soundEffect = null;\r\n    }\r\n\r\n}\r\n/**\r\n * 设置音效大小\r\n * @param volume\r\n */\r\naudio.setSoundEffectVolume = function (volume) {\r\n    this.BGMSE[\"SoundEffectVolume\"] = volume;\r\n    cc.audioEngine.setVolume(this.curSoundEffect, this.BGMSE[\"SoundEffectVolume\"]);\r\n    cc.audioEngine.setVolume(this.curLoopSE, this.BGMSE[\"SoundEffectVolume\"]);\r\n};\r\n/**\r\n * 设置音效播放开启\r\n */\r\naudio.openSE = function () {\r\n    this.BGMSE[\"SoundEffectPlayState\"] = true;\r\n    this.saveVolume();\r\n};\r\n/**\r\n * 设置音效播放关闭\r\n */\r\naudio.closeSE = function () {\r\n    this.BGMSE[\"SoundEffectPlayState\"] = false;\r\n    this.stopLoopSE();\r\n    this.saveVolume();\r\n};\r\n\r\naudio.stopLoopSE = function () {\r\n    if (this.curLoopSE !== null) cc.audioEngine.stop(this.curLoopSE);\r\n    this.curLoopSE = null;\r\n};\r\n\r\n/**\r\n * 停止所有声音\r\n */\r\naudio.stopAllMusic = function () {\r\n    cc.audioEngine.stopAll();\r\n    this.curBGM = null;\r\n    this.curSoundEffect = null;\r\n    this.curLoopSE = null;\r\n};\r\n\r\n/**\r\n * 检查预制名是否符合房间选场名称\r\n * @param {string} nodeName 需要坚持的预支名称 \r\n */\r\naudio.checkEnterName = function (nodeName) {\r\n    if (typeof nodeName != \"string\") return false;\r\n    for (let key in glGame.scene.entryGame) {\r\n        let panelName = `${glGame.scene.entryGame[key]}entry`;\r\n        if (nodeName === panelName) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * 初始化主要场景\r\n */\r\naudio.initPlazaAodio = function () {\r\n    let isHavaEntery = false;\r\n    let scene = cc.director.getScene();\r\n    for (let i = 0; i < scene.childrenCount; i++) {\r\n        let str = scene.children[i] ? scene.children[i].name.indexOf(\"entry\") : -1;\r\n        if (str != -1 && this.checkEnterName(scene.children[i].name)) {\r\n            isHavaEntery = true;\r\n            let script = scene.children[i].getComponent(scene.children[i].name);\r\n            //播放选场音乐\r\n            if (script.BGM) glGame.audio.playBGM(script.BGM);\r\n            break;\r\n        }\r\n    }\r\n    if (!isHavaEntery) {\r\n        //glGame.audio.playBGM(this.BGM);\r\n        if (scene && scene.name == \"plaza\") {\r\n            if (glGame.audio) glGame.audio.playPathBGM();\r\n        }\r\n    }\r\n    glGame.audio.lastAudioSceneName = null;\r\n};\r\n/**\r\n * 回到主要场景\r\n * @param {string} name 需要坚持的预支名称 \r\n */\r\naudio.goBackPlazaAudio = function (name) {\r\n    let scene = cc.director.getScene();\r\n    //回到大厅 继续播 原来的背景音乐\r\n    if (scene && scene.name === \"plaza\" && this.checkEnterName(name)) glGame.audio.playPathBGM();\r\n    glGame.audio.lastAudioSceneName = null;\r\n};\r\n/**\r\n * 改变场景\r\n */\r\naudio.onChangeScene = function () {\r\n    let scene = cc.director.getScene();\r\n    let isHave = false;\r\n    for (let i = 0; i < scene.childrenCount; i++) {\r\n        for (let key in glGame.scene.entryGame) {\r\n            if (glGame.scene.entryGame[key] == scene.children[i].name) {\r\n                isHave = true;\r\n                break;\r\n            }\r\n        }\r\n        if (isHave) {\r\n            let script = scene.children[i].getComponent(scene.children[i].name) ? scene.children[i].getComponent(scene.children[i].name) : scene.children[i].getComponent(scene.children[i].name + \"Scene\");\r\n            script = script ? script : scene.children[i].getComponent(scene.children[i].name + \"scene\");\r\n            if (glGame.audio.lastAudioSceneName) {\r\n                if (glGame.audio.lastAudioSceneName == scene.children[i].name) {\r\n                    return;\r\n                }\r\n            }\r\n            glGame.audio.lastAudioSceneName = scene.children[i].name;\r\n            //播放选场音乐\r\n            if (script.BGM) {\r\n                glGame.audio.playBGM(script.BGM);\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 写入缓存\r\n */\r\naudio.saveVolume = function () {\r\n    glGame.storage.setItem(\"BGMSE\", this.BGMSE);\r\n};\r\naudio.get = function (key) {\r\n    return this[key];\r\n};\r\nmodule.exports = function () {\r\n    if (!g_instance) {\r\n        g_instance = new Audio();\r\n    }\r\n    return g_instance;\r\n};\r\n"]}