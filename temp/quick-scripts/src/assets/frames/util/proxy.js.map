{"version":3,"sources":["assets\\frames\\util\\proxy.js"],"names":["JSEncrypt","require","Base64","Cryptor","ProxyData","init","proxy","prototype","_special","_img_list","g_instance","DELAY_TYPE","DELAY_ON","DELAY_OFF","DELAY_ERROR","CODE","BEGIN_LINK_ERROR","LINK_ERROR","begin_start","data","standby_start","_http_list","_begin","_begincount","_begindelay","_standby","_standbycount","_standbydelay","_event_list","_begin_end_for","_standby_end_for","_end_for","_delay","_linkmax","_delayof","_linkcount","enkey","push","dekey","encrypt","decrypt","setPublicKey","decode","setPrivateKey","cryptor","start","getBeginServer","stop","clear","key","ping","then","pingBegin","bind","console","error","times","encode","url","timeout","clearTimeout","clearList","getServer","getStandbyServer","pingStandb","onload","src","emit","addHttpList","length","getHttpList","http_list","https","ids","i","head","String","hash","slice","list","body","id","includes","concat","parseInt","Math","random","path","JSON","stringify","route","xhr","XMLHttpRequest","open","setRequestHeader","onerror","ProxyO","onreadystatechange","readyState","status","respone","responseText","resp","parse","code","log","checkServer","send","jsencrypt","jsdecrypt","domain","Promise","resolve","reject","Date","now","test","ontimeout","pingSucceed","setTimeout","name","item","args","call","arguments","apply","obj","on","callfunc","self","off","window"],"mappings":"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","sourceRoot":"/","sourcesContent":["var JSEncrypt = require(\"jsencrypt\");\r\nvar Base64 = Base64 || require('base64').Base64;\r\nvar Cryptor = require('cryptor');\r\n\r\nlet ProxyData = function () {\r\n    this.init();\r\n},\r\n    proxy = ProxyData.prototype,\r\n    _special = \"\",\r\n    _img_list = {},\r\n    g_instance = null;\r\n\r\nlet DELAY_TYPE = {\r\n    DELAY_ON: 0,\r\n    DELAY_OFF: 1,\r\n    DELAY_ERROR: 2,\r\n}\r\n\r\nlet CODE = {\r\n    BEGIN_LINK_ERROR: 0,\r\n    LINK_ERROR: 1,\r\n    DELAY_ERROR: 2,\r\n}\r\n\r\n\r\nlet begin_start = {\r\n    1: { data: \"aHR0cDovLzE5Mi4xNjguMy4xMDE6MTAwMTA=\" },\r\n\r\n}\r\n\r\nlet standby_start = {\r\n    1: { data: \"aHR0cDovLzE5Mi4xNjguMy4xMDE6MTAwMTA=\" },\r\n}\r\n\r\nproxy.init = function () {\r\n    this._http_list = [];\r\n    this._begin = null;\r\n    this._begincount = 0;\r\n    this._begindelay = 3000;\r\n    this._standby = null;\r\n    this._standbycount = 0;\r\n    this._standbydelay = 10000;\r\n    this._event_list = {};\r\n    this._begin_end_for = false;\r\n    this._standby_end_for = false;\r\n    this._end_for = false;\r\n    this._delay = 3000;\r\n    this._linkmax = 5;\r\n    this._delayof = 0;\r\n    this._linkcount = 0;\r\n\r\n    let enkey = [];\r\n    enkey.push(\"LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlHZU1BMEdDU3FHU0liM0RRRUJBUVVBQTRHTUFEQ0JpQUtCZ0ZXdUFvSUhncXduZks1MUlFamJhMG4wZzV3eApZL04wb3kzSV\");\r\n    enkey.push(\"Qyakp1NWEwcUkwZXlGRmNUME5FV2ViUTR3S0NnS1M1MTNGN3FZM2c0MTdNWGlpaEZnWXZWczQ0CmloZFVieDFPbnZmZWl4UTI1aHJzNDZESG45aUxxWTFxNExhOXh6ZFg4Q1BOR\");\r\n    enkey.push(\"jdLRDF6UVQvZzdVcWd4dVBrZDEKOExmN2MvaWNUQnd2bFdkWkFnTUJBQUU9Ci0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLQ==\");\r\n    let dekey = [];\r\n    dekey.push(\"LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDV3dJQkFBS0JnR0JDYk5YQ0hRL0ZCOG11R0NVMyt4SmhNb3lnTm5DNXBtZFhIdXlhZGx1ZndiYWZ\");\r\n    dekey.push(\"Hd1ZrCjM0dTh0anlod3RYZVFidWZXbTJOTDV1Z3JjeENyWUgwUHNIcjFwTitMUG9yUkFqS01lNys5NlRhblpZOWdmdUsKSTBnNlJtelMzOXB4UHdoSFlBVTJNMy\");\r\n    dekey.push(\"9IUGpON2ZFQUhDMFNFU0d4cEVJcnFyNHdMTVpzTGJoVlpBZ01CQUFFQwpnWUFCRGZrL1JrY25PeE5neEVXRGN0K1BUZjFOeVJ1UGxKa2NITG84QVYwMmw4TjVpc\");\r\n    dekey.push(\"ml6RUczYWpCQzdEVktqCklUSTdLZjNGb1h4YUNpS2RVRVd5WE1pck44ZWtnZUxnUERRN0Jyb3h6M3JTazNOWXhFR0tIS2VnbVAxVjFQL20KM2JwTC8rMjNHUHJI\");\r\n    dekey.push(\"bkpDSEJ2aW9RSlVPQWVXb0F6b2xibGROSFlQN1FLU1IrUUpCQUo1dlI3RjU1eGtXazFVegpvSXNqaFNHeVRKYlJTYzQyK0RsaW1BM25GWVQ4T0JwUFd5YnFHQWJJ\");\r\n    dekey.push(\"WkdFS1RBZ0w5c0ZjL1lyNTEwZy9VeVpiCkZBS21xMXNDUVFDYmlXd09oaHMrT1NTSlBOM21hU1BuVEREVnBTZFRNUWt2K2x0c3BLd1l4V2Y3OXFDS3NnVGQKcGJ0\");\r\n    dekey.push(\"UXdLdUlLSFB0MHpoYmlVWmJsTWlsc2VMTThVUmJBa0VBaUNoV1VyM1N6NHJKUDVYSXlRclRwU3ZZQ2x6Kwpzc3dtOHhvNlZ1aGJaQmhtRnFaUVRkY3NvdGVnL0l5\");\r\n    dekey.push(\"ZTN1TjVRcUFwL1QvTnRmZEYvRmFWa2RtdXRRSkFPaW45CjJzQ1QxNFVQQUxOZVdCZmhjVkd3d1hSdGJGTGVHSzhMR1duTFljZ1F4c3pINUpZRjg4MVNhelJoOFIw\");\r\n    dekey.push(\"UG5WUnIKc3U5Mi9EQjdpRnNwY1hLWUdRSkFZdnd4T3lmSmhjVHRSOVZtQmsrVEJ4MnY1T0NQVmZMZHA3N1NkbWJVN3NpRAovc0ZFb0hJUk1OQkh6MForN0dNckhX\");\r\n    dekey.push(\"UzZlMldKdzVlc2VjSTB2T3g3SGc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQ==\");\r\n    this.encrypt = new JSEncrypt.JSEncrypt();\r\n    this.decrypt = new JSEncrypt.JSEncrypt();\r\n    this.encrypt.setPublicKey(Base64.decode(enkey[0] + enkey[1] + enkey[2]));\r\n    this.decrypt.setPrivateKey(Base64.decode(dekey[0] + dekey[1] + dekey[2] + dekey[3] + dekey[4] + dekey[5] + dekey[6] + dekey[7] + dekey[8] + dekey[9]));\r\n    this.cryptor = null;\r\n}\r\n\r\n/**\r\n * \r\n */\r\nproxy.start = function () {\r\n    this._linkcount = 0;\r\n    this._begincount = 0;\r\n    this._standbycount = 0;\r\n    this.getBeginServer();\r\n}\r\n\r\nproxy.stop = function () {\r\n    this.clear();\r\n    this.init();\r\n}\r\n\r\n/**\r\n * 获取服务器地址列表\r\n */\r\nproxy.getBeginServer = function () {\r\n    this._begin = begin_start;//JSON.parse(this.jsdecrypt(begin_start));\r\n    for (let key in this._begin) {\r\n        if (this._begin_end_for) break;\r\n        if (!this._begin[key].data) continue;\r\n        this.ping(Base64.decode(this._begin[key].data)).then(this.pingBegin.bind(this)).catch(data => { console.error(`Address to repeat:${data}`); })\r\n    }\r\n}\r\n\r\n/**\r\n * 开始链接地址ping测试\r\n */\r\nproxy.pingBegin = function (data) {\r\n    if (this._begin_end_for) return;\r\n    if (data.times <= this._begindelay) {\r\n        _special = Base64.encode(data.url);\r\n        this._begin_end_for = true;\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n\r\n        this.clearList();\r\n\r\n        this._begin = null;\r\n        this.getServer();\r\n\r\n        //启用备用地址\r\n    } else {\r\n        this.clearList();\r\n\r\n        this.getStandbyServer();\r\n    }\r\n    //else this.emit('failed', CODE.BEGIN_LINK_ERROR);\r\n}\r\n\r\n\r\n/**\r\n * 启用备用地址服务器地址列表\r\n */\r\nproxy.getStandbyServer = function () {\r\n    this._standby = standby_start;//JSON.parse(this.jsdecrypt(begin_start));\r\n    for (let key in this._standby) {\r\n        if (this._standby_end_for) break;\r\n        if (!this._standby[key].data) continue;\r\n        this.ping(Base64.decode(this._standby[key].data)).then(this.pingStandb.bind(this)).catch(data => { console.error(`Address to repeat:${data}`); })\r\n    }\r\n}\r\n\r\n/**\r\n * 开始链接备用地址ping测试\r\n */\r\nproxy.pingStandb = function (data) {\r\n    if (this._standby_end_for) return;\r\n    if (data.times <= this._standbydelay) {\r\n        _special = Base64.encode(data.url);\r\n        this._standby_end_for = true;\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n\r\n\r\n        for (let key in _img_list) {\r\n            if (!_img_list[key].onload) continue;\r\n            _img_list[key].src = \"\";\r\n            _img_list[key] = null;\r\n        }\r\n        _img_list = {};\r\n        this._standby = null;\r\n        this.getServer();\r\n        //启用备用地址\r\n    } else this.emit('failed', CODE.BEGIN_LINK_ERROR);\r\n}\r\n\r\n/**\r\n * 添加服务列表\r\n * @param {Object} data\r\n */\r\nproxy.addHttpList = function (data) {\r\n    if (this._http_list.length) {\r\n        for (let key in this._http_list) {\r\n            if (this._http_list[key] == data) return;\r\n        }\r\n    }\r\n    this._http_list.push(data);\r\n}\r\n\r\n/**\r\n * 返回http列表给与服务端\r\n */\r\nproxy.getHttpList = function () {\r\n    let http_list = \"\";\r\n    let https = {};\r\n    https.ids = [];\r\n    for (let i = 0; i < this._http_list.length; i++) {\r\n        let head = this._http_list[i].head;\r\n        //let cryptor = new Cryptor(this.jsdecrypt(head.key));\r\n        let cryptor = new Cryptor(String(Cryptor.hash(head.key, 'md5')).slice(0, 6));\r\n        let list = cryptor.decode(Base64.decode(this._http_list[i].body))\r\n        for (let key in list) {\r\n            if (!list[key] || !list[key].id) continue;\r\n            if (https.ids.includes(list[key].id)) continue;\r\n            https.ids = https.ids.concat(list[key].id)\r\n        }\r\n    }\r\n\r\n    let key = String(Cryptor.hash(\"\" + parseInt(Math.random() * 100), 'md5')).slice(0, 6)\r\n    //let enkey = this.jsencrypt(key);\r\n    let enkey = String(Cryptor.hash(key, 'md5')).slice(-6);\r\n    let cryptor = new Cryptor(enkey)\r\n    let path = Base64.encode(cryptor.encode(JSON.stringify(https)))\r\n    http_list = JSON.stringify({ head: { route: \"http.reqDomainList\", key: key }, body: path });\r\n    return http_list;\r\n}\r\n\r\n/**\r\n * 获取服务器地址列表\r\n */\r\nproxy.getServer = function () {\r\n    if (this._linkcount > this._linkmax) {\r\n        this.emit('failed', CODE.LINK_ERROR);\r\n        this.getStandbyServer();\r\n    } else {\r\n        this._linkcount++;\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open(\"POST\", Base64.decode(_special), true);\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=utf-8\");\r\n        xhr.timeout = 10000;\r\n        xhr.onerror = (error) => { ProxyO.getServer() };\r\n\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n                let respone = xhr.responseText;\r\n                let resp = JSON.parse(respone);\r\n                let head = resp.head;\r\n                //表示服务端已无可用高效的链接地址\r\n                if (head.code != 0) {\r\n                    ProxyO.emit('failed', CODE.LINK_ERROR);\r\n                    return;\r\n                }\r\n                console.log(\"getServer:\", Base64.decode(_special));\r\n                //记录所有ping低的网络环境\r\n                ProxyO.addHttpList(resp);\r\n                //解密ping值\r\n                let cryptor = new Cryptor(String(Cryptor.hash(head.key, 'md5')).slice(0, 6));\r\n                ProxyO.checkServer(cryptor.decode(Base64.decode(resp.body)));\r\n            }\r\n        };\r\n        xhr.send(ProxyO.getHttpList());\r\n    }\r\n}\r\n\r\n/**\r\n * rsa 加密\r\n * @param {any} data\r\n */\r\nproxy.jsencrypt = function (data) {\r\n    return this.encrypt.encrypt(data);\r\n}\r\n\r\n/**\r\n * rsa 解密\r\n * @param {Sting} data\r\n */\r\nproxy.jsdecrypt = function (data) {\r\n    return this.decrypt.decrypt(data);\r\n}\r\n\r\n// /**\r\n//  * ping 函数 \r\n//  * @param {String} ip \r\n//  * @returns {Promise<any>}\r\n//  */\r\n// proxy.ping = function (domain) {\r\n//     return new Promise((resolve, reject) => {\r\n//         if (_img_list[domain] != null) return reject(domain);\r\n//         _img_list[domain] = new Image();\r\n//         var start = Date.now()\r\n//         _img_list[domain].onload = function () {\r\n//             resolve({ url: domain, times: Date.now() - start });\r\n//         }\r\n//         //TODO IE8无法监听到该消息\r\n//         _img_list[domain].onerror = function (data, event) {\r\n//             resolve({ url: domain, times: Date.now() - start })\r\n//         }\r\n//         console.log(\"ping:\", domain);\r\n//         _img_list[domain].src = /^(http|https)/.test(domain) ? domain : \"https://\" + domain;\r\n//     })\r\n// }\r\n\r\n/**\r\n * ping 函数 \r\n * @param {String} ip \r\n * @returns {Promise<any>}\r\n */\r\nproxy.ping = function (domain) {\r\n    return new Promise((resolve, reject) => {\r\n        if (_img_list[domain] != null) return reject(domain);\r\n\r\n        let xhr = new XMLHttpRequest();\r\n        _img_list[domain] = xhr;\r\n        let start = Date.now();\r\n        let url = /^(http|https)/.test(domain) ? domain : \"https://\" + domain;\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=utf-8\");\r\n        xhr.open(\"GET\", url, true);\r\n\r\n        xhr.onreadystatechange = ()=> {\r\n            if(xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n                resolve({ url: domain, times: Date.now() - start});\r\n            }\r\n        };\r\n\r\n        xhr.onerror = () => { \r\n            reject(domain);\r\n        };\r\n        xhr.ontimeout = ()=> {\r\n            resolve({ url:domain, times: Date.now() - start });\r\n        };\r\n\r\n        xhr.send();\r\n    });\r\n}\r\n\r\n/**\r\n * 清理已发包的域名\r\n */\r\nproxy.clearList = function () {\r\n    for (let key in _img_list) {\r\n        if (!_img_list[key].onreadystatechange) continue;\r\n        _img_list[key].onreadystatechange = null;\r\n        _img_list[key].onerror = null;\r\n        _img_list[key].ontimeout = null;\r\n        _img_list[key] = null;\r\n    }\r\n    _img_list = {};\r\n}\r\n\r\n\r\n/**\r\n * 链接地址ping通过\r\n */\r\nproxy.pingSucceed = function (data) {\r\n    if (this._end_for) return;\r\n    if (data.times <= this._delay || this._delayof == DELAY_TYPE.DELAY_OFF) {\r\n        this.emit('succeed', data);\r\n        this._end_for = true;\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n        this.clearList();\r\n        _special = \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * 检查服务器的链接时长\r\n */\r\nproxy.checkServer = function (http_list) {\r\n    if (http_list) {\r\n        this.emit('check');\r\n        this._end_for = false;\r\n        for (let key in http_list) {\r\n            if (this._end_for) break;\r\n            if (!http_list[key]) continue;\r\n            this.ping(http_list[key].domain).then(this.pingSucceed.bind(this)).catch(data => { console.error(`Address to repeat:${data}`); })\r\n        }\r\n        this.timeout = setTimeout(() => {\r\n            if (this.timeout) {\r\n                clearTimeout(this.timeout);\r\n                this.timeout = null;\r\n            }\r\n            this.clearList();\r\n            // TODO 所有链接延迟超过设定标准 重新获取新的链接服务器。\r\n            if (DELAY_TYPE.DELAY_ERROR === this._delayof) this.emit('failed', CODE.LINK_ERROR);\r\n            else this.getServer();\r\n        }, this._delay)\r\n    }\r\n}\r\n\r\n/**\r\n * 发送消息通知事件\r\n * @param {String} name\r\n * @param {Any} data\r\n */\r\nproxy.emit = function (name, data) {\r\n    let item = this._event_list[name];\r\n    if (this._event_list[name] != null) {\r\n        var args = [].slice.call(arguments, 1);\r\n        item.call.apply(item.obj, args);\r\n    }\r\n}\r\n\r\n/**\r\n * 注册监听\r\n * @param {String} name\r\n * @param {func} callfunc\r\n * @param {Object} self\r\n */\r\nproxy.on = function (name, callfunc, self) {\r\n    switch (name) {\r\n        case 'begin':\r\n        case 'check':\r\n        case 'succeed':\r\n        case 'failed':\r\n            if (this._event_list[name] == null) this._event_list[name] = { call: callfunc, obj: self };\r\n            else console.error(`event name ${name} is registered!`);\r\n            break\r\n        default: console.error(`event name ${name} registration failed!`);\r\n    }\r\n}\r\n\r\n/**\r\n * 取消监听\r\n * @param {String} name\r\n */\r\nproxy.off = function (name) {\r\n    for (let key in this._event_list) {\r\n        if (key === name) {\r\n            delete this._event_list[key];\r\n            this._event_list = null;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 关闭所有监听\r\n */\r\nproxy.clear = function () {\r\n    this._event_list = null;\r\n    this._event_list = {};\r\n}\r\n\r\n\r\n\r\nwindow.ProxyO = function () {\r\n    if (!g_instance) g_instance = new ProxyData();\r\n    return g_instance;\r\n}();"]}