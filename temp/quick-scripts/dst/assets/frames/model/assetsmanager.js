
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/frames/model/assetsmanager.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e445cKk3hBLbKDcYKgsPeUp', 'assetsmanager');
// frames/model/assetsmanager.js

"use strict";

/**
 * 玩家模型
 * @constructor
 */
var AssetsManager = function AssetsManager() {
  this.resetData();
  this.registerEvent();
},
    assetsManager = AssetsManager.prototype,
    g_instance = null;

assetsManager.resetData = function () {
  this.updateGameMax = 2;
  this.assets_manager = {};
  this.update_list = {};
};
/**
 * 注册事件监听
 * 数据模型的事件无需销毁
 * 理论上重启游戏后就不存在了
 */


assetsManager.registerEvent = function () {// glGame.emitter.on("loginSuccess", this.loginSuccess, this);
  // glGame.emitter.on(MESSAGE.USER.PHONE_VERIFICATION, this.clearAllPhoneInterval, this);
}; // 查找是否需要更新


assetsManager.isNeedUpdate = function (gameName) {
  if (!cc.sys.isNative) return; //真机才做校验

  var update_data = glGame.storage.getItem('update_data');

  if (update_data && update_data[gameName]) {
    //本地缓存有游戏在做校验
    var hotUpdateURL = glGame.servercfg.getHotupdateVersionUrl();
    var url = "".concat(hotUpdateURL).concat(gameName, "/").concat(gameName, "version.manifest");
    glGame.gamelistcfg.getGameVersion(url).then(function (data) {
      if (data.version === update_data[gameName]) {
        // 不需要更新
        glGame.gamelistcfg.setGameUpdate(gameName);
      } else {
        // 需要更新
        glGame.gamelistcfg.setGameUpdate(gameName, false);
      }
    });
  }
}, // 热更开启
assetsManager.gameUpdata = function (data) {
  if (!cc.sys.isNative) return;
  var gameName = glGame.scene.getSceneNameByID(data.gameID);
  if (!gameName || this.update_list[gameName]) return;
  var update_list_data = {};
  update_list_data.gameID = data.gameID;
  update_list_data.manifestUrl = data.manifestUrl;
  update_list_data.gameName = gameName;
  update_list_data.isUpdating = true;
  update_list_data.isUpdate = true;
  this.update_list[gameName] = update_list_data;
  var update_list_length = Object.keys(this.update_list).length;

  if (update_list_length && update_list_length > this.updateGameMax) {
    // 下载列表大于最大同时下载量的时候显示等待中
    this.update_list[gameName].isUpdate = false;
    glGame.emitter.emit("hotUIRefresh", {
      gameName: gameName,
      isActive: true
    });
    return;
  }

  this.downloadGame(update_list_data);
}; // 开始下载游戏

assetsManager.downloadGame = function (data) {
  var _this = this;

  // 切换到可以跟新的页面
  glGame.emitter.emit("hotUIRefresh", {
    gameName: data.gameName,
    isStatus: 0,
    isActive: true
  });
  var m_assets = new glGame.assets(glGame.scene.getSceneNameByID(data.gameID), data.manifestUrl, function (process) {
    // 更新下载进度条
    process = process ? process : 0;
    console.log("需要发送事件，更新下载进度", process);
    glGame.emitter.emit("hotUIRefresh", {
      gameName: data.gameName,
      isStatus: 1,
      isActive: true,
      process: process
    });
  }, function () {
    // 成功回调
    console.log("assetsManager==============下载完成 ===>", data.gameName);
    var m_gameName = data.gameName;
    var str = glGame.tips.UPDATE.COMPLETED.format("".concat(glGame.room.getGameDictById(data.gameID)));
    glGame.panel.showTip(str, 2);
    glGame.emitter.emit("hotUIRefresh", {
      gameName: m_gameName,
      isActive: false,
      process: 100
    }); // 设置已更新的游戏

    glGame.gamelistcfg.setGameUpdate(m_gameName);

    _this.gameUpdateEnd(data.gameName);

    var hotUpdateURL = glGame.servercfg.getHotupdateVersionUrl();
    var url = "".concat(hotUpdateURL).concat(m_gameName, "/").concat(m_gameName, "version.manifest");
    glGame.gamelistcfg.getGameVersion(url).then(function (verdata) {
      var data = glGame.storage.getItem('update_data');

      if (data) {
        data[m_gameName] = verdata.version;
      } else {
        data = {};
        data[m_gameName] = verdata.version;
      }

      glGame.storage.setItem('update_data', data);
    });
  }, function () {
    // 失败回调
    console.log("assetsManager==============下载失败 ===>", data.gameName);
    glGame.emitter.emit("hotUIRefresh", {
      gameName: data.gameName,
      isActive: false
    });

    _this.gameUpdateEnd(data.gameName);
  });
  this.assets_manager[data.gameName] = m_assets;
}; // 热更结束


assetsManager.gameUpdateEnd = function (gameName) {
  this.assets_manager[gameName].destroy();
  var update_list_keys = Object.keys(this.update_list);
  var update_list_length = update_list_keys.length;
  console.log("热更结束, gameUpdateEnd ===> update_list_length:", update_list_length);
  if (!update_list_length || update_list_length == 0) return; // 热更新下一个

  if (update_list_length > this.updateGameMax) {
    var data = this.update_list[update_list_keys[this.updateGameMax]];
    data.isUpdate = true;
    this.downloadGame(data);
  } // 删除已经跟新完成的数据


  delete this.update_list[gameName];
}; // 检查当前是否有游戏正在跟新


assetsManager.isBeingUpdate = function (gameName) {
  var isUpdate = null;

  for (var key in this.update_list) {
    if (key == gameName) {
      var data = this.update_list[key];

      if (data.isUpdating && data.isUpdate) {
        isUpdate = true;
      } else {
        isUpdate = false;
      }
    }
  }

  return isUpdate;
}; // 检查当前游戏是否已经在更新队列


assetsManager.isUpdateQueue = function (gameId) {
  var isUpdate = false;
  var gameName = glGame.scene.getSceneNameByID(gameId); // 查找更新列表里是否有游戏正在更新

  for (var key in this.update_list) {
    if (key == gameName) {
      var data = this.update_list[key];

      if (data.isUpdating) {
        // 【%s(游戏名称)】正在更新中，请耐心等待...
        glGame.panel.showTip(glGame.tips.UPDATE.UPDATING.format("".concat(glGame.room.getGameDictById(gameId))));
      } else {
        glGame.panel.showTip(glGame.tips.UPDATE.INUPDATEQUEUE.format("".concat(glGame.room.getGameDictById(gameId))));
      }

      isUpdate = true;
    }
  }

  return isUpdate;
}; // 获取热更属性


assetsManager.get = function (key) {
  return this[key];
};

module.exports = function () {
  if (!g_instance) {
    g_instance = new AssetsManager();
  }

  return g_instance;
};

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZnJhbWVzXFxtb2RlbFxcYXNzZXRzbWFuYWdlci5qcyJdLCJuYW1lcyI6WyJBc3NldHNNYW5hZ2VyIiwicmVzZXREYXRhIiwicmVnaXN0ZXJFdmVudCIsImFzc2V0c01hbmFnZXIiLCJwcm90b3R5cGUiLCJnX2luc3RhbmNlIiwidXBkYXRlR2FtZU1heCIsImFzc2V0c19tYW5hZ2VyIiwidXBkYXRlX2xpc3QiLCJpc05lZWRVcGRhdGUiLCJnYW1lTmFtZSIsImNjIiwic3lzIiwiaXNOYXRpdmUiLCJ1cGRhdGVfZGF0YSIsImdsR2FtZSIsInN0b3JhZ2UiLCJnZXRJdGVtIiwiaG90VXBkYXRlVVJMIiwic2VydmVyY2ZnIiwiZ2V0SG90dXBkYXRlVmVyc2lvblVybCIsInVybCIsImdhbWVsaXN0Y2ZnIiwiZ2V0R2FtZVZlcnNpb24iLCJ0aGVuIiwiZGF0YSIsInZlcnNpb24iLCJzZXRHYW1lVXBkYXRlIiwiZ2FtZVVwZGF0YSIsInNjZW5lIiwiZ2V0U2NlbmVOYW1lQnlJRCIsImdhbWVJRCIsInVwZGF0ZV9saXN0X2RhdGEiLCJtYW5pZmVzdFVybCIsImlzVXBkYXRpbmciLCJpc1VwZGF0ZSIsInVwZGF0ZV9saXN0X2xlbmd0aCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJlbWl0dGVyIiwiZW1pdCIsImlzQWN0aXZlIiwiZG93bmxvYWRHYW1lIiwiaXNTdGF0dXMiLCJtX2Fzc2V0cyIsImFzc2V0cyIsInByb2Nlc3MiLCJjb25zb2xlIiwibG9nIiwibV9nYW1lTmFtZSIsInN0ciIsInRpcHMiLCJVUERBVEUiLCJDT01QTEVURUQiLCJmb3JtYXQiLCJyb29tIiwiZ2V0R2FtZURpY3RCeUlkIiwicGFuZWwiLCJzaG93VGlwIiwiZ2FtZVVwZGF0ZUVuZCIsInZlcmRhdGEiLCJzZXRJdGVtIiwiZGVzdHJveSIsInVwZGF0ZV9saXN0X2tleXMiLCJpc0JlaW5nVXBkYXRlIiwia2V5IiwiaXNVcGRhdGVRdWV1ZSIsImdhbWVJZCIsIlVQREFUSU5H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SyxJQUFJRixHQUFULElBQWdCLEtBQUsxRCxXQUFyQixFQUFrQztBQUM5QixRQUFJMEQsR0FBRyxJQUFJeEQsUUFBWCxFQUFxQjtBQUNqQixVQUFJZSxJQUFJLEdBQUcsS0FBS2pCLFdBQUwsQ0FBaUIwRCxHQUFqQixDQUFYOztBQUNBLFVBQUl6QyxJQUFJLENBQUNTLFVBQVQsRUFBcUI7QUFDakI7QUFDQW5CLFFBQUFBLE1BQU0sQ0FBQzJDLEtBQVAsQ0FBYUMsT0FBYixDQUFxQjVDLE1BQU0sQ0FBQ3FDLElBQVAsQ0FBWUMsTUFBWixDQUFtQmdCLFFBQW5CLENBQTRCZCxNQUE1QixXQUFzQ3hDLE1BQU0sQ0FBQ3lDLElBQVAsQ0FBWUMsZUFBWixDQUE0QlcsTUFBNUIsQ0FBdEMsRUFBckI7QUFDSCxPQUhELE1BR087QUFDSHJELFFBQUFBLE1BQU0sQ0FBQzJDLEtBQVAsQ0FBYUMsT0FBYixDQUFxQjVDLE1BQU0sQ0FBQ3FDLElBQVAsQ0FBWUMsTUFBWixDQUFtQmlCLGFBQW5CLENBQWlDZixNQUFqQyxXQUEyQ3hDLE1BQU0sQ0FBQ3lDLElBQVAsQ0FBWUMsZUFBWixDQUE0QlcsTUFBNUIsQ0FBM0MsRUFBckI7QUFDSDs7QUFDRGpDLE1BQUFBLFFBQVEsR0FBRyxJQUFYO0FBQ0g7QUFDSjs7QUFDRCxTQUFPQSxRQUFQO0FBQ0gsQ0FsQkQsRUFvQkE7OztBQUNBaEMsYUFBYSxDQUFDb0UsR0FBZCxHQUFvQixVQUFVTCxHQUFWLEVBQWU7QUFDL0IsU0FBTyxLQUFLQSxHQUFMLENBQVA7QUFDSCxDQUZEOztBQUlBTSxNQUFNLENBQUNDLE9BQVAsR0FBaUIsWUFBWTtBQUN6QixNQUFJLENBQUNwRSxVQUFMLEVBQWlCO0FBQ2JBLElBQUFBLFVBQVUsR0FBRyxJQUFJTCxhQUFKLEVBQWI7QUFDSDs7QUFDRCxTQUFPSyxVQUFQO0FBQ0gsQ0FMRCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi8qKlxyXG4gKiDnjqnlrrbmqKHlnotcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5sZXRcclxuICAgIEFzc2V0c01hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5yZXNldERhdGEoKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgIH0sXHJcbiAgICBhc3NldHNNYW5hZ2VyID0gQXNzZXRzTWFuYWdlci5wcm90b3R5cGUsXHJcbiAgICBnX2luc3RhbmNlID0gbnVsbDtcclxuXHJcbmFzc2V0c01hbmFnZXIucmVzZXREYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy51cGRhdGVHYW1lTWF4ID0gMjtcclxuICAgIHRoaXMuYXNzZXRzX21hbmFnZXIgPSB7fTtcclxuICAgIHRoaXMudXBkYXRlX2xpc3QgPSB7fTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiDms6jlhozkuovku7bnm5HlkKxcclxuICog5pWw5o2u5qih5Z6L55qE5LqL5Lu25peg6ZyA6ZSA5q+BXHJcbiAqIOeQhuiuuuS4iumHjeWQr+a4uOaIj+WQjuWwseS4jeWtmOWcqOS6hlxyXG4gKi9cclxuYXNzZXRzTWFuYWdlci5yZWdpc3RlckV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gZ2xHYW1lLmVtaXR0ZXIub24oXCJsb2dpblN1Y2Nlc3NcIiwgdGhpcy5sb2dpblN1Y2Nlc3MsIHRoaXMpO1xyXG4gICAgLy8gZ2xHYW1lLmVtaXR0ZXIub24oTUVTU0FHRS5VU0VSLlBIT05FX1ZFUklGSUNBVElPTiwgdGhpcy5jbGVhckFsbFBob25lSW50ZXJ2YWwsIHRoaXMpO1xyXG59O1xyXG5cclxuLy8g5p+l5om+5piv5ZCm6ZyA6KaB5pu05pawXHJcbmFzc2V0c01hbmFnZXIuaXNOZWVkVXBkYXRlID0gZnVuY3Rpb24oZ2FtZU5hbWUpIHtcclxuICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSByZXR1cm47Ly/nnJ/mnLrmiY3lgZrmoKHpqoxcclxuICAgIGxldCB1cGRhdGVfZGF0YSA9IGdsR2FtZS5zdG9yYWdlLmdldEl0ZW0oJ3VwZGF0ZV9kYXRhJyk7XHJcbiAgICBpZiAodXBkYXRlX2RhdGEgJiYgdXBkYXRlX2RhdGFbZ2FtZU5hbWVdKSB7Ly/mnKzlnLDnvJPlrZjmnInmuLjmiI/lnKjlgZrmoKHpqoxcclxuICAgICAgICBsZXQgaG90VXBkYXRlVVJMID0gZ2xHYW1lLnNlcnZlcmNmZy5nZXRIb3R1cGRhdGVWZXJzaW9uVXJsKCk7XHJcbiAgICAgICAgbGV0IHVybCA9IGAke2hvdFVwZGF0ZVVSTH0ke2dhbWVOYW1lfS8ke2dhbWVOYW1lfXZlcnNpb24ubWFuaWZlc3RgXHJcbiAgICAgICAgZ2xHYW1lLmdhbWVsaXN0Y2ZnLmdldEdhbWVWZXJzaW9uKHVybCkudGhlbihkYXRhID0+IHtcclxuICAgICAgICAgICAgaWYgKGRhdGEudmVyc2lvbiA9PT0gdXBkYXRlX2RhdGFbZ2FtZU5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDkuI3pnIDopoHmm7TmlrBcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5nYW1lbGlzdGNmZy5zZXRHYW1lVXBkYXRlKGdhbWVOYW1lKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOmcgOimgeabtOaWsFxyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLmdhbWVsaXN0Y2ZnLnNldEdhbWVVcGRhdGUoZ2FtZU5hbWUsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59LFxyXG5cclxuLy8g54Ot5pu05byA5ZCvXHJcbmFzc2V0c01hbmFnZXIuZ2FtZVVwZGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSByZXR1cm47XHJcbiAgICBsZXQgZ2FtZU5hbWUgPSBnbEdhbWUuc2NlbmUuZ2V0U2NlbmVOYW1lQnlJRChkYXRhLmdhbWVJRCk7XHJcblxyXG4gICAgaWYgKCFnYW1lTmFtZSB8fCB0aGlzLnVwZGF0ZV9saXN0W2dhbWVOYW1lXSkgcmV0dXJuO1xyXG4gICAgbGV0IHVwZGF0ZV9saXN0X2RhdGEgPSB7fTtcclxuICAgIHVwZGF0ZV9saXN0X2RhdGEuZ2FtZUlEID0gZGF0YS5nYW1lSUQ7XHJcbiAgICB1cGRhdGVfbGlzdF9kYXRhLm1hbmlmZXN0VXJsID0gZGF0YS5tYW5pZmVzdFVybDtcclxuICAgIHVwZGF0ZV9saXN0X2RhdGEuZ2FtZU5hbWUgPSBnYW1lTmFtZTtcclxuICAgIHVwZGF0ZV9saXN0X2RhdGEuaXNVcGRhdGluZyA9IHRydWU7XHJcbiAgICB1cGRhdGVfbGlzdF9kYXRhLmlzVXBkYXRlID0gdHJ1ZTtcclxuICAgIHRoaXMudXBkYXRlX2xpc3RbZ2FtZU5hbWVdID0gdXBkYXRlX2xpc3RfZGF0YTtcclxuXHJcbiAgICBsZXQgdXBkYXRlX2xpc3RfbGVuZ3RoID0gT2JqZWN0LmtleXModGhpcy51cGRhdGVfbGlzdCkubGVuZ3RoO1xyXG4gICAgaWYgKHVwZGF0ZV9saXN0X2xlbmd0aCAmJiB1cGRhdGVfbGlzdF9sZW5ndGggPiB0aGlzLnVwZGF0ZUdhbWVNYXgpIHtcclxuICAgICAgICAvLyDkuIvovb3liJfooajlpKfkuo7mnIDlpKflkIzml7bkuIvovb3ph4/nmoTml7blgJnmmL7npLrnrYnlvoXkuK1cclxuICAgICAgICB0aGlzLnVwZGF0ZV9saXN0W2dhbWVOYW1lXS5pc1VwZGF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLmVtaXQoXCJob3RVSVJlZnJlc2hcIiwge2dhbWVOYW1lOiBnYW1lTmFtZSwgaXNBY3RpdmU6dHJ1ZX0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmRvd25sb2FkR2FtZSh1cGRhdGVfbGlzdF9kYXRhKTtcclxufTtcclxuXHJcbi8vIOW8gOWni+S4i+i9vea4uOaIj1xyXG5hc3NldHNNYW5hZ2VyLmRvd25sb2FkR2FtZSA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgIC8vIOWIh+aNouWIsOWPr+S7pei3n+aWsOeahOmhtemdolxyXG4gICAgZ2xHYW1lLmVtaXR0ZXIuZW1pdChcImhvdFVJUmVmcmVzaFwiLCB7Z2FtZU5hbWU6ZGF0YS5nYW1lTmFtZSwgaXNTdGF0dXM6MCwgaXNBY3RpdmU6dHJ1ZX0pO1xyXG5cclxuICAgIGxldCBtX2Fzc2V0cyA9IG5ldyBnbEdhbWUuYXNzZXRzKGdsR2FtZS5zY2VuZS5nZXRTY2VuZU5hbWVCeUlEKGRhdGEuZ2FtZUlEKSwgZGF0YS5tYW5pZmVzdFVybCwgKHByb2Nlc3MpID0+IHtcclxuICAgICAgICAvLyDmm7TmlrDkuIvovb3ov5vluqbmnaFcclxuICAgICAgICBwcm9jZXNzID0gcHJvY2VzcyA/IHByb2Nlc3MgOiAwO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi6ZyA6KaB5Y+R6YCB5LqL5Lu277yM5pu05paw5LiL6L296L+b5bqmXCIsIHByb2Nlc3MpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLmVtaXQoXCJob3RVSVJlZnJlc2hcIiwge2dhbWVOYW1lOmRhdGEuZ2FtZU5hbWUsIGlzU3RhdHVzOjEsIGlzQWN0aXZlOnRydWUsIHByb2Nlc3M6cHJvY2Vzc30pO1xyXG4gICAgfSwgKCkgPT4ge1xyXG4gICAgICAgIC8vIOaIkOWKn+Wbnuiwg1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiYXNzZXRzTWFuYWdlcj09PT09PT09PT09PT095LiL6L295a6M5oiQID09PT5cIiwgZGF0YS5nYW1lTmFtZSk7XHJcbiAgICAgICAgbGV0IG1fZ2FtZU5hbWUgPSBkYXRhLmdhbWVOYW1lO1xyXG4gICAgICAgIGxldCBzdHIgPSBnbEdhbWUudGlwcy5VUERBVEUuQ09NUExFVEVELmZvcm1hdChgJHtnbEdhbWUucm9vbS5nZXRHYW1lRGljdEJ5SWQoZGF0YS5nYW1lSUQpfWApO1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93VGlwKHN0ciwyKTtcclxuICAgICAgICBcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5lbWl0KFwiaG90VUlSZWZyZXNoXCIsIHtnYW1lTmFtZTptX2dhbWVOYW1lLCBpc0FjdGl2ZTpmYWxzZSwgcHJvY2VzczoxMDB9KTtcclxuXHJcbiAgICAgICAgLy8g6K6+572u5bey5pu05paw55qE5ri45oiPXHJcbiAgICAgICAgZ2xHYW1lLmdhbWVsaXN0Y2ZnLnNldEdhbWVVcGRhdGUobV9nYW1lTmFtZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2FtZVVwZGF0ZUVuZChkYXRhLmdhbWVOYW1lKTtcclxuXHJcbiAgICAgICAgbGV0IGhvdFVwZGF0ZVVSTCA9IGdsR2FtZS5zZXJ2ZXJjZmcuZ2V0SG90dXBkYXRlVmVyc2lvblVybCgpO1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHtob3RVcGRhdGVVUkx9JHttX2dhbWVOYW1lfS8ke21fZ2FtZU5hbWV9dmVyc2lvbi5tYW5pZmVzdGBcclxuICAgICAgICBnbEdhbWUuZ2FtZWxpc3RjZmcuZ2V0R2FtZVZlcnNpb24odXJsKS50aGVuKHZlcmRhdGEgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IGdsR2FtZS5zdG9yYWdlLmdldEl0ZW0oJ3VwZGF0ZV9kYXRhJyk7XHJcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhW21fZ2FtZU5hbWVdID0gdmVyZGF0YS52ZXJzaW9uO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZGF0YVttX2dhbWVOYW1lXSA9IHZlcmRhdGEudmVyc2lvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBnbEdhbWUuc3RvcmFnZS5zZXRJdGVtKCd1cGRhdGVfZGF0YScsIGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgLy8g5aSx6LSl5Zue6LCDXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJhc3NldHNNYW5hZ2VyPT09PT09PT09PT09PT3kuIvovb3lpLHotKUgPT09PlwiLCBkYXRhLmdhbWVOYW1lKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5lbWl0KFwiaG90VUlSZWZyZXNoXCIsIHtnYW1lTmFtZTpkYXRhLmdhbWVOYW1lLCBpc0FjdGl2ZTpmYWxzZX0pO1xyXG4gICAgICAgIHRoaXMuZ2FtZVVwZGF0ZUVuZChkYXRhLmdhbWVOYW1lKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYXNzZXRzX21hbmFnZXJbZGF0YS5nYW1lTmFtZV0gPSBtX2Fzc2V0cztcclxufTtcclxuXHJcbi8vIOeDreabtOe7k+adn1xyXG5hc3NldHNNYW5hZ2VyLmdhbWVVcGRhdGVFbmQgPSBmdW5jdGlvbihnYW1lTmFtZSkge1xyXG4gICAgdGhpcy5hc3NldHNfbWFuYWdlcltnYW1lTmFtZV0uZGVzdHJveSgpO1xyXG4gICAgbGV0IHVwZGF0ZV9saXN0X2tleXMgPSBPYmplY3Qua2V5cyh0aGlzLnVwZGF0ZV9saXN0KTtcclxuICAgIGxldCB1cGRhdGVfbGlzdF9sZW5ndGggPSB1cGRhdGVfbGlzdF9rZXlzLmxlbmd0aDsgXHJcbiAgICBjb25zb2xlLmxvZyhcIueDreabtOe7k+adnywgZ2FtZVVwZGF0ZUVuZCA9PT0+IHVwZGF0ZV9saXN0X2xlbmd0aDpcIiwgdXBkYXRlX2xpc3RfbGVuZ3RoKTtcclxuXHJcbiAgICBpZiAoIXVwZGF0ZV9saXN0X2xlbmd0aCB8fCB1cGRhdGVfbGlzdF9sZW5ndGggPT0gMCkgcmV0dXJuO1xyXG5cclxuICAgIC8vIOeDreabtOaWsOS4i+S4gOS4qlxyXG4gICAgaWYgKHVwZGF0ZV9saXN0X2xlbmd0aCA+IHRoaXMudXBkYXRlR2FtZU1heCkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy51cGRhdGVfbGlzdFt1cGRhdGVfbGlzdF9rZXlzW3RoaXMudXBkYXRlR2FtZU1heF1dXHJcbiAgICAgICAgZGF0YS5pc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kb3dubG9hZEdhbWUoZGF0YSk7XHJcbiAgICB9XHJcbiAgICAvLyDliKDpmaTlt7Lnu4/ot5/mlrDlrozmiJDnmoTmlbDmja5cclxuICAgIGRlbGV0ZSB0aGlzLnVwZGF0ZV9saXN0W2dhbWVOYW1lXTtcclxufTtcclxuXHJcbi8vIOajgOafpeW9k+WJjeaYr+WQpuaciea4uOaIj+ato+WcqOi3n+aWsFxyXG5hc3NldHNNYW5hZ2VyLmlzQmVpbmdVcGRhdGUgPSBmdW5jdGlvbiAoZ2FtZU5hbWUpIHtcclxuICAgIGxldCBpc1VwZGF0ZSA9IG51bGw7XHJcbiAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy51cGRhdGVfbGlzdCkge1xyXG4gICAgICAgIGlmIChrZXkgPT0gZ2FtZU5hbWUpIHtcclxuICAgICAgICAgICAgbGV0IGRhdGEgPSB0aGlzLnVwZGF0ZV9saXN0W2tleV07XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmlzVXBkYXRpbmcgJiYgZGF0YS5pc1VwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaXNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXNVcGRhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBpc1VwZGF0ZTtcclxufVxyXG5cclxuLy8g5qOA5p+l5b2T5YmN5ri45oiP5piv5ZCm5bey57uP5Zyo5pu05paw6Zif5YiXXHJcbmFzc2V0c01hbmFnZXIuaXNVcGRhdGVRdWV1ZSA9IGZ1bmN0aW9uIChnYW1lSWQpIHtcclxuICAgIGxldCBpc1VwZGF0ZSA9IGZhbHNlO1xyXG4gICAgbGV0IGdhbWVOYW1lID0gZ2xHYW1lLnNjZW5lLmdldFNjZW5lTmFtZUJ5SUQoZ2FtZUlkKTtcclxuXHJcbiAgICAvLyDmn6Xmib7mm7TmlrDliJfooajph4zmmK/lkKbmnInmuLjmiI/mraPlnKjmm7TmlrBcclxuICAgIGZvciAobGV0IGtleSBpbiB0aGlzLnVwZGF0ZV9saXN0KSB7XHJcbiAgICAgICAgaWYgKGtleSA9PSBnYW1lTmFtZSkge1xyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IHRoaXMudXBkYXRlX2xpc3Rba2V5XTtcclxuICAgICAgICAgICAgaWYgKGRhdGEuaXNVcGRhdGluZykge1xyXG4gICAgICAgICAgICAgICAgLy8g44CQJXMo5ri45oiP5ZCN56ewKeOAkeato+WcqOabtOaWsOS4re+8jOivt+iAkOW/g+etieW+hS4uLlxyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dUaXAoZ2xHYW1lLnRpcHMuVVBEQVRFLlVQREFUSU5HLmZvcm1hdChgJHtnbEdhbWUucm9vbS5nZXRHYW1lRGljdEJ5SWQoZ2FtZUlkKX1gKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1RpcChnbEdhbWUudGlwcy5VUERBVEUuSU5VUERBVEVRVUVVRS5mb3JtYXQoYCR7Z2xHYW1lLnJvb20uZ2V0R2FtZURpY3RCeUlkKGdhbWVJZCl9YCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXNVcGRhdGU7XHJcbn1cclxuXHJcbi8vIOiOt+WPlueDreabtOWxnuaAp1xyXG5hc3NldHNNYW5hZ2VyLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgIHJldHVybiB0aGlzW2tleV07XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghZ19pbnN0YW5jZSkge1xyXG4gICAgICAgIGdfaW5zdGFuY2UgPSBuZXcgQXNzZXRzTWFuYWdlcigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGdfaW5zdGFuY2U7XHJcbn07Il19