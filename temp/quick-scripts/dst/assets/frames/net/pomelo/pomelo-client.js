
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/frames/net/pomelo/pomelo-client.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f46b8iXN9NIP6/33SIBNQ7O', 'pomelo-client');
// frames/net/pomelo/pomelo-client.js

"use strict";

(function () {
  var JS_WS_CLIENT_TYPE = 'js-websocket';
  var JS_WS_CLIENT_VERSION = '0.0.1';

  var Proctocol = require("protocol");

  var Package = Protocol.Package;
  var Message = Protocol.Message;

  if (typeof window != "undefined" && typeof sys != 'undefined' && sys.localStorage) {
    window.localStorage = sys.localStorage;
  }

  var RES_OK = 200;
  var RES_FAIL = 500;
  var RES_OLD_CLIENT = 501;

  if (typeof Object.create !== 'function') {
    Object.create = function (o) {
      function F() {}

      F.prototype = o;
      return new F();
    };
  }

  var root = window;
  var pomelo = {};
  root.pomelo = pomelo;
  var socket = null;
  var reqId = 0;
  var handlers = {}; //Map from request id to route

  var routeMap = {};
  var heartbeatInterval = 0;
  var heartbeatTimeout = 0;
  var nextHeartbeatTimeout = 0;
  var gapThreshold = 100; // heartbeat gap threashold

  var heartbeatId = null;
  var heartbeatTimeoutId = null;
  var handshakeCallback = null;
  var decode = null;
  var encode = null;
  var useCrypto;
  var handshakeBuffer = {
    'sys': {
      type: JS_WS_CLIENT_TYPE,
      version: JS_WS_CLIENT_VERSION
    },
    'user': {}
  };
  var connectcb = null;
  var debug = false;
  var msgcb = null;

  pomelo.init = function (params) {
    var host = params.host;
    var port = params.port;
    connectcb = params.connectcb;
    debug = params.debug;
    msgcb = params.msgcb;
    var url = "";
    if (host.toLowerCase().indexOf("ws://") >= 0 || host.toLowerCase().indexOf("wss://") >= 0) url = host;else url = 'ws://' + host;

    if (port) {
      url += ':' + port;
    }

    handshakeBuffer.user = params.user;
    handshakeCallback = params.handshakeCallback;
    initWebSocket(url);
  };

  var initWebSocket = function initWebSocket(url) {
    var onopen = function onopen(event) {
      var obj = Package.encode(Package.TYPE_HANDSHAKE, Protocol.strencode(JSON.stringify(handshakeBuffer)));
      send(obj);
    };

    var onmessage = function onmessage(event) {
      processPackage(Package.decode(event.data)); // new package arrived, update the heartbeat timeout

      if (heartbeatTimeout) {
        nextHeartbeatTimeout = Date.now() + heartbeatTimeout;
      }
    };

    var onerror = function onerror(event) {
      if (connectcb) {
        connectcb('io-error', event);
      }

      cc.error('socket error: ', JSON.stringify(arguments, null, 2));
    };

    var onclose = function onclose(event) {
      if (connectcb) {
        connectcb('close', event);
        connectcb('disconnect', event);
      }

      cc.error('socket close: ', JSON.stringify(arguments, null, 2));
    }; // socket = new WebSocket(url);
    //采用論壇中的方法支持 wss  by root 20190921


    var pemUrl = cc.url.raw("resources/cacert.pem");
    console.log("pemUrl:" + pemUrl);

    if (cc.loader.md5Pipe) {
      pemUrl = cc.loader.md5Pipe.transformURL(pemUrl);
    }

    console.log("transformURL(pemUrl):" + pemUrl);
    socket = new WebSocket(url, null, pemUrl);
    socket.binaryType = 'arraybuffer';
    socket.onopen = onopen;
    socket.onmessage = onmessage;
    socket.onerror = onerror;
    socket.onclose = onclose;
  };

  pomelo.clearListener = function () {
    connectcb = function connectcb() {};

    msgcb = function msgcb() {};
  };

  pomelo.disconnect = function () {
    if (socket) {
      if (socket.disconnect) socket.disconnect();
      if (socket.close) socket.close();
      socket = null;
    }

    if (heartbeatId) {
      clearTimeout(heartbeatId);
      heartbeatId = null;
    }

    if (heartbeatTimeoutId) {
      clearTimeout(heartbeatTimeoutId);
      heartbeatTimeoutId = null;
    }
  };

  pomelo.request = function (route, msg) {
    if (!route) {
      return;
    }

    reqId++;
    sendMessage(reqId, route, msg);
    routeMap[reqId] = route;
    console.log("routeMap=", routeMap);
  };

  pomelo.notify = function (route, msg) {
    msg = msg || {};
    sendMessage(0, route, msg);
  };

  pomelo.getState = function () {
    return !socket || socket.readyState != 1 ? false : true;
  };

  var sendMessage = function sendMessage(reqId, route, msg) {
    var type = reqId ? Message.TYPE_REQUEST : Message.TYPE_NOTIFY; //compress message by protobuf

    var protos = !!pomelo.data.protos ? pomelo.data.protos.client : {};

    if (!!protos[route]) {
      msg = protobuf.encode(route, msg);
    } else {
      msg = Protocol.strencode(JSON.stringify(msg));
    }

    var compressRoute = 0;

    if (pomelo.dict && pomelo.dict[route]) {
      route = pomelo.dict[route];
      compressRoute = 1;
    }

    msg = Message.encode(reqId, type, compressRoute, route, msg);
    var packet = Package.encode(Package.TYPE_DATA, msg);
    send(packet);
  };

  var send = function send(packet) {
    if (!socket || !socket.send) return console.error("pomelo socket fractured!!");
    socket.send(packet.buffer);
  };

  var handler = {};

  var heartbeat = function heartbeat(data) {
    if (!heartbeatInterval) {
      // no heartbeat
      return;
    }

    var obj = Package.encode(Package.TYPE_HEARTBEAT);

    if (heartbeatTimeoutId) {
      clearTimeout(heartbeatTimeoutId);
      heartbeatTimeoutId = null;
    }

    if (heartbeatId) {
      // already in a heartbeat interval
      return;
    }

    heartbeatId = setTimeout(function () {
      heartbeatId = null;
      send(obj);
      nextHeartbeatTimeout = Date.now() + heartbeatTimeout;
      heartbeatTimeoutId = setTimeout(heartbeatTimeoutCb, heartbeatTimeout);
    }, heartbeatInterval);
  };

  var heartbeatTimeoutCb = function heartbeatTimeoutCb() {
    var gap = nextHeartbeatTimeout - Date.now();

    if (gap > gapThreshold) {
      heartbeatTimeoutId = setTimeout(heartbeatTimeoutCb, gap);
    } else {
      cc.error('server heartbeat timeout');
      connectcb('heartbeat timeout');
      pomelo.disconnect();
    }
  };

  var handshake = function handshake(data) {
    data = JSON.parse(Protocol.strdecode(data));

    if (data.code === RES_OLD_CLIENT) {
      connectcb('error', 'client version not fullfill');
      return;
    }

    if (data.code !== RES_OK) {
      connectcb('error', 'handshake fail');
      return;
    }

    handshakeInit(data);
    var obj = Package.encode(Package.TYPE_HANDSHAKE_ACK);
    send(obj);
    connectcb("connect");
  };

  var onData = function onData(data) {
    //probuff decode
    var msg = Message.decode(data);

    if (msg.id > 0) {
      msg.route = routeMap[msg.id];
      delete routeMap[msg.id];

      if (!msg.route) {
        return;
      }
    }

    msg.body = deCompose(msg);
    processMessage(pomelo, msg);
  };

  var onKick = function onKick(data) {
    data = JSON.parse(Protocol.strdecode(data));
    connectcb('onKick', data);
  };

  handlers[Package.TYPE_HANDSHAKE] = handshake;
  handlers[Package.TYPE_HEARTBEAT] = heartbeat;
  handlers[Package.TYPE_DATA] = onData;
  handlers[Package.TYPE_KICK] = onKick;

  var processPackage = function processPackage(msgs) {
    if (Array.isArray(msgs)) {
      for (var i = 0; i < msgs.length; i++) {
        var msg = msgs[i];
        handlers[msg.type](msg.body);
      }
    } else {
      handlers[msgs.type](msgs.body);
    }
  };

  var processMessage = function processMessage(pomelo, msg) {
    var code = null;

    if (msg.body) {
      code = msg.body.code;
    }

    msgcb(msg.route, code, msg.body);
    return;
  };

  var processMessageBatch = function processMessageBatch(pomelo, msgs) {
    for (var i = 0, l = msgs.length; i < l; i++) {
      processMessage(pomelo, msgs[i]);
    }
  };

  var deCompose = function deCompose(msg) {
    var protos = !!pomelo.data.protos ? pomelo.data.protos.server : {};
    var abbrs = pomelo.data.abbrs;
    var route = msg.route; //Decompose route from dict

    if (msg.compressRoute) {
      if (!abbrs[route]) {
        return {};
      }

      route = msg.route = abbrs[route];
    }

    if (!!protos[route]) {
      return protobuf.decode(route, msg.body);
    } else {
      return JSON.parse(Protocol.strdecode(msg.body));
    }

    return msg;
  };

  var handshakeInit = function handshakeInit(data) {
    if (data.sys && data.sys.heartbeat) {
      heartbeatInterval = data.sys.heartbeat * 1000; // heartbeat interval

      heartbeatTimeout = heartbeatInterval * 2; // max heartbeat timeout
    } else {
      heartbeatInterval = 0;
      heartbeatTimeout = 0;
    }

    initData(data);

    if (typeof handshakeCallback === 'function') {
      handshakeCallback(data.user);
    }
  }; //Initilize data used in pomelo client


  var initData = function initData(data) {
    if (!data || !data.sys) {
      return;
    }

    pomelo.data = pomelo.data || {};
    var dict = data.sys.dict;
    var protos = data.sys.protos; //Init compress dict

    if (dict) {
      pomelo.data.dict = dict;
      pomelo.data.abbrs = {};

      for (var route in dict) {
        pomelo.data.abbrs[dict[route]] = route;
      }
    } //Init protobuf protos


    if (protos) {
      pomelo.data.protos = {
        server: protos.server || {},
        client: protos.client || {}
      };

      if (!!protobuf) {
        protobuf.init({
          encoderProtos: protos.client,
          decoderProtos: protos.server
        });
      }
    }
  };

  module.exports = pomelo;
})();

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZnJhbWVzXFxuZXRcXHBvbWVsb1xccG9tZWxvLWNsaWVudC5qcyJdLCJuYW1lcyI6WyJKU19XU19DTElFTlRfVFlQRSIsIkpTX1dTX0NMSUVOVF9WRVJTSU9OIiwiUHJvY3RvY29sIiwicmVxdWlyZSIsIlBhY2thZ2UiLCJQcm90b2NvbCIsIk1lc3NhZ2UiLCJ3aW5kb3ciLCJzeXMiLCJsb2NhbFN0b3JhZ2UiLCJSRVNfT0siLCJSRVNfRkFJTCIsIlJFU19PTERfQ0xJRU5UIiwiT2JqZWN0IiwiY3JlYXRlIiwibyIsIkYiLCJwcm90b3R5cGUiLCJyb290IiwicG9tZWxvIiwic29ja2V0IiwicmVxSWQiLCJoYW5kbGVycyIsInJvdXRlTWFwIiwiaGVhcnRiZWF0SW50ZXJ2YWwiLCJoZWFydGJlYXRUaW1lb3V0IiwibmV4dEhlYXJ0YmVhdFRpbWVvdXQiLCJnYXBUaHJlc2hvbGQiLCJoZWFydGJlYXRJZCIsImhlYXJ0YmVhdFRpbWVvdXRJZCIsImhhbmRzaGFrZUNhbGxiYWNrIiwiZGVjb2RlIiwiZW5jb2RlIiwidXNlQ3J5cHRvIiwiaGFuZHNoYWtlQnVmZmVyIiwidHlwZSIsInZlcnNpb24iLCJjb25uZWN0Y2IiLCJkZWJ1ZyIsIm1zZ2NiIiwiaW5pdCIsInBhcmFtcyIsImhvc3QiLCJwb3J0IiwidXJsIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwidXNlciIsImluaXRXZWJTb2NrZXQiLCJvbm9wZW4iLCJldmVudCIsIm9iaiIsIlRZUEVfSEFORFNIQUtFIiwic3RyZW5jb2RlIiwiSlNPTiIsInN0cmluZ2lmeSIsInNlbmQiLCJvbm1lc3NhZ2UiLCJwcm9jZXNzUGFja2FnZSIsImRhdGEiLCJEYXRlIiwibm93Iiwib25lcnJvciIsImNjIiwiZXJyb3IiLCJhcmd1bWVudHMiLCJvbmNsb3NlIiwicGVtVXJsIiwicmF3IiwiY29uc29sZSIsImxvZyIsImxvYWRlciIsIm1kNVBpcGUiLCJ0cmFuc2Zvcm1VUkwiLCJXZWJTb2NrZXQiLCJiaW5hcnlUeXBlIiwiY2xlYXJMaXN0ZW5lciIsImRpc2Nvbm5lY3QiLCJjbG9zZSIsImNsZWFyVGltZW91dCIsInJlcXVlc3QiLCJyb3V0ZSIsIm1zZyIsInNlbmRNZXNzYWdlIiwibm90aWZ5IiwiZ2V0U3RhdGUiLCJyZWFkeVN0YXRlIiwiVFlQRV9SRVFVRVNUIiwiVFlQRV9OT1RJRlkiLCJwcm90b3MiLCJjbGllbnQiLCJwcm90b2J1ZiIsImNvbXByZXNzUm91dGUiLCJkaWN0IiwicGFja2V0IiwiVFlQRV9EQVRBIiwiYnVmZmVyIiwiaGFuZGxlciIsImhlYXJ0YmVhdCIsIlRZUEVfSEVBUlRCRUFUIiwic2V0VGltZW91dCIsImhlYXJ0YmVhdFRpbWVvdXRDYiIsImdhcCIsImhhbmRzaGFrZSIsInBhcnNlIiwic3RyZGVjb2RlIiwiY29kZSIsImhhbmRzaGFrZUluaXQiLCJUWVBFX0hBTkRTSEFLRV9BQ0siLCJvbkRhdGEiLCJpZCIsImJvZHkiLCJkZUNvbXBvc2UiLCJwcm9jZXNzTWVzc2FnZSIsIm9uS2ljayIsIlRZUEVfS0lDSyIsIm1zZ3MiLCJBcnJheSIsImlzQXJyYXkiLCJpIiwibGVuZ3RoIiwicHJvY2Vzc01lc3NhZ2VCYXRjaCIsImwiLCJzZXJ2ZXIiLCJhYmJycyIsImluaXREYXRhIiwiZW5jb2RlclByb3RvcyIsImRlY29kZXJQcm90b3MiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLENBQUMsWUFBWTtBQUNULE1BQUlBLGlCQUFpQixHQUFHLGNBQXhCO0FBQ0EsTUFBSUMsb0JBQW9CLEdBQUcsT0FBM0I7O0FBRUEsTUFBSUMsU0FBUyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF2Qjs7QUFDQSxNQUFJQyxPQUFPLEdBQUdDLFFBQVEsQ0FBQ0QsT0FBdkI7QUFDQSxNQUFJRSxPQUFPLEdBQUdELFFBQVEsQ0FBQ0MsT0FBdkI7O0FBRUEsTUFBSSxPQUFRQyxNQUFSLElBQW1CLFdBQW5CLElBQWtDLE9BQVFDLEdBQVIsSUFBZ0IsV0FBbEQs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QUFDSixLQWhCMEIsQ0FrQjNCOzs7QUFDQSxRQUFJUSxNQUFKLEVBQVk7QUFDUnRFLE1BQUFBLE1BQU0sQ0FBQ3dDLElBQVAsQ0FBWThCLE1BQVosR0FBcUI7QUFDakJrQyxRQUFBQSxNQUFNLEVBQUVsQyxNQUFNLENBQUNrQyxNQUFQLElBQWlCLEVBRFI7QUFFakJqQyxRQUFBQSxNQUFNLEVBQUVELE1BQU0sQ0FBQ0MsTUFBUCxJQUFpQjtBQUZSLE9BQXJCOztBQUlBLFVBQUksQ0FBQyxDQUFDQyxRQUFOLEVBQWdCO0FBQ1pBLFFBQUFBLFFBQVEsQ0FBQ25ELElBQVQsQ0FBYztBQUFFc0YsVUFBQUEsYUFBYSxFQUFFckMsTUFBTSxDQUFDQyxNQUF4QjtBQUFnQ3FDLFVBQUFBLGFBQWEsRUFBRXRDLE1BQU0sQ0FBQ2tDO0FBQXRELFNBQWQ7QUFDSDtBQUNKO0FBQ0osR0E1QkQ7O0FBOEJBSyxFQUFBQSxNQUFNLENBQUNDLE9BQVAsR0FBaUI5RyxNQUFqQjtBQUNILENBeFhEIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIEpTX1dTX0NMSUVOVF9UWVBFID0gJ2pzLXdlYnNvY2tldCc7XHJcbiAgICB2YXIgSlNfV1NfQ0xJRU5UX1ZFUlNJT04gPSAnMC4wLjEnO1xyXG5cclxuICAgIHZhciBQcm9jdG9jb2wgPSByZXF1aXJlKFwicHJvdG9jb2xcIik7XHJcbiAgICB2YXIgUGFja2FnZSA9IFByb3RvY29sLlBhY2thZ2U7XHJcbiAgICB2YXIgTWVzc2FnZSA9IFByb3RvY29sLk1lc3NhZ2U7XHJcblxyXG4gICAgaWYgKHR5cGVvZiAod2luZG93KSAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiAoc3lzKSAhPSAndW5kZWZpbmVkJyAmJiBzeXMubG9jYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZSA9IHN5cy5sb2NhbFN0b3JhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIFJFU19PSyA9IDIwMDtcclxuICAgIHZhciBSRVNfRkFJTCA9IDUwMDtcclxuICAgIHZhciBSRVNfT0xEX0NMSUVOVCA9IDUwMTtcclxuXHJcbiAgICBpZiAodHlwZW9mIE9iamVjdC5jcmVhdGUgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBPYmplY3QuY3JlYXRlID0gZnVuY3Rpb24gKG8pIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gRigpIHsgfVxyXG4gICAgICAgICAgICBGLnByb3RvdHlwZSA9IG87XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRigpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHJvb3QgPSB3aW5kb3c7XHJcbiAgICB2YXIgcG9tZWxvID0ge307XHJcbiAgICByb290LnBvbWVsbyA9IHBvbWVsbztcclxuICAgIHZhciBzb2NrZXQgPSBudWxsO1xyXG4gICAgdmFyIHJlcUlkID0gMDtcclxuICAgIHZhciBoYW5kbGVycyA9IHt9O1xyXG4gICAgLy9NYXAgZnJvbSByZXF1ZXN0IGlkIHRvIHJvdXRlXHJcbiAgICB2YXIgcm91dGVNYXAgPSB7fTtcclxuXHJcbiAgICB2YXIgaGVhcnRiZWF0SW50ZXJ2YWwgPSAwO1xyXG4gICAgdmFyIGhlYXJ0YmVhdFRpbWVvdXQgPSAwO1xyXG4gICAgdmFyIG5leHRIZWFydGJlYXRUaW1lb3V0ID0gMDtcclxuICAgIHZhciBnYXBUaHJlc2hvbGQgPSAxMDA7ICAgLy8gaGVhcnRiZWF0IGdhcCB0aHJlYXNob2xkXHJcbiAgICB2YXIgaGVhcnRiZWF0SWQgPSBudWxsO1xyXG4gICAgdmFyIGhlYXJ0YmVhdFRpbWVvdXRJZCA9IG51bGw7XHJcblxyXG4gICAgdmFyIGhhbmRzaGFrZUNhbGxiYWNrID0gbnVsbDtcclxuXHJcbiAgICB2YXIgZGVjb2RlID0gbnVsbDtcclxuICAgIHZhciBlbmNvZGUgPSBudWxsO1xyXG5cclxuICAgIHZhciB1c2VDcnlwdG87XHJcblxyXG4gICAgdmFyIGhhbmRzaGFrZUJ1ZmZlciA9IHtcclxuICAgICAgICAnc3lzJzoge1xyXG4gICAgICAgICAgICB0eXBlOiBKU19XU19DTElFTlRfVFlQRSxcclxuICAgICAgICAgICAgdmVyc2lvbjogSlNfV1NfQ0xJRU5UX1ZFUlNJT05cclxuICAgICAgICB9LFxyXG4gICAgICAgICd1c2VyJzoge1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG5cclxuICAgIHZhciBjb25uZWN0Y2IgPSBudWxsO1xyXG4gICAgdmFyIGRlYnVnID0gZmFsc2U7XHJcbiAgICB2YXIgbXNnY2IgPSBudWxsO1xyXG5cclxuXHJcbiAgICBwb21lbG8uaW5pdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuXHJcbiAgICAgICAgdmFyIGhvc3QgPSBwYXJhbXMuaG9zdDtcclxuICAgICAgICB2YXIgcG9ydCA9IHBhcmFtcy5wb3J0O1xyXG4gICAgICAgIGNvbm5lY3RjYiA9IHBhcmFtcy5jb25uZWN0Y2I7XHJcbiAgICAgICAgZGVidWcgPSBwYXJhbXMuZGVidWc7XHJcbiAgICAgICAgbXNnY2IgPSBwYXJhbXMubXNnY2I7XHJcbiAgICAgICAgdmFyIHVybCA9IFwiXCI7XHJcbiAgICAgICAgaWYgKGhvc3QudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwid3M6Ly9cIikgPj0gMCB8fCBob3N0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcIndzczovL1wiKSA+PSAwKSB1cmwgPSBob3N0O1xyXG4gICAgICAgIGVsc2UgdXJsID0gJ3dzOi8vJyArIGhvc3Q7XHJcblxyXG4gICAgICAgIGlmIChwb3J0KSB7XHJcbiAgICAgICAgICAgIHVybCArPSAnOicgKyBwb3J0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaGFuZHNoYWtlQnVmZmVyLnVzZXIgPSBwYXJhbXMudXNlcjtcclxuICAgICAgICBoYW5kc2hha2VDYWxsYmFjayA9IHBhcmFtcy5oYW5kc2hha2VDYWxsYmFjaztcclxuICAgICAgICBpbml0V2ViU29ja2V0KHVybCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBpbml0V2ViU29ja2V0ID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHZhciBvbm9wZW4gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIG9iaiA9IFBhY2thZ2UuZW5jb2RlKFBhY2thZ2UuVFlQRV9IQU5EU0hBS0UsIFByb3RvY29sLnN0cmVuY29kZShKU09OLnN0cmluZ2lmeShoYW5kc2hha2VCdWZmZXIpKSk7XHJcbiAgICAgICAgICAgIHNlbmQob2JqKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBvbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgcHJvY2Vzc1BhY2thZ2UoUGFja2FnZS5kZWNvZGUoZXZlbnQuZGF0YSkpO1xyXG4gICAgICAgICAgICAvLyBuZXcgcGFja2FnZSBhcnJpdmVkLCB1cGRhdGUgdGhlIGhlYXJ0YmVhdCB0aW1lb3V0XHJcbiAgICAgICAgICAgIGlmIChoZWFydGJlYXRUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0SGVhcnRiZWF0VGltZW91dCA9IERhdGUubm93KCkgKyBoZWFydGJlYXRUaW1lb3V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgb25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoY29ubmVjdGNiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25uZWN0Y2IoJ2lvLWVycm9yJywgZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNjLmVycm9yKCdzb2NrZXQgZXJyb3I6ICcsIEpTT04uc3RyaW5naWZ5KGFyZ3VtZW50cywgbnVsbCwgMikpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIG9uY2xvc2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGNvbm5lY3RjYikge1xyXG4gICAgICAgICAgICAgICAgY29ubmVjdGNiKCdjbG9zZScsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGNvbm5lY3RjYignZGlzY29ubmVjdCcsIGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYy5lcnJvcignc29ja2V0IGNsb3NlOiAnLCBKU09OLnN0cmluZ2lmeShhcmd1bWVudHMsIG51bGwsIDIpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuICAgICAgICAvL+mHh+eUqOirluWjh+S4reeahOaWueazleaUr+aMgSB3c3MgIGJ5IHJvb3QgMjAxOTA5MjFcclxuICAgICAgICBsZXQgcGVtVXJsID0gY2MudXJsLnJhdyhcInJlc291cmNlcy9jYWNlcnQucGVtXCIpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwicGVtVXJsOlwiICsgcGVtVXJsKTtcclxuICAgICAgICBpZiAoY2MubG9hZGVyLm1kNVBpcGUpIHtcclxuICAgICAgICAgICAgcGVtVXJsID0gY2MubG9hZGVyLm1kNVBpcGUudHJhbnNmb3JtVVJMKHBlbVVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwidHJhbnNmb3JtVVJMKHBlbVVybCk6XCIgKyBwZW1VcmwpO1xyXG4gICAgICAgIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsLCBudWxsLCBwZW1VcmwpO1xyXG5cclxuICAgICAgICBzb2NrZXQuYmluYXJ5VHlwZSA9ICdhcnJheWJ1ZmZlcic7XHJcbiAgICAgICAgc29ja2V0Lm9ub3BlbiA9IG9ub3BlbjtcclxuICAgICAgICBzb2NrZXQub25tZXNzYWdlID0gb25tZXNzYWdlO1xyXG4gICAgICAgIHNvY2tldC5vbmVycm9yID0gb25lcnJvcjtcclxuICAgICAgICBzb2NrZXQub25jbG9zZSA9IG9uY2xvc2U7XHJcbiAgICB9O1xyXG4gICAgcG9tZWxvLmNsZWFyTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29ubmVjdGNiID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgICAgIG1zZ2NiID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgfVxyXG4gICAgcG9tZWxvLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHNvY2tldCkge1xyXG4gICAgICAgICAgICBpZiAoc29ja2V0LmRpc2Nvbm5lY3QpIHNvY2tldC5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIGlmIChzb2NrZXQuY2xvc2UpIHNvY2tldC5jbG9zZSgpO1xyXG4gICAgICAgICAgICBzb2NrZXQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhlYXJ0YmVhdElkKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChoZWFydGJlYXRJZCk7XHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdElkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhlYXJ0YmVhdFRpbWVvdXRJZCkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoaGVhcnRiZWF0VGltZW91dElkKTtcclxuICAgICAgICAgICAgaGVhcnRiZWF0VGltZW91dElkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHBvbWVsby5yZXF1ZXN0ID0gZnVuY3Rpb24gKHJvdXRlLCBtc2cpIHtcclxuXHJcbiAgICAgICAgaWYgKCFyb3V0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXFJZCsrO1xyXG4gICAgICAgIHNlbmRNZXNzYWdlKHJlcUlkLCByb3V0ZSwgbXNnKTtcclxuICAgICAgICByb3V0ZU1hcFtyZXFJZF0gPSByb3V0ZTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInJvdXRlTWFwPVwiLCByb3V0ZU1hcClcclxuICAgIH07XHJcblxyXG4gICAgcG9tZWxvLm5vdGlmeSA9IGZ1bmN0aW9uIChyb3V0ZSwgbXNnKSB7XHJcbiAgICAgICAgbXNnID0gbXNnIHx8IHt9O1xyXG4gICAgICAgIHNlbmRNZXNzYWdlKDAsIHJvdXRlLCBtc2cpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwb21lbG8uZ2V0U3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICghc29ja2V0IHx8IHNvY2tldC5yZWFkeVN0YXRlICE9IDEpID8gZmFsc2UgOiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBzZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChyZXFJZCwgcm91dGUsIG1zZykge1xyXG4gICAgICAgIHZhciB0eXBlID0gcmVxSWQgPyBNZXNzYWdlLlRZUEVfUkVRVUVTVCA6IE1lc3NhZ2UuVFlQRV9OT1RJRlk7XHJcblxyXG4gICAgICAgIC8vY29tcHJlc3MgbWVzc2FnZSBieSBwcm90b2J1ZlxyXG4gICAgICAgIHZhciBwcm90b3MgPSAhIXBvbWVsby5kYXRhLnByb3RvcyA/IHBvbWVsby5kYXRhLnByb3Rvcy5jbGllbnQgOiB7fTtcclxuICAgICAgICBpZiAoISFwcm90b3Nbcm91dGVdKSB7XHJcbiAgICAgICAgICAgIG1zZyA9IHByb3RvYnVmLmVuY29kZShyb3V0ZSwgbXNnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBtc2cgPSBQcm90b2NvbC5zdHJlbmNvZGUoSlNPTi5zdHJpbmdpZnkobXNnKSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdmFyIGNvbXByZXNzUm91dGUgPSAwO1xyXG4gICAgICAgIGlmIChwb21lbG8uZGljdCAmJiBwb21lbG8uZGljdFtyb3V0ZV0pIHtcclxuICAgICAgICAgICAgcm91dGUgPSBwb21lbG8uZGljdFtyb3V0ZV07XHJcbiAgICAgICAgICAgIGNvbXByZXNzUm91dGUgPSAxO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbXNnID0gTWVzc2FnZS5lbmNvZGUocmVxSWQsIHR5cGUsIGNvbXByZXNzUm91dGUsIHJvdXRlLCBtc2cpO1xyXG4gICAgICAgIHZhciBwYWNrZXQgPSBQYWNrYWdlLmVuY29kZShQYWNrYWdlLlRZUEVfREFUQSwgbXNnKTtcclxuICAgICAgICBzZW5kKHBhY2tldCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzZW5kID0gZnVuY3Rpb24gKHBhY2tldCkge1xyXG4gICAgICAgIGlmICghc29ja2V0IHx8ICFzb2NrZXQuc2VuZCkgcmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJwb21lbG8gc29ja2V0IGZyYWN0dXJlZCEhXCIpO1xyXG4gICAgICAgIHNvY2tldC5zZW5kKHBhY2tldC5idWZmZXIpO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgdmFyIGhhbmRsZXIgPSB7fTtcclxuXHJcbiAgICB2YXIgaGVhcnRiZWF0ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBpZiAoIWhlYXJ0YmVhdEludGVydmFsKSB7XHJcbiAgICAgICAgICAgIC8vIG5vIGhlYXJ0YmVhdFxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgb2JqID0gUGFja2FnZS5lbmNvZGUoUGFja2FnZS5UWVBFX0hFQVJUQkVBVCk7XHJcbiAgICAgICAgaWYgKGhlYXJ0YmVhdFRpbWVvdXRJZCkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoaGVhcnRiZWF0VGltZW91dElkKTtcclxuICAgICAgICAgICAgaGVhcnRiZWF0VGltZW91dElkID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoZWFydGJlYXRJZCkge1xyXG4gICAgICAgICAgICAvLyBhbHJlYWR5IGluIGEgaGVhcnRiZWF0IGludGVydmFsXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGhlYXJ0YmVhdElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdElkID0gbnVsbDtcclxuICAgICAgICAgICAgc2VuZChvYmopO1xyXG5cclxuICAgICAgICAgICAgbmV4dEhlYXJ0YmVhdFRpbWVvdXQgPSBEYXRlLm5vdygpICsgaGVhcnRiZWF0VGltZW91dDtcclxuICAgICAgICAgICAgaGVhcnRiZWF0VGltZW91dElkID0gc2V0VGltZW91dChoZWFydGJlYXRUaW1lb3V0Q2IsIGhlYXJ0YmVhdFRpbWVvdXQpO1xyXG4gICAgICAgIH0sIGhlYXJ0YmVhdEludGVydmFsKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGhlYXJ0YmVhdFRpbWVvdXRDYiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZ2FwID0gbmV4dEhlYXJ0YmVhdFRpbWVvdXQgLSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGlmIChnYXAgPiBnYXBUaHJlc2hvbGQpIHtcclxuICAgICAgICAgICAgaGVhcnRiZWF0VGltZW91dElkID0gc2V0VGltZW91dChoZWFydGJlYXRUaW1lb3V0Q2IsIGdhcCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2MuZXJyb3IoJ3NlcnZlciBoZWFydGJlYXQgdGltZW91dCcpO1xyXG4gICAgICAgICAgICBjb25uZWN0Y2IoJ2hlYXJ0YmVhdCB0aW1lb3V0Jyk7XHJcbiAgICAgICAgICAgIHBvbWVsby5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaGFuZHNoYWtlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShQcm90b2NvbC5zdHJkZWNvZGUoZGF0YSkpO1xyXG4gICAgICAgIGlmIChkYXRhLmNvZGUgPT09IFJFU19PTERfQ0xJRU5UKSB7XHJcbiAgICAgICAgICAgIGNvbm5lY3RjYignZXJyb3InLCAnY2xpZW50IHZlcnNpb24gbm90IGZ1bGxmaWxsJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkYXRhLmNvZGUgIT09IFJFU19PSykge1xyXG4gICAgICAgICAgICBjb25uZWN0Y2IoJ2Vycm9yJywgJ2hhbmRzaGFrZSBmYWlsJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGhhbmRzaGFrZUluaXQoZGF0YSk7XHJcblxyXG4gICAgICAgIHZhciBvYmogPSBQYWNrYWdlLmVuY29kZShQYWNrYWdlLlRZUEVfSEFORFNIQUtFX0FDSyk7XHJcbiAgICAgICAgc2VuZChvYmopO1xyXG5cclxuICAgICAgICBjb25uZWN0Y2IoXCJjb25uZWN0XCIpXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBvbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIC8vcHJvYnVmZiBkZWNvZGVcclxuICAgICAgICB2YXIgbXNnID0gTWVzc2FnZS5kZWNvZGUoZGF0YSk7XHJcblxyXG4gICAgICAgIGlmIChtc2cuaWQgPiAwKSB7XHJcbiAgICAgICAgICAgIG1zZy5yb3V0ZSA9IHJvdXRlTWFwW21zZy5pZF07XHJcbiAgICAgICAgICAgIGRlbGV0ZSByb3V0ZU1hcFttc2cuaWRdO1xyXG4gICAgICAgICAgICBpZiAoIW1zZy5yb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBtc2cuYm9keSA9IGRlQ29tcG9zZShtc2cpO1xyXG5cclxuICAgICAgICBwcm9jZXNzTWVzc2FnZShwb21lbG8sIG1zZyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBvbktpY2sgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKFByb3RvY29sLnN0cmRlY29kZShkYXRhKSk7XHJcbiAgICAgICAgY29ubmVjdGNiKCdvbktpY2snLCBkYXRhKTtcclxuICAgIH07XHJcblxyXG4gICAgaGFuZGxlcnNbUGFja2FnZS5UWVBFX0hBTkRTSEFLRV0gPSBoYW5kc2hha2U7XHJcbiAgICBoYW5kbGVyc1tQYWNrYWdlLlRZUEVfSEVBUlRCRUFUXSA9IGhlYXJ0YmVhdDtcclxuICAgIGhhbmRsZXJzW1BhY2thZ2UuVFlQRV9EQVRBXSA9IG9uRGF0YTtcclxuICAgIGhhbmRsZXJzW1BhY2thZ2UuVFlQRV9LSUNLXSA9IG9uS2ljaztcclxuXHJcbiAgICB2YXIgcHJvY2Vzc1BhY2thZ2UgPSBmdW5jdGlvbiAobXNncykge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KG1zZ3MpKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXNncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1zZyA9IG1zZ3NbaV07XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyc1ttc2cudHlwZV0obXNnLmJvZHkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaGFuZGxlcnNbbXNncy50eXBlXShtc2dzLmJvZHkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NNZXNzYWdlID0gZnVuY3Rpb24gKHBvbWVsbywgbXNnKSB7XHJcbiAgICAgICAgbGV0IGNvZGUgPSBudWxsO1xyXG4gICAgICAgIGlmIChtc2cuYm9keSkge1xyXG4gICAgICAgICAgICBjb2RlID0gbXNnLmJvZHkuY29kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbXNnY2IobXNnLnJvdXRlLCBjb2RlLCBtc2cuYm9keSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcHJvY2Vzc01lc3NhZ2VCYXRjaCA9IGZ1bmN0aW9uIChwb21lbG8sIG1zZ3MpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG1zZ3MubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHByb2Nlc3NNZXNzYWdlKHBvbWVsbywgbXNnc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZGVDb21wb3NlID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgIHZhciBwcm90b3MgPSAhIXBvbWVsby5kYXRhLnByb3RvcyA/IHBvbWVsby5kYXRhLnByb3Rvcy5zZXJ2ZXIgOiB7fTtcclxuICAgICAgICB2YXIgYWJicnMgPSBwb21lbG8uZGF0YS5hYmJycztcclxuICAgICAgICB2YXIgcm91dGUgPSBtc2cucm91dGU7XHJcblxyXG4gICAgICAgIC8vRGVjb21wb3NlIHJvdXRlIGZyb20gZGljdFxyXG4gICAgICAgIGlmIChtc2cuY29tcHJlc3NSb3V0ZSkge1xyXG4gICAgICAgICAgICBpZiAoIWFiYnJzW3JvdXRlXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByb3V0ZSA9IG1zZy5yb3V0ZSA9IGFiYnJzW3JvdXRlXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCEhcHJvdG9zW3JvdXRlXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvdG9idWYuZGVjb2RlKHJvdXRlLCBtc2cuYm9keSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoUHJvdG9jb2wuc3RyZGVjb2RlKG1zZy5ib2R5KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbXNnO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaGFuZHNoYWtlSW5pdCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGEuc3lzICYmIGRhdGEuc3lzLmhlYXJ0YmVhdCkge1xyXG4gICAgICAgICAgICBoZWFydGJlYXRJbnRlcnZhbCA9IGRhdGEuc3lzLmhlYXJ0YmVhdCAqIDEwMDA7ICAgLy8gaGVhcnRiZWF0IGludGVydmFsXHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdFRpbWVvdXQgPSBoZWFydGJlYXRJbnRlcnZhbCAqIDI7ICAgICAgICAvLyBtYXggaGVhcnRiZWF0IHRpbWVvdXRcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBoZWFydGJlYXRJbnRlcnZhbCA9IDA7XHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdFRpbWVvdXQgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaW5pdERhdGEoZGF0YSk7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgaGFuZHNoYWtlQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgaGFuZHNoYWtlQ2FsbGJhY2soZGF0YS51c2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vSW5pdGlsaXplIGRhdGEgdXNlZCBpbiBwb21lbG8gY2xpZW50XHJcbiAgICB2YXIgaW5pdERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGlmICghZGF0YSB8fCAhZGF0YS5zeXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwb21lbG8uZGF0YSA9IHBvbWVsby5kYXRhIHx8IHt9O1xyXG4gICAgICAgIHZhciBkaWN0ID0gZGF0YS5zeXMuZGljdDtcclxuICAgICAgICB2YXIgcHJvdG9zID0gZGF0YS5zeXMucHJvdG9zO1xyXG5cclxuICAgICAgICAvL0luaXQgY29tcHJlc3MgZGljdFxyXG4gICAgICAgIGlmIChkaWN0KSB7XHJcbiAgICAgICAgICAgIHBvbWVsby5kYXRhLmRpY3QgPSBkaWN0O1xyXG4gICAgICAgICAgICBwb21lbG8uZGF0YS5hYmJycyA9IHt9O1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgcm91dGUgaW4gZGljdCkge1xyXG4gICAgICAgICAgICAgICAgcG9tZWxvLmRhdGEuYWJicnNbZGljdFtyb3V0ZV1dID0gcm91dGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vSW5pdCBwcm90b2J1ZiBwcm90b3NcclxuICAgICAgICBpZiAocHJvdG9zKSB7XHJcbiAgICAgICAgICAgIHBvbWVsby5kYXRhLnByb3RvcyA9IHtcclxuICAgICAgICAgICAgICAgIHNlcnZlcjogcHJvdG9zLnNlcnZlciB8fCB7fSxcclxuICAgICAgICAgICAgICAgIGNsaWVudDogcHJvdG9zLmNsaWVudCB8fCB7fVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAoISFwcm90b2J1Zikge1xyXG4gICAgICAgICAgICAgICAgcHJvdG9idWYuaW5pdCh7IGVuY29kZXJQcm90b3M6IHByb3Rvcy5jbGllbnQsIGRlY29kZXJQcm90b3M6IHByb3Rvcy5zZXJ2ZXIgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIG1vZHVsZS5leHBvcnRzID0gcG9tZWxvO1xyXG59KSgpO1xyXG4iXX0=