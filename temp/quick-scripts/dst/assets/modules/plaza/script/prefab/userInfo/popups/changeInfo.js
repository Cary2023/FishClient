
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/userInfo/popups/changeInfo.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '53d20WEMNpNL7aCq0N3L7O+', 'changeInfo');
// modules/plaza/script/prefab/userInfo/popups/changeInfo.js

"use strict";

glGame.baseclass.extend({
  properties: {
    //个人资料
    edit_name: cc.EditBox,
    edit_wechat: cc.EditBox,
    edit_qq: cc.EditBox,
    edit_email: cc.EditBox,
    //设置自定义脚本
    edits_name: cc.Node,
    edits_wechat: cc.Node,
    edits_qq: cc.Node,
    edits_email: cc.Node,
    edits_birth: cc.Node
  },
  onLoad: function onLoad() {
    this.registerEvent();
  },
  start: function start() {
    this.inituserinfo();
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_birthPanel":
        this.showbirthPanel();
        break;

      case "btn_userSure":
        this.userSure_cb();
        break;

      case "btn_userCancel":
        this.remove();
        break;

      case "btn_forbidname":
        glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.MODIFYNAME);
        break;

      default:
        break;
    }
  },
  registerEvent: function registerEvent() {
    glGame.emitter.on("editBirthDay", this.editBirthEnd, this);
  },
  unregisterEvent: function unregisterEvent() {
    glGame.emitter.off("editBirthDay", this);
  },
  //显示生日界面
  showbirthPanel: function showbirthPanel() {
    if (glGame.user.get("birthday_month") != "") {
      return glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.MODIFYBIRTH);
    }

    glGame.panel.showBirthday();
  },
  //显示个人资料界面
  inituserinfo: function inituserinfo() {
    this.edits_name.getSelfFunc().setString(glGame.user.get("name") || "");
    this.edits_wechat.getSelfFunc().setString(glGame.user.get("wechat") || "");
    this.edits_qq.getSelfFunc().setString(glGame.user.get("qq") || "");
    this.edits_email.getSelfFunc().setString(glGame.user.get("email") || "");

    if (this.edit_name.string != "") {
      this.edit_name.enabled = false;
      this.edits_name.getChildByName("btn_forbidname").active = true;
    }

    this.brithDay = glGame.user.get("birthday_month") || "";

    if (this.brithDay && this.brithDay != "") {
      var arr = this.brithDay.split("_");
      this.edits_birth.getSelfFunc().setString("".concat(arr[0], "\u6708").concat(arr[1], "\u65E5"));
    }
  },
  editBirthEnd: function editBirthEnd(str) {
    this.brithDay = str; //生日编辑结束

    var arr = this.brithDay.split("_");
    this.edits_birth.getSelfFunc().setString("".concat(arr[0], "\u6708").concat(arr[1], "\u65E5"));
  },
  userSure_cb: function userSure_cb() {
    var _this = this;

    var msg = {}; //name

    if (this.edit_name.string != "" && this.edit_name.string != glGame.user.get("name")) {
      var name = this.checkName(this.edit_name.string);
      if (!name) return;
      msg.name = name;
    } //wechat


    if (this.edit_wechat.string != glGame.user.get("wechat") && this.edit_wechat.string != "") {
      var wechat = this.checkWX(this.edit_wechat.string);
      if (!wechat) return;
      msg.wechat = wechat;
    } //qq


    if (this.edit_qq.string != glGame.user.get("qq") && this.edit_qq.string != "") {
      var qq = this.checkQQ(this.edit_qq.string);
      if (!qq) return;
      msg.qq = qq;
    } //email


    if (this.edit_email.string != glGame.user.get("email") && this.edit_email.string != "") {
      var email = this.checkMail(this.edit_email.string);
      if (!email) return;
      msg.email = email;
    } //birth


    if (this.brithDay != glGame.user.get("birthday_month") && this.brithDay != "") {
      msg.birthday_month = this.brithDay;
    }

    if (Object.keys(msg).length == 0) {
      this.remove();
      return;
    }

    glGame.gameNet.send_msg('http.reqEditMyInfo', msg, function (route, data) {
      glGame.panel.showTip(glGame.tips.USER.EDITINFO.BASEINFO);

      for (var key in msg) {
        glGame.user[key] = msg[key];
      }

      _this.remove();
    });
  },
  //===========================================================================================
  //邮箱检查
  checkMail: function checkMail(mailNum) {
    var reg = /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/; //验证规则

    var ismailNum_matcher = reg.test(mailNum);

    if (!ismailNum_matcher) {
      glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.INVALIDEMAIL);
      return false;
    }

    return mailNum;
  },
  // QQ检查
  checkQQ: function checkQQ(qqNum) {
    var reg = /^[1-9][0-9]{4,14}$/gim; //验证规则

    var isQQNum_matcher = reg.test(qqNum);

    if (!isQQNum_matcher) {
      glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.INVALIDQQ);
      return false;
    }

    return qqNum;
  },
  // 微信检查
  checkWX: function checkWX(wxNum) {
    var reg = /^[-_a-zA-Z0-9]{6,20}$/; //验证规则

    var isWXNum_matcher = reg.test(wxNum);

    if (!isWXNum_matcher) {
      glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.INVALIDWX);
      return false;
    }

    return wxNum;
  },
  // 姓名检查
  checkName: function checkName(nameNum) {
    if (this.checkStrLength(nameNum, 2, 40)) {
      glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.NAMELIMIT);
      return false;
    } // let reg = /^[\u4e00-\u9fa5]{2,8}$/


    var reg = /^[\u4E00-\u9FA5\uf900-\ufa2d·s]{2,20}$/; //验证规则

    var isnameNum_matcher = reg.test(nameNum);
    console.log('姓名格式错误！?', isnameNum_matcher);

    if (!isnameNum_matcher) {
      glGame.panel.showErrorTip(glGame.tips.USER.EDITINFO.INVALIDNAME);
      return false;
    }

    return nameNum;
  },
  //检查中文和英文混合的字符长度
  checkStrLength: function checkStrLength(str, min, max) {
    var mTextMaxlenght = 0;
    var arr = str.split("");

    for (var i = 0; i < arr.length; i++) {
      var charAt = arr[i].charCodeAt(); //32-122包含了空格，大小写字母，数字和一些常用的符号，
      //如果在这个范围内则算一个字符，
      //如果不在这个范围比如是汉字的话就是两个字符

      if (charAt >= 32 && charAt <= 122) {
        mTextMaxlenght++;
      } else {
        mTextMaxlenght += 2;
      }
    }

    return mTextMaxlenght < min || mTextMaxlenght > max;
  },
  OnDestroy: function OnDestroy() {
    this.unregisterEvent();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFx1c2VySW5mb1xccG9wdXBzXFxjaGFuZ2VJbmZvLmpzIl0sIm5hbWVzIjpbImdsR2FtZSIsImJhc2VjbGFzcyIsImV4dGVuZCIsInByb3BlcnRpZXMiLCJlZGl0X25hbWUiLCJjYyIsIkVkaXRCb3giLCJlZGl0X3dlY2hhdCIsImVkaXRfcXEiLCJlZGl0X2VtYWlsIiwiZWRpdHNfbmFtZSIsIk5vZGUiLCJlZGl0c193ZWNoYXQiLCJlZGl0c19xcSIsImVkaXRzX2VtYWlsIiwiZWRpdHNfYmlydGgiLCJvbkxvYWQiLCJyZWdpc3RlckV2ZW50Iiwic3RhcnQiLCJpbml0dXNlcmluZm8iLCJvbkNsaWNrIiwibmFtZSIsIm5vZGUiLCJzaG93YmlydGhQYW5lbCIsInVzZXJTdXJlX2NiIiwicmVtb3ZlIiwicGFuZWwiLCJzaG93RXJyb3JUaXAiLCJ0aXBzIiwiVVNFUiIsIkVESVRJTkZPIiwiTU9ESUZZTkFNRSIsImVtaXR0ZXIiLCJvbiIsImVkaXRCaXJ0aEVuZCIsInVucmVnaXN0ZXJFdmVudCIsIm9mZiIsInVzZXIiLCJnZXQiLCJNT0RJRllCSVJUSCIsInNob3dCaXJ0aGRheSIsImdldFNlbGZGdW5jIiwic2V0U3RyaW5nIiwic3RyaW5nIiwiZW5hYmxlZCIsImdldENoaWxkQnlOYW1lIiwiYWN0aXZlIiwiYnJpdGhEYXkiLCJhcnIiLCJzcGxpdCIsInN0ciIsIm1zZyIsImNoZWNrTmFtZSIsIndlY2hhdCIsImNoZWNrV1giLCJxcSIsImNoZWNrUVEiLCJlbWFpbCIsImNoZWNrTWFpbCIsImJpcnRoZGF5X21vbnRoIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsImdhbWVOZXQiLCJzZW5kX21zZyIsInJvdXRlIiwiZGF0YSIsInNob3dUaXAiLCJCQVNFSU5GTyIsImtleSIsIm1haWxOdW0iLCJyZWciLCJpc21haWxOdW1fbWF0Y2hlciIsInRlc3QiLCJJTlZBTElERU1BSUwiLCJxcU51bSIsImlzUVFOdW1fbWF0Y2hlciIsIklOVkFMSURRUSIsInd4TnVtIiwiaXNXWE51bV9tYXRjaGVyIiwiSU5WQUxJRFdYIiwibmFtZU51bSIsImNoZWNrU3RyTGVuZ3RoIiwiTkFNRUxJTUlUIiwiaXNuYW1lTnVtX21hdGNoZXIiLCJjb25zb2xlIiwibG9nIiwiSU5WQUxJRE5BTUUiLCJtaW4iLCJtYXgiLCJtVGV4dE1heGxlbmdodCIsImkiLCJjaGFyQXQiLCJjaGFyQ29kZUF0IiwiT25EZXN0cm95Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUVBQSxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLE1BQWpCLENBQXdCO0FBRXBCQyxFQUFBQSxVQUFVLEVBQUU7QUFDUjtBQUNBQyxJQUFBQSxTQUFTLEVBQUVDLEVBQUUsQ0FBQ0MsT0FGTjtBQUdSQyxJQUFBQSxXQUFXLEVBQUVGLEVBQUUsQ0FBQ0MsT0FIUjtBQUlSRSxJQUFBQSxPQUFPLEVBQUVILEVBQUUsQ0FBQ0MsT0FKSjtBQUtSRyxJQUFBQSxVQUFVLEVBQUVKLEVBQUUsQ0FBQ0MsT0FMUDtBQU1SO0FBQ0FJLElBQUFBLFVBQVUsRUFBRUwsRUFBRSxDQUFDTSxJQVBQO0FBUVJDLElBQUFBLFlBQVksRUFBRVAsRUFBRSxDQUFDTSxJQVJUO0FBU1JFLElBQUFBLFFBQVEsRUFBRVIsRUFBRSxDQUFDTSxJQVRMO0FBVVJHLElBQUFBLFdBQVcsRUFBRVQsRUFBRSxDQUFDTSxJQVZSO0FBV1JJLElBQUFBLFdBQVcsRUFBRVYsRUFBRSxDQUFDTTtBQVhSLEdBRlE7QUFpQnBCSyxFQUFBQSxNQWpCb0Isb0JBaUJYO0FBQ0wsU0FBS0MsYUFBTDtBQUVILEdBcEJtQjtBQXNCcEJDLEVBQUFBLEtBdEJvQixtQkFzQlo7QUFDSixTQUFLQyxZQUFMO0FBQ0gsR0F4Qm1CO0FBMEJwQkMsRUFBQUEsT0ExQm9CLG1CQTBCWkMsSUExQlksRUEwQk5DLElBMUJNLEVBMEJBO0FBQ2hCLFlBQVFELElBQVI7QUFDSSxXQUFLLGdCQUFMO0FBQXVCLGFBQUtFLGNB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MEJBc0tMaEMsR0F0S0ssRUFzS0FzQyxHQXRLQSxFQXNLS0MsR0F0S0wsRUFzS1U7QUFDMUIsUUFBSUMsY0FBYyxHQUFHLENBQXJCO0FBQ0EsUUFBSTFDLEdBQUcsR0FBR0UsR0FBRyxDQUFDRCxLQUFKLENBQVUsRUFBVixDQUFWOztBQUNBLFNBQUssSUFBSTBDLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUczQyxHQUFHLENBQUNjLE1BQXhCLEVBQWdDNkIsQ0FBQyxFQUFqQyxFQUFxQztBQUNqQyxVQUFJQyxNQUFNLEdBQUc1QyxHQUFHLENBQUMyQyxDQUFELENBQUgsQ0FBT0UsVUFBUCxFQUFiLENBRGlDLENBRWpDO0FBQ0E7QUFDQTs7QUFDQSxVQUFJRCxNQUFNLElBQUksRUFBVixJQUFnQkEsTUFBTSxJQUFJLEdBQTlCLEVBQW1DO0FBQy9CRixRQUFBQSxjQUFjO0FBQ2pCLE9BRkQsTUFFTztBQUNIQSxRQUFBQSxjQUFjLElBQUksQ0FBbEI7QUFDSDtBQUNKOztBQUNELFdBQU9BLGNBQWMsR0FBR0YsR0FBakIsSUFBd0JFLGNBQWMsR0FBR0QsR0FBaEQ7QUFDSCxHQXJMbUI7QUF1THBCSyxFQUFBQSxTQXZMb0IsdUJBdUxSO0FBQ1IsU0FBSzNELGVBQUw7QUFDSDtBQXpMbUIsQ0FBeEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuZ2xHYW1lLmJhc2VjbGFzcy5leHRlbmQoe1xyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvL+S4quS6uui1hOaWmVxyXG4gICAgICAgIGVkaXRfbmFtZTogY2MuRWRpdEJveCxcclxuICAgICAgICBlZGl0X3dlY2hhdDogY2MuRWRpdEJveCxcclxuICAgICAgICBlZGl0X3FxOiBjYy5FZGl0Qm94LFxyXG4gICAgICAgIGVkaXRfZW1haWw6IGNjLkVkaXRCb3gsXHJcbiAgICAgICAgLy/orr7nva7oh6rlrprkuYnohJrmnKxcclxuICAgICAgICBlZGl0c19uYW1lOiBjYy5Ob2RlLFxyXG4gICAgICAgIGVkaXRzX3dlY2hhdDogY2MuTm9kZSxcclxuICAgICAgICBlZGl0c19xcTogY2MuTm9kZSxcclxuICAgICAgICBlZGl0c19lbWFpbDogY2MuTm9kZSxcclxuICAgICAgICBlZGl0c19iaXJ0aDogY2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0KCkgeyBcclxuICAgICAgICB0aGlzLmluaXR1c2VyaW5mbygpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsaWNrKG5hbWUsIG5vZGUpIHtcclxuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9iaXJ0aFBhbmVsXCI6IHRoaXMuc2hvd2JpcnRoUGFuZWwoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJidG5fdXNlclN1cmVcIjogdGhpcy51c2VyU3VyZV9jYigpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl91c2VyQ2FuY2VsXCI6IHRoaXMucmVtb3ZlKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2ZvcmJpZG5hbWVcIjogZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5VU0VSLkVESVRJTkZPLk1PRElGWU5BTUUpOyBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgcmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihcImVkaXRCaXJ0aERheVwiLCB0aGlzLmVkaXRCaXJ0aEVuZCwgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgdW5yZWdpc3RlckV2ZW50KCkge1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcImVkaXRCaXJ0aERheVwiLCB0aGlzKTtcclxuICAgIH0sXHJcbiAgICAvL+aYvuekuueUn+aXpeeVjOmdolxyXG4gICAgc2hvd2JpcnRoUGFuZWwoKSB7XHJcbiAgICAgICAgaWYoZ2xHYW1lLnVzZXIuZ2V0KFwiYmlydGhkYXlfbW9udGhcIikhPVwiXCIpe1xyXG4gICAgICAgICAgICByZXR1cm4gZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5VU0VSLkVESVRJTkZPLk1PRElGWUJJUlRIKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dCaXJ0aGRheSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+aYvuekuuS4quS6uui1hOaWmeeVjOmdolxyXG4gICAgaW5pdHVzZXJpbmZvKCkge1xyXG4gICAgICAgIHRoaXMuZWRpdHNfbmFtZS5nZXRTZWxmRnVuYygpLnNldFN0cmluZyhnbEdhbWUudXNlci5nZXQoXCJuYW1lXCIpIHx8IFwiXCIpO1xyXG4gICAgICAgIHRoaXMuZWRpdHNfd2VjaGF0LmdldFNlbGZGdW5jKCkuc2V0U3RyaW5nKGdsR2FtZS51c2VyLmdldChcIndlY2hhdFwiKSB8fCBcIlwiKTtcclxuICAgICAgICB0aGlzLmVkaXRzX3FxLmdldFNlbGZGdW5jKCkuc2V0U3RyaW5nKGdsR2FtZS51c2VyLmdldChcInFxXCIpIHx8IFwiXCIpO1xyXG4gICAgICAgIHRoaXMuZWRpdHNfZW1haWwuZ2V0U2VsZkZ1bmMoKS5zZXRTdHJpbmcoZ2xHYW1lLnVzZXIuZ2V0KFwiZW1haWxcIikgfHwgXCJcIik7XHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdF9uYW1lLnN0cmluZyAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWRpdF9uYW1lLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0c19uYW1lLmdldENoaWxkQnlOYW1lKFwiYnRuX2ZvcmJpZG5hbWVcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5icml0aERheSA9IGdsR2FtZS51c2VyLmdldChcImJpcnRoZGF5X21vbnRoXCIpIHx8IFwiXCI7XHJcbiAgICAgICAgaWYgKHRoaXMuYnJpdGhEYXkgJiYgdGhpcy5icml0aERheSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGxldCBhcnIgPSB0aGlzLmJyaXRoRGF5LnNwbGl0KFwiX1wiKTtcclxuICAgICAgICAgICAgdGhpcy5lZGl0c19iaXJ0aC5nZXRTZWxmRnVuYygpLnNldFN0cmluZyhgJHthcnJbMF195pyIJHthcnJbMV195pelYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGVkaXRCaXJ0aEVuZChzdHIpIHtcclxuICAgICAgICB0aGlzLmJyaXRoRGF5ID0gc3RyOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+eUn+aXpee8lui+kee7k+adn1xyXG4gICAgICAgIGxldCBhcnIgPSB0aGlzLmJyaXRoRGF5LnNwbGl0KFwiX1wiKTtcclxuICAgICAgICB0aGlzLmVkaXRzX2JpcnRoLmdldFNlbGZGdW5jKCkuc2V0U3RyaW5nKGAke2FyclswXX3mnIgke2FyclsxXX3ml6VgKTtcclxuICAgIH0sXHJcbiAgICB1c2VyU3VyZV9jYigpIHtcclxuICAgICAgICBsZXQgbXNnID0ge307XHJcbiAgICAgICAgLy9uYW1lXHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdF9uYW1lLnN0cmluZyAhPSBcIlwiICYmIHRoaXMuZWRpdF9uYW1lLnN0cmluZyAhPSBnbEdhbWUudXNlci5nZXQoXCJuYW1lXCIpKSB7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gdGhpcy5jaGVja05hbWUodGhpcy5lZGl0X25hbWUuc3RyaW5nKTtcclxuICAgICAgICAgICAgaWYgKCFuYW1lKSByZXR1cm47XHJcbiAgICAgICAgICAgIG1zZy5uYW1lID0gbmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy93ZWNoYXRcclxuICAgICAgICBpZiAodGhpcy5lZGl0X3dlY2hhdC5zdHJpbmcgIT0gZ2xHYW1lLnVzZXIuZ2V0KFwid2VjaGF0XCIpICYmIHRoaXMuZWRpdF93ZWNoYXQuc3RyaW5nICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgbGV0IHdlY2hhdCA9IHRoaXMuY2hlY2tXWCh0aGlzLmVkaXRfd2VjaGF0LnN0cmluZyk7XHJcbiAgICAgICAgICAgIGlmICghd2VjaGF0KSByZXR1cm47XHJcbiAgICAgICAgICAgIG1zZy53ZWNoYXQgPSB3ZWNoYXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vcXFcclxuICAgICAgICBpZiAodGhpcy5lZGl0X3FxLnN0cmluZyAhPSBnbEdhbWUudXNlci5nZXQoXCJxcVwiKSAmJiB0aGlzLmVkaXRfcXEuc3RyaW5nICE9IFwiXCIpIHtcclxuICAgICAgICAgICAgbGV0IHFxID0gdGhpcy5jaGVja1FRKHRoaXMuZWRpdF9xcS5zdHJpbmcpO1xyXG4gICAgICAgICAgICBpZiAoIXFxKSByZXR1cm47XHJcbiAgICAgICAgICAgIG1zZy5xcSA9IHFxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2VtYWlsXHJcbiAgICAgICAgaWYgKHRoaXMuZWRpdF9lbWFpbC5zdHJpbmcgIT0gZ2xHYW1lLnVzZXIuZ2V0KFwiZW1haWxcIikgJiYgdGhpcy5lZGl0X2VtYWlsLnN0cmluZyAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGxldCBlbWFpbCA9IHRoaXMuY2hlY2tNYWlsKHRoaXMuZWRpdF9lbWFpbC5zdHJpbmcpO1xyXG4gICAgICAgICAgICBpZiAoIWVtYWlsKSByZXR1cm47XHJcbiAgICAgICAgICAgIG1zZy5lbWFpbCA9IGVtYWlsO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2JpcnRoXHJcbiAgICAgICAgaWYgKHRoaXMuYnJpdGhEYXkgIT0gZ2xHYW1lLnVzZXIuZ2V0KFwiYmlydGhkYXlfbW9udGhcIikgJiYgdGhpcy5icml0aERheSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIG1zZy5iaXJ0aGRheV9tb250aCA9IHRoaXMuYnJpdGhEYXk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoT2JqZWN0LmtleXMobXNnKS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBnbEdhbWUuZ2FtZU5ldC5zZW5kX21zZygnaHR0cC5yZXFFZGl0TXlJbmZvJywgbXNnLCAocm91dGUsIGRhdGEpID0+IHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dUaXAoZ2xHYW1lLnRpcHMuVVNFUi5FRElUSU5GTy5CQVNFSU5GTyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBtc2cpIHtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS51c2VyW2tleV0gPSBtc2dba2V5XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH0sXHJcblxyXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvL+mCrueuseajgOafpVxyXG4gICAgY2hlY2tNYWlsKG1haWxOdW0pIHtcclxuICAgICAgICBsZXQgcmVnID0gL15bQS1aYS16XFxkXSsoWy1fLl1bQS1aYS16XFxkXSspKkAoW0EtWmEtelxcZF0rWy0uXSkrW0EtWmEtelxcZF17Miw0fSQvIC8v6aqM6K+B6KeE5YiZXHJcbiAgICAgICAgbGV0IGlzbWFpbE51bV9tYXRjaGVyID0gcmVnLnRlc3QobWFpbE51bSk7XHJcbiAgICAgICAgaWYgKCFpc21haWxOdW1fbWF0Y2hlcikge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0Vycm9yVGlwKGdsR2FtZS50aXBzLlVTRVIuRURJVElORk8uSU5WQUxJREVNQUlMKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWFpbE51bTtcclxuICAgIH0sXHJcbiAgICAvLyBRUeajgOafpVxyXG4gICAgY2hlY2tRUShxcU51bSkge1xyXG4gICAgICAgIGxldCByZWcgPSAvXlsxLTldWzAtOV17NCwxNH0kL2dpbTsgLy/pqozor4Hop4TliJlcclxuICAgICAgICBsZXQgaXNRUU51bV9tYXRjaGVyID0gcmVnLnRlc3QocXFOdW0pO1xyXG4gICAgICAgIGlmICghaXNRUU51bV9tYXRjaGVyKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuVVNFUi5FRElUSU5GTy5JTlZBTElEUVEpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHFxTnVtO1xyXG4gICAgfSxcclxuICAgIC8vIOW+ruS/oeajgOafpVxyXG4gICAgY2hlY2tXWCh3eE51bSkge1xyXG4gICAgICAgIGxldCByZWcgPSAvXlstX2EtekEtWjAtOV17NiwyMH0kLzsgLy/pqozor4Hop4TliJlcclxuICAgICAgICBsZXQgaXNXWE51bV9tYXRjaGVyID0gcmVnLnRlc3Qod3hOdW0pO1xyXG4gICAgICAgIGlmICghaXNXWE51bV9tYXRjaGVyKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuVVNFUi5FRElUSU5GTy5JTlZBTElEV1gpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHd4TnVtO1xyXG4gICAgfSxcclxuICAgIC8vIOWnk+WQjeajgOafpVxyXG4gICAgY2hlY2tOYW1lKG5hbWVOdW0pIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja1N0ckxlbmd0aChuYW1lTnVtLCAyLCA0MCkpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5VU0VSLkVESVRJTkZPLk5BTUVMSU1JVCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBsZXQgcmVnID0gL15bXFx1NGUwMC1cXHU5ZmE1XXsyLDh9JC9cclxuICAgICAgICBsZXQgcmVnID0gL15bXFx1NEUwMC1cXHU5RkE1XFx1ZjkwMC1cXHVmYTJkwrdzXXsyLDIwfSQvOyAvL+mqjOivgeinhOWImVxyXG4gICAgICAgIGxldCBpc25hbWVOdW1fbWF0Y2hlciA9IHJlZy50ZXN0KG5hbWVOdW0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCflp5PlkI3moLzlvI/plJnor6/vvIE/JywgaXNuYW1lTnVtX21hdGNoZXIpXHJcbiAgICAgICAgaWYgKCFpc25hbWVOdW1fbWF0Y2hlcikge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0Vycm9yVGlwKGdsR2FtZS50aXBzLlVTRVIuRURJVElORk8uSU5WQUxJRE5BTUUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5hbWVOdW07XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5qOA5p+l5Lit5paH5ZKM6Iux5paH5re35ZCI55qE5a2X56ym6ZW/5bqmXHJcbiAgICBjaGVja1N0ckxlbmd0aChzdHIsIG1pbiwgbWF4KSB7XHJcbiAgICAgICAgbGV0IG1UZXh0TWF4bGVuZ2h0ID0gMDtcclxuICAgICAgICBsZXQgYXJyID0gc3RyLnNwbGl0KFwiXCIpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBjaGFyQXQgPSBhcnJbaV0uY2hhckNvZGVBdCgpO1xyXG4gICAgICAgICAgICAvLzMyLTEyMuWMheWQq+S6huepuuagvO+8jOWkp+Wwj+WGmeWtl+avje+8jOaVsOWtl+WSjOS4gOS6m+W4uOeUqOeahOespuWPt++8jFxyXG4gICAgICAgICAgICAvL+WmguaenOWcqOi/meS4quiMg+WbtOWGheWImeeul+S4gOS4quWtl+espu+8jFxyXG4gICAgICAgICAgICAvL+WmguaenOS4jeWcqOi/meS4quiMg+WbtOavlOWmguaYr+axieWtl+eahOivneWwseaYr+S4pOS4quWtl+esplxyXG4gICAgICAgICAgICBpZiAoY2hhckF0ID49IDMyICYmIGNoYXJBdCA8PSAxMjIpIHtcclxuICAgICAgICAgICAgICAgIG1UZXh0TWF4bGVuZ2h0Kys7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBtVGV4dE1heGxlbmdodCArPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtVGV4dE1heGxlbmdodCA8IG1pbiB8fCBtVGV4dE1heGxlbmdodCA+IG1heFxyXG4gICAgfSxcclxuXHJcbiAgICBPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgIH0sXHJcbn0pO1xyXG4iXX0=