
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/backWater/waterrecord.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '34dc1/7F6ZCrba4dMu4/NxL', 'waterrecord');
// modules/plaza/script/prefab/backWater/waterrecord.js

"use strict";

/**
 * 返水记录
 */
var status = {
  0: '定时返水',
  1: '实时返水'
};
glGame.baseclass.extend({
  properties: {
    content: cc.Node,
    recorditem: cc.Node,
    noitem: cc.Node,
    today_bet: cc.Label,
    //未返水有效投注
    today_back: cc.Label,
    //今日预计返水
    Lab_CurPage: cc.Label,
    Lab_totalPage: cc.Label
  },
  onLoad: function onLoad() {
    this.registerEvent();
    var userPumpRecord = glGame.user.get("userPumpRecord");
    this.gameRecord = userPumpRecord;
    this.today_bet.string = "".concat(this.cutFloat(this.gameRecord.betCoin));
    this.today_back.string = "".concat(this.cutFloat(this.gameRecord.rebateCoin));
    this.page = 1;
    this.Lab_CurPage.string = this.page;
    this.pageSize = 7;
    this.pageTotal = 1;
    this.record = []; //  蓝 绿 红 黄 

    this.stateColor = [cc.color(102, 144, 204), cc.color(0, 255, 24), cc.color(244, 20, 36), cc.color(187, 151, 4)];
    glGame.user.ReqRebateRecordList(this.page, this.pageSize);
  },
  start: function start() {},
  registerEvent: function registerEvent() {
    glGame.emitter.on("updateReqRebateRecordList", this.updateReqRebateRecordList, this);
  },
  unRegisterEvent: function unRegisterEvent() {
    glGame.emitter.off("updateReqRebateRecordList", this);
  },
  updateReqRebateRecordList: function updateReqRebateRecordList(recordData) {
    this.record = recordData.data;
    this.pageTotal = recordData.totalPage;
    this.Lab_totalPage.string = recordData.totalPage;
    this.initUI();
    this.noitem.active = this.record.length == 0;
  },
  initUI: function initUI() {
    var _this = this;

    this.unscheduleAllCallbacks();
    this.content.destroyAllChildren();
    this.content.removeAllChildren();
    this.Lab_CurPage.string = this.page;
    var len = this.record.length;
    this.node.getChildByName("pagelayout").active = len > 0;
    this.node.getChildByName("noThink").active = len == 0;
    this.node.getChildByName("explain").active = len != 0;
    this.node.getChildByName("btn_pageup").active = len != 0;
    this.node.getChildByName("btn_pagedown").active = len != 0;
    var i = 0;
    this.schedule(function () {
      if (!_this.record[i]) {
        return;
      }

      var node = cc.instantiate(_this.recorditem);
      node.parent = _this.content;
      node.active = true;
      var timeStamp = new Date(_this.record[i].createTime * 1000);
      var strTime = "".concat(timeStamp.getFullYear(), "-").concat(timeStamp.getMonth() + 1 >= 10 ? timeStamp.getMonth() + 1 : "0" + (timeStamp.getMonth() + 1), "-").concat(timeStamp.getDate() >= 10 ? timeStamp.getDate() : '0' + timeStamp.getDate());
      strTime += " ";
      strTime += "".concat(timeStamp.getHours() >= 10 ? timeStamp.getHours() : "0" + timeStamp.getHours(), ":");
      strTime += "".concat(timeStamp.getMinutes() >= 10 ? timeStamp.getMinutes() : "0" + timeStamp.getMinutes(), ":");
      strTime += "".concat(timeStamp.getSeconds() >= 10 ? timeStamp.getSeconds() : "0" + timeStamp.getSeconds());
      node.getChildByName("time").getComponent(cc.Label).string = strTime;
      node.getChildByName("type").getComponent(cc.Label).string = status[_this.record[i].receiveType - 1];
      node.getChildByName("betcoin").getComponent(cc.Label).string = _this.cutFloat(_this.record[i].allBetting);
      node.getChildByName("coin").getComponent(cc.Label).string = _this.cutFloat(_this.record[i].number);
      glGame.panel.settingTableLabelColor(node.getChildByName("coin"));
      node.getChildByName("status").getComponent(cc.Label).string = _this.record[i].stateDes; // 0，未领取；1，已领取。2，审核中。3，已拒绝。12，过期作废

      var color = _this.stateColor[0];
      var state = _this.record[i].state;

      switch (state) {
        case 0:
        case 1:
        case 4:
          // 成功
          color = _this.stateColor[1];
          break;

        case 2:
        case 3:
          // 处理中
          color = _this.stateColor[0];
          break;

        case 5:
        case 6:
        case 12:
          // 失败
          color = _this.stateColor[2];
          break;

        case 11:
          // 
          color = _this.stateColor[3];
          break;
      }

      node.getChildByName("status").color = color;
      node.getChildByName("bg").active = i % 2 == 1;
      i++;
    }, 0.08, len - 1, 0.3);
  },
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_pageup":
        this.pageup_click();
        break;

      case "btn_pagedown":
        this.pagedown_click();
        break;

      default:
        break;
    }
  },
  pageup_click: function pageup_click() {
    if (this.page <= 1) return;
    this.page--;
    glGame.user.ReqRebateRecordList(this.page, this.pageSize);
  },
  pagedown_click: function pagedown_click() {
    if (this.page >= this.pageTotal) return;
    this.page++;
    glGame.user.ReqRebateRecordList(this.page, this.pageSize);
  },
  //浮点型运算取俩位
  cutFloat: function cutFloat(value) {
    return Number(value).div(100).toFixed(2).toString();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxiYWNrV2F0ZXJcXHdhdGVycmVjb3JkLmpzIl0sIm5hbWVzIjpbInN0YXR1cyIsImdsR2FtZSIsImJhc2VjbGFzcyIsImV4dGVuZCIsInByb3BlcnRpZXMiLCJjb250ZW50IiwiY2MiLCJOb2RlIiwicmVjb3JkaXRlbSIsIm5vaXRlbSIsInRvZGF5X2JldCIsIkxhYmVsIiwidG9kYXlfYmFjayIsIkxhYl9DdXJQYWdlIiwiTGFiX3RvdGFsUGFnZSIsIm9uTG9hZCIsInJlZ2lzdGVyRXZlbnQiLCJ1c2VyUHVtcFJlY29yZCIsInVzZXIiLCJnZXQiLCJnYW1lUmVjb3JkIiwic3RyaW5nIiwiY3V0RmxvYXQiLCJiZXRDb2luIiwicmViYXRlQ29pbiIsInBhZ2UiLCJwYWdlU2l6ZSIsInBhZ2VUb3RhbCIsInJlY29yZCIsInN0YXRlQ29sb3IiLCJjb2xvciIsIlJlcVJlYmF0ZVJlY29yZExpc3QiLCJzdGFydCIsImVtaXR0ZXIiLCJvbiIsInVwZGF0ZVJlcVJlYmF0ZVJlY29yZExpc3QiLCJ1blJlZ2lzdGVyRXZlbnQiLCJvZmYiLCJyZWNvcmREYXRhIiwiZGF0YSIsInRvdGFsUGFnZSIsImluaXRVSSIsImFjdGl2ZSIsImxlbmd0aCIsInVuc2NoZWR1bGVBbGxDYWxsYmFja3MiLCJkZXN0cm95QWxsQ2hpbGRyZW4iLCJyZW1vdmVBbGxDaGlsZHJlbiIsImxlbiIsIm5vZGUiLCJnZXRDaGlsZEJ5TmFtZSIsImkiLCJzY2hlZHVsZSIsImluc3RhbnRpYXRlIiwicGFyZW50IiwidGltZVN0YW1wIiwiRGF0ZSIsImNyZWF0ZVRpbWUiLCJzdHJUaW1lIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRTZWNvbmRzIiwiZ2V0Q29tcG9uZW50IiwicmVjZWl2ZVR5cGUiLCJhbGxCZXR0aW5nIiwibnVtYmVyIiwicGFuZWwiLCJzZXR0aW5nVGFibGVMYWJlbENvbG9yIiwic3RhdGVEZXMiLCJzdGF0ZSIsIk9uRGVzdHJveSIsIm9uQ2xpY2siLCJuYW1lIiwicGFnZXVwX2NsaWNrIiwicGFnZWRvd25fY2xpY2siLCJ2YWx1ZSIsIk51bWJlciIsImRpdiIsInRvRml4ZWQiLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7O0FBR0EsSUFBTUEsTUFBTSxHQUFHO0FBQ1gsS0FBRyxNQURRO0FBRVgsS0FBRztBQUZRLENBQWY7QUFLQUMsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QjtBQUNwQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLE9BQU8sRUFBRUMsRUFBRSxDQUFDQyxJQURKO0FBRVJDLElBQUFBLFVBQVUsRUFBRUYsRUFBRSxDQUFDQyxJQUZQO0FBR1JFLElBQUFBLE1BQU0sRUFBRUgsRUFBRSxDQUFDQyxJQUhIO0FBSVJHLElBQUFBLFNBQVMsRUFBRUosRUFBRSxDQUFDSyxLQUpOO0FBSW9CO0FBQzVCQyxJQUFBQSxVQUFVLEVBQUVOLEVBQUUsQ0FBQ0ssS0FMUDtBQUtvQjtBQUU1QkUsSUFBQUEsV0FBVyxFQUFFUCxFQUFFLENBQUNLLEtBUFI7QUFRUkcsSUFBQUEsYUFBYSxFQUFFUixFQUFFLENBQUNLO0FBUlYsR0FEUTtBQVlwQkksRUFBQUEsTUFab0Isb0JBWVg7QUFDTCxTQUFLQyxhQUFMO0FBQ0EsUUFBSUMsY0FBYyxHQUFHaEIsTUFBTSxDQUFDaUIsSUFBUCxDQUFZQyxHQUFaLENBQWdCLGdCQUFoQixDQUFyQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0JILGNBQWxCO0FBQ0EsU0FBS1AsU0FBTCxDQUFlVyxNQUFmLGFBQTJCLEtBQUtDLFFBQUwsQ0FBYyxLQUFLRixVQUFMLENBQWdCRyxPQUE5QixDQUEzQjtBQUNBLFNBQUtYLFVBQUwsQ0FBZ0JTLE1BQWhCLGFBQTRCLEtBQUtDLFFBQUwsQ0FBYyxLQUFLRixVQUFMLENBQWdCSSxVQUE5QixDQUE1QjtBQUVBLFNBQUtDLElBQUwsR0FBWSxDQUFaO0FBQ0EsU0FBS1osV0FBTCxDQUFpQlEsTUFBakIsR0FBMEIsS0FBS0ksSUFBL0I7QUFDQSxTQUFLQyxRQUFMLEdBQWdCLENBQWhCO0FBQ0EsU0FBS0MsU0FBTCxHQUFpQixDQUFqQjtBQUNBLFNBQUtDLE1BQUwsR0FBYyxFQUFkLENBWEssQ0FZTDs7QUFDQSxTQUFLQyxVQUFMLEdBQWtCLENBQUN2QixFQUFFLENBQUN3QixLQUFILENBQVMsR0FBVCxFQUFjLEdBQWQsRUFBbUIsR0FBbkIsQ0FBRCxFQUEwQnhCLEVBQUUsQ0FBQ3dCLEtBQUgsQ0FBUyxDQUFULEVBQVcsR0FBWCxFQUFlLEVBQWYsQ0FBMUIsRUFDZHhCLEVBQUUsQ0FBQ3dCLEtBQUgsQ0FBUyxHQUFULEVBQWEsRUFBYixFQUFnQixFQUFoQixDQURjLEVBQ094QixFQUFFLENBQUN3QixLQUFILENBQVMsR0FBVCxFQUFhLEdBQWIsRUFBaUIsQ0FBakIsQ0FEUCxDQUFsQjtBQUdBN0IsSUFBQUEsTUFBTSxDQUFDaUIsSUFBUCxDQUFZYSxtQkFBWixDQUFnQyxLQUFLTixJQUFyQyxFQUEyQyxLQUFLQyxRQUFoRDtBQUNILEdBN0JtQjtBQStCcEJNLEVBQUFBLEtBL0JvQixtQkErQlosQ0FFUCxDQWpDbUI7QUFrQ3BCaEIsRUFBQUEsYUFsQ29CLDJCQWtDSjtBQUNaZixJQUFBQSxNQUFNLENBQUNnQyxPQUFQLENBQWVDLEVBQWYsQ0FBa0IsMkJBQWxCLEVBQStDLEtBQUtDLHlCQUFwRCxFQUErRSxJQUEvRTtBQUNILEdBcENtQjtBQXNDcEJDLEVBQUFBLGVBdENvQiw2QkFzQ0Y7QUFDZG5DLElBQUFBLE1BQU0sQ0FBQ2dDLE9BQVAsQ0FBZUksR0FBZixDQUFtQiwyQkFBbkIsRUFBZ0QsSUFBaEQ7QUFDSCxHQXhDbUI7QUEwQ3BCRixFQUFBQSx5QkExQ29CLHFDQTBDTUcsVUExQ04sRUEwQ2tCO0FBQ2xDLFNBQUtWLE1BQUwsR0FBY1UsVUFBVSxDQUFDQyxJQUF6QjtBQUNBLFNBQUtaLFNBQUwsR0FBaUJXLFVBQVUsQ0FBQ0UsU0FBNUI7QUFDQSxTQUFLMUIsYUFBTCxDQUFtQk8sTUFBbkIsR0FBNEJpQixVQUFVLENBQUNFLFNBQXZDO0FBQ0EsU0FBS0MsTUFBTDtBQUNBLFNBQUtoQyxNQUFMLENBQVlpQyxNQUFaLEdBQXFCLEtBQUtkLE1BQUwsQ0FBWWUsTUFBWixJQUFzQixDQUEzQztBQUNILEdBaERtQjtBQWlEcEJGLEVBQUFBLE1BakRvQixvQkFpRFg7QUFBQTs7QUFDTCxTQUFLRyxzQkFBTDtBQUNBLFNBQUt2QyxPQUFMLENBQWF3QyxrQkFBYjtBQUNBLFNBQUt4QyxPQUFMLENBQWF5QyxpQkFBYjtBQUNBLFNBQUtqQyxXQUFMLENBQWlCUSxNQUFqQixHQUEwQixLQUFLSSxJQUEvQjtBQUNBLFFBQUlzQixHQUFHLEdBQUcsS0FBS25CLE1BQUwsQ0FBWWUsTUFBdEI7QUFDQSxTQUFLSyxJQUFMLENBQVVDLGNBQVYsQ0FBeUIsWUFBekIsRUFBdUNQLE1BQXZDLEdBQWdESyxHQUFHLEdBQUcsQ0FBdEQ7QUFDQSxTQUFLQyxJQUFMLENBQVVDLGNBQVYsQ0FBeUIsU0FBekIsRUFBb0NQLE1BQXBDLEdBQTZDSyxHQUFHLElBQUksQ0FBcEQ7QUFDQSxTQUFLQyxJQUFMLENBQVVDLGNBQVYsQ0FBeUIsU0FBekIsRUFBb0NQLE1BQXBDLEdBQTZDSyxHQUFHLElBQUksQ0FBcEQ7QUFDQSxTQUFLQyxJQUFMLENBQVVDLGNBQVYsQ0FBeUIsWUFBekIsRUFBdUNQLE1BQXZDLEdBQWdESyxHQUFHLElBQUksQ0FBdkQ7QUFDQSxTQUFLQyxJQUFMLENBQVVDLGNBQVYsQ0FBeUIsY0FBekIsRUFBeUNQLE1BQXpDLEdBQWtESyxHQUFHLElBQUksQ0FBekQ7QUFDQSxRQUFJRyxDQUFDLEdBQUcsQ0FBUjtBQUNBLFNBQUtDLFFBQUwsQ0FBYyxZQUFJO0FBQ2QsVUFBRyxDQUFDLEtBQUksQ0FBQ3ZCLE1BQUwsQ0FBWXNCLENBQVosQ0FBSixFQUFtQjtBQUNmO0FBQ0g7O0FBQ0QsVUFBSUYsSUFBSSxHQUFHMUMsRUFBRSxDQUFDOEMsV0FBSCxDQUFlLEtBQUksQ0FBQzVDLFVBQXBCLENBQVg7QUFDQXdDLE1BQUFBLElBQUksQ0FBQ0ssTUFBTCxHQUFjLEtBQUksQ0FBQ2hELE9BQW5CO0FBQ0EyQyxNQUFBQSxJQUFJLENBQUNOLE1BQUwsR0FBYyxJQUFkO0FBQ0EsVUFBSVksU0FBUyxHQUFHLElBQUlDLElBQUosQ0FBUyxLQUFJLENBQUMzQixNQUFMLENBQVlzQixDQUFaLEVBQWVNLFVBQWYsR0FBNEIsSUFBckMsQ0FBaEI7QUFDQSxVQUFJQyxPQUFPLGFBQU1ILFNBQVMsQ0FBQ0ksV0FBVixFQUFOLGNBQWlDSixTQUFTLENBQUNLLFFBQVYsS0FBdUIsQ0FBdkIsSUFBNEIsRUFBNUIsR0FBaUNMLFNBQVMsQ0FBQ0ssUUFBVixLQUF1QixDQUF4RCxHQUE0RCxPQUFPTCxTQUFTLENBQUNLLFFBQVYsS0FBdUIsQ0FBOUIsQ0FBN0YsY0FBaUlMLFNBQVMsQ0FBQ00sT0FBVixNQUF1QixFQUF2QixHQUE0Qk4sU0FBUyxDQUFDTSxPQUFWLEVBQTVCLEdBQWtELE1BQU1OLFNBQVMsQ0FBQ00sT0FBVixFQUF6TCxDQUFYO0FBQ0FILE1BQUFBLE9BQU8sT0FBUDtBQUNBQSxNQUFBQSxPQUFPLGNBQU9ILFNBQVMsQ0FBQ08sUUFBVixNQUF3QixFQUF4QixHQUE0QlAsU0FBUyxDQUFDTyxRQUFWLEVBQTVCLEdBQWtELE1BQU1QLFNBQVMsQ0FBQ08sUUFBVixFQUEvRCxNQUFQO0FBQ0FKLE1BQUFBLE9BQU8sY0FBT0gsU0FBUyxDQUFDUSxVQUFWLE1BQTBCLEVBQTFCLEdBQThCUixTQUFTLENBQUNRLFVBQVYsRUFBOUIsR0FBc0QsTUFBTVIsU0FBUyxDQUFDUSxVQUFWLEVBQW5FLE1BQVA7QUFDQUwsTUFBQUEsT0FBTyxjQUFPSCxTQUFTLENBQUNTLFVBQVYsTUFBMEIsRUFBMUIsR0FBOEJULFNBQVMsQ0FBQ1MsVUFBVixFQUE5QixHQUFzRCxNQUFNVCxTQUFTLENBQUNTLFVBQVYsRUFBbkUsQ0FBUDtBQUNBZixNQUFBQSxJQUFJLENBQUNDLGNBQUwsQ0FBb0IsTUFBcEIsRUFBNEJlLFlBQTVCLENBQXlDMUQsRUFBRSxDQUFDSyxLQUE1QyxFQUFtRFUsTUFBbkQsR0FBNERvQyxPQUE1RDtBQUNBVCxNQUFBQSxJQUFJLENBQUNDLGNBQUwsQ0FBb0IsTUFBcEIsRUFBNEJlLFlBQTVCLENBQXlDMUQsRUFBRSxDQUFDSyxLQUE1QyxFQUFtRFUsTUFBbkQsR0FBNERyQixNQUFNLENBQUMsS0FBSSxDQUFDNEIsTUFBTCxDQUFZc0IsQ0FBWixFQUFlZSxXQUFmLEdBQTZCLENBQTlCLENBQWxFO0FBQ0FqQixNQUFBQSxJQUFJLENBQUNDLGNBQUwsQ0FBb0IsU0FBcEIsRUFBK0JlLFlBQS9CLENBQTRDMUQsRUFBRSxDQUFDSyxLQUEvQyxFQUFzRFUsTUFBdEQsR0FBK0QsS0FBSSxDQUFDQyxRQUFMLENBQWMsS0FBSSxDQUFDTSxNQUFMLENBQVlzQixDQUFaLEVBQWVnQixVQUE3QixDQUEvRDtBQUNBbEIsTUFBQUEsSUFBSSxDQUFDQyxjQUFMLENBQW9CLE1BQXBCLEVBQTRCZSxZQUE1QixDQUF5QzFELEVBQUUsQ0FBQ0ssS0FBNUMsRUFBbURVLE1BQW5ELEdBQTRELEtBQUksQ0FBQ0MsUUFBTCxDQUFjLEtBQUksQ0FBQ00sTUFBTCxDQUFZc0IsQ0FBWixFQUFlaUIsTUFBN0IsQ0FBNUQ7QUFDQWxFLE1BQUFBLE1BQU0sQ0FBQ21FLEtBQVAsQ0FBYUMsc0JBQWIsQ0FBb0NyQixJQUFJLENBQUNDLGNBQUwsQ0FBb0IsTUFBcEIsQ0FBcEM7QUFDQUQsTUFBQUEsSUFBSSxDQUFDQyxjQUFMLENBQW9CLFFBQXBCLEVBQThCZSxZQUE5QixDQUEyQzFELEVBQUUsQ0FBQ0ssS0FBOUMsRUFBcURVLE1BQXJELEdBQThELEtBQUksQ0FBQ08sTUFBTCxDQUFZc0IsQ0FBWixFQUFlb0IsUUFBN0UsQ0FsQmMsQ0FvQmQ7O0FBQ0EsVUFBSXhDLEtBQUssR0FBRyxLQUFJLENBQUNELFVBQUwsQ0FBZ0IsQ0FBaEIsQ0FBWjtBQUNBLFVBQUkwQyxLQUFLLEdBQUcsS0FBSSxDQUFDM0MsTUFBTCxDQUFZc0IsQ0FBWixFQUFlcUIsS0FBM0I7O0FBQ0EsY0FBT0EsS0FBUDtBQUNJLGFBQUssQ0FBTDtBQUFRLGFBQUssQ0FBTDtBQUFRLGFBQUssQ0FBTDtBQUFTO0FBQ3JCekMsVUFBQUEsS0FBSyxHQUFHLEtBQUksQ0FBQ0QsVUFBTCxDQUFnQixDQUFoQixDQUFSO0FBQ0o7O0FBRUEsYUFBSyxDQUFMO0FBQVEsYUFBSyxDQUFMO0FBQVM7QUFDYkMsVUFBQUEsS0FBSyxHQUFHLEtBQUksQ0FBQ0QsVUFBTCxDQUFnQixDQUFoQixDQUFSO0FBQ0o7O0FBRUEsYUFBSyxDQUFMO0FBQVEsYUFBSyxDQUFMO0FBQVEsYUFBSyxFQUFMO0FBQVU7QUFDdEJDLFVBQUFBLEtBQUssR0FBRyxLQUFJLENBQUNELFVBQUwsQ0FBZ0IsQ0FBaEIsQ0FBUjtBQUNKOztBQUVBLGFBQUssRUFBTDtBQUFTO0FBQ0xDLFVBQUFBLEtBQUssR0FBRyxLQUFJLENBQUNELFVBQUwsQ0FBZ0IsQ0FBaEIsQ0FBUjtBQUNKO0FBZko7O0FBaUJBbUIsTUFBQUEsSUFBSSxDQUFDQyxjQUFMLENBQW9CLFFBQXBCLEVBQThCbkIsS0FBOUIsR0FBc0NBLEtBQXRDO0FBRUFrQixNQUFBQSxJQUFJLENBQUNDLGNBQUwsQ0FBb0IsSUFBcEIsRUFBMEJQLE1BQTFCLEdBQW1DUSxDQUFDLEdBQUcsQ0FBSixJQUFTLENBQTVDO0FBQ0FBLE1BQUFBLENBQUM7QUFDSixLQTVDRCxFQTRDRSxJQTVDRixFQTRDT0gsR0FBRyxHQUFDLENBNUNYLEVBNENhLEdBNUNiO0FBNkNILEdBMUdtQjtBQTJHcEJ5QixFQUFBQSxTQTNHb0IsdUJBMkdSO0FBQ1IsU0FBS3BDLGVBQUw7QUFDSCxHQTdHbUI7QUErR3BCcUMsRUFBQUEsT0EvR29CLG1CQStHWkMsSUEvR1ksRUErR04xQixJQS9HTSxFQStHQTtBQUNoQixZQUFRMEIsSUFBUjtBQUNJLFdBQUssWUFBTDtBQUFtQixhQUFLQyxZQUFMO0FBQXFCOztBQUN4QyxXQUFLLGNBQUw7QUFBcUIsYUFBS0MsY0FBTDtBQUF1Qjs7QUFDNUM7QUFBUztBQUhiO0FBS0gsR0FySG1CO0FBdUhwQkQsRUFBQUEsWUF2SG9CLDBCQXVITDtBQUNYLFFBQUksS0FBS2xELElBQUwsSUFBYSxDQUFqQixFQUFvQjtBQUNwQixTQUFLQSxJQUFMO0FBQ0F4QixJQUFBQSxNQUFNLENBQUNpQixJQUFQLENBQVlhLG1CQUFaLENBQWdDLEtBQUtOLElBQXJDLEVBQTJDLEtBQUtDLFFBQWhEO0FBQ0gsR0EzSG1CO0FBNkhwQmtELEVBQUFBLGNBN0hvQiw0QkE2SEg7QUFDYixRQUFJLEtBQUtuRCxJQUFMLElBQWEsS0FBS0UsU0FBdEIsRUFBaUM7QUFDakMsU0FBS0YsSUFBTDtBQUNBeEIsSUFBQUEsTUFBTSxDQUFDaUIsSUFBUCxDQUFZYSxtQkFBWixDQUFnQyxLQUFLTixJQUFyQyxFQUEyQyxLQUFLQyxRQUFoRDtBQUNILEdBakltQjtBQW1JcEI7QUFDQUosRUFBQUEsUUFwSW9CLG9CQW9JWHVELEtBcElXLEVBb0lKO0FBQ1osV0FBT0MsTUFBTSxDQUFDRCxLQUFELENBQU4sQ0FBY0UsR0FBZCxDQUFrQixHQUFsQixFQUF1QkMsT0FBdkIsQ0FBK0IsQ0FBL0IsRUFBa0NDLFFBQWxDLEVBQVA7QUFDSDtBQXRJbUIsQ0FBeEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDov5TmsLTorrDlvZVcclxuICovXHJcbmNvbnN0IHN0YXR1cyA9IHtcclxuICAgIDA6ICflrprml7bov5TmsLQnLFxyXG4gICAgMTogJ+WunuaXtui/lOawtCcsXHJcbn1cclxuXHJcbmdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBjb250ZW50OiBjYy5Ob2RlLFxyXG4gICAgICAgIHJlY29yZGl0ZW06IGNjLk5vZGUsXHJcbiAgICAgICAgbm9pdGVtOiBjYy5Ob2RlLFxyXG4gICAgICAgIHRvZGF5X2JldDogY2MuTGFiZWwsICAgICAgICAvL+acqui/lOawtOacieaViOaKleazqFxyXG4gICAgICAgIHRvZGF5X2JhY2s6IGNjLkxhYmVsLCAgICAgICAvL+S7iuaXpemihOiuoei/lOawtFxyXG5cclxuICAgICAgICBMYWJfQ3VyUGFnZTogY2MuTGFiZWwsXHJcbiAgICAgICAgTGFiX3RvdGFsUGFnZTogY2MuTGFiZWwsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgICAgICBsZXQgdXNlclB1bXBSZWNvcmQgPSBnbEdhbWUudXNlci5nZXQoXCJ1c2VyUHVtcFJlY29yZFwiKTtcclxuICAgICAgICB0aGlzLmdhbWVSZWNvcmQgPSB1c2VyUHVtcFJlY29yZDtcclxuICAgICAgICB0aGlzLnRvZGF5X2JldC5zdHJpbmcgPSBgJHt0aGlzLmN1dEZsb2F0KHRoaXMuZ2FtZVJlY29yZC5iZXRDb2luKX1gO1xyXG4gICAgICAgIHRoaXMudG9kYXlfYmFjay5zdHJpbmcgPSBgJHt0aGlzLmN1dEZsb2F0KHRoaXMuZ2FtZVJlY29yZC5yZWJhdGVDb2luKX1gO1xyXG5cclxuICAgICAgICB0aGlzLnBhZ2UgPSAxO1xyXG4gICAgICAgIHRoaXMuTGFiX0N1clBhZ2Uuc3RyaW5nID0gdGhpcy5wYWdlO1xyXG4gICAgICAgIHRoaXMucGFnZVNpemUgPSA3O1xyXG4gICAgICAgIHRoaXMucGFnZVRvdGFsID0gMTtcclxuICAgICAgICB0aGlzLnJlY29yZCA9IFtdO1xyXG4gICAgICAgIC8vICDok50g57u/IOe6oiDpu4QgXHJcbiAgICAgICAgdGhpcy5zdGF0ZUNvbG9yID0gW2NjLmNvbG9yKDEwMiwgMTQ0LCAyMDQpLCBjYy5jb2xvcigwLDI1NSwyNCksIFxyXG4gICAgICAgICAgICBjYy5jb2xvcigyNDQsMjAsMzYpLCBjYy5jb2xvcigxODcsMTUxLDQpXTsgXHJcblxyXG4gICAgICAgIGdsR2FtZS51c2VyLlJlcVJlYmF0ZVJlY29yZExpc3QodGhpcy5wYWdlLCB0aGlzLnBhZ2VTaXplKTtcclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIHJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oXCJ1cGRhdGVSZXFSZWJhdGVSZWNvcmRMaXN0XCIsIHRoaXMudXBkYXRlUmVxUmViYXRlUmVjb3JkTGlzdCwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVuUmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vZmYoXCJ1cGRhdGVSZXFSZWJhdGVSZWNvcmRMaXN0XCIsIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVSZXFSZWJhdGVSZWNvcmRMaXN0KHJlY29yZERhdGEpIHtcclxuICAgICAgICB0aGlzLnJlY29yZCA9IHJlY29yZERhdGEuZGF0YTtcclxuICAgICAgICB0aGlzLnBhZ2VUb3RhbCA9IHJlY29yZERhdGEudG90YWxQYWdlO1xyXG4gICAgICAgIHRoaXMuTGFiX3RvdGFsUGFnZS5zdHJpbmcgPSByZWNvcmREYXRhLnRvdGFsUGFnZTtcclxuICAgICAgICB0aGlzLmluaXRVSSgpO1xyXG4gICAgICAgIHRoaXMubm9pdGVtLmFjdGl2ZSA9IHRoaXMucmVjb3JkLmxlbmd0aCA9PSAwO1xyXG4gICAgfSxcclxuICAgIGluaXRVSSgpIHtcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICB0aGlzLmNvbnRlbnQuZGVzdHJveUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5MYWJfQ3VyUGFnZS5zdHJpbmcgPSB0aGlzLnBhZ2U7XHJcbiAgICAgICAgbGV0IGxlbiA9IHRoaXMucmVjb3JkLmxlbmd0aDtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJwYWdlbGF5b3V0XCIpLmFjdGl2ZSA9IGxlbiA+IDA7XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwibm9UaGlua1wiKS5hY3RpdmUgPSBsZW4gPT0gMDtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJleHBsYWluXCIpLmFjdGl2ZSA9IGxlbiAhPSAwO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bl9wYWdldXBcIikuYWN0aXZlID0gbGVuICE9IDA7XHJcbiAgICAgICAgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuX3BhZ2Vkb3duXCIpLmFjdGl2ZSA9IGxlbiAhPSAwO1xyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlKCgpPT57XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLnJlY29yZFtpXSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZGl0ZW0pO1xyXG4gICAgICAgICAgICBub2RlLnBhcmVudCA9IHRoaXMuY29udGVudDtcclxuICAgICAgICAgICAgbm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBsZXQgdGltZVN0YW1wID0gbmV3IERhdGUodGhpcy5yZWNvcmRbaV0uY3JlYXRlVGltZSAqIDEwMDApO1xyXG4gICAgICAgICAgICBsZXQgc3RyVGltZSA9IGAke3RpbWVTdGFtcC5nZXRGdWxsWWVhcigpfS0ke3RpbWVTdGFtcC5nZXRNb250aCgpICsgMSA+PSAxMCA/IHRpbWVTdGFtcC5nZXRNb250aCgpICsgMSA6IFwiMFwiICsgKHRpbWVTdGFtcC5nZXRNb250aCgpICsgMSl9LSR7dGltZVN0YW1wLmdldERhdGUoKSA+PSAxMCA/IHRpbWVTdGFtcC5nZXREYXRlKCkgOiAnMCcgKyB0aW1lU3RhbXAuZ2V0RGF0ZSgpfWBcclxuICAgICAgICAgICAgc3RyVGltZSArPSBgIGBcclxuICAgICAgICAgICAgc3RyVGltZSArPSBgJHt0aW1lU3RhbXAuZ2V0SG91cnMoKSA+PSAxMCA/dGltZVN0YW1wLmdldEhvdXJzKCk6IFwiMFwiICsgdGltZVN0YW1wLmdldEhvdXJzKCl9OmBcclxuICAgICAgICAgICAgc3RyVGltZSArPSBgJHt0aW1lU3RhbXAuZ2V0TWludXRlcygpID49IDEwID90aW1lU3RhbXAuZ2V0TWludXRlcygpOiBcIjBcIiArIHRpbWVTdGFtcC5nZXRNaW51dGVzKCl9OmBcclxuICAgICAgICAgICAgc3RyVGltZSArPSBgJHt0aW1lU3RhbXAuZ2V0U2Vjb25kcygpID49IDEwID90aW1lU3RhbXAuZ2V0U2Vjb25kcygpOiBcIjBcIiArIHRpbWVTdGFtcC5nZXRTZWNvbmRzKCl9YFxyXG4gICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKFwidGltZVwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHN0clRpbWU7XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0eXBlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gc3RhdHVzW3RoaXMucmVjb3JkW2ldLnJlY2VpdmVUeXBlIC0gMV07XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZXRjb2luXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5jdXRGbG9hdCh0aGlzLnJlY29yZFtpXS5hbGxCZXR0aW5nKTtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcImNvaW5cIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLmN1dEZsb2F0KHRoaXMucmVjb3JkW2ldLm51bWJlcik7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zZXR0aW5nVGFibGVMYWJlbENvbG9yKG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjb2luXCIpKTtcclxuICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShcInN0YXR1c1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMucmVjb3JkW2ldLnN0YXRlRGVzO1xyXG5cclxuICAgICAgICAgICAgLy8gMO+8jOacqumihuWPlu+8mzHvvIzlt7Lpooblj5bjgIIy77yM5a6h5qC45Lit44CCM++8jOW3suaLkue7neOAgjEy77yM6L+H5pyf5L2c5bqfXHJcbiAgICAgICAgICAgIGxldCBjb2xvciA9IHRoaXMuc3RhdGVDb2xvclswXTtcclxuICAgICAgICAgICAgbGV0IHN0YXRlID0gdGhpcy5yZWNvcmRbaV0uc3RhdGU7XHJcbiAgICAgICAgICAgIHN3aXRjaChzdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IGNhc2UgNDogIC8vIOaIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gdGhpcy5zdGF0ZUNvbG9yWzFdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAyOiBjYXNlIDM6ICAvLyDlpITnkIbkuK1cclxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuc3RhdGVDb2xvclswXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgNTogY2FzZSA2OiBjYXNlIDEyOiAgLy8g5aSx6LSlXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB0aGlzLnN0YXRlQ29sb3JbMl07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlIDExOiAvLyBcclxuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IHRoaXMuc3RhdGVDb2xvclszXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzdGF0dXNcIikuY29sb3IgPSBjb2xvcjtcclxuXHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZ1wiKS5hY3RpdmUgPSBpICUgMiA9PSAxO1xyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgfSwwLjA4LGxlbi0xLDAuMyk7XHJcbiAgICB9LFxyXG4gICAgT25EZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMudW5SZWdpc3RlckV2ZW50KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQ2xpY2sobmFtZSwgbm9kZSkge1xyXG4gICAgICAgIHN3aXRjaCAobmFtZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX3BhZ2V1cFwiOiB0aGlzLnBhZ2V1cF9jbGljaygpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9wYWdlZG93blwiOiB0aGlzLnBhZ2Vkb3duX2NsaWNrKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBhZ2V1cF9jbGljaygpIHtcclxuICAgICAgICBpZiAodGhpcy5wYWdlIDw9IDEpIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2UtLTtcclxuICAgICAgICBnbEdhbWUudXNlci5SZXFSZWJhdGVSZWNvcmRMaXN0KHRoaXMucGFnZSwgdGhpcy5wYWdlU2l6ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBhZ2Vkb3duX2NsaWNrKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2UgPj0gdGhpcy5wYWdlVG90YWwpIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2UrKztcclxuICAgICAgICBnbEdhbWUudXNlci5SZXFSZWJhdGVSZWNvcmRMaXN0KHRoaXMucGFnZSwgdGhpcy5wYWdlU2l6ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5rWu54K55Z6L6L+Q566X5Y+W5L+p5L2NXHJcbiAgICBjdXRGbG9hdCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBOdW1iZXIodmFsdWUpLmRpdigxMDApLnRvRml4ZWQoMikudG9TdHJpbmcoKTtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIl19