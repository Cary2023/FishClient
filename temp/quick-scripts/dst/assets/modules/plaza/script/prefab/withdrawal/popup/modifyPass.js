
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/withdrawal/popup/modifyPass.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b37cdrHexZHn7jqwj5XW18C', 'modifyPass');
// modules/plaza/script/prefab/withdrawal/popup/modifyPass.js

"use strict";

glGame.baseclass.extend({
  properties: {
    phoneNumber: cc.EditBox,
    passWord: cc.EditBox,
    surePassWord: cc.EditBox,
    verificaCode: cc.EditBox,
    btn_sendCode: cc.Node
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.VerificaCD = 60;
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_close":
        this.remove();
        break;

      case "btn_sure":
        this.sure();
        break;

      case "btn_sendCode":
        this.sendCode();
        break;
    }
  },
  //设置60秒倒计时
  setCutDown: function setCutDown() {
    var _this = this;

    this.btn_sendCode.getComponent(cc.Button).interactable = false;
    this.btn_sendCode.getChildByName("time").active = true;
    this.btn_sendCode.getChildByName("tip").active = false;
    this.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1), cc.callFunc(function () {
      _this.VerificaCD--;
      _this.btn_sendCode.getChildByName("time").getComponent(cc.Label).string = "".concat(_this.VerificaCD, "\u79D2");

      if (_this.VerificaCD == 0) {
        _this.node.stopAllActions();

        _this.VerificaCD = 60;
        _this.btn_sendCode.getChildByName("time").active = false;
        _this.btn_sendCode.getChildByName("tip").active = true;
        _this.btn_sendCode.getComponent(cc.Button).interactable = true;
      }
    }))));
  },
  // 手机号码检查
  checkPhone: function checkPhone(acc) {
    if (!acc) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PHONENULL);
      return null;
    }

    var reg = /^\d{11}$/; //验证规则

    var isacc_matcher = reg.test(acc);

    if (!isacc_matcher) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PHONETYPE);
      pingf;
      return false;
    }

    return acc;
  },
  sendCode: function sendCode() {
    var _this2 = this;

    var phone = this.checkPhone(this.phoneNumber.string);
    if (!phone) return;
    var msg = {
      phone: phone,
      type: 11
    };
    glGame.gameNet.send_msg("http.ReqPostPhoneCode", msg, function (route, data) {
      glGame.panel.showTip("验证码发送成功");

      _this2.setCutDown();
    });
  },
  sure: function sure() {
    var _this3 = this;

    var psw = this.checkPassword(this.passWord.string);
    var confirm = this.checkPassword(this.passWord.string, this.surePassWord.string);
    var phone = this.checkPhone(this.phoneNumber.string);
    if (!psw) return;
    if (!confirm) return;
    if (!phone) return;
    if (this.verificaCode.string == "") return glGame.panel.showErrorTip(glGame.tips.COMMON.CODE_NULL);
    var reg = /^[0-9]{0,6}$/; //验证规则

    var verif = reg.test(this.verificaCode.string);

    if (!verif) {
      return glGame.panel.showErrorTip(glGame.tips.REGISTRATION.VERIFICA);
    }

    var msg = {
      pwd: md5(psw),
      phone: phone,
      type: 3,
      code: verif
    };
    glGame.gameNet.send_msg("http.ReqEditPwd", msg, function (route, data) {
      _this3.remove();

      glGame.panel.showTip("修改成功");
    });
  },
  // 密码检查
  checkPassword: function checkPassword(psw, confimpsw) {
    if (!psw) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.LOGPSWNULL);
      return null;
    }

    if (psw.length < 4) {
      glGame.panel.showErrorTip(glGame.tips.EXCHANGE.PSWLENGTH);
      return false;
    }

    if (!/\w$/.test(psw)) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWWRONGFUL);
      return null;
    }

    if (confimpsw == null) return psw;

    if (!confimpsw || psw !== confimpsw) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWCOFAIL);
      return null;
    }

    return psw;
  },
  OnDestroy: function OnDestroy() {} // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFx3aXRoZHJhd2FsXFxwb3B1cFxcbW9kaWZ5UGFzcy5qcyJdLCJuYW1lcyI6WyJnbEdhbWUiLCJiYXNlY2xhc3MiLCJleHRlbmQiLCJwcm9wZXJ0aWVzIiwicGhvbmVOdW1iZXIiLCJjYyIsIkVkaXRCb3giLCJwYXNzV29yZCIsInN1cmVQYXNzV29yZCIsInZlcmlmaWNhQ29kZSIsImJ0bl9zZW5kQ29kZSIsIk5vZGUiLCJvbkxvYWQiLCJWZXJpZmljYUNEIiwib25DbGljayIsIm5hbWUiLCJub2RlIiwicmVtb3ZlIiwic3VyZSIsInNlbmRDb2RlIiwic2V0Q3V0RG93biIsImdldENvbXBvbmVudCIsIkJ1dHRvbiIsImludGVyYWN0YWJsZSIsImdldENoaWxkQnlOYW1lIiwiYWN0aXZlIiwicnVuQWN0aW9uIiwicmVwZWF0Rm9yZXZlciIsInNlcXVlbmNlIiwiZGVsYXlUaW1lIiwiY2FsbEZ1bmMiLCJMYWJlbCIsInN0cmluZyIsInN0b3BBbGxBY3Rpb25zIiwiY2hlY2tQaG9uZSIsImFjYyIsInBhbmVsIiwic2hvd0Vycm9yVGlwIiwidGlwcyIsIlJFR0lTVFJBVElPTiIsIlBIT05FTlVMTCIsInJlZyIsImlzYWNjX21hdGNoZXIiLCJ0ZXN0IiwiUEhPTkVUWVBFIiwicGluZ2YiLCJwaG9uZSIsIm1zZyIsInR5cGUiLCJnYW1lTmV0Iiwic2VuZF9tc2ciLCJyb3V0ZSIsImRhdGEiLCJzaG93VGlwIiwicHN3IiwiY2hlY2tQYXNzd29yZCIsImNvbmZpcm0iLCJDT01NT04iLCJDT0RFX05VTEwiLCJ2ZXJpZiIsIlZFUklGSUNBIiwicHdkIiwibWQ1IiwiY29kZSIsImNvbmZpbXBzdyIsIkxPR1BTV05VTEwiLCJsZW5ndGgiLCJFWENIQU5HRSIsIlBTV0xFTkdUSCIsIlBTV1dST05HRlVMIiwiUFNXQ09GQUlMIiwiT25EZXN0cm95Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztB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YUMsWUFBYixDQUEwQnJDLE1BQU0sQ0FBQ3NDLElBQVAsQ0FBWUMsWUFBWixDQUF5QjBCLFVBQW5EO0FBQ0EsYUFBTyxJQUFQO0FBQ0g7O0FBQ0QsUUFBSVgsR0FBRyxDQUFDWSxNQUFKLEdBQWEsQ0FBakIsRUFBb0I7QUFDaEJsRSxNQUFBQSxNQUFNLENBQUNvQyxLQUFQLENBQWFDLFlBQWIsQ0FBMEJyQyxNQUFNLENBQUNzQyxJQUFQLENBQVk2QixRQUFaLENBQXFCQyxTQUEvQztBQUNBLGFBQU8sS0FBUDtBQUNIOztBQUNELFFBQUksQ0FBQyxNQUFNekIsSUFBTixDQUFXVyxHQUFYLENBQUwsRUFBc0I7QUFDbEJ0RCxNQUFBQSxNQUFNLENBQUNvQyxLQUFQLENBQWFDLFlBQWIsQ0FBMEJyQyxNQUFNLENBQUNzQyxJQUFQLENBQVlDLFlBQVosQ0FBeUI4QixXQUFuRDtBQUNBLGFBQU8sSUFBUDtBQUNIOztBQUNELFFBQUlMLFNBQVMsSUFBSSxJQUFqQixFQUF1QixPQUFPVixHQUFQOztBQUN2QixRQUFJLENBQUNVLFNBQUQsSUFBY1YsR0FBRyxLQUFLVSxTQUExQixFQUFxQztBQUNqQ2hFLE1BQUFBLE1BQU0sQ0FBQ29DLEtBQVAsQ0FBYUMsWUFBYixDQUEwQnJDLE1BQU0sQ0FBQ3NDLElBQVAsQ0FBWUMsWUFBWixDQUF5QitCLFNBQW5EO0FBQ0EsYUFBTyxJQUFQO0FBQ0g7O0FBQ0QsV0FBT2hCLEdBQVA7QUFDSCxHQWxIbUI7QUFtSHBCaUIsRUFBQUEsU0FuSG9CLHVCQW1IUixDQUNYLENBcEhtQixDQXFIcEI7O0FBckhvQixDQUF4QiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IGNjLkVkaXRCb3gsXHJcbiAgICAgICAgcGFzc1dvcmQ6IGNjLkVkaXRCb3gsXHJcbiAgICAgICAgc3VyZVBhc3NXb3JkOiBjYy5FZGl0Qm94LFxyXG4gICAgICAgIHZlcmlmaWNhQ29kZTogY2MuRWRpdEJveCxcclxuICAgICAgICBidG5fc2VuZENvZGU6IGNjLk5vZGVcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTElGRS1DWUNMRSBDQUxMQkFDS1M6XHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIHRoaXMuVmVyaWZpY2FDRCA9IDYwO1xyXG4gICAgfSxcclxuICAgIG9uQ2xpY2sobmFtZSwgbm9kZSkge1xyXG4gICAgICAgIHN3aXRjaCAobmFtZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2Nsb3NlXCI6IHRoaXMucmVtb3ZlKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX3N1cmVcIjogdGhpcy5zdXJlKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX3NlbmRDb2RlXCI6IHRoaXMuc2VuZENvZGUoKTsgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v6K6+572uNjDnp5LlgJLorqHml7ZcclxuICAgIHNldEN1dERvd24oKSB7XHJcbiAgICAgICAgdGhpcy5idG5fc2VuZENvZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5idG5fc2VuZENvZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aW1lXCIpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5idG5fc2VuZENvZGUuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXBcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5yZXBlYXRGb3JldmVyKGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICBjYy5kZWxheVRpbWUoMSksXHJcbiAgICAgICAgICAgIGNjLmNhbGxGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuVmVyaWZpY2FDRC0tXHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bl9zZW5kQ29kZS5nZXRDaGlsZEJ5TmFtZShcInRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBgJHt0aGlzLlZlcmlmaWNhQ0R956eSYDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLlZlcmlmaWNhQ0QgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuVmVyaWZpY2FDRCA9IDYwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuX3NlbmRDb2RlLmdldENoaWxkQnlOYW1lKFwidGltZVwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0bl9zZW5kQ29kZS5nZXRDaGlsZEJ5TmFtZShcInRpcFwiKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuX3NlbmRDb2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKVxyXG4gICAgICAgICkpXHJcbiAgICB9LFxyXG4gICAgLy8g5omL5py65Y+356CB5qOA5p+lXHJcbiAgICBjaGVja1Bob25lKGFjYykge1xyXG4gICAgICAgIGlmICghYWNjKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuUkVHSVNUUkFUSU9OLlBIT05FTlVMTCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHJlZyA9IC9eXFxkezExfSQvOyAvL+mqjOivgeinhOWImVxyXG4gICAgICAgIGxldCBpc2FjY19tYXRjaGVyID0gcmVnLnRlc3QoYWNjKTtcclxuICAgICAgICBpZiAoIWlzYWNjX21hdGNoZXIpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uUEhPTkVUWVBFKTsgcGluZ2ZcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWNjO1xyXG4gICAgfSxcclxuICAgIHNlbmRDb2RlKCkge1xyXG4gICAgICAgIGxldCBwaG9uZSA9IHRoaXMuY2hlY2tQaG9uZSh0aGlzLnBob25lTnVtYmVyLnN0cmluZylcclxuICAgICAgICBpZiAoIXBob25lKSByZXR1cm47XHJcbiAgICAgICAgbGV0IG1zZyA9IHtcclxuICAgICAgICAgICAgcGhvbmU6IHBob25lLFxyXG4gICAgICAgICAgICB0eXBlOiAxMSxcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2xHYW1lLmdhbWVOZXQuc2VuZF9tc2coXCJodHRwLlJlcVBvc3RQaG9uZUNvZGVcIiwgbXNnLCAocm91dGUsIGRhdGEpID0+IHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dUaXAoXCLpqozor4HnoIHlj5HpgIHmiJDlip9cIik7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0Q3V0RG93bigpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgc3VyZSgpIHtcclxuICAgICAgICBsZXQgcHN3ID0gdGhpcy5jaGVja1Bhc3N3b3JkKHRoaXMucGFzc1dvcmQuc3RyaW5nKVxyXG4gICAgICAgIGxldCBjb25maXJtID0gdGhpcy5jaGVja1Bhc3N3b3JkKHRoaXMucGFzc1dvcmQuc3RyaW5nLCB0aGlzLnN1cmVQYXNzV29yZC5zdHJpbmcpXHJcbiAgICAgICAgbGV0IHBob25lID0gdGhpcy5jaGVja1Bob25lKHRoaXMucGhvbmVOdW1iZXIuc3RyaW5nKVxyXG4gICAgICAgIGlmICghcHN3KSByZXR1cm47XHJcbiAgICAgICAgaWYgKCFjb25maXJtKSByZXR1cm47XHJcbiAgICAgICAgaWYgKCFwaG9uZSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh0aGlzLnZlcmlmaWNhQ29kZS5zdHJpbmcgPT0gXCJcIikgcmV0dXJuIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuQ09NTU9OLkNPREVfTlVMTCk7XHJcbiAgICAgICAgbGV0IHJlZyA9IC9eWzAtOV17MCw2fSQvOy8v6aqM6K+B6KeE5YiZXHJcbiAgICAgICAgbGV0IHZlcmlmID0gcmVnLnRlc3QodGhpcy52ZXJpZmljYUNvZGUuc3RyaW5nKTtcclxuICAgICAgICBpZiAoIXZlcmlmKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnbEdhbWUucGFuZWwuc2hvd0Vycm9yVGlwKGdsR2FtZS50aXBzLlJFR0lTVFJBVElPTi5WRVJJRklDQSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBtc2cgPSB7XHJcbiAgICAgICAgICAgIHB3ZDogbWQ1KHBzdyksXHJcbiAgICAgICAgICAgIHBob25lOiBwaG9uZSxcclxuICAgICAgICAgICAgdHlwZTogMyxcclxuICAgICAgICAgICAgY29kZTogdmVyaWYsXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdsR2FtZS5nYW1lTmV0LnNlbmRfbXNnKFwiaHR0cC5SZXFFZGl0UHdkXCIsIG1zZywgKHJvdXRlLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93VGlwKFwi5L+u5pS55oiQ5YqfXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgLy8g5a+G56CB5qOA5p+lXHJcbiAgICBjaGVja1Bhc3N3b3JkKHBzdywgY29uZmltcHN3KSB7XHJcbiAgICAgICAgaWYgKCFwc3cpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uTE9HUFNXTlVMTCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHN3Lmxlbmd0aCA8IDQpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5FWENIQU5HRS5QU1dMRU5HVEgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghL1xcdyQvLnRlc3QocHN3KSkge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0Vycm9yVGlwKGdsR2FtZS50aXBzLlJFR0lTVFJBVElPTi5QU1dXUk9OR0ZVTCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmltcHN3ID09IG51bGwpIHJldHVybiBwc3c7XHJcbiAgICAgICAgaWYgKCFjb25maW1wc3cgfHwgcHN3ICE9PSBjb25maW1wc3cpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uUFNXQ09GQUlMKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwc3c7XHJcbiAgICB9LFxyXG4gICAgT25EZXN0cm95KCkge1xyXG4gICAgfVxyXG4gICAgLy8gdXBkYXRlIChkdCkge30sXHJcbn0pO1xyXG4iXX0=