
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/backWater/porpor_complex.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'fbeb7fOe0xCn5rUB2Ene/h2', 'porpor_complex');
// modules/plaza/script/prefab/backWater/porpor_complex.js

"use strict";

/**
 * 返水比例
 */
// key 为控件名称， value 为与服务端约定好的数组名称
var GAME_VARIETY_TAB = {
  tabs_official: -1,
  //官方平台
  tabs_qipai: 1,
  //棋牌
  tabs_jieji: 3,
  //街机
  tabs_buyu: 2,
  //捕鱼
  tabs_shixun: 4,
  //视讯
  tabs_tiyu: 6,
  //体育
  tabs_caipiao: 5,
  //彩票
  tabs_dianjing: 7 //电竞

};
glGame.baseclass.extend({
  properties: {
    typeNodeList: cc.Node,
    //
    vip_page: cc.Node,
    vip_pageup: cc.Node,
    vip_rightnext: cc.Node,
    vip_level: cc.Label,
    bet_page: cc.Node,
    bet_pageup: cc.Node,
    bet_pagenext: cc.Node,
    bet_scope: cc.Label,
    ratecontent: cc.Node,
    rateitem: cc.Node
  },
  onLoad: function onLoad() {
    this.registerEvent();
    this.vipLevel = -1;
    this.gradeId = 0; // vip等级id或会员层级id

    this.vipMax = 0;
    this.pageIndex = 0;
    this.betNumMax = 0;
    this.config = null;
    this.gameOrPlatMap = null;
    this.type = -1;
    this.initTopToggle();
    this.switchPlatform(-1);
  },
  registerEvent: function registerEvent() {
    glGame.emitter.on("rebateConfigList", this.rebateConfigList, this);
  },
  unRegisterEvent: function unRegisterEvent() {
    glGame.emitter.off("rebateConfigList", this);
  },
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  },
  switchPlatform: function switchPlatform(type) {
    this.type = type;
    this.ReqRebateConfigList(type);
  },
  ReqRebateConfigList: function ReqRebateConfigList(type) {
    glGame.user.ReqRebateConfigList({
      accountId: glGame.user.userID,
      type: type
    });
  },
  initTopToggle: function initTopToggle() {
    // 获取配表里面的数据牌区分是否开启分类
    var gameTypeList = glGame.gamelistcfg.get("gameDisplayTypeList");

    if (!gameTypeList) {
      return;
    }

    for (var tabName in GAME_VARIETY_TAB) {
      var id = GAME_VARIETY_TAB[tabName];
      this.typeNodeList.getChildByName(tabName).active = this.isGameOpen(gameTypeList, id);
    }

    this.typeNodeList.getChildByName("tabs_official").active = true;
  },
  rebateConfigList: function rebateConfigList() {
    this.rebateConfigList = glGame.user.get("rebateConfigList");
    this.gameOrPlatMap = this.rebateConfigList.gameOrPlatMap;
    this.gradeId = this.rebateConfigList.gradeId;
    var vipId = this.rebateConfigList.vipId;
    var data = this.rebateConfigList.data;

    if (this.vipLevel == -1) {
      for (var i = 0; i < data.length; i++) {
        if (data[i].groupId == vipId) {
          this.vipLevel = i;
          break;
        }
      }
    }

    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  initpageView: function initpageView() {
    if (Object.keys(this.config) == 0) {
      this.vip_page.active = false;
      this.bet_page.active = false;
      return;
    } else {
      this.vip_page.active = this.rebateConfigList.modeType == "vip";
      this.bet_page.active = true;
    }

    var keys = Object.keys(this.config); //子游戏ID数组

    var gameporpor = this.config[keys[0]]; //子游戏的数据

    var gameKeys = Object.keys(gameporpor); //区间的keys

    if (this.vip_page.active) this.vip_level.string = this.rebateConfigList.data[this.vipLevel].name;

    if (this.pageIndex == gameKeys.length - 1) {
      this.bet_scope.string = "".concat(this.cutFloat(gameKeys[this.pageIndex]), "\u4EE5\u4E0A");
    } else {
      this.bet_scope.string = "".concat(this.cutFloat(gameKeys[this.pageIndex]), "~").concat(this.cutFloat(gameKeys[this.pageIndex + 1]));
    }
  },
  initMidUI: function initMidUI() {
    var config = this.config;
    this.ratecontent.removeAllChildren();
    var gamekeys = Object.keys(config);
    var itemCount = 0;
    var item; //一个item包含3个子游戏

    var index = 0;

    for (var i = 0; i < gamekeys.length; i++) {
      if (!this.gameOrPlatMap[Number(gamekeys[i])]) {
        continue;
      }

      if (index % 3 == 0) {
        item = cc.instantiate(this.rateitem);
        item.parent = this.ratecontent;
        item.active = false;
        item.getChildByName("bg").active = itemCount % 2 == 0;
        itemCount += 1;
      }

      var childrenindex = index % 3 + 1; //节点里面有bg

      var gameitem = item.getChildByName("gamename".concat(childrenindex));
      gameitem.active = true;
      gameitem.getComponent(cc.Label).string = this.gameOrPlatMap[Number(gamekeys[i])]; //游戏名

      var gamedata = config[gamekeys[i]];
      var keys = Object.keys(gamedata);
      gameitem.getChildByName("porpor_lab").getComponent(cc.Label).string = "".concat(Number(gamedata[keys[this.pageIndex]]).div(100).toFixed(2), "%");
      index++;
    }

    glGame.panel.showEffectNode(this, this.ratecontent, 0.02, true);
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "vip_left":
        this.vipleft_cb();
        break;

      case "vip_right":
        this.vipright_cb();
        break;

      case "bet_left":
        this.betleft_cb();
        break;

      case "bet_right":
        this.betright_cb();
        break;

      default:
        if (name.indexOf("tabs_") > -1) this.selectClick(name);
        break;
    }
  },
  selectClick: function selectClick(name) {
    this.pageIndex = 0;
    this.switchPlatform(GAME_VARIETY_TAB[name]);
  },
  betleft_cb: function betleft_cb() {
    if (this.pageIndex == 0) return;
    this.pageIndex--;
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  betright_cb: function betright_cb() {
    if (this.pageIndex == this.betNumMax - 1) return;
    this.pageIndex++;
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  vipleft_cb: function vipleft_cb() {
    if (this.vipLevel <= 0) return;
    this.vipLevel--;
    this.pageIndex = 0;
    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  vipright_cb: function vipright_cb() {
    if (this.vipLevel == this.vipMax) return;
    this.vipLevel++;
    this.pageIndex = 0;
    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  chengeBtnState: function chengeBtnState() {
    this.vip_pageup.active = this.vipLevel != 0;
    this.vip_rightnext.active = this.vipLevel != this.vipMax - 1;
    this.bet_pageup.active = this.pageIndex != 0;
    this.bet_pagenext.active = this.pageIndex != this.betNumMax - 1;
  },
  setConfig: function setConfig() {
    this.bet_page.active = true;

    if (this.rebateConfigList.modeType == "vip") {
      this.vipMax = Object.keys(this.rebateConfigList.data).length;
      this.config = this.rebateConfigList.data[this.vipLevel].config;
      var keys = Object.keys(this.config); //子游戏ID数组

      var gameporpor = this.config[keys[0]]; //子游戏的数据

      var gameKeys = Object.keys(gameporpor); //区间的keys

      this.betNumMax = gameKeys.length;
      this.vip_page.active = true;
      this.bet_page.x = 224;
    } else {
      this.config = this.rebateConfigList.data.config;

      var _keys = Object.keys(this.config); //子游戏ID数组


      var _gameporpor = this.config[_keys[0]]; //子游戏的数据

      var _gameKeys = Object.keys(_gameporpor); //区间的keys


      this.betNumMax = _gameKeys.length;
      this.vip_page.active = false;
      this.bet_page.x = 0;
    }
  },
  // 游戏是否开启
  isGameOpen: function isGameOpen(typeList, id) {
    var count = typeList.length;

    for (var i = 0; i < count; i++) {
      if (typeList[i].id == id) {
        return true;
      }
    }

    return false;
  },
  getFloat: function getFloat(value) {
    return Number(value).div(100).toFixed(4);
  },
  //浮点型运算取俩位
  cutFloat: function cutFloat(value) {
    return Number(value).div(100).toString();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxiYWNrV2F0ZXJcXHBvcnBvcl9jb21wbGV4LmpzIl0sIm5hbWVzIjpbIkdBTUVfVkFSSUVUWV9UQUIiLCJ0YWJzX29mZmljaWFsIiwidGFic19xaXBhaSIsInRhYnNfamllamkiLCJ0YWJzX2J1eXUiLCJ0YWJzX3NoaXh1biIsInRhYnNfdGl5dSIsInRhYnNfY2FpcGlhbyIsInRhYnNfZGlhbmppbmciLCJnbEdhbWUiLCJiYXNlY2xhc3MiLCJleHRlbmQiLCJwcm9wZXJ0aWVzIiwidHlwZU5vZGVMaXN0IiwiY2MiLCJOb2RlIiwidmlwX3BhZ2UiLCJ2aXBfcGFnZXVwIiwidmlwX3JpZ2h0bmV4dCIsInZpcF9sZXZlbCIsIkxhYmVsIiwiYmV0X3BhZ2UiLCJiZXRfcGFnZXVwIiwiYmV0X3BhZ2VuZXh0IiwiYmV0X3Njb3BlIiwicmF0ZWNvbnRlbnQiLCJyYXRlaXRlbSIsIm9uTG9hZCIsInJlZ2lzdGVyRXZlbnQiLCJ2aXBMZXZlbCIsImdyYWRlSWQiLCJ2aXBNYXgiLCJwYWdlSW5kZXgiLCJiZXROdW1NYXgiLCJjb25maWciLCJnYW1lT3JQbGF0TWFwIiwidHlwZSIsImluaXRUb3BUb2dnbGUiLCJzd2l0Y2hQbGF0Zm9ybSIsImVtaXR0ZXIiLCJvbiIsInJlYmF0ZUNvbmZpZ0xpc3QiLCJ1blJlZ2lzdGVyRXZlbnQiLCJvZmYiLCJPbkRlc3Ryb3kiLCJSZXFSZWJhdGVDb25maWdMaXN0IiwidXNlciIsImFjY291bnRJZCIsInVzZXJJRCIsImdhbWVUeXBlTGlzdCIsImdhbWVsaXN0Y2ZnIiwiZ2V0IiwidGFiTmFtZSIsImlkIiwiZ2V0Q2hpbGRCeU5hbWUiLCJhY3RpdmUiLCJpc0dhbWVPcGVuIiwidmlwSWQiLCJkYXRhIiwiaSIsImxlbmd0aCIsImdyb3VwSWQiLCJzZXRDb25maWciLCJpbml0cGFnZVZpZXciLCJpbml0TWlkVUkiLCJjaGVuZ2VCdG5TdGF0ZSIsIk9iamVjdCIsImtleXMiLCJtb2RlVHlwZSIsImdhbWVwb3Jwb3IiLCJnYW1lS2V5cyIsInN0cmluZyIsIm5hbWUiLCJjdXRGbG9hdCIsInJlbW92ZUFsbENoaWxkcmVuIiwiZ2FtZWtleXMiLCJpdGVtQ291bnQiLCJpdGVtIiwiaW5kZXgiLCJOdW1iZXIiLCJpbnN0YW50aWF0ZSIsInBhcmVudCIsImNoaWxkcmVuaW5kZXgiLCJnYW1laXRlbSIsImdldENvbXBvbmVudCIsImdhbWVkYXRhIiwiZGl2IiwidG9GaXhlZCIsInBhbmVsIiwic2hvd0VmZmVjdE5vZGUiLCJvbkNsaWNrIiwibm9kZSIsInZpcGxlZnRfY2IiLCJ2aXByaWdodF9jYiIsImJldGxlZnRfY2IiLCJiZXRyaWdodF9jYiIsImluZGV4T2YiLCJzZWxlY3RDbGljayIsIngiLCJ0eXBlTGlzdCIsImNvdW50IiwiZ2V0RmxvYXQiLCJ2YWx1ZSIsInRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7QUFJQTtBQUNBLElBQU1BLGdCQUFnQixHQUFHO0FBQ3JCQyxFQUFBQSxhQUFhLEVBQUUsQ0FBQyxDQURLO0FBQ087QUFDNUJDLEVBQUFBLFVBQVUsRUFBRSxDQUZTO0FBRU87QUFDNUJDLEVBQUFBLFVBQVUsRUFBRSxDQUhTO0FBR087QUFDNUJDLEVBQUFBLFNBQVMsRUFBRSxDQUpVO0FBSU87QUFDNUJDLEVBQUFBLFdBQVcsRUFBRSxDQUxRO0FBS087QUFDNUJDLEVBQUFBLFNBQVMsRUFBRSxDQU5VO0FBTU87QUFDNUJDLEVBQUFBLFlBQVksRUFBRSxDQVBPO0FBT087QUFDNUJDLEVBQUFBLGFBQWEsRUFBRSxDQVJNLENBUU87O0FBUlAsQ0FBekI7QUFXQUMsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QjtBQUNwQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFlBQVksRUFBRUMsRUFBRSxDQUFDQyxJQURUO0FBRVI7QUFDQUMsSUFBQUEsUUFBUSxFQUFFRixFQUFFLENBQUNDLElBSEw7QUFJUkUsSUFB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biAqL1xyXG5cclxuLy8ga2V5IOS4uuaOp+S7tuWQjeensO+8jCB2YWx1ZSDkuLrkuI7mnI3liqHnq6/nuqblrprlpb3nmoTmlbDnu4TlkI3np7BcclxuY29uc3QgR0FNRV9WQVJJRVRZX1RBQiA9IHtcclxuICAgIHRhYnNfb2ZmaWNpYWw6IC0xLCAgICAgICAgICAvL+WumOaWueW5s+WPsFxyXG4gICAgdGFic19xaXBhaTogMSwgICAgICAgICAgICAgIC8v5qOL54mMXHJcbiAgICB0YWJzX2ppZWppOiAzLCAgICAgICAgICAgICAgLy/ooZfmnLpcclxuICAgIHRhYnNfYnV5dTogMiwgICAgICAgICAgICAgICAvL+aNlemxvFxyXG4gICAgdGFic19zaGl4dW46IDQsICAgICAgICAgICAgIC8v6KeG6K6vXHJcbiAgICB0YWJzX3RpeXU6IDYsICAgICAgICAgICAgICAgLy/kvZPogrJcclxuICAgIHRhYnNfY2FpcGlhbzogNSwgICAgICAgICAgICAvL+W9qeelqFxyXG4gICAgdGFic19kaWFuamluZzogNywgICAgICAgICAgIC8v55S156ueXHJcbn1cclxuXHJcbmdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICB0eXBlTm9kZUxpc3Q6IGNjLk5vZGUsXHJcbiAgICAgICAgLy9cclxuICAgICAgICB2aXBfcGFnZTogY2MuTm9kZSxcclxuICAgICAgICB2aXBfcGFnZXVwOiBjYy5Ob2RlLFxyXG4gICAgICAgIHZpcF9yaWdodG5leHQ6IGNjLk5vZGUsXHJcbiAgICAgICAgdmlwX2xldmVsOiBjYy5MYWJlbCxcclxuXHJcbiAgICAgICAgYmV0X3BhZ2U6IGNjLk5vZGUsXHJcbiAgICAgICAgYmV0X3BhZ2V1cDogY2MuTm9kZSxcclxuICAgICAgICBiZXRfcGFnZW5leHQ6IGNjLk5vZGUsXHJcbiAgICAgICAgYmV0X3Njb3BlOiBjYy5MYWJlbCxcclxuXHJcbiAgICAgICAgcmF0ZWNvbnRlbnQ6IGNjLk5vZGUsXHJcbiAgICAgICAgcmF0ZWl0ZW06IGNjLk5vZGUsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnZpcExldmVsID0gLTE7XHJcbiAgICAgICAgdGhpcy5ncmFkZUlkID0gMDsgICAgICAvLyB2aXDnrYnnuqdpZOaIluS8muWRmOWxgue6p2lkXHJcbiAgICAgICAgdGhpcy52aXBNYXggPSAwO1xyXG4gICAgICAgIHRoaXMucGFnZUluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmJldE51bU1heCA9IDA7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZ2FtZU9yUGxhdE1hcCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50eXBlID0gLTE7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdFRvcFRvZ2dsZSgpO1xyXG4gICAgICAgIHRoaXMuc3dpdGNoUGxhdGZvcm0oLTEpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgcmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihcInJlYmF0ZUNvbmZpZ0xpc3RcIiwgdGhpcy5yZWJhdGVDb25maWdMaXN0LCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgdW5SZWdpc3RlckV2ZW50KCkge1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcInJlYmF0ZUNvbmZpZ0xpc3RcIiwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIE9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLnVuUmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzd2l0Y2hQbGF0Zm9ybSh0eXBlKSB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLlJlcVJlYmF0ZUNvbmZpZ0xpc3QodHlwZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIFJlcVJlYmF0ZUNvbmZpZ0xpc3QodHlwZSkge1xyXG4gICAgICAgIGdsR2FtZS51c2VyLlJlcVJlYmF0ZUNvbmZpZ0xpc3Qoe1xyXG4gICAgICAgICAgICBhY2NvdW50SWQ6IGdsR2FtZS51c2VyLnVzZXJJRCxcclxuICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgaW5pdFRvcFRvZ2dsZSgpIHtcclxuICAgICAgICAvLyDojrflj5bphY3ooajph4zpnaLnmoTmlbDmja7niYzljLrliIbmmK/lkKblvIDlkK/liIbnsbtcclxuICAgICAgICBsZXQgZ2FtZVR5cGVMaXN0ID0gZ2xHYW1lLmdhbWVsaXN0Y2ZnLmdldChcImdhbWVEaXNwbGF5VHlwZUxpc3RcIik7XHJcbiAgICAgICAgaWYoIWdhbWVUeXBlTGlzdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IobGV0IHRhYk5hbWUgaW4gR0FNRV9WQVJJRVRZX1RBQikge1xyXG4gICAgICAgICAgICBsZXQgaWQgPSBHQU1FX1ZBUklFVFlfVEFCW3RhYk5hbWVdO1xyXG4gICAgICAgICAgICB0aGlzLnR5cGVOb2RlTGlzdC5nZXRDaGlsZEJ5TmFtZSh0YWJOYW1lKS5hY3RpdmUgPSB0aGlzLmlzR2FtZU9wZW4oZ2FtZVR5cGVMaXN0LCBpZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnR5cGVOb2RlTGlzdC5nZXRDaGlsZEJ5TmFtZShcInRhYnNfb2ZmaWNpYWxcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG4gICAgcmViYXRlQ29uZmlnTGlzdCgpIHtcclxuICAgICAgICB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QgPSBnbEdhbWUudXNlci5nZXQoXCJyZWJhdGVDb25maWdMaXN0XCIpO1xyXG4gICAgICAgIHRoaXMuZ2FtZU9yUGxhdE1hcCA9IHRoaXMucmViYXRlQ29uZmlnTGlzdC5nYW1lT3JQbGF0TWFwO1xyXG4gICAgICAgIHRoaXMuZ3JhZGVJZCA9IHRoaXMucmViYXRlQ29uZmlnTGlzdC5ncmFkZUlkO1xyXG4gICAgICAgIGxldCB2aXBJZCA9IHRoaXMucmViYXRlQ29uZmlnTGlzdC52aXBJZDtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMucmViYXRlQ29uZmlnTGlzdC5kYXRhO1xyXG4gICAgICAgIGlmKHRoaXMudmlwTGV2ZWwgPT0gLTEpIHtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGFbaV0uZ3JvdXBJZCA9PSB2aXBJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlwTGV2ZWwgPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnNldENvbmZpZygpO1xyXG4gICAgICAgIHRoaXMuaW5pdHBhZ2VWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWlkVUkoKTtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRwYWdlVmlldygpIHtcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5jb25maWcpID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy52aXBfcGFnZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5iZXRfcGFnZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlwX3BhZ2UuYWN0aXZlID0gdGhpcy5yZWJhdGVDb25maWdMaXN0Lm1vZGVUeXBlID09IFwidmlwXCI7XHJcbiAgICAgICAgICAgIHRoaXMuYmV0X3BhZ2UuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb25maWcpICAgICAgICAgICAgICAgICAvL+WtkOa4uOaIj0lE5pWw57uEXHJcbiAgICAgICAgbGV0IGdhbWVwb3Jwb3IgPSB0aGlzLmNvbmZpZ1trZXlzWzBdXTsgICAgICAgICAgICAgIC8v5a2Q5ri45oiP55qE5pWw5o2uXHJcbiAgICAgICAgbGV0IGdhbWVLZXlzID0gT2JqZWN0LmtleXMoZ2FtZXBvcnBvcik7ICAgICAgICAgICAgIC8v5Yy66Ze055qEa2V5c1xyXG5cclxuICAgICAgICBpZiAodGhpcy52aXBfcGFnZS5hY3RpdmUpIHRoaXMudmlwX2xldmVsLnN0cmluZyA9IHRoaXMucmViYXRlQ29uZmlnTGlzdC5kYXRhW3RoaXMudmlwTGV2ZWxdLm5hbWU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VJbmRleCA9PSBnYW1lS2V5cy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmV0X3Njb3BlLnN0cmluZyA9IGAke3RoaXMuY3V0RmxvYXQoZ2FtZUtleXNbdGhpcy5wYWdlSW5kZXhdKX3ku6XkuIpgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5iZXRfc2NvcGUuc3RyaW5nID0gYCR7dGhpcy5jdXRGbG9hdChnYW1lS2V5c1t0aGlzLnBhZ2VJbmRleF0pfX4ke3RoaXMuY3V0RmxvYXQoZ2FtZUtleXNbdGhpcy5wYWdlSW5kZXggKyAxXSl9YFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdE1pZFVJKCkge1xyXG4gICAgICAgIGxldCBjb25maWcgPSB0aGlzLmNvbmZpZztcclxuICAgICAgICB0aGlzLnJhdGVjb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgbGV0IGdhbWVrZXlzID0gT2JqZWN0LmtleXMoY29uZmlnKVxyXG4gICAgICAgIGxldCBpdGVtQ291bnQgPSAwO1xyXG4gICAgICAgIGxldCBpdGVtOyAgICAgICAgICAgICAgIC8v5LiA5LiqaXRlbeWMheWQqzPkuKrlrZDmuLjmiI9cclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2FtZWtleXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuZ2FtZU9yUGxhdE1hcFtOdW1iZXIoZ2FtZWtleXNbaV0pXSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChpbmRleCAlIDMgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmF0ZWl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5wYXJlbnQgPSB0aGlzLnJhdGVjb250ZW50O1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uZ2V0Q2hpbGRCeU5hbWUoXCJiZ1wiKS5hY3RpdmUgPSBpdGVtQ291bnQgJSAyID09IDBcclxuICAgICAgICAgICAgICAgIGl0ZW1Db3VudCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgY2hpbGRyZW5pbmRleCA9IChpbmRleCAlIDMpICsgMTsgICAgLy/oioLngrnph4zpnaLmnIliZ1xyXG4gICAgICAgICAgICBsZXQgZ2FtZWl0ZW0gPSBpdGVtLmdldENoaWxkQnlOYW1lKGBnYW1lbmFtZSR7Y2hpbGRyZW5pbmRleH1gKVxyXG4gICAgICAgICAgICBnYW1laXRlbS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBnYW1laXRlbS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMuZ2FtZU9yUGxhdE1hcFtOdW1iZXIoZ2FtZWtleXNbaV0pXTsgLy/muLjmiI/lkI1cclxuXHJcbiAgICAgICAgICAgIGxldCBnYW1lZGF0YSA9IGNvbmZpZ1tnYW1la2V5c1tpXV07XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMoZ2FtZWRhdGEpO1xyXG4gICAgICAgICAgICBnYW1laXRlbS5nZXRDaGlsZEJ5TmFtZShcInBvcnBvcl9sYWJcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBgJHtOdW1iZXIoZ2FtZWRhdGFba2V5c1t0aGlzLnBhZ2VJbmRleF1dKS5kaXYoMTAwKS50b0ZpeGVkKDIpfSVgO1xyXG4gICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0VmZmVjdE5vZGUodGhpcyx0aGlzLnJhdGVjb250ZW50LDAuMDIsdHJ1ZSk7XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIG9uQ2xpY2sobmFtZSwgbm9kZSkge1xyXG4gICAgICAgIHN3aXRjaCAobmFtZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwidmlwX2xlZnRcIjogdGhpcy52aXBsZWZ0X2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwidmlwX3JpZ2h0XCI6IHRoaXMudmlwcmlnaHRfY2IoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJiZXRfbGVmdFwiOiB0aGlzLmJldGxlZnRfY2IoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJiZXRfcmlnaHRcIjogdGhpcy5iZXRyaWdodF9jYigpOyBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoXCJ0YWJzX1wiKSA+IC0xKSB0aGlzLnNlbGVjdENsaWNrKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzZWxlY3RDbGljayhuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5wYWdlSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuc3dpdGNoUGxhdGZvcm0oR0FNRV9WQVJJRVRZX1RBQltuYW1lXSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGJldGxlZnRfY2IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ID09IDApIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleC0tO1xyXG4gICAgICAgIHRoaXMuaW5pdHBhZ2VWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWlkVUkoKTtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGJldHJpZ2h0X2NiKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VJbmRleCA9PSB0aGlzLmJldE51bU1heCAtIDEpIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCsrO1xyXG4gICAgICAgIHRoaXMuaW5pdHBhZ2VWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWlkVUkoKTtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHZpcGxlZnRfY2IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlwTGV2ZWwgPD0gMCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMudmlwTGV2ZWwtLTtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5zZXRDb25maWcoKTtcclxuICAgICAgICB0aGlzLmluaXRwYWdlVmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdE1pZFVJKCk7XHJcbiAgICAgICAgdGhpcy5jaGVuZ2VCdG5TdGF0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICB2aXByaWdodF9jYigpIHtcclxuICAgICAgICBpZiAodGhpcy52aXBMZXZlbCA9PSB0aGlzLnZpcE1heCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMudmlwTGV2ZWwrKztcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5zZXRDb25maWcoKTtcclxuICAgICAgICB0aGlzLmluaXRwYWdlVmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdE1pZFVJKCk7XHJcbiAgICAgICAgdGhpcy5jaGVuZ2VCdG5TdGF0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGVuZ2VCdG5TdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLnZpcF9wYWdldXAuYWN0aXZlID0gdGhpcy52aXBMZXZlbCAhPSAwO1xyXG4gICAgICAgIHRoaXMudmlwX3JpZ2h0bmV4dC5hY3RpdmUgPSB0aGlzLnZpcExldmVsICE9IHRoaXMudmlwTWF4IC0gMTtcclxuICAgICAgICB0aGlzLmJldF9wYWdldXAuYWN0aXZlID0gdGhpcy5wYWdlSW5kZXggIT0gMDtcclxuICAgICAgICB0aGlzLmJldF9wYWdlbmV4dC5hY3RpdmUgPSB0aGlzLnBhZ2VJbmRleCAhPSB0aGlzLmJldE51bU1heCAtIDE7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldENvbmZpZygpIHtcclxuICAgICAgICB0aGlzLmJldF9wYWdlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMucmViYXRlQ29uZmlnTGlzdC5tb2RlVHlwZSA9PSBcInZpcFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlwTWF4ID0gT2JqZWN0LmtleXModGhpcy5yZWJhdGVDb25maWdMaXN0LmRhdGEpLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcgPSB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QuZGF0YVt0aGlzLnZpcExldmVsXS5jb25maWc7XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb25maWcpOyAgICAgICAgICAgICAgICAgICAgICAgICAvL+WtkOa4uOaIj0lE5pWw57uEXHJcbiAgICAgICAgICAgIGxldCBnYW1lcG9ycG9yID0gdGhpcy5jb25maWdba2V5c1swXV07ICAgICAgICAgICAgICAgICAgICAgIC8v5a2Q5ri45oiP55qE5pWw5o2uXHJcbiAgICAgICAgICAgIGxldCBnYW1lS2V5cyA9IE9iamVjdC5rZXlzKGdhbWVwb3Jwb3IpOyAgICAgICAgICAgICAgICAgICAgIC8v5Yy66Ze055qEa2V5c1xyXG4gICAgICAgICAgICB0aGlzLmJldE51bU1heCA9IGdhbWVLZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy52aXBfcGFnZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJldF9wYWdlLnggPSAyMjQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcgPSB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QuZGF0YS5jb25maWc7XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb25maWcpICAgICAgICAgICAgICAgICAgICAgICAgIC8v5a2Q5ri45oiPSUTmlbDnu4RcclxuICAgICAgICAgICAgbGV0IGdhbWVwb3Jwb3IgPSB0aGlzLmNvbmZpZ1trZXlzWzBdXTsgICAgICAgICAgICAgICAgICAgICAgLy/lrZDmuLjmiI/nmoTmlbDmja5cclxuICAgICAgICAgICAgbGV0IGdhbWVLZXlzID0gT2JqZWN0LmtleXMoZ2FtZXBvcnBvcik7ICAgICAgICAgICAgICAgICAgICAgLy/ljLrpl7TnmoRrZXlzXHJcbiAgICAgICAgICAgIHRoaXMuYmV0TnVtTWF4ID0gZ2FtZUtleXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLnZpcF9wYWdlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJldF9wYWdlLnggPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5ri45oiP5piv5ZCm5byA5ZCvXHJcbiAgICBpc0dhbWVPcGVuKHR5cGVMaXN0LCBpZCkge1xyXG4gICAgICAgIGxldCBjb3VudCA9IHR5cGVMaXN0Lmxlbmd0aDtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICBpZih0eXBlTGlzdFtpXS5pZCA9PSBpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0RmxvYXQodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gKE51bWJlcih2YWx1ZSkuZGl2KDEwMCkpLnRvRml4ZWQoNCk7XHJcbiAgICB9LFxyXG4gICAgLy/mta7ngrnlnovov5Dnrpflj5bkv6nkvY1cclxuICAgIGN1dEZsb2F0KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSkuZGl2KDEwMCkudG9TdHJpbmcoKTtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIl19