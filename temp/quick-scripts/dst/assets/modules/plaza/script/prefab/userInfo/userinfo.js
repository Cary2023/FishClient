
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/userInfo/userinfo.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '6fc33Q1ez1BabnrxBzHLaTb', 'userinfo');
// modules/plaza/script/prefab/userInfo/userinfo.js

"use strict";

/**
 * 玩家个人信息界面
 */
var GAMETYPE = {
  CHESS: 1,
  //棋牌版
  COMPLEX: 2 //综合版

};
glGame.baseclass.extend({
  properties: {
    mainPanel: cc.Node,
    leftbtns: cc.Node,
    reddot: cc.Node,
    left_node: cc.Node,
    head: cc.Node,
    sex: cc.Sprite,
    vip_level: cc.Label,
    img_sex: [cc.SpriteFrame],
    base_acc: cc.Label,
    base_phone: cc.Label,
    base_id: cc.Label,
    base_nickname: cc.Label
  },
  onLoad: function onLoad() {
    this.isFirst = true;
    this.gameDisplayType = glGame.user.get("gameDisplayType");
    this.registerEvent();
  },
  start: function start() {},
  showInfo: function showInfo() {
    if (this.isFirst) {
      this.showPanel("vipinfo");
      this.isFirst = false;
    }

    this.initUi();
    this.initReddot();
  },
  initUi: function initUi() {
    //头像
    glGame.panel.showHeadImage(this.head, glGame.user.get("headURL")); //基础信息

    this.base_acc.string = glGame.user.get("userName") || "";
    var phoneStr = glGame.user.get("phone").toString();
    var new_str = '';
    console.log('phoneStrphoneStr', phoneStr, phoneStr.length);

    for (var i = 0; i < phoneStr.length; i++) {
      var valueNum = phoneStr[i];

      if (i > 2 && i < 8) {
        valueNum = '*';
      }

      new_str += valueNum;
    }

    this.base_phone.string = glGame.user.get("phone") ? new_str : "";
    this.sex.spriteFrame = this.img_sex[glGame.user.get("userSex")];
    this.base_id.string = glGame.user.get("logicID") || "";
    this.base_nickname.string = glGame.user.get("nickname") || "";
    this.vip_level.string = glGame.user.get("vip_name");
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "account":
      case "vipinfo":
      case "statement":
      case "record":
      case "bank":
      case "seting":
        this.showPanel(name);
        break;

      case "head":
        this.changeHead_cb();
        break;

      case 'btn_grzl':
        this.userEdit_cb();
        break;

      case 'btn_phoneEdit':
        this.phoneEdit_cb();
        break;

      case 'btn_nicknameEdit':
        this.nicknameEdit_cb();
        break;

      case "close":
        this.remove();
        break;
    }
  },
  initReddot: function initReddot() {
    this.reddot.active = glGame.user.get("redDotData").vipReq == 1;
  },
  //隐藏所有界面
  hideAllPanel: function hideAllPanel() {
    if (!this.mainPanel.childrenCount) return;

    for (var i = 0; i < this.mainPanel.childrenCount; i++) {
      this.mainPanel.children[i].active = false;
    }
  },
  //显示某个界面。按名字来显示
  showPanel: function showPanel(panelName) {
    var _this = this;

    this.hideAllPanel();
    var panellist = {};
    panellist["vipinfo"] = "userinfoVip";
    panellist["statement"] = this.gameDisplayType == GAMETYPE.CHESS ? "userinfostatement" : "userinfostatement_complex";
    panellist["account"] = "userinfoaccount";
    panellist["record"] = this.gameDisplayType == GAMETYPE.CHESS ? "userinforecord" : "userinforecord_complex";
    panellist["bank"] = "userinfoBank";
    panellist["seting"] = "userinfoSeting";

    for (var name in panellist) {
      var index = 0;
      if (panelName == name) index = 1;
      this.leftbtns.getChildByName(name).zIndex = index;
    }

    if (this.mainPanel.getChildByName(panellist[panelName])) {
      this.mainPanel.getChildByName(panellist[panelName]).active = true;
      glGame.emitter.emit("userinfo_switchFace");
      return;
    }

    glGame.panel.getPanelByName(panellist[panelName]).then(function (panelData) {
      panelData.parent = _this.mainPanel;
    });
  },
  //浮点型运算取俩位
  cutFloat: function cutFloat(num) {
    return this.getFloat(Number(num).div(100)).toString();
  },
  //浮点型运算取俩位
  getFloat: function getFloat(value) {
    var num = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;
    value = Number(value);
    if (isNaN(value)) return;

    if (~~value === value) {
      return value.toString();
    } else {
      return (Math.floor(value * 100) / 100).toFixed(num);
    }
  },
  changeHead_cb: function changeHead_cb() {
    glGame.panel.showPanelByName("changehead");
  },
  //个人资料
  userEdit_cb: function userEdit_cb() {
    console.log("显示个人资料");
    glGame.panel.showPanelByName("changeInfo");
  },
  //修改昵称
  nicknameEdit_cb: function nicknameEdit_cb() {
    console.log("显示修改昵称");
    glGame.panel.showPanelByName("editNickName");
  },
  //修改手机
  phoneEdit_cb: function phoneEdit_cb() {
    //允许手机更改密码
    var phone = glGame.user.get("phone").toString();

    if (phone && phone != "") {
      if (phone == 0) glGame.panel.showPanelByName("bindPhone"); //绑定
      else if (glGame.user.get("loginSwitch").self_edit_phone == 1) glGame.panel.showPanelByName("untiedPhone");else glGame.panel.showPanelByName("unbind");
    } else {
      glGame.panel.showPanelByName("bindPhone"); //绑定
    }
  },
  //修改密码
  changepsw_cb: function changepsw_cb() {
    if (glGame.user.get("loginSwitch").self_edit_login_pwd == 1) {
      glGame.panel.showPanelByName("modifypsw");
    } else {
      glGame.panel.showErrorTip(glGame.tips.USER.PASSWORD.UNCHANGE);
    }
  },
  // 注册界面监听事件
  registerEvent: function registerEvent() {
    glGame.emitter.on("ReqRedDot", this.initReddot, this);
    glGame.emitter.on("updateUserData", this.showInfo, this);
    glGame.emitter.on("".concat(this.node.name).concat(MESSAGE.UI.ACTION_END), this.showInfo, this);
    glGame.emitter.on("notifyVipInfo", this.updateVip, this);
  },
  // 销毁界面监听事件
  unRegisterEvent: function unRegisterEvent() {
    glGame.emitter.off("ReqRedDot", this);
    glGame.emitter.off("updateUserData", this);
    glGame.emitter.off("".concat(this.node.name).concat(MESSAGE.UI.ACTION_END), this);
    glGame.emitter.off("notifyVipInfo", this);
  },
  updateVip: function updateVip(msg) {
    var vipList = msg.vipList,
        vipId = msg.userInfo.vipId;

    for (var i = 0; i < vipList.length; i++) {
      if (vipList[i].id == vipId && vipList[i].vipName != glGame.user.get("vip_name")) {
        glGame.user.set("vip_name", vipList[i].vipName);
        this.vip_level.string = glGame.user.get("vip_name");
        glGame.emitter.emit("updateUserData");
        break;
      }
    }
  },
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFx1c2VySW5mb1xcdXNlcmluZm8uanMiXSwibmFtZXMiOlsiR0FNRVRZUEUiLCJDSEVTUyIsIkNPTVBMRVgiLCJnbEdhbWUiLCJiYXNlY2xhc3MiLCJleHRlbmQiLCJwcm9wZXJ0aWVzIiwibWFpblBhbmVsIiwiY2MiLCJOb2RlIiwibGVmdGJ0bnMiLCJyZWRkb3QiLCJsZWZ0X25vZGUiLCJoZWFkIiwic2V4IiwiU3ByaXRlIiwidmlwX2xldmVsIiwiTGFiZWwiLCJpbWdfc2V4IiwiU3ByaXRlRnJhbWUiLCJiYXNlX2FjYyIsImJhc2VfcGhvbmUiLCJiYXNlX2lkIiwiYmFzZV9uaWNrbmFtZSIsIm9uTG9hZCIsImlzRmlyc3QiLCJnYW1lRGlzcGxheVR5cGUiLCJ1c2VyIiwiZ2V0IiwicmVnaXN0ZXJFdmVudCIsInN0YXJ0Iiwic2hvd0luZm8iLCJzaG93UGFuZWwiLCJpbml0VWkiLCJpbml0UmVkZG90IiwicGFuZWwiLCJzaG93SGVhZEltYWdlIiwic3RyaW5nIiwicGhvbmVTdHIiLCJ0b1N0cmluZyIsIm5ld19zdHIiLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwiaSIsInZhbHVlTnVtIiwic3ByaXRlRnJhbWUiLCJvbkNsaWNrIiwibmFtZSIsIm5vZGUiLCJjaGFuZ2VIZWFkX2NiIiwidXNlckVkaXRfY2IiLCJwaG9uZUVkaXRfY2IiLCJuaWNrbmFtZUVkaXRfY2IiLCJyZW1vdmUiLCJhY3RpdmUiLCJ2aXBSZXEiLCJoaWRlQWxsUGFuZWwiLCJjaGlsZHJlbkNvdW50IiwiY2hpbGRyZW4iLCJwYW5lbE5hbWUiLCJwYW5lbGxpc3QiLCJpbmRleCIsImdldENoaWxkQnlOYW1lIiwiekluZGV4IiwiZW1pdHRlciIsImVtaXQiLCJnZXRQYW5lbEJ5TmFtZSIsInRoZW4iLCJwYW5lbERhdGEiLCJwYXJlbnQiLCJjdXRGbG9hdCIsIm51bSIsImdldEZsb2F0IiwiTnVtYmVyIiwiZGl2IiwidmFsdWUiLCJpc05hTiIsIk1hdGgiLCJmbG9vciIsInRvRml4ZWQiLCJzaG93UGFuZWxCeU5hbWUiLCJwaG9uZSIsInNlbGZfZWRpdF9waG9uZSIsImNoYW5nZXBzd19jYiIsInNlbGZfZWRpdF9sb2dpbl9wd2QiLCJzaG93RXJyb3JUaXAiLCJ0aXBzIiwiVVNFUiIsIlBBU1NXT1JEIiwiVU5DSEFOR0UiLCJvbiIsIk1FU1NBR0UiLCJVSSIsIkFDVElPTl9FTkQiLCJ1cGRhdGVWaXAiLCJ1blJlZ2lzdGVyRXZlbnQiLCJvZmYiLCJtc2ciLCJ2aXBMaXN0IiwidmlwSWQiLCJ1c2VySW5mbyIsImlkIiwidmlwTmFtZSIsInNldCIsIk9uRGVzdHJveSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7O0FBR0EsSUFBTUEsUUFBUSxHQUFHO0FBQ2JDLEVBQUFBLEtBQUssRUFBRSxDQURNO0FBQ0E7QUFDYkMsRUFBQUEsT0FBTyxFQUFFLENBRkksQ0FFQTs7QUFGQSxDQUFqQjtBQUlBQyxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLE1BQWpCLENBQXdCO0FBQ3BCQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsU0FBUyxFQUFFQyxFQUFFLENBQUNDLElBRE47QUFFUkMsSUFBQUEsUUFBUSxFQUFFRixFQUFFLENBQUNDLElBRkw7QUFJUkUsSUFBQUEsTUFBTSxFQUFFSCxFQUFFLENBQUNDLElBSkg7QUFNUkcsSUFBQUEsU0FBUyxFQUFFSixFQUFFLENBQUNDLElBTk47QUFRUkksSUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNDLElBUkQ7QUFTUkssSUFBQUEsR0FBRyxFQUFFTixFQUFFLENBQUNPLE1BVEE7QUFVUkMsSUFBQUEsU0FBUyxFQUFFUixFQUFFLENBQUNTLEtBVk47QUFXUkMsSUFBQUEsT0FBTyxFQUFFLENBQUNWLEVBQUUsQ0FBQ1csV0FBSixDQVhEO0FBYVJDLElBQUFBLFFBQVEsRUFBRVosRUFBRSxDQUFDUyxLQWJMO0FBY1JJLElBQUFBLFVBQVUsRUFBRWIsRUFBRSxDQUFD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Q3ZELENBQUQsQ0FBUCxDQUFXMEQsRUFBWCxJQUFpQkYsS0FBakIsSUFBMEJELE9BQU8sQ0FBQ3ZELENBQUQsQ0FBUCxDQUFXMkQsT0FBWCxJQUFzQnBHLE1BQU0sQ0FBQ3dCLElBQVAsQ0FBWUMsR0FBWixDQUFnQixVQUFoQixDQUFwRCxFQUFpRjtBQUM3RXpCLFFBQUFBLE1BQU0sQ0FBQ3dCLElBQVAsQ0FBWTZFLEdBQVosQ0FBZ0IsVUFBaEIsRUFBNEJMLE9BQU8sQ0FBQ3ZELENBQUQsQ0FBUCxDQUFXMkQsT0FBdkM7QUFDQSxhQUFLdkYsU0FBTCxDQUFlcUIsTUFBZixHQUF3QmxDLE1BQU0sQ0FBQ3dCLElBQVAsQ0FBWUMsR0FBWixDQUFnQixVQUFoQixDQUF4QjtBQUNBekIsUUFBQUEsTUFBTSxDQUFDOEQsT0FBUCxDQUFlQyxJQUFmLENBQW9CLGdCQUFwQjtBQUNBO0FBQ0g7QUFDSjtBQUNKLEdBek1tQjtBQTBNcEJ1QyxFQUFBQSxTQTFNb0IsdUJBME1SO0FBQ1IsU0FBS1QsZUFBTDtBQUNIO0FBNU1tQixDQUF4QiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOeOqeWutuS4quS6uuS/oeaBr+eVjOmdolxyXG4gKi9cclxuY29uc3QgR0FNRVRZUEUgPSB7XHJcbiAgICBDSEVTUzogMSwgICAgLy/mo4vniYzniYhcclxuICAgIENPTVBMRVg6IDIsICAvL+e7vOWQiOeJiFxyXG59XHJcbmdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBtYWluUGFuZWw6IGNjLk5vZGUsXHJcbiAgICAgICAgbGVmdGJ0bnM6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIHJlZGRvdDogY2MuTm9kZSxcclxuXHJcbiAgICAgICAgbGVmdF9ub2RlOiBjYy5Ob2RlLFxyXG5cclxuICAgICAgICBoZWFkOiBjYy5Ob2RlLFxyXG4gICAgICAgIHNleDogY2MuU3ByaXRlLFxyXG4gICAgICAgIHZpcF9sZXZlbDogY2MuTGFiZWwsXHJcbiAgICAgICAgaW1nX3NleDogW2NjLlNwcml0ZUZyYW1lXSxcclxuXHJcbiAgICAgICAgYmFzZV9hY2M6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJhc2VfcGhvbmU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJhc2VfaWQ6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJhc2Vfbmlja25hbWU6IGNjLkxhYmVsLFxyXG4gICAgfSxcclxuICAgIG9uTG9hZCgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5pc0ZpcnN0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmdhbWVEaXNwbGF5VHlwZSA9IGdsR2FtZS51c2VyLmdldChcImdhbWVEaXNwbGF5VHlwZVwiKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuXHJcbiAgICB9LFxyXG4gICAgc3RhcnQoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93SW5mbygpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0ZpcnN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd1BhbmVsKFwidmlwaW5mb1wiKTtcclxuICAgICAgICAgICAgdGhpcy5pc0ZpcnN0ID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5pdFVpKCk7XHJcbiAgICAgICAgdGhpcy5pbml0UmVkZG90KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRVaSgpIHtcclxuICAgICAgICAvL+WktOWDj1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93SGVhZEltYWdlKHRoaXMuaGVhZCwgZ2xHYW1lLnVzZXIuZ2V0KFwiaGVhZFVSTFwiKSk7XHJcbiAgICAgICAgLy/ln7rnoYDkv6Hmga9cclxuICAgICAgICB0aGlzLmJhc2VfYWNjLnN0cmluZyA9IGdsR2FtZS51c2VyLmdldChcInVzZXJOYW1lXCIpIHx8IFwiXCI7XHJcbiAgICAgICAgbGV0IHBob25lU3RyID0gZ2xHYW1lLnVzZXIuZ2V0KFwicGhvbmVcIikudG9TdHJpbmcoKTtcclxuICAgICAgICBsZXQgbmV3X3N0ciA9ICcnO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdwaG9uZVN0cnBob25lU3RyJywgcGhvbmVTdHIsIHBob25lU3RyLmxlbmd0aClcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBob25lU3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZU51bSA9IHBob25lU3RyW2ldO1xyXG4gICAgICAgICAgICBpZiAoaSA+IDIgJiYgaSA8IDgpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlTnVtID0gJyonO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG5ld19zdHIgKz0gdmFsdWVOdW1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5iYXNlX3Bob25lLnN0cmluZyA9IGdsR2FtZS51c2VyLmdldChcInBob25lXCIpID8gbmV3X3N0ciA6IFwiXCI7XHJcbiAgICAgICAgdGhpcy5zZXguc3ByaXRlRnJhbWUgPSB0aGlzLmltZ19zZXhbZ2xHYW1lLnVzZXIuZ2V0KFwidXNlclNleFwiKV07XHJcblxyXG4gICAgICAgIHRoaXMuYmFzZV9pZC5zdHJpbmcgPSBnbEdhbWUudXNlci5nZXQoXCJsb2dpY0lEXCIpIHx8IFwiXCI7XHJcbiAgICAgICAgdGhpcy5iYXNlX25pY2tuYW1lLnN0cmluZyA9IGdsR2FtZS51c2VyLmdldChcIm5pY2tuYW1lXCIpIHx8IFwiXCI7XHJcblxyXG4gICAgICAgIHRoaXMudmlwX2xldmVsLnN0cmluZyA9IGdsR2FtZS51c2VyLmdldChcInZpcF9uYW1lXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsaWNrKG5hbWUsIG5vZGUpIHtcclxuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImFjY291bnRcIjpcclxuICAgICAgICAgICAgY2FzZSBcInZpcGluZm9cIjpcclxuICAgICAgICAgICAgY2FzZSBcInN0YXRlbWVudFwiOlxyXG4gICAgICAgICAgICBjYXNlIFwicmVjb3JkXCI6XHJcbiAgICAgICAgICAgIGNhc2UgXCJiYW5rXCI6XHJcbiAgICAgICAgICAgIGNhc2UgXCJzZXRpbmdcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BhbmVsKG5hbWUpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImhlYWRcIjogdGhpcy5jaGFuZ2VIZWFkX2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdidG5fZ3J6bCc6IHRoaXMudXNlckVkaXRfY2IoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2J0bl9waG9uZUVkaXQnOiB0aGlzLnBob25lRWRpdF9jYigpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYnRuX25pY2tuYW1lRWRpdCc6IHRoaXMubmlja25hbWVFZGl0X2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiY2xvc2VcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKClcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdFJlZGRvdCgpIHtcclxuICAgICAgICB0aGlzLnJlZGRvdC5hY3RpdmUgPSBnbEdhbWUudXNlci5nZXQoXCJyZWREb3REYXRhXCIpLnZpcFJlcSA9PSAxO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+makOiXj+aJgOacieeVjOmdolxyXG4gICAgaGlkZUFsbFBhbmVsKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5tYWluUGFuZWwuY2hpbGRyZW5Db3VudCkgcmV0dXJuO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYWluUGFuZWwuY2hpbGRyZW5Db3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFpblBhbmVsLmNoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/mmL7npLrmn5DkuKrnlYzpnaLjgILmjInlkI3lrZfmnaXmmL7npLpcclxuICAgIHNob3dQYW5lbChwYW5lbE5hbWUpIHtcclxuICAgICAgICB0aGlzLmhpZGVBbGxQYW5lbCgpXHJcbiAgICAgICAgbGV0IHBhbmVsbGlzdCA9IHt9XHJcbiAgICAgICAgcGFuZWxsaXN0W1widmlwaW5mb1wiXSA9IFwidXNlcmluZm9WaXBcIjtcclxuICAgICAgICBwYW5lbGxpc3RbXCJzdGF0ZW1lbnRcIl0gPSB0aGlzLmdhbWVEaXNwbGF5VHlwZSA9PSBHQU1FVFlQRS5DSEVTUyA/IFwidXNlcmluZm9zdGF0ZW1lbnRcIiA6IFwidXNlcmluZm9zdGF0ZW1lbnRfY29tcGxleFwiO1xyXG4gICAgICAgIHBhbmVsbGlzdFtcImFjY291bnRcIl0gPSBcInVzZXJpbmZvYWNjb3VudFwiO1xyXG4gICAgICAgIHBhbmVsbGlzdFtcInJlY29yZFwiXSA9IHRoaXMuZ2FtZURpc3BsYXlUeXBlID09IEdBTUVUWVBFLkNIRVNTID8gXCJ1c2VyaW5mb3JlY29yZFwiIDogXCJ1c2VyaW5mb3JlY29yZF9jb21wbGV4XCI7XHJcbiAgICAgICAgcGFuZWxsaXN0W1wiYmFua1wiXSA9IFwidXNlcmluZm9CYW5rXCI7XHJcbiAgICAgICAgcGFuZWxsaXN0W1wic2V0aW5nXCJdID0gXCJ1c2VyaW5mb1NldGluZ1wiO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBuYW1lIGluIHBhbmVsbGlzdCkge1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgICAgICBpZiAocGFuZWxOYW1lID09IG5hbWUpIGluZGV4ID0gMTtcclxuICAgICAgICAgICAgdGhpcy5sZWZ0YnRucy5nZXRDaGlsZEJ5TmFtZShuYW1lKS56SW5kZXggPSBpbmRleDtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBpZiAodGhpcy5tYWluUGFuZWwuZ2V0Q2hpbGRCeU5hbWUocGFuZWxsaXN0W3BhbmVsTmFtZV0pKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFpblBhbmVsLmdldENoaWxkQnlOYW1lKHBhbmVsbGlzdFtwYW5lbE5hbWVdKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBnbEdhbWUuZW1pdHRlci5lbWl0KFwidXNlcmluZm9fc3dpdGNoRmFjZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLmdldFBhbmVsQnlOYW1lKHBhbmVsbGlzdFtwYW5lbE5hbWVdKS50aGVuKHBhbmVsRGF0YSA9PiB7XHJcbiAgICAgICAgICAgIHBhbmVsRGF0YS5wYXJlbnQgPSB0aGlzLm1haW5QYW5lbDtcclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+a1rueCueWei+i/kOeul+WPluS/qeS9jVxyXG4gICAgY3V0RmxvYXQobnVtKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmdldEZsb2F0KE51bWJlcihudW0pLmRpdigxMDApKSkudG9TdHJpbmcoKTtcclxuICAgIH0sXHJcbiAgICAvL+a1rueCueWei+i/kOeul+WPluS/qeS9jVxyXG4gICAgZ2V0RmxvYXQodmFsdWUsIG51bSA9IDIpIHtcclxuICAgICAgICB2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh+fnZhbHVlID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gKE1hdGguZmxvb3IodmFsdWUgKiAxMDApIC8gMTAwKS50b0ZpeGVkKG51bSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBjaGFuZ2VIZWFkX2NiKCkge1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJjaGFuZ2VoZWFkXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+S4quS6uui1hOaWmVxyXG4gICAgdXNlckVkaXRfY2IoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLmmL7npLrkuKrkurrotYTmlplcIilcclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1BhbmVsQnlOYW1lKFwiY2hhbmdlSW5mb1wiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/kv67mlLnmmLXnp7BcclxuICAgIG5pY2tuYW1lRWRpdF9jYigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuaYvuekuuS/ruaUueaYteensFwiKVxyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJlZGl0Tmlja05hbWVcIik7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5L+u5pS55omL5py6XHJcbiAgICBwaG9uZUVkaXRfY2IoKSB7XHJcbiAgICAgICAgLy/lhYHorrjmiYvmnLrmm7TmlLnlr4bnoIFcclxuICAgICAgICBsZXQgcGhvbmUgPSBnbEdhbWUudXNlci5nZXQoXCJwaG9uZVwiKS50b1N0cmluZygpO1xyXG4gICAgICAgIGlmIChwaG9uZSAmJiBwaG9uZSAhPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGlmIChwaG9uZSA9PSAwKSBnbEdhbWUucGFuZWwuc2hvd1BhbmVsQnlOYW1lKFwiYmluZFBob25lXCIpOyAgICAgIC8v57uR5a6aXHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGdsR2FtZS51c2VyLmdldChcImxvZ2luU3dpdGNoXCIpLnNlbGZfZWRpdF9waG9uZSA9PSAxKSBnbEdhbWUucGFuZWwuc2hvd1BhbmVsQnlOYW1lKFwidW50aWVkUGhvbmVcIik7XHJcbiAgICAgICAgICAgIGVsc2UgZ2xHYW1lLnBhbmVsLnNob3dQYW5lbEJ5TmFtZShcInVuYmluZFwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1BhbmVsQnlOYW1lKFwiYmluZFBob25lXCIpOyAgICAgICAvL+e7keWumlxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy/kv67mlLnlr4bnoIFcclxuICAgIGNoYW5nZXBzd19jYigpIHtcclxuICAgICAgICBpZiAoZ2xHYW1lLnVzZXIuZ2V0KFwibG9naW5Td2l0Y2hcIikuc2VsZl9lZGl0X2xvZ2luX3B3ZCA9PSAxKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJtb2RpZnlwc3dcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5VU0VSLlBBU1NXT1JELlVOQ0hBTkdFKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOazqOWGjOeVjOmdouebkeWQrOS6i+S7tlxyXG4gICAgcmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihcIlJlcVJlZERvdFwiLCB0aGlzLmluaXRSZWRkb3QsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKFwidXBkYXRlVXNlckRhdGFcIiwgdGhpcy5zaG93SW5mbywgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oYCR7dGhpcy5ub2RlLm5hbWV9JHtNRVNTQUdFLlVJLkFDVElPTl9FTkR9YCwgdGhpcy5zaG93SW5mbywgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oXCJub3RpZnlWaXBJbmZvXCIsIHRoaXMudXBkYXRlVmlwLCB0aGlzKTtcclxuICAgIH0sXHJcbiAgICAvLyDplIDmr4HnlYzpnaLnm5HlkKzkuovku7ZcclxuICAgIHVuUmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vZmYoXCJSZXFSZWREb3RcIiwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKFwidXBkYXRlVXNlckRhdGFcIiwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKGAke3RoaXMubm9kZS5uYW1lfSR7TUVTU0FHRS5VSS5BQ1RJT05fRU5EfWAsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcIm5vdGlmeVZpcEluZm9cIiwgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlVmlwKG1zZykge1xyXG4gICAgICAgIGxldCB2aXBMaXN0ID0gbXNnLnZpcExpc3QsXHJcbiAgICAgICAgICAgIHZpcElkID0gbXNnLnVzZXJJbmZvLnZpcElkO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmlwTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodmlwTGlzdFtpXS5pZCA9PSB2aXBJZCAmJiB2aXBMaXN0W2ldLnZpcE5hbWUgIT0gZ2xHYW1lLnVzZXIuZ2V0KFwidmlwX25hbWVcIikpIHtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS51c2VyLnNldChcInZpcF9uYW1lXCIsIHZpcExpc3RbaV0udmlwTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpcF9sZXZlbC5zdHJpbmcgPSBnbEdhbWUudXNlci5nZXQoXCJ2aXBfbmFtZVwiKTtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5lbWl0dGVyLmVtaXQoXCJ1cGRhdGVVc2VyRGF0YVwiKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIE9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLnVuUmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==