
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/room_field.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'aff3d/DNXxHbJgYUFx+eY13', 'room_field');
// modules/plaza/script/prefab/room_field.js

"use strict";

var CORNER_MARK = {
  0: "无",
  1: "推荐",
  2: "火爆",
  3: "最新"
};
var ROOM_ICON = {
  rqznn: "看牌抢庄",
  rddz: "斗地主",
  rdzpk: "德州扑克",
  rkpqz: "抢庄牛牛",
  rpj: "牌九",
  rsss: "十三水",
  rzjh: "炸金花"
};
glGame.baseclass.extend({
  properties: {
    appointment: cc.Node,
    room_item: cc.Node,
    url_txt: cc.Label,
    bg: cc.Node,
    atlas_corner_mark: cc.SpriteAtlas,
    atlas_room_icon: cc.SpriteAtlas
  },
  onLoad: function onLoad() {
    glGame.emitter.on("hotUIRefresh", this.hotUIRefresh, this);
  },
  start: function start() {
    var gamegroup = this.node.parent.getChildByName("gamegroup").width;
    var width = cc.winSize.width - gamegroup;
    this.node.width = width; // let bg_width = this.bg.width;
    // if (width >= bg_width) {
    //     this.bg.getComponent(cc.Widget).left = 0;
    //     this.bg.getComponent(cc.Widget).updateAlignment();
    // }
  },
  initData: function initData(list) {
    this.gameItemWidth = this.room_item.width; //item大小

    this.gameList = list.gameList;
    this.initRoomList();
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_invite":
        console.log(this.url_txt.string);
        glGame.platform.copyToClip(this.url_txt.string, "推广链接复制成功");
        break;

      default:
        // 判断是否是游客
        if (glGame.user.isTourist()) {
          glGame.panel.showRegisteredGift(true);
          break;
        }

        if (name == "btn_jiaruzidi") glGame.panel.showPanelByName("joinRoom"); //加入房间
        else if (name == "btn_duihuanzuanshianniu") glGame.panel.showPanelByName("exchangeDiamond"); //砖石
          else if (name == "btn_chaxunzhanjianniu") glGame.panel.showPanelByName("roomRecord"); //战绩
            else if (name.indexOf("room") !== -1) {
                // 创建房间
                var str = name.split("room"),
                    id = Number(str[str.length - 1]),
                    room_gamedata = this.gameList["_".concat(id)];

                if (id != 0) {
                  this.onEnterRoomGame(id);
                } else {
                  glGame.platform.copyToClip(this.url_txt.string, "敬请期待");
                }
              }
        break;
    }
  },
  initRoomList: function initRoomList() {
    var _this = this;

    var room_scrollTime = 0.25,
        //图标移动时间
    room_everyTime = 0.05,
        //图标移动间隔时间
    room_distance = 30,
        //图标弹动距离
    room_distanceTime = 0.1; //图标弹动时间
    // 设置推广链接地址

    var url = glGame.user.get("url");

    if (url) {
      this.url_txt.string = url.promote_url;
    } // 屏蔽web版网页游戏


    this.game_list = [];
    Object.values(this.gameList).forEach(function (item) {
      // if (!isEnableHotUpdate && item.id > 9999) return;
      _this.game_list.push(item);
    });
    Object.keys(ROOM_ICON).forEach(function (item) {
      if (item == "rqznn") {
        _this.game_list[0].icon = item;
      } else {
        var game = {};
        game.id = 0;
        game.icon = item;
        game.gameName = ROOM_ICON[item];

        _this.game_list.push(game);
      }
    });
    var length = this.game_list.length; // 获取需要展示节点的位置

    var room_posArr = this.getPosArr(); // 设置

    this.appointment.getComponent(cc.ScrollView).stopAutoScroll();
    var room_view = this.appointment.getChildByName("view");
    room_view.getComponent(cc.Widget).updateAlignment();
    var content = room_view.getChildByName("content");
    content.destroyAllChildren();
    content.removeAllChildren();
    content.x = 0; //设置scrollview.width

    var viewWidth = room_view.width;
    var room_width = Math.ceil(length / 2) * this.gameItemWidth;
    content.width = room_width < viewWidth ? viewWidth : room_width; // 初始化UI
    // if (content.childrenCount == 0) {

    this.initUI(content); // }
    // 执行动作

    for (var i = 0; i < length; i++) {
      var item = content.children[i];

      if (item) {
        item.position = cc.v2(room_posArr[i].x + viewWidth, room_posArr[i].y);
        item.runAction(cc.sequence(cc.moveTo(room_scrollTime + room_everyTime * i, room_posArr[i].x - room_distance, room_posArr[i].y), cc.moveTo(room_distanceTime, room_posArr[i])));
      }
    }
  },
  // 初始化UI
  initUI: function initUI(content) {
    this.gameList = {};

    for (var i = 0; i < this.game_list.length; i++) {
      var id = this.game_list[i].id;
      var item = cc.instantiate(this.room_item);
      item.parent = content;
      item.name = "room" + id;
      item.active = true; // 设置游戏名称

      item.getChildByName("game_name").getComponent(cc.Label).string = this.game_list[i].gameName; // 设置角标

      if (this.game_list[i].tag > 0) {
        var room_cornerMark = item.getChildByName("cornerMark");
        var corner_mark = this.atlas_corner_mark.getSpriteFrame("img_corner_mark".concat(this.game_list[i].tag));
        room_cornerMark.getComponent(cc.Sprite).spriteFrame = corner_mark;
        room_cornerMark.getChildByName("txt").getComponent(cc.Label).string = CORNER_MARK[this.game_list[i].tag];
        room_cornerMark.active = true;
      } // 设置游戏图标


      if (this.game_list[i].icon) {
        item.getChildByName("game_icon").getComponent(cc.Sprite).spriteFrame = this.atlas_room_icon.getSpriteFrame("icon_".concat(this.game_list[i].icon)); // let url = glGame.user.get('url').resource_url;
        // glGame.panel.showRemoteImage(item.getChildByName("game_icon"), url + this.game_list[i].icon);
      }

      var gameName = "rqznn_" + i;

      if (id > 0) {
        gameName = glGame.scene.getSceneNameByID(id);
      }

      this.gameList[gameName] = item;
    } // 检查游戏是否有正在更新的


    this.isHotStatus();
  },
  //获得展示节点的位置
  getPosArr: function getPosArr() {
    var posX = this.gameItemWidth / 2,
        posY = [95, -95],
        posArr = [];

    for (var i = 0; i < this.game_list.length; i++) {
      var index = i % 2;
      posArr.push(cc.v2(index == 0 && i != 0 ? posX += this.gameItemWidth : posX, posY[index]));
    }

    console.log("房间分类下的游戏展示位置列表", posArr);
    return posArr;
  },
  onEnterRoomGame: function onEnterRoomGame(gameId) {
    // glGame.panel.showPanelByName("createRoom").then(create_room => {
    //     console.log("create_room ====> ", create_room.name);
    //     create_room.getComponent(create_room.name).setGameButton(42)
    // });
    // return;
    // 检查当前游戏是否已经在更新队列
    if (glGame.assetsManager.isUpdateQueue(gameId)) return; // 检查游戏是否需要更新

    glGame.gamelistcfg.isNeedUpdate(gameId).then(function (bol) {
      if (bol && cc.sys.isNative) {
        // 开始更新【%s(游戏名称)】，请耐心等待...
        // glGame.panel.showTip(`开始更新【${glGame.room.getGameDictById(gameId)}】，请耐心等待...`);
        var gameName = glGame.scene.getSceneNameByID(gameId);
        glGame.gamelistcfg.setGameUpdate(gameName, false);
        glGame.assetsManager.gameUpdata({
          gameID: gameId,
          manifestUrl: null
        });
      } else {
        // 不需要更新
        // glGame.panel.showPanelByName("createRoom")
        glGame.panel.showPanelByName("createRoom").then(function (create_room) {
          console.log("create_room ====> ", create_room.name);
          create_room.getComponent(create_room.name).setGameButton(gameId);
        });
      }
    });
  },
  // 判断游戏是否在热更
  isHotStatus: function isHotStatus() {
    var _this2 = this;

    if (!cc.sys.isNative) return;
    Object.keys(this.gameList).forEach(function (gameName) {
      // 检查当前是否有游戏正在跟新
      var is_update_queue = glGame.assetsManager.isBeingUpdate(gameName);

      if (is_update_queue != null) {
        var data = {
          gameName: gameName,
          isActive: true
        };

        if (is_update_queue) {
          data.isStatus = 0;
        }

        _this2.hotUIRefresh(data);
      } else {
        // 查找是否需要更新
        glGame.assetsManager.isNeedUpdate(gameName);
      }
    });
  },
  // 热更刷新UI
  hotUIRefresh: function hotUIRefresh(data) {
    var _this3 = this;

    Object.keys(this.gameList).forEach(function (gameName) {
      if (data.gameName == gameName) {
        var item = _this3.gameList[gameName];
        var processNew = item.getChildByName("process");
        var progressPic = processNew.getChildByName("pro").getChildByName("bar").getComponent(cc.Sprite); // 进度条

        processNew.active = data.isActive; // 显示下载进度

        var schedule = processNew.getChildByName("label").getComponent(cc.Label);

        switch (data.isStatus) {
          case 0:
            // 热更接续
            schedule.string = "0%";
            progressPic.fillRange = 0;
            break;

          case 1:
            // 下载中
            schedule.string = "".concat(parseInt(data.process * 100) || 0, "%");
            progressPic.fillRange = data.process;
            break;

          default:
            // 下载列表大于最大同时下载量的时候显示等待中
            schedule.string = "等待中";
            progressPic.fillRange = 0;
            break;
        }
      }
    });
  },
  OnDestroy: function OnDestroy() {
    glGame.emitter.off("hotUIRefresh", this);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxyb29tX2ZpZWxkLmpzIl0sIm5hbWVzIjpbIkNPUk5FUl9NQVJLIiwiUk9PTV9JQ09OIiwicnF6bm4iLCJyZGR6IiwicmR6cGsiLCJya3BxeiIsInJwaiIsInJzc3MiLCJyempoIiwiZ2xHYW1lIiwiYmFzZWNsYXNzIiwiZXh0ZW5kIiwicHJvcGVydGllcyIsImFwcG9pbnRtZW50IiwiY2MiLCJOb2RlIiwicm9vbV9pdGVtIiwidXJsX3R4dCIsIkxhYmVsIiwiYmciLCJhdGxhc19jb3JuZXJfbWFyayIsIlNwcml0ZUF0bGFzIiwiYXRsYXNfcm9vbV9pY29uIiwib25Mb2FkIiwiZW1pdHRlciIsIm9uIiwiaG90VUlSZWZyZXNoIiwic3RhcnQiLCJnYW1lZ3JvdXAiLCJub2RlIiwicGFyZW50IiwiZ2V0Q2hpbGRCeU5hbWUiLCJ3aWR0aCIsIndpblNpemUiLCJpbml0RGF0YSIsImxpc3QiLCJnYW1lSXRlbVdpZHRoIiwiZ2FtZUxpc3QiLCJpbml0Um9vbUxpc3QiLCJvbkNsaWNrIiwibmFtZSIsImNvbnNvbGUiLCJsb2ciLCJzdHJpbmciLCJwbGF0Zm9ybSIsImNvcHlUb0NsaXAiLCJ1c2VyIiwiaXNUb3VyaXN0IiwicGFuZWwiLCJzaG93UmVnaXN0ZXJlZEdpZnQiLCJzaG93UGFuZWxCeU5hbWUiLCJpbmRleE9mIiwic3RyIiwic3BsaXQiLCJpZCIsIk51bWJlciIsImxlbmd0aCIsInJvb21fZ2FtZWRhdGEiLCJvbkVudGVyUm9vbUdhbWUiLCJyb29tX3Njcm9sbFRpbWUiLCJyb29tX2V2ZXJ5VGltZSIsInJvb21fZGlzdGFuY2UiLCJyb29tX2Rpc3RhbmNlVGltZSIsInVybCIsImdldCIsInByb21vdGVfdXJsIiwiZ2FtZV9saXN0IiwiT2JqZWN0IiwidmFsdWVzIiwiZm9yRWFjaCIsIml0ZW0iLCJwdXNoIiwia2V5cyIsImljb24iLCJnYW1lIiwiZ2FtZU5hbWUiLCJyb29tX3Bvc0FyciIsImdldFBvc0FyciIsImdldENvbXBvbmVudCIsIlNjcm9sbFZpZXciLCJzdG9wQXV0b1Njcm9sbCIsInJvb21fdmlldyIsIldpZGdldCIsInVwZGF0ZUFsaWdubWVudCIsImNvbnRlbnQiLCJkZXN0cm95QWxsQ2hpbGRyZW4iLCJyZW1vdmVBbGxDaGlsZHJlbiIsIngiLCJ2aWV3V2lkdGgiLCJyb29tX3dpZHRoIiwiTWF0aCIsImNlaWwiLCJpbml0VUkiLCJpIiwiY2hpbGRyZW4iLCJwb3NpdGlvbiIsInYyIiwieSIsInJ1bkFjdGlvbiIsInNlcXVlbmNlIiwibW92ZVRvIiwiaW5zdGFudGlhdGUiLCJhY3RpdmUiLCJ0YWciLCJyb29tX2Nvcm5lck1hcmsiLCJjb3JuZXJfbWFyayIsImdldFNwcml0ZUZyYW1lIiwiU3ByaXRlIiwic3ByaXRlRnJhbWUiLCJzY2VuZSIsImdldFNjZW5lTmFtZUJ5SUQiLCJpc0hvdFN0YXR1cyIsInBvc1giLCJwb3NZIiwicG9zQXJyIiwiaW5kZXgiLCJnYW1lSWQiLCJhc3NldHNNYW5hZ2VyIiwiaXNVcGRhdGVRdWV1ZSIsImdhbWVsaXN0Y2ZnIiwiaXNOZWVkVXBkYXRlIiwidGhlbiIsImJvbCIsInN5cyIsImlzTmF0aXZlIiwic2V0R2FtZVVwZGF0ZSIsImdhbWVVcGRhdGEiLCJnYW1lSUQiLCJtYW5pZmVzdFVybCIsImNyZWF0ZV9yb29tIiwic2V0R2FtZUJ1dHRvbiIsImlzX3VwZGF0ZV9xdWV1ZSIsImlzQmVpbmdVcGRhdGUiLCJkYXRhIiwiaXNBY3RpdmUiLCJpc1N0YXR1cyIsInByb2Nlc3NOZXciLCJwcm9ncmVzc1BpYyIsInNjaGVkdWxlIiwiZmlsbFJhbmdlIiwicGFyc2VJbnQiLCJwcm9jZXNzIiwiT25EZXN0cm95Iiwib2ZmIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLFdBQVcsR0FBRztBQUNoQixLQUFHLEdBRGE7QUFFaEIsS0FBRyxJQUZhO0FBR2hCLEtBQUcsSUFIYTtBQUloQixLQUFHO0FBSmEsQ0FBcEI7QUFN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QUksQ0FBQ1EsT0FBN0I7QUFDQTs7QUFDSjtBQUNJO0FBQ0FILFlBQUFBLFFBQVEsQ0FBQy9GLE1BQVQsR0FBa0IsS0FBbEI7QUFDQThGLFlBQUFBLFdBQVcsQ0FBQ0UsU0FBWixHQUF3QixDQUF4QjtBQUNBO0FBZlI7QUFpQkg7QUFDSixLQTNCRDtBQTRCSCxHQTlQbUI7QUFnUXBCRyxFQUFBQSxTQWhRb0IsdUJBZ1FSO0FBQ1JySSxJQUFBQSxNQUFNLENBQUNlLE9BQVAsQ0FBZXVILEdBQWYsQ0FBbUIsY0FBbkIsRUFBbUMsSUFBbkM7QUFDSDtBQWxRbUIsQ0FBeEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IENPUk5FUl9NQVJLID0ge1xyXG4gICAgMDogXCLml6BcIixcclxuICAgIDE6IFwi5o6o6I2QXCIsXHJcbiAgICAyOiBcIueBq+eIhlwiLFxyXG4gICAgMzogXCLmnIDmlrBcIixcclxufVxyXG5jb25zdCBST09NX0lDT04gPSB7XHJcbiAgICBycXpubjogXCLnnIvniYzmiqLluoRcIixcclxuICAgIHJkZHo6IFwi5paX5Zyw5Li7XCIsXHJcbiAgICByZHpwazogXCLlvrflt57miZHlhYtcIixcclxuICAgIHJrcHF6OiBcIuaKouW6hOeJm+eJm1wiLFxyXG4gICAgcnBqOiBcIueJjOS5nVwiLFxyXG4gICAgcnNzczogXCLljYHkuInmsLRcIixcclxuICAgIHJ6amg6IFwi54K46YeR6IqxXCIsXHJcbn1cclxuXHJcbmdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBhcHBvaW50bWVudDogY2MuTm9kZSxcclxuICAgICAgICByb29tX2l0ZW06IGNjLk5vZGUsXHJcbiAgICAgICAgdXJsX3R4dDogY2MuTGFiZWwsXHJcbiAgICAgICAgYmc6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIGF0bGFzX2Nvcm5lcl9tYXJrOiBjYy5TcHJpdGVBdGxhcyxcclxuICAgICAgICBhdGxhc19yb29tX2ljb246IGNjLlNwcml0ZUF0bGFzLFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oXCJob3RVSVJlZnJlc2hcIiwgdGhpcy5ob3RVSVJlZnJlc2gsIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgc3RhcnQoKSB7XHJcbiAgICAgICAgbGV0IGdhbWVncm91cCA9IHRoaXMubm9kZS5wYXJlbnQuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lZ3JvdXBcIikud2lkdGg7XHJcbiAgICAgICAgbGV0IHdpZHRoID0gY2Mud2luU2l6ZS53aWR0aCAtIGdhbWVncm91cDtcclxuICAgICAgICB0aGlzLm5vZGUud2lkdGggPSB3aWR0aDtcclxuICAgICAgICAvLyBsZXQgYmdfd2lkdGggPSB0aGlzLmJnLndpZHRoO1xyXG4gICAgICAgIC8vIGlmICh3aWR0aCA+PSBiZ193aWR0aCkge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmJnLmdldENvbXBvbmVudChjYy5XaWRnZXQpLmxlZnQgPSAwO1xyXG4gICAgICAgIC8vICAgICB0aGlzLmJnLmdldENvbXBvbmVudChjYy5XaWRnZXQpLnVwZGF0ZUFsaWdubWVudCgpO1xyXG4gICAgICAgIC8vIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdERhdGEobGlzdCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZUl0ZW1XaWR0aCA9IHRoaXMucm9vbV9pdGVtLndpZHRoOyAvL2l0ZW3lpKflsI9cclxuICAgICAgICB0aGlzLmdhbWVMaXN0ID0gbGlzdC5nYW1lTGlzdDtcclxuICAgICAgICB0aGlzLmluaXRSb29tTGlzdCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsaWNrKG5hbWUsIG5vZGUpIHtcclxuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9pbnZpdGVcIjpcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMudXJsX3R4dC5zdHJpbmcpO1xyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLnBsYXRmb3JtLmNvcHlUb0NsaXAodGhpcy51cmxfdHh0LnN0cmluZywgXCLmjqjlub/pk77mjqXlpI3liLbmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIC8vIOWIpOaWreaYr+WQpuaYr+a4uOWuolxyXG4gICAgICAgICAgICAgICAgaWYgKGdsR2FtZS51c2VyLmlzVG91cmlzdCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dSZWdpc3RlcmVkR2lmdCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuYW1lID09IFwiYnRuX2ppYXJ1emlkaVwiKSBnbEdhbWUucGFuZWwuc2hvd1BhbmVsQnlOYW1lKFwiam9pblJvb21cIik7ICAvL+WKoOWFpeaIv+mXtFxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobmFtZSA9PSBcImJ0bl9kdWlodWFuenVhbnNoaWFubml1XCIpIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJleGNoYW5nZURpYW1vbmRcIik7ICAgIC8v56CW55+zXHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChuYW1lID09IFwiYnRuX2NoYXh1bnpoYW5qaWFubml1XCIpIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJyb29tUmVjb3JkXCIpOyAgIC8v5oiY57upXHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChuYW1lLmluZGV4T2YoXCJyb29tXCIpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWIm+W7uuaIv+mXtFxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdHIgPSBuYW1lLnNwbGl0KFwicm9vbVwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBOdW1iZXIoc3RyW3N0ci5sZW5ndGggLSAxXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb21fZ2FtZWRhdGEgPSB0aGlzLmdhbWVMaXN0W2BfJHtpZH1gXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRW50ZXJSb29tR2FtZShpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2xHYW1lLnBsYXRmb3JtLmNvcHlUb0NsaXAodGhpcy51cmxfdHh0LnN0cmluZywgXCLmlazor7fmnJ/lvoVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBpbml0Um9vbUxpc3QoKSB7XHJcbiAgICAgICAgbGV0IHJvb21fc2Nyb2xsVGltZSA9IDAuMjUsICAgLy/lm77moIfnp7vliqjml7bpl7RcclxuICAgICAgICAgICAgcm9vbV9ldmVyeVRpbWUgPSAwLjA1LCAgICAvL+Wbvuagh+enu+WKqOmXtOmalOaXtumXtFxyXG4gICAgICAgICAgICByb29tX2Rpc3RhbmNlID0gMzAsICAgICAgIC8v5Zu+5qCH5by55Yqo6Led56a7XHJcbiAgICAgICAgICAgIHJvb21fZGlzdGFuY2VUaW1lID0gMC4xOyAgLy/lm77moIflvLnliqjml7bpl7RcclxuXHJcbiAgICAgICAgLy8g6K6+572u5o6o5bm/6ZO+5o6l5Zyw5Z2AXHJcbiAgICAgICAgbGV0IHVybCA9IGdsR2FtZS51c2VyLmdldChcInVybFwiKTtcclxuICAgICAgICBpZiAodXJsKXtcclxuICAgICAgICAgICAgdGhpcy51cmxfdHh0LnN0cmluZyA9IHVybC5wcm9tb3RlX3VybDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIOWxj+iUvXdlYueJiOe9kemhtea4uOaIj1xyXG4gICAgICAgIHRoaXMuZ2FtZV9saXN0ID0gW107XHJcbiAgICAgICAgT2JqZWN0LnZhbHVlcyh0aGlzLmdhbWVMaXN0KS5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgLy8gaWYgKCFpc0VuYWJsZUhvdFVwZGF0ZSAmJiBpdGVtLmlkID4gOTk5OSkgcmV0dXJuO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVfbGlzdC5wdXNoKGl0ZW0pXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgT2JqZWN0LmtleXMoUk9PTV9JQ09OKS5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgICAgICAgaWYgKGl0ZW0gPT0gXCJycXpublwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVfbGlzdFswXS5pY29uID0gaXRlbTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBnYW1lID0ge31cclxuICAgICAgICAgICAgICAgIGdhbWUuaWQgPSAwO1xyXG4gICAgICAgICAgICAgICAgZ2FtZS5pY29uID0gaXRlbTtcclxuICAgICAgICAgICAgICAgIGdhbWUuZ2FtZU5hbWUgPSBST09NX0lDT05baXRlbV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVfbGlzdC5wdXNoKGdhbWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBsZXQgbGVuZ3RoID0gdGhpcy5nYW1lX2xpc3QubGVuZ3RoO1xyXG4gICAgICAgIC8vIOiOt+WPlumcgOimgeWxleekuuiKgueCueeahOS9jee9rlxyXG4gICAgICAgIGxldCByb29tX3Bvc0FyciA9IHRoaXMuZ2V0UG9zQXJyKClcclxuXHJcbiAgICAgICAgLy8g6K6+572uXHJcbiAgICAgICAgdGhpcy5hcHBvaW50bWVudC5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuc3RvcEF1dG9TY3JvbGwoKTtcclxuICAgICAgICBsZXQgcm9vbV92aWV3ID0gdGhpcy5hcHBvaW50bWVudC5nZXRDaGlsZEJ5TmFtZShcInZpZXdcIik7XHJcbiAgICAgICAgcm9vbV92aWV3LmdldENvbXBvbmVudChjYy5XaWRnZXQpLnVwZGF0ZUFsaWdubWVudCgpO1xyXG4gICAgICAgIGxldCBjb250ZW50ID0gcm9vbV92aWV3LmdldENoaWxkQnlOYW1lKFwiY29udGVudFwiKTtcclxuICAgICAgICBjb250ZW50LmRlc3Ryb3lBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIGNvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcclxuICAgICAgICBjb250ZW50LnggPSAwO1xyXG5cclxuICAgICAgICAvL+iuvue9rnNjcm9sbHZpZXcud2lkdGhcclxuICAgICAgICBsZXQgdmlld1dpZHRoID0gcm9vbV92aWV3LndpZHRoO1xyXG4gICAgICAgIGxldCByb29tX3dpZHRoID0gTWF0aC5jZWlsKGxlbmd0aCAvIDIpICogdGhpcy5nYW1lSXRlbVdpZHRoO1xyXG4gICAgICAgIGNvbnRlbnQud2lkdGggPSByb29tX3dpZHRoIDwgdmlld1dpZHRoID8gdmlld1dpZHRoIDogcm9vbV93aWR0aDtcclxuXHJcbiAgICAgICAgLy8g5Yid5aeL5YyWVUlcclxuICAgICAgICAvLyBpZiAoY29udGVudC5jaGlsZHJlbkNvdW50ID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5pbml0VUkoY29udGVudCk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICAvLyDmiafooYzliqjkvZxcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBpdGVtID0gY29udGVudC5jaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0ucG9zaXRpb24gPSBjYy52Mihyb29tX3Bvc0FycltpXS54ICsgdmlld1dpZHRoLCByb29tX3Bvc0FycltpXS55KTtcclxuICAgICAgICAgICAgICAgIGl0ZW0ucnVuQWN0aW9uKGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICAgICAgICAgIGNjLm1vdmVUbyhyb29tX3Njcm9sbFRpbWUgKyByb29tX2V2ZXJ5VGltZSAqIGksIHJvb21fcG9zQXJyW2ldLnggLSByb29tX2Rpc3RhbmNlLCByb29tX3Bvc0FycltpXS55KSxcclxuICAgICAgICAgICAgICAgICAgICBjYy5tb3ZlVG8ocm9vbV9kaXN0YW5jZVRpbWUsIHJvb21fcG9zQXJyW2ldKSxcclxuICAgICAgICAgICAgICAgICkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWIneWni+WMllVJXHJcbiAgICBpbml0VUkoY29udGVudCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZUxpc3QgPSB7fTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZ2FtZV9saXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IHRoaXMuZ2FtZV9saXN0W2ldLmlkO1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucm9vbV9pdGVtKTtcclxuICAgICAgICAgICAgaXRlbS5wYXJlbnQgPSBjb250ZW50O1xyXG4gICAgICAgICAgICBpdGVtLm5hbWUgPSBcInJvb21cIiArIGlkO1xyXG4gICAgICAgICAgICBpdGVtLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vIOiuvue9rua4uOaIj+WQjeensFxyXG4gICAgICAgICAgICBpdGVtLmdldENoaWxkQnlOYW1lKFwiZ2FtZV9uYW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5nYW1lX2xpc3RbaV0uZ2FtZU5hbWU7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruinkuagh1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lX2xpc3RbaV0udGFnID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHJvb21fY29ybmVyTWFyayA9IGl0ZW0uZ2V0Q2hpbGRCeU5hbWUoXCJjb3JuZXJNYXJrXCIpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGNvcm5lcl9tYXJrID0gdGhpcy5hdGxhc19jb3JuZXJfbWFyay5nZXRTcHJpdGVGcmFtZShgaW1nX2Nvcm5lcl9tYXJrJHt0aGlzLmdhbWVfbGlzdFtpXS50YWd9YCk7XHJcbiAgICAgICAgICAgICAgICByb29tX2Nvcm5lck1hcmsuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBjb3JuZXJfbWFyaztcclxuICAgICAgICAgICAgICAgIHJvb21fY29ybmVyTWFyay5nZXRDaGlsZEJ5TmFtZShcInR4dFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IENPUk5FUl9NQVJLW3RoaXMuZ2FtZV9saXN0W2ldLnRhZ107XHJcbiAgICAgICAgICAgICAgICByb29tX2Nvcm5lck1hcmsuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDorr7nva7muLjmiI/lm77moIdcclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZV9saXN0W2ldLmljb24pIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0uZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lX2ljb25cIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSB0aGlzLmF0bGFzX3Jvb21faWNvbi5nZXRTcHJpdGVGcmFtZShgaWNvbl8ke3RoaXMuZ2FtZV9saXN0W2ldLmljb259YCk7XHJcbiAgICAgICAgICAgICAgICAvLyBsZXQgdXJsID0gZ2xHYW1lLnVzZXIuZ2V0KCd1cmwnKS5yZXNvdXJjZV91cmw7XHJcbiAgICAgICAgICAgICAgICAvLyBnbEdhbWUucGFuZWwuc2hvd1JlbW90ZUltYWdlKGl0ZW0uZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lX2ljb25cIiksIHVybCArIHRoaXMuZ2FtZV9saXN0W2ldLmljb24pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgZ2FtZU5hbWUgPSBcInJxem5uX1wiICsgaTtcclxuICAgICAgICAgICAgaWYgKGlkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZ2FtZU5hbWUgPSBnbEdhbWUuc2NlbmUuZ2V0U2NlbmVOYW1lQnlJRChpZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5nYW1lTGlzdFtnYW1lTmFtZV0gPSBpdGVtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8g5qOA5p+l5ri45oiP5piv5ZCm5pyJ5q2j5Zyo5pu05paw55qEXHJcbiAgICAgICAgdGhpcy5pc0hvdFN0YXR1cygpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+iOt+W+l+WxleekuuiKgueCueeahOS9jee9rlxyXG4gICAgZ2V0UG9zQXJyKCkge1xyXG4gICAgICAgIGxldCBwb3NYID0gdGhpcy5nYW1lSXRlbVdpZHRoLzIsIHBvc1kgPSBbOTUsIC05NV0sIHBvc0FyciA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nYW1lX2xpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gaSAlIDI7XHJcbiAgICAgICAgICAgIHBvc0Fyci5wdXNoKGNjLnYyKGluZGV4ID09IDAgJiYgaSAhPSAwID8gcG9zWCArPSB0aGlzLmdhbWVJdGVtV2lkdGggOiBwb3NYLCBwb3NZW2luZGV4XSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhcIuaIv+mXtOWIhuexu+S4i+eahOa4uOaIj+WxleekuuS9jee9ruWIl+ihqFwiLCBwb3NBcnIpXHJcbiAgICAgICAgcmV0dXJuIHBvc0FycjtcclxuICAgIH0sXHJcblxyXG4gICAgb25FbnRlclJvb21HYW1lKGdhbWVJZCkge1xyXG4gICAgICAgIC8vIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJjcmVhdGVSb29tXCIpLnRoZW4oY3JlYXRlX3Jvb20gPT4ge1xyXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcImNyZWF0ZV9yb29tID09PT0+IFwiLCBjcmVhdGVfcm9vbS5uYW1lKTtcclxuICAgICAgICAvLyAgICAgY3JlYXRlX3Jvb20uZ2V0Q29tcG9uZW50KGNyZWF0ZV9yb29tLm5hbWUpLnNldEdhbWVCdXR0b24oNDIpXHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gcmV0dXJuO1xyXG4gICAgICAgIC8vIOajgOafpeW9k+WJjea4uOaIj+aYr+WQpuW3sue7j+WcqOabtOaWsOmYn+WIl1xyXG4gICAgICAgIGlmIChnbEdhbWUuYXNzZXRzTWFuYWdlci5pc1VwZGF0ZVF1ZXVlKGdhbWVJZCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgLy8g5qOA5p+l5ri45oiP5piv5ZCm6ZyA6KaB5pu05pawXHJcbiAgICAgICAgZ2xHYW1lLmdhbWVsaXN0Y2ZnLmlzTmVlZFVwZGF0ZShnYW1lSWQpLnRoZW4oYm9sID0+IHtcclxuICAgICAgICAgICAgaWYgKGJvbCAmJiBjYy5zeXMuaXNOYXRpdmUpIHtcclxuICAgICAgICAgICAgICAgIC8vIOW8gOWni+abtOaWsOOAkCVzKOa4uOaIj+WQjeensCnjgJHvvIzor7fogJDlv4PnrYnlvoUuLi5cclxuICAgICAgICAgICAgICAgIC8vIGdsR2FtZS5wYW5lbC5zaG93VGlwKGDlvIDlp4vmm7TmlrDjgJAke2dsR2FtZS5yb29tLmdldEdhbWVEaWN0QnlJZChnYW1lSWQpfeOAke+8jOivt+iAkOW/g+etieW+hS4uLmApO1xyXG4gICAgICAgICAgICAgICAgbGV0IGdhbWVOYW1lID0gZ2xHYW1lLnNjZW5lLmdldFNjZW5lTmFtZUJ5SUQoZ2FtZUlkKTtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5nYW1lbGlzdGNmZy5zZXRHYW1lVXBkYXRlKGdhbWVOYW1lLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUuYXNzZXRzTWFuYWdlci5nYW1lVXBkYXRhKHtnYW1lSUQ6IGdhbWVJZCwgbWFuaWZlc3RVcmw6IG51bGx9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOS4jemcgOimgeabtOaWsFxyXG4gICAgICAgICAgICAgICAgLy8gZ2xHYW1lLnBhbmVsLnNob3dQYW5lbEJ5TmFtZShcImNyZWF0ZVJvb21cIilcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93UGFuZWxCeU5hbWUoXCJjcmVhdGVSb29tXCIpLnRoZW4oY3JlYXRlX3Jvb20gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlX3Jvb20gPT09PT4gXCIsIGNyZWF0ZV9yb29tLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZV9yb29tLmdldENvbXBvbmVudChjcmVhdGVfcm9vbS5uYW1lKS5zZXRHYW1lQnV0dG9uKGdhbWVJZClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWIpOaWrea4uOaIj+aYr+WQpuWcqOeDreabtFxyXG4gICAgaXNIb3RTdGF0dXMoKSB7XHJcbiAgICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHJldHVybjtcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmdhbWVMaXN0KS5mb3JFYWNoKGdhbWVOYW1lPT57XHJcbiAgICAgICAgICAgIC8vIOajgOafpeW9k+WJjeaYr+WQpuaciea4uOaIj+ato+WcqOi3n+aWsFxyXG4gICAgICAgICAgICBsZXQgaXNfdXBkYXRlX3F1ZXVlID0gZ2xHYW1lLmFzc2V0c01hbmFnZXIuaXNCZWluZ1VwZGF0ZShnYW1lTmFtZSk7XHJcbiAgICAgICAgICAgIGlmIChpc191cGRhdGVfcXVldWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7Z2FtZU5hbWU6Z2FtZU5hbWUsIGlzQWN0aXZlOnRydWV9XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNfdXBkYXRlX3F1ZXVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc1N0YXR1cyA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhvdFVJUmVmcmVzaChkYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOafpeaJvuaYr+WQpumcgOimgeabtOaWsFxyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLmFzc2V0c01hbmFnZXIuaXNOZWVkVXBkYXRlKGdhbWVOYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDng63mm7TliLfmlrBVSVxyXG4gICAgaG90VUlSZWZyZXNoKGRhdGEpIHtcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmdhbWVMaXN0KS5mb3JFYWNoKGdhbWVOYW1lPT57XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmdhbWVOYW1lID09IGdhbWVOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZ2FtZUxpc3RbZ2FtZU5hbWVdO1xyXG4gICAgICAgICAgICAgICAgbGV0IHByb2Nlc3NOZXcgPSBpdGVtLmdldENoaWxkQnlOYW1lKFwicHJvY2Vzc1wiKTtcclxuICAgICAgICAgICAgICAgIGxldCBwcm9ncmVzc1BpYyA9IHByb2Nlc3NOZXcuZ2V0Q2hpbGRCeU5hbWUoXCJwcm9cIikuZ2V0Q2hpbGRCeU5hbWUoXCJiYXJcIikuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDov5vluqbmnaFcclxuICAgICAgICAgICAgICAgIHByb2Nlc3NOZXcuYWN0aXZlID0gZGF0YS5pc0FjdGl2ZTtcclxuICAgICAgICAgICAgICAgIC8vIOaYvuekuuS4i+i9vei/m+W6plxyXG4gICAgICAgICAgICAgICAgbGV0IHNjaGVkdWxlID0gcHJvY2Vzc05ldy5nZXRDaGlsZEJ5TmFtZShcImxhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbClcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5pc1N0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g54Ot5pu05o6l57utXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlLnN0cmluZyA9IFwiMCVcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3NQaWMuZmlsbFJhbmdlID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDkuIvovb3kuK1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGUuc3RyaW5nID0gYCR7cGFyc2VJbnQoZGF0YS5wcm9jZXNzICogMTAwKSB8fCAwfSVgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc1BpYy5maWxsUmFuZ2UgPSBkYXRhLnByb2Nlc3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS4i+i9veWIl+ihqOWkp+S6juacgOWkp+WQjOaXtuS4i+i9vemHj+eahOaXtuWAmeaYvuekuuetieW+heS4rVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZS5zdHJpbmcgPSBcIuetieW+heS4rVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc1BpYy5maWxsUmFuZ2UgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKFwiaG90VUlSZWZyZXNoXCIsIHRoaXMpO1xyXG4gICAgfSxcclxufSk7Il19