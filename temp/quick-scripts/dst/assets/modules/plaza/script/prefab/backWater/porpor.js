
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/backWater/porpor.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '12b46wc8PtH65b00mmwSuZq', 'porpor');
// modules/plaza/script/prefab/backWater/porpor.js

"use strict";

/**
 * 返水比例
 */
// key 为控件名称， value 为与服务端约定好的数组名称
var GAME_VARIETY_TAB = {
  tabs_qipai: "pokerConfig",
  //棋牌
  tabs_jieji: "arcadeConfig",
  //街机
  tabs_buyu: "fishConfig",
  //捕鱼
  tabs_shixun: "videoConfig",
  //视讯
  tabs_tiyu: "sportsConfig",
  //体育
  tabs_caipiao: "lotteryConfig",
  //彩票
  tabs_dianjing: "electronicSportsConfig" //电竞

};
glGame.baseclass.extend({
  properties: {
    typeNodeList: cc.Node,
    //
    vip_page: cc.Node,
    vip_pageup: cc.Node,
    vip_rightnext: cc.Node,
    vip_level: cc.Label,
    bet_page: cc.Node,
    bet_pageup: cc.Node,
    bet_pagenext: cc.Node,
    bet_scope: cc.Label,
    ratecontent: cc.Node,
    rateitem: cc.Node
  },
  onLoad: function onLoad() {
    this.registerEvent();
    glGame.user.ReqRebateConfigList({
      accountId: glGame.user.userID,
      type: -1
    });
    this.vipLevel = 0;
    this.gradeId = 0; // vip等级id或会员层级id

    this.vipMax = 0;
    this.pageIndex = 0;
    this.betNumMax = 0;
    this.config = null;
    this.gameOrPlatMap = null;
    this.type = -1;
  },
  registerEvent: function registerEvent() {
    glGame.emitter.on("rebateConfigList", this.rebateConfigList, this);
  },
  unRegisterEvent: function unRegisterEvent() {
    glGame.emitter.off("rebateConfigList", this);
  },
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  },
  rebateConfigList: function rebateConfigList() {
    this.rebateConfigList = glGame.user.get("rebateConfigList");
    this.gameOrPlatMap = this.rebateConfigList.gameOrPlatMap;
    this.gradeId = this.rebateConfigList.gradeId;
    var vipId = this.rebateConfigList.vipId;
    var data = this.rebateConfigList.data;

    for (var i = 0; i < data.length; i++) {
      if (data[i].groupId == vipId) {
        this.vipLevel = i;
        break;
      }
    }

    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  initpageView: function initpageView() {
    if (Object.keys(this.config) == 0) {
      this.vip_page.active = false;
      this.bet_page.active = false;
      return;
    } else {
      this.vip_page.active = this.rebateConfigList.modeType == "vip";
      this.bet_page.active = true;
    }

    var keys = Object.keys(this.config); //子游戏ID数组

    var gameporpor = this.config[keys[0]]; //子游戏的数据

    var gameKeys = Object.keys(gameporpor); //区间的keys

    if (this.vip_page.active) this.vip_level.string = this.rebateConfigList.data[this.vipLevel].name;

    if (this.pageIndex == gameKeys.length - 1) {
      this.bet_scope.string = "".concat(this.cutFloat(gameKeys[this.pageIndex]), "\u4EE5\u4E0A");
    } else {
      this.bet_scope.string = "".concat(this.cutFloat(gameKeys[this.pageIndex]), "~").concat(this.cutFloat(gameKeys[this.pageIndex + 1]));
    }
  },
  initMidUI: function initMidUI() {
    var config = this.config;
    this.ratecontent.removeAllChildren();
    var gamekeys = Object.keys(config);
    var itemCount = 0;
    var item; //一个item包含3个子游戏

    var index = 0;

    for (var i = 0; i < gamekeys.length; i++) {
      if (!this.gameOrPlatMap[Number(gamekeys[i])]) {
        continue;
      }

      if (index % 3 == 0) {
        item = cc.instantiate(this.rateitem);
        item.parent = this.ratecontent;
        item.active = false;
        item.getChildByName("bg").active = itemCount % 2 == 0;
        itemCount += 1;
      }

      var childrenindex = index % 3 + 1; //节点里面有bg

      var gameitem = item.getChildByName("gamename".concat(childrenindex));
      gameitem.active = true;
      gameitem.getComponent(cc.Label).string = this.gameOrPlatMap[Number(gamekeys[i])]; //游戏名

      var gamedata = config[gamekeys[i]];
      var keys = Object.keys(gamedata);
      gameitem.getChildByName("porpor_lab").getComponent(cc.Label).string = "".concat(Number(gamedata[keys[this.pageIndex]]).div(100).toFixed(2), "%");
      index++;
    }

    glGame.panel.showEffectNode(this, this.ratecontent, 0.02, true);
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "vip_left":
        this.vipleft_cb();
        break;

      case "vip_right":
        this.vipright_cb();
        break;

      case "bet_left":
        this.betleft_cb();
        break;

      case "bet_right":
        this.betright_cb();
        break;

      default:
        if (name.indexOf("tabs_") > -1) this.selectClick(name);
        break;
    }
  },
  selectClick: function selectClick(name) {
    this.typeName = name;
    this.pageIndex = 0;
    this.chengeBtnState();
    this.setConfig();
    this.initpageView();
    this.initMidUI();
  },
  betleft_cb: function betleft_cb() {
    if (this.pageIndex == 0) return;
    this.pageIndex--;
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  betright_cb: function betright_cb() {
    if (this.pageIndex == this.betNumMax - 1) return;
    this.pageIndex++;
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  vipleft_cb: function vipleft_cb() {
    if (this.vipLevel <= 0) return;
    this.vipLevel--;
    this.pageIndex = 0;
    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  vipright_cb: function vipright_cb() {
    if (this.vipLevel == this.vipMax) return;
    this.vipLevel++;
    this.pageIndex = 0;
    this.setConfig();
    this.initpageView();
    this.initMidUI();
    this.chengeBtnState();
  },
  chengeBtnState: function chengeBtnState() {
    this.vip_pageup.active = this.vipLevel != 0;
    this.vip_rightnext.active = this.vipLevel != this.vipMax - 1;
    this.bet_pageup.active = this.pageIndex != 0;
    this.bet_pagenext.active = this.pageIndex != this.betNumMax - 1;
  },
  setConfig: function setConfig() {
    this.bet_page.active = true;

    if (this.rebateConfigList.modeType == "vip") {
      this.vipMax = Object.keys(this.rebateConfigList.data).length;
      this.config = this.rebateConfigList.data[this.vipLevel].config;
      var keys = Object.keys(this.config); //子游戏ID数组

      var gameporpor = this.config[keys[0]]; //子游戏的数据

      var gameKeys = Object.keys(gameporpor); //区间的keys

      this.betNumMax = gameKeys.length;
      this.vip_page.active = true;
      this.bet_page.x = 226;
    } else {
      this.config = this.rebateConfigList.data.config;

      var _keys = Object.keys(this.config); //子游戏ID数组


      var _gameporpor = this.config[_keys[0]]; //子游戏的数据

      var _gameKeys = Object.keys(_gameporpor); //区间的keys


      this.betNumMax = _gameKeys.length;
      this.vip_page.active = false;
      this.bet_page.x = 0;
    }
  },
  // 游戏是否开启
  isGameOpen: function isGameOpen(typeList, id) {
    var count = typeList.length;

    for (var i = 0; i < count; i++) {
      if (typeList[i].id == id) {
        return true;
      }
    }

    return false;
  },
  getFloat: function getFloat(value) {
    return Number(value).div(100).toFixed(4);
  },
  //浮点型运算取俩位
  cutFloat: function cutFloat(value) {
    return Number(value).div(100).toString();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxiYWNrV2F0ZXJcXHBvcnBvci5qcyJdLCJuYW1lcyI6WyJHQU1FX1ZBUklFVFlfVEFCIiwidGFic19xaXBhaSIsInRhYnNfamllamkiLCJ0YWJzX2J1eXUiLCJ0YWJzX3NoaXh1biIsInRhYnNfdGl5dSIsInRhYnNfY2FpcGlhbyIsInRhYnNfZGlhbmppbmciLCJnbEdhbWUiLCJiYXNlY2xhc3MiLCJleHRlbmQiLCJwcm9wZXJ0aWVzIiwidHlwZU5vZGVMaXN0IiwiY2MiLCJOb2RlIiwidmlwX3BhZ2UiLCJ2aXBfcGFnZXVwIiwidmlwX3JpZ2h0bmV4dCIsInZpcF9sZXZlbCIsIkxhYmVsIiwiYmV0X3BhZ2UiLCJiZXRfcGFnZXVwIiwiYmV0X3BhZ2VuZXh0IiwiYmV0X3Njb3BlIiwicmF0ZWNvbnRlbnQiLCJyYXRlaXRlbSIsIm9uTG9hZCIsInJlZ2lzdGVyRXZlbnQiLCJ1c2VyIiwiUmVxUmViYXRlQ29uZmlnTGlzdCIsImFjY291bnRJZCIsInVzZXJJRCIsInR5cGUiLCJ2aXBMZXZlbCIsImdyYWRlSWQiLCJ2aXBNYXgiLCJwYWdlSW5kZXgiLCJiZXROdW1NYXgiLCJjb25maWciLCJnYW1lT3JQbGF0TWFwIiwiZW1pdHRlciIsIm9uIiwicmViYXRlQ29uZmlnTGlzdCIsInVuUmVnaXN0ZXJFdmVudCIsIm9mZiIsIk9uRGVzdHJveSIsImdldCIsInZpcElkIiwiZGF0YSIsImkiLCJsZW5ndGgiLCJncm91cElkIiwic2V0Q29uZmlnIiwiaW5pdHBhZ2VWaWV3IiwiaW5pdE1pZFVJIiwiY2hlbmdlQnRuU3RhdGUiLCJPYmplY3QiLCJrZXlzIiwiYWN0aXZlIiwibW9kZVR5cGUiLCJnYW1lcG9ycG9yIiwiZ2FtZUtleXMiLCJzdHJpbmciLCJuYW1lIiwiY3V0RmxvYXQiLCJyZW1vdmVBbGxDaGlsZHJlbiIsImdhbWVrZXlzIiwiaXRlbUNvdW50IiwiaXRlbSIsImluZGV4IiwiTnVtYmVyIiwiaW5zdGFudGlhdGUiLCJwYXJlbnQiLCJnZXRDaGlsZEJ5TmFtZSIsImNoaWxkcmVuaW5kZXgiLCJnYW1laXRlbSIsImdldENvbXBvbmVudCIsImdhbWVkYXRhIiwiZGl2IiwidG9GaXhlZCIsInBhbmVsIiwic2hvd0VmZmVjdE5vZGUiLCJvbkNsaWNrIiwibm9kZSIsInZpcGxlZnRfY2IiLCJ2aXByaWdodF9jYiIsImJldGxlZnRfY2IiLCJiZXRyaWdodF9jYiIsImluZGV4T2YiLCJzZWxlY3RDbGljayIsInR5cGVOYW1lIiwieCIsImlzR2FtZU9wZW4iLCJ0eXBlTGlzdCIsImlkIiwiY291bnQiLCJnZXRGbG9hdCIsInZhbHVlIiwidG9TdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7OztBQUlBO0FBQ0EsSUFBTUEsZ0JBQWdCLEdBQUc7QUFDckJDLEVBQUFBLFVBQVUsRUFBRSxhQURTO0FBQ21CO0FBQ3hDQyxFQUFBQSxVQUFVLEVBQUUsY0FGUztBQUVtQjtBQUN4Q0MsRUFBQUEsU0FBUyxFQUFFLFlBSFU7QUFHbUI7QUFDeENDLEVBQUFBLFdBQVcsRUFBRSxhQUpRO0FBSW1CO0FBQ3hDQyxFQUFBQSxTQUFTLEVBQUUsY0FMVTtBQUttQjtBQUN4Q0MsRUFBQUEsWUFBWSxFQUFFLGVBTk87QUFNbUI7QUFDeENDLEVBQUFBLGFBQWEsRUFBRSx3QkFQTSxDQU9tQjs7QUFQbkIsQ0FBekI7QUFVQUMsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QjtBQUNwQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFlBQVksRUFBRUMsRUFBRSxDQUFDQyxJQURUO0FBRVI7QUFDQUMsSUFBQUEsUUFBUSxFQUFFRixFQUFFLENBQUNDLElBSEw7QUFJUkUsSUFBQUEsVUFBVSxFQUFFSCxFQUFFLENBQUNDLElBSlA7QUFLUkcsSUFBQUEsYUFBYSxFQUFFSixFQUFFLENBQUNDLElBTFY7QUFNUkksSUFBQUEsU0FBUyxFQUFFTCxFQUFFLENBQUNNLEtBTk47QUFRUkMs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QUFrQixHQUFsQixFQUF1Qm9CLFFBQXZCLEVBQVA7QUFDSDtBQTlObUIsQ0FBeEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDov5TmsLTmr5TkvotcclxuICovXHJcblxyXG4vLyBrZXkg5Li65o6n5Lu25ZCN56ew77yMIHZhbHVlIOS4uuS4juacjeWKoeerr+e6puWumuWlveeahOaVsOe7hOWQjeensFxyXG5jb25zdCBHQU1FX1ZBUklFVFlfVEFCID0ge1xyXG4gICAgdGFic19xaXBhaTogXCJwb2tlckNvbmZpZ1wiLCAgICAgICAgICAgICAgLy/mo4vniYxcclxuICAgIHRhYnNfamllamk6IFwiYXJjYWRlQ29uZmlnXCIsICAgICAgICAgICAgIC8v6KGX5py6XHJcbiAgICB0YWJzX2J1eXU6IFwiZmlzaENvbmZpZ1wiLCAgICAgICAgICAgICAgICAvL+aNlemxvFxyXG4gICAgdGFic19zaGl4dW46IFwidmlkZW9Db25maWdcIiwgICAgICAgICAgICAgLy/op4borq9cclxuICAgIHRhYnNfdGl5dTogXCJzcG9ydHNDb25maWdcIiwgICAgICAgICAgICAgIC8v5L2T6IKyXHJcbiAgICB0YWJzX2NhaXBpYW86IFwibG90dGVyeUNvbmZpZ1wiLCAgICAgICAgICAvL+W9qeelqFxyXG4gICAgdGFic19kaWFuamluZzogXCJlbGVjdHJvbmljU3BvcnRzQ29uZmlnXCIsLy/nlLXnq55cclxufVxyXG5cclxuZ2xHYW1lLmJhc2VjbGFzcy5leHRlbmQoe1xyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHR5cGVOb2RlTGlzdDogY2MuTm9kZSxcclxuICAgICAgICAvL1xyXG4gICAgICAgIHZpcF9wYWdlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHZpcF9wYWdldXA6IGNjLk5vZGUsXHJcbiAgICAgICAgdmlwX3JpZ2h0bmV4dDogY2MuTm9kZSxcclxuICAgICAgICB2aXBfbGV2ZWw6IGNjLkxhYmVsLFxyXG5cclxuICAgICAgICBiZXRfcGFnZTogY2MuTm9kZSxcclxuICAgICAgICBiZXRfcGFnZXVwOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJldF9wYWdlbmV4dDogY2MuTm9kZSxcclxuICAgICAgICBiZXRfc2NvcGU6IGNjLkxhYmVsLFxyXG5cclxuICAgICAgICByYXRlY29udGVudDogY2MuTm9kZSxcclxuICAgICAgICByYXRlaXRlbTogY2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgICAgIGdsR2FtZS51c2VyLlJlcVJlYmF0ZUNvbmZpZ0xpc3Qoe1xyXG4gICAgICAgICAgICBhY2NvdW50SWQ6IGdsR2FtZS51c2VyLnVzZXJJRCxcclxuICAgICAgICAgICAgdHlwZTogLTEsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy52aXBMZXZlbCA9IDA7XHJcbiAgICAgICAgdGhpcy5ncmFkZUlkID0gMDsgICAgICAvLyB2aXDnrYnnuqdpZOaIluS8muWRmOWxgue6p2lkXHJcbiAgICAgICAgdGhpcy52aXBNYXggPSAwO1xyXG4gICAgICAgIHRoaXMucGFnZUluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmJldE51bU1heCA9IDA7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZ2FtZU9yUGxhdE1hcCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50eXBlID0gLTE7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oXCJyZWJhdGVDb25maWdMaXN0XCIsIHRoaXMucmViYXRlQ29uZmlnTGlzdCwgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgdW5SZWdpc3RlckV2ZW50KCkge1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcInJlYmF0ZUNvbmZpZ0xpc3RcIiwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIE9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLnVuUmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICByZWJhdGVDb25maWdMaXN0KCkge1xyXG4gICAgICAgIHRoaXMucmViYXRlQ29uZmlnTGlzdCA9IGdsR2FtZS51c2VyLmdldChcInJlYmF0ZUNvbmZpZ0xpc3RcIik7XHJcbiAgICAgICAgdGhpcy5nYW1lT3JQbGF0TWFwID0gdGhpcy5yZWJhdGVDb25maWdMaXN0LmdhbWVPclBsYXRNYXA7XHJcbiAgICAgICAgdGhpcy5ncmFkZUlkID0gdGhpcy5yZWJhdGVDb25maWdMaXN0LmdyYWRlSWQ7XHJcbiAgICAgICAgbGV0IHZpcElkID0gdGhpcy5yZWJhdGVDb25maWdMaXN0LnZpcElkO1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5yZWJhdGVDb25maWdMaXN0LmRhdGE7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYoZGF0YVtpXS5ncm91cElkID09IHZpcElkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpcExldmVsID0gaTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0Q29uZmlnKCk7XHJcbiAgICAgICAgdGhpcy5pbml0cGFnZVZpZXcoKTtcclxuICAgICAgICB0aGlzLmluaXRNaWRVSSgpO1xyXG4gICAgICAgIHRoaXMuY2hlbmdlQnRuU3RhdGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaW5pdHBhZ2VWaWV3KCkge1xyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmNvbmZpZykgPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpcF9wYWdlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJldF9wYWdlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy52aXBfcGFnZS5hY3RpdmUgPSB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QubW9kZVR5cGUgPT0gXCJ2aXBcIjtcclxuICAgICAgICAgICAgdGhpcy5iZXRfcGFnZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmNvbmZpZykgICAgICAgICAgICAgICAgIC8v5a2Q5ri45oiPSUTmlbDnu4RcclxuICAgICAgICBsZXQgZ2FtZXBvcnBvciA9IHRoaXMuY29uZmlnW2tleXNbMF1dOyAgICAgICAgICAgICAgLy/lrZDmuLjmiI/nmoTmlbDmja5cclxuICAgICAgICBsZXQgZ2FtZUtleXMgPSBPYmplY3Qua2V5cyhnYW1lcG9ycG9yKTsgICAgICAgICAgICAgLy/ljLrpl7TnmoRrZXlzXHJcblxyXG4gICAgICAgIGlmICh0aGlzLnZpcF9wYWdlLmFjdGl2ZSkgdGhpcy52aXBfbGV2ZWwuc3RyaW5nID0gdGhpcy5yZWJhdGVDb25maWdMaXN0LmRhdGFbdGhpcy52aXBMZXZlbF0ubmFtZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ID09IGdhbWVLZXlzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgdGhpcy5iZXRfc2NvcGUuc3RyaW5nID0gYCR7dGhpcy5jdXRGbG9hdChnYW1lS2V5c1t0aGlzLnBhZ2VJbmRleF0pfeS7peS4imBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmJldF9zY29wZS5zdHJpbmcgPSBgJHt0aGlzLmN1dEZsb2F0KGdhbWVLZXlzW3RoaXMucGFnZUluZGV4XSl9fiR7dGhpcy5jdXRGbG9hdChnYW1lS2V5c1t0aGlzLnBhZ2VJbmRleCArIDFdKX1gXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGluaXRNaWRVSSgpIHtcclxuICAgICAgICBsZXQgY29uZmlnID0gdGhpcy5jb25maWc7XHJcbiAgICAgICAgdGhpcy5yYXRlY29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xyXG4gICAgICAgIGxldCBnYW1la2V5cyA9IE9iamVjdC5rZXlzKGNvbmZpZylcclxuICAgICAgICBsZXQgaXRlbUNvdW50ID0gMDtcclxuICAgICAgICBsZXQgaXRlbTsgICAgICAgICAgICAgICAvL+S4gOS4qml0ZW3ljIXlkKsz5Liq5a2Q5ri45oiPXHJcbiAgICAgICAgbGV0IGluZGV4ID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVrZXlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmdhbWVPclBsYXRNYXBbTnVtYmVyKGdhbWVrZXlzW2ldKV0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoaW5kZXggJSAzID09IDApIHtcclxuICAgICAgICAgICAgICAgIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJhdGVpdGVtKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0ucGFyZW50ID0gdGhpcy5yYXRlY29udGVudDtcclxuICAgICAgICAgICAgICAgIGl0ZW0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmdldENoaWxkQnlOYW1lKFwiYmdcIikuYWN0aXZlID0gaXRlbUNvdW50ICUgMiA9PSAwXHJcbiAgICAgICAgICAgICAgICBpdGVtQ291bnQgKz0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgY2hpbGRyZW5pbmRleCA9IChpbmRleCAlIDMpICsgMTsgICAgLy/oioLngrnph4zpnaLmnIliZ1xyXG4gICAgICAgICAgICBsZXQgZ2FtZWl0ZW0gPSBpdGVtLmdldENoaWxkQnlOYW1lKGBnYW1lbmFtZSR7Y2hpbGRyZW5pbmRleH1gKVxyXG4gICAgICAgICAgICBnYW1laXRlbS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBnYW1laXRlbS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMuZ2FtZU9yUGxhdE1hcFtOdW1iZXIoZ2FtZWtleXNbaV0pXTsgLy/muLjmiI/lkI1cclxuXHJcbiAgICAgICAgICAgIGxldCBnYW1lZGF0YSA9IGNvbmZpZ1tnYW1la2V5c1tpXV07XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMoZ2FtZWRhdGEpO1xyXG4gICAgICAgICAgICBnYW1laXRlbS5nZXRDaGlsZEJ5TmFtZShcInBvcnBvcl9sYWJcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBgJHtOdW1iZXIoZ2FtZWRhdGFba2V5c1t0aGlzLnBhZ2VJbmRleF1dKS5kaXYoMTAwKS50b0ZpeGVkKDIpfSVgO1xyXG5cclxuICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFZmZlY3ROb2RlKHRoaXMsdGhpcy5yYXRlY29udGVudCwwLjAyLHRydWUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsaWNrKG5hbWUsIG5vZGUpIHtcclxuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcInZpcF9sZWZ0XCI6IHRoaXMudmlwbGVmdF9jYigpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInZpcF9yaWdodFwiOiB0aGlzLnZpcHJpZ2h0X2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYmV0X2xlZnRcIjogdGhpcy5iZXRsZWZ0X2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYmV0X3JpZ2h0XCI6IHRoaXMuYmV0cmlnaHRfY2IoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5pbmRleE9mKFwidGFic19cIikgPiAtMSkgdGhpcy5zZWxlY3RDbGljayhuYW1lKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2VsZWN0Q2xpY2sobmFtZSkge1xyXG4gICAgICAgIHRoaXMudHlwZU5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMucGFnZUluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5zZXRDb25maWcoKTtcclxuICAgICAgICB0aGlzLmluaXRwYWdlVmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdE1pZFVJKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGJldGxlZnRfY2IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucGFnZUluZGV4ID09IDApIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleC0tO1xyXG4gICAgICAgIHRoaXMuaW5pdHBhZ2VWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWlkVUkoKTtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGJldHJpZ2h0X2NiKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhZ2VJbmRleCA9PSB0aGlzLmJldE51bU1heCAtIDEpIHJldHVybjtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCsrO1xyXG4gICAgICAgIHRoaXMuaW5pdHBhZ2VWaWV3KCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWlkVUkoKTtcclxuICAgICAgICB0aGlzLmNoZW5nZUJ0blN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHZpcGxlZnRfY2IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlwTGV2ZWwgPD0gMCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMudmlwTGV2ZWwtLTtcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5zZXRDb25maWcoKTtcclxuICAgICAgICB0aGlzLmluaXRwYWdlVmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdE1pZFVJKCk7XHJcbiAgICAgICAgdGhpcy5jaGVuZ2VCdG5TdGF0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICB2aXByaWdodF9jYigpIHtcclxuICAgICAgICBpZiAodGhpcy52aXBMZXZlbCA9PSB0aGlzLnZpcE1heCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMudmlwTGV2ZWwrKztcclxuICAgICAgICB0aGlzLnBhZ2VJbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5zZXRDb25maWcoKTtcclxuICAgICAgICB0aGlzLmluaXRwYWdlVmlldygpO1xyXG4gICAgICAgIHRoaXMuaW5pdE1pZFVJKCk7XHJcbiAgICAgICAgdGhpcy5jaGVuZ2VCdG5TdGF0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGVuZ2VCdG5TdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLnZpcF9wYWdldXAuYWN0aXZlID0gdGhpcy52aXBMZXZlbCAhPSAwO1xyXG4gICAgICAgIHRoaXMudmlwX3JpZ2h0bmV4dC5hY3RpdmUgPSB0aGlzLnZpcExldmVsICE9IHRoaXMudmlwTWF4IC0gMTtcclxuICAgICAgICB0aGlzLmJldF9wYWdldXAuYWN0aXZlID0gdGhpcy5wYWdlSW5kZXggIT0gMDtcclxuICAgICAgICB0aGlzLmJldF9wYWdlbmV4dC5hY3RpdmUgPSB0aGlzLnBhZ2VJbmRleCAhPSB0aGlzLmJldE51bU1heCAtIDE7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldENvbmZpZygpIHtcclxuICAgICAgICB0aGlzLmJldF9wYWdlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMucmViYXRlQ29uZmlnTGlzdC5tb2RlVHlwZSA9PSBcInZpcFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlwTWF4ID0gT2JqZWN0LmtleXModGhpcy5yZWJhdGVDb25maWdMaXN0LmRhdGEpLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcgPSB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QuZGF0YVt0aGlzLnZpcExldmVsXS5jb25maWc7XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb25maWcpOyAgICAgICAgICAgICAgICAgICAgICAgICAvL+WtkOa4uOaIj0lE5pWw57uEXHJcbiAgICAgICAgICAgIGxldCBnYW1lcG9ycG9yID0gdGhpcy5jb25maWdba2V5c1swXV07ICAgICAgICAgICAgICAgICAgICAgIC8v5a2Q5ri45oiP55qE5pWw5o2uXHJcbiAgICAgICAgICAgIGxldCBnYW1lS2V5cyA9IE9iamVjdC5rZXlzKGdhbWVwb3Jwb3IpOyAgICAgICAgICAgICAgICAgICAgIC8v5Yy66Ze055qEa2V5c1xyXG4gICAgICAgICAgICB0aGlzLmJldE51bU1heCA9IGdhbWVLZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy52aXBfcGFnZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJldF9wYWdlLnggPSAyMjY7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb25maWcgPSB0aGlzLnJlYmF0ZUNvbmZpZ0xpc3QuZGF0YS5jb25maWc7XHJcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jb25maWcpICAgICAgICAgICAgICAgICAgICAgICAgIC8v5a2Q5ri45oiPSUTmlbDnu4RcclxuICAgICAgICAgICAgbGV0IGdhbWVwb3Jwb3IgPSB0aGlzLmNvbmZpZ1trZXlzWzBdXTsgICAgICAgICAgICAgICAgICAgICAgLy/lrZDmuLjmiI/nmoTmlbDmja5cclxuICAgICAgICAgICAgbGV0IGdhbWVLZXlzID0gT2JqZWN0LmtleXMoZ2FtZXBvcnBvcik7ICAgICAgICAgICAgICAgICAgICAgLy/ljLrpl7TnmoRrZXlzXHJcbiAgICAgICAgICAgIHRoaXMuYmV0TnVtTWF4ID0gZ2FtZUtleXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLnZpcF9wYWdlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJldF9wYWdlLnggPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5ri45oiP5piv5ZCm5byA5ZCvXHJcbiAgICBpc0dhbWVPcGVuKHR5cGVMaXN0LCBpZCkge1xyXG4gICAgICAgIGxldCBjb3VudCA9IHR5cGVMaXN0Lmxlbmd0aDtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICBpZih0eXBlTGlzdFtpXS5pZCA9PSBpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0RmxvYXQodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gKE51bWJlcih2YWx1ZSkuZGl2KDEwMCkpLnRvRml4ZWQoNCk7XHJcbiAgICB9LFxyXG4gICAgLy/mta7ngrnlnovov5Dnrpflj5bkv6nkvY1cclxuICAgIGN1dEZsb2F0KHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZSkuZGl2KDEwMCkudG9TdHJpbmcoKTtcclxuICAgIH0sXHJcblxyXG59KTtcclxuIl19