
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/enterRoom/sssentry.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '5bb7b5yqmtGrrpfzkGiCXKP', 'sssentry');
// modules/plaza/script/prefab/enterRoom/sssentry.js

"use strict";

glGame.baseclass.extend({
  properties: {
    BGM: {
      type: cc.AudioClip,
      "default": null
    },
    goldCount: cc.Label,
    sssRecord: cc.Prefab,
    sssRule: cc.Prefab,
    ptf_text: [cc.Label],
    gbf_text: [cc.Label],
    fhf_text: [cc.Label],
    sp_role: [sp.Skeleton],
    level: {
      type: cc.Node,
      "default": []
    }
  },
  onLoad: function onLoad() {
    this.limitTxt = [this.tyf_text, this.ptf_text, this.gbf_text, this.fhf_text];
    this.gameid = 0;
    this.node.zIndex = 20;
    glGame.emitter.on(MESSAGE.UI.ROOM_ENTER_SHOW, this.RootNodeShow, this);
    glGame.emitter.on(MESSAGE.UI.ROOM_ENTER_HIDE, this.RootNodeHide, this);
    glGame.emitter.on("nodeRemove", this.click_back, this);
    glGame.emitter.on("updateUserData", this.updateuserInfo, this);
    this.registerEvent();
    this.reqEnterArea();
    this.updateuserInfo();
    this.aniEvent();
  },
  RootNodeShow: function RootNodeShow() {
    this.node.active = true;
    this.registerEvent();
    this.reqEnterArea();
  },
  RootNodeHide: function RootNodeHide() {
    this.node.active = false;
    this.unregisterEvent();
  },
  registerEvent: function registerEvent() {
    glGame.emitter.on("goldOnlineNum", this.goldOnlineNum, this);
    glGame.emitter.on("onGameConfig", this.onGameConfig, this);
  },
  unregisterEvent: function unregisterEvent() {
    glGame.emitter.off("goldOnlineNum", this);
    glGame.emitter.off("onGameConfig", this);
  },
  reqEnterArea: function reqEnterArea() {
    this.gameID = glGame.scenetag.SSS;
    glGame.readyroom.reqEnterArea(glGame.scenetag.SSS);
  },
  onGameConfig: function onGameConfig(msg) {
    this.gameConfig = msg;
    this.initUI();
  },
  initUI: function initUI() {
    this.node.active = true;
    var configure = this.gameConfig;
    var count = this.level.length;

    for (var i = 0; i < count; i++) {
      if (i > 0) {
        // 底注
        this.limitTxt[i][0].string = this.getFloat(configure[i].BaseChips); // 准入

        this.limitTxt[i][1].string = this.getFloat(configure[i].EntranceRestrictions);
      }
    }
  },
  //骨骼动画播放结束的回调
  aniEvent: function aniEvent() {
    var _this = this;

    var count = this.level.length;

    var _loop = function _loop(i) {
      var tiem = i * 0.13;

      _this.node.runAction(cc.sequence(cc.delayTime(tiem), cc.callFunc(function () {
        _this.sp_role[i].node.active = true;

        _this.sp_role[i].setAnimation(0, "idle3", false);

        _this.sp_role[i].setCompleteListener(function (trackEntry, loopCount) {
          var name = trackEntry.animation ? trackEntry.animation.name : "";

          if (name == "idle3") {
            _this.sp_role[i].setAnimation(0, "idle2", true);
          }
        });
      })));
    };

    for (var i = 0; i < count; i++) {
      _loop(i);
    }
  },

  /**
   * 检查玩家金币是否足够
   * @returns {boolean}
   */
  checkGold: function checkGold(coin, minCion) {
    if (parseInt(coin) < parseInt(minCion)) {
      glGame.panel.showDialog(glGame.i18n.t("USER.GOLDLACK.TITLE"), glGame.i18n.t("USER.GOLDLACK.CONTENT"), function () {
        glGame.panel.showPanelByName("shop");
      }, null);
      return false;
    }

    return true;
  },
  getFloat: function getFloat(value) {
    return Number(value).div(100).toString();
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "primary":
        this.enterGame(99);
        break;

      case "intermediate":
        this.enterGame(1);
        break;

      case "senior":
        this.enterGame(2);
        break;

      case "tuhao":
        this.enterGame(3);
        break;

      case "btn_back":
        this.click_back();
        break;

      case "btn_help":
        this.click_help();
        break;

      case "btn_record":
        this.click_record();
        break;

      case "mycoinInfo":
        this.click_addgold();
        break;

      case "headbg":
        this.click_userinfo();
        break;

      case "btn_chongzhi":
        this.click_addgold();
        break;

      default:
        console.error("no find button name -> %s", name);
    }
  },

  /**
   * 进入金币场房间
   * @param level 场次类型 1:普通场 2:贵宾场 3:富豪场
   */
  enterGame: function enterGame(level) {
    var _this2 = this;

    glGame.room.reqMyGameState(this.gameID, level).then(function () {
      var gameID = _this2.gameID;

      if (_this2.gameConfig[level] == null) {
        glGame.panel.showMsgBox('提示', '该房间尚未开放，请尝试其他房间。');
        return;
      }

      if (glGame.user.isTourist()) {
        if (level != 99) {
          glGame.panel.showRegisteredGift(true);
          return;
        }
      }

      if (glGame.user.suspicious == 1 && glGame.user.game == 2 || glGame.user.is_game == 2) {
        glGame.panel.showDialog("", "您的账号数据异常，暂时禁止进入游戏，如有疑问，请联系客服！", function () {
          glGame.panel.showService();
        }, function () {}, "我知道了", "联系客服");
        return;
      }

      if (_this2.gameConfig[level].EntranceRestrictions > glGame.user.get("coin")) {
        console.log("这是当前的房间限制", _this2.gameConfig);
        var string = "<color=#99C7FF>\u60A8\u7684\u91D1\u5E01\u4E0D\u8DB3\uFF0C\u8BE5\u623F\u95F4\u9700\u8981</c> <color=#ff0000> ".concat(_this2.getFloat(_this2.gameConfig[level].EntranceRestrictions), "  </c><color=#99C7FF>\u91D1\u5E01\u624D\u53EF\u4E0B\u6CE8\uFF0C\u662F\u5426\u9A6C\u4E0A\u524D\u5F80\u5145\u503C\uFF1F</c>");
        glGame.panel.showDialog("", string, function () {
          glGame.panel.showShop(100);
        }, function () {}, "取消", "充值");
        return;
      }

      glGame.panel.showJuHua();

      _this2.node.runAction(cc.sequence(cc.delayTime(15), cc.callFunc(function () {
        glGame.panel.closeJuHua();
      })));

      glGame.room.setGoldRoomInfo(gameID, level);
    });
  },
  showUserInfo: function showUserInfo() {
    glGame.panel.showRemoteImage(this.Playerhead, glGame.user.get("headURL"));
  },
  updateuserInfo: function updateuserInfo() {
    var coin = glGame.user.get("coin");
    this.goldCount.string = glGame.user.GoldTemp(coin); //glGame.user.cutFloat(coin);
  },
  setGameId: function setGameId(gameid) {
    this.gameid = gameid;
  },
  updateBgInfo: function updateBgInfo() {},
  click_userinfo: function click_userinfo() {
    glGame.panel.showPanelByName("userinfo");
  },
  click_addgold: function click_addgold() {
    glGame.panel.showShop(30);
  },
  click_back: function click_back() {
    glGame.readyroom.reqExitArea();
    this.remove();
  },
  click_help: function click_help() {
    var panel = glGame.panel.showPanel(this.sssRule);
    panel.zIndex = 30;
  },
  click_record: function click_record() {
    var panel = glGame.panel.showPanel(this.sssRecord);
    panel.zIndex = 30;
  },
  set: function set(key, value) {
    this[key] = value;
  },
  get: function get(key) {
    return this[key];
  },
  OnDestroy: function OnDestroy() {
    glGame.emitter.off(MESSAGE.UI.ROOM_ENTER_SHOW, this);
    glGame.emitter.off(MESSAGE.UI.ROOM_ENTER_HIDE, this);
    glGame.emitter.off("nodeRemove", this);
    glGame.emitter.off("updateUserData", this);
    this.unregisterEvent();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxlbnRlclJvb21cXHNzc2VudHJ5LmpzIl0sIm5hbWVzIjpbImdsR2FtZSIsImJhc2VjbGFzcyIsImV4dGVuZCIsInByb3BlcnRpZXMiLCJCR00iLCJ0eXBlIiwiY2MiLCJBdWRpb0NsaXAiLCJnb2xkQ291bnQiLCJMYWJlbCIsInNzc1JlY29yZCIsIlByZWZhYiIsInNzc1J1bGUiLCJwdGZfdGV4dCIsImdiZl90ZXh0IiwiZmhmX3RleHQiLCJzcF9yb2xlIiwic3AiLCJTa2VsZXRvbiIsImxldmVsIiwiTm9kZSIsIm9uTG9hZCIsImxpbWl0VHh0IiwidHlmX3RleHQiLCJnYW1laWQiLCJub2RlIiwiekluZGV4IiwiZW1pdHRlciIsIm9uIiwiTUVTU0FHRSIsIlVJIiwiUk9PTV9FTlRFUl9TSE9XIiwiUm9vdE5vZGVTaG93IiwiUk9PTV9FTlRFUl9ISURFIiwiUm9vdE5vZGVIaWRlIiwiY2xpY2tfYmFjayIsInVwZGF0ZXVzZXJJbmZvIiwicmVnaXN0ZXJFdmVudCIsInJlcUVudGVyQXJlYSIsImFuaUV2ZW50IiwiYWN0aXZlIiwidW5yZWdpc3RlckV2ZW50IiwiZ29sZE9ubGluZU51bSIsIm9uR2FtZUNvbmZpZyIsIm9mZiIsImdhbWVJRCIsInNjZW5ldGFnIiwiU1NTIiwicmVhZHlyb29tIiwibXNnIiwiZ2FtZUNvbmZpZyIsImluaXRVSSIsImNvbmZpZ3VyZSIsImNvdW50IiwibGVuZ3RoIiwiaSIsInN0cmluZyIsImdldEZsb2F0IiwiQmFzZUNoaXBzIiwiRW50cmFuY2VSZXN0cmljdGlvbnMiLCJ0aWVtIiwicnVuQWN0aW9uIiwic2VxdWVuY2UiLCJkZWxheVRpbWUiLCJjYWxsRnVuYyIsInNldEFuaW1hdGlvbiIsInNldENvbXBsZXRlTGlzdGVuZXIiLCJ0cmFja0VudHJ5IiwibG9vcENvdW50IiwibmFtZSIsImFuaW1hdGlvbiIsImNoZWNrR29sZCIsImNvaW4iLCJtaW5DaW9uIiwicGFyc2VJbnQiLCJwYW5lbCIsInNob3dEaWFsb2ciLCJpMThuIiwidCIsInNob3dQYW5lbEJ5TmFtZSIsInZhbHVlIiwiTnVtYmVyIiwiZGl2IiwidG9TdHJpbmciLCJvbkNsaWNrIiwiZW50ZXJHYW1lIiwiY2xpY2tfaGVscCIsImNsaWNrX3JlY29yZCIsImNsaWNrX2FkZGdvbGQiLCJjbGlja191c2VyaW5mbyIsImNvbnNvbGUiLCJlcnJvciIsInJvb20iLCJyZXFNeUdhbWVTdGF0ZSIsInRoZW4iLCJzaG93TXNnQm94IiwidXNlciIsImlzVG91cmlzdCIsInNob3dSZWdpc3RlcmVkR2lmdCIsInN1c3BpY2lvdXMiLCJnYW1lIiwiaXNfZ2FtZSIsInNob3dTZXJ2aWNlIiwiZ2V0IiwibG9nIiwic2hvd1Nob3AiLCJzaG93SnVIdWEiLCJjbG9zZUp1SHVhIiwic2V0R29sZFJvb21JbmZvIiwic2hvd1VzZXJJbmZvIiwic2hvd1JlbW90ZUltYWdlIiwiUGxheWVyaGVhZCIsIkdvbGRUZW1wIiwic2V0R2FtZUlkIiwidXBkYXRlQmdJbmZvIiwicmVxRXhpdEFyZWEiLCJyZW1vdmUiLCJzaG93UGFuZWwiLCJzZXQiLCJrZXkiLCJPbkRlc3Ryb3kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0I7QUFFcEJDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxHQUFHLEVBQUU7QUFDREMsTUFBQUEsSUFBSSxFQUFFQyxFQUFFLENBQUNDLFNBRFI7QUFFRCxpQkFBUztBQUZSLEtBREc7QUFLUkMsSUFBQUEsU0FBUyxFQUFFRixFQUFFLENBQUNHLEtBTE47QUFNUkMsSUFBQUEsU0FBUyxFQUFFSixFQUFFLENBQUNLLE1BTk47QUFPUkMsSUFBQUEsT0FBTyxFQUFFTixFQUFFLENBQUNLLE1BUEo7QUFTUkUsSUFBQUEsUUFBUSxFQUFFLENBQUNQLEVBQUUsQ0FBQ0csS0FBSixDQVRGO0FBVVJLLElBQUFBLFFBQVEsRUFBRSxD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QjtBQWtPcEJDLEVBQUFBLFNBbE9vQix1QkFrT1I7QUFDUnhILElBQUFBLE1BQU0sQ0FBQzJCLE9BQVAsQ0FBZWlCLEdBQWYsQ0FBbUJmLE9BQU8sQ0FBQ0MsRUFBUixDQUFXQyxlQUE5QixFQUE4QyxJQUE5QztBQUNBL0IsSUFBQUEsTUFBTSxDQUFDMkIsT0FBUCxDQUFlaUIsR0FBZixDQUFtQmYsT0FBTyxDQUFDQyxFQUFSLENBQVdHLGVBQTlCLEVBQThDLElBQTlDO0FBQ0FqQyxJQUFBQSxNQUFNLENBQUMyQixPQUFQLENBQWVpQixHQUFmLENBQW1CLFlBQW5CLEVBQWlDLElBQWpDO0FBQ0E1QyxJQUFBQSxNQUFNLENBQUMyQixPQUFQLENBQWVpQixHQUFmLENBQW1CLGdCQUFuQixFQUFvQyxJQUFwQztBQUNBLFNBQUtILGVBQUw7QUFDSDtBQXhPbUIsQ0FBeEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImdsR2FtZS5iYXNlY2xhc3MuZXh0ZW5kKHtcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgQkdNOiB7XHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcCxcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdvbGRDb3VudDogY2MuTGFiZWwsXHJcbiAgICAgICAgc3NzUmVjb3JkOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgc3NzUnVsZTogY2MuUHJlZmFiLFxyXG5cclxuICAgICAgICBwdGZfdGV4dDogW2NjLkxhYmVsXSxcclxuICAgICAgICBnYmZfdGV4dDogW2NjLkxhYmVsXSxcclxuICAgICAgICBmaGZfdGV4dDogW2NjLkxhYmVsXSxcclxuXHJcbiAgICAgICAgc3Bfcm9sZTogW3NwLlNrZWxldG9uXSxcclxuXHJcbiAgICAgICAgbGV2ZWw6IHtcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgICAgICAgICAgZGVmYXVsdDogW11cclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5saW1pdFR4dCA9IFtcclxuICAgICAgICAgICAgdGhpcy50eWZfdGV4dCxcclxuICAgICAgICAgICAgdGhpcy5wdGZfdGV4dCxcclxuICAgICAgICAgICAgdGhpcy5nYmZfdGV4dCxcclxuICAgICAgICAgICAgdGhpcy5maGZfdGV4dFxyXG4gICAgICAgIF07XHJcblxyXG4gICAgICAgIHRoaXMuZ2FtZWlkID0gMDtcclxuICAgICAgICB0aGlzLm5vZGUuekluZGV4ID0gMjA7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oTUVTU0FHRS5VSS5ST09NX0VOVEVSX1NIT1csIHRoaXMuUm9vdE5vZGVTaG93LCB0aGlzKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihNRVNTQUdFLlVJLlJPT01fRU5URVJfSElERSwgdGhpcy5Sb290Tm9kZUhpZGUsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKFwibm9kZVJlbW92ZVwiLCB0aGlzLmNsaWNrX2JhY2ssIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKFwidXBkYXRlVXNlckRhdGFcIiwgdGhpcy51cGRhdGV1c2VySW5mbywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KCk7XHJcbiAgICAgICAgdGhpcy5yZXFFbnRlckFyZWEoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZXVzZXJJbmZvKCk7XHJcbiAgICAgICAgdGhpcy5hbmlFdmVudCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBSb290Tm9kZVNob3coKXtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgICAgICB0aGlzLnJlcUVudGVyQXJlYSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBSb290Tm9kZUhpZGUoKXtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihcImdvbGRPbmxpbmVOdW1cIiwgdGhpcy5nb2xkT25saW5lTnVtLCB0aGlzKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihcIm9uR2FtZUNvbmZpZ1wiLCB0aGlzLm9uR2FtZUNvbmZpZywgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVucmVnaXN0ZXJFdmVudCgpIHtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vZmYoXCJnb2xkT25saW5lTnVtXCIsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcIm9uR2FtZUNvbmZpZ1wiLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVxRW50ZXJBcmVhKCkge1xyXG4gICAgICAgIHRoaXMuZ2FtZUlEID0gZ2xHYW1lLnNjZW5ldGFnLlNTUztcclxuICAgICAgICBnbEdhbWUucmVhZHlyb29tLnJlcUVudGVyQXJlYShnbEdhbWUuc2NlbmV0YWcuU1NTKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25HYW1lQ29uZmlnKG1zZykge1xyXG4gICAgICAgIHRoaXMuZ2FtZUNvbmZpZyA9IG1zZztcclxuICAgICAgICB0aGlzLmluaXRVSSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbml0VUkoKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IGNvbmZpZ3VyZSA9IHRoaXMuZ2FtZUNvbmZpZztcclxuICAgICAgICBsZXQgY291bnQgPSB0aGlzLmxldmVsLmxlbmd0aDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlupXms6hcclxuICAgICAgICAgICAgICAgIHRoaXMubGltaXRUeHRbaV1bMF0uc3RyaW5nID0gdGhpcy5nZXRGbG9hdChjb25maWd1cmVbaV0uQmFzZUNoaXBzKTtcclxuICAgICAgICAgICAgICAgIC8vIOWHhuWFpVxyXG4gICAgICAgICAgICAgICAgdGhpcy5saW1pdFR4dFtpXVsxXS5zdHJpbmcgPSB0aGlzLmdldEZsb2F0KGNvbmZpZ3VyZVtpXS5FbnRyYW5jZVJlc3RyaWN0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v6aqo6aq85Yqo55S75pKt5pS+57uT5p2f55qE5Zue6LCDXHJcbiAgICBhbmlFdmVudCgpIHtcclxuICAgICAgICBsZXQgY291bnQgPSB0aGlzLmxldmVsLmxlbmd0aDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHRpZW0gPSBpICogMC4xMztcclxuICAgICAgICAgICAgdGhpcy5ub2RlLnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShjYy5kZWxheVRpbWUodGllbSksIGNjLmNhbGxGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Bfcm9sZVtpXS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNwX3JvbGVbaV0uc2V0QW5pbWF0aW9uKDAsIFwiaWRsZTNcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zcF9yb2xlW2ldLnNldENvbXBsZXRlTGlzdGVuZXIoKHRyYWNrRW50cnksIGxvb3BDb3VudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gdHJhY2tFbnRyeS5hbmltYXRpb24gPyB0cmFja0VudHJ5LmFuaW1hdGlvbi5uYW1lIDogXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PSBcImlkbGUzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcF9yb2xlW2ldLnNldEFuaW1hdGlvbigwLCBcImlkbGUyXCIsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pKSlcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5qOA5p+l546p5a626YeR5biB5piv5ZCm6Laz5aSfXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgY2hlY2tHb2xkKGNvaW4sIG1pbkNpb24pIHtcclxuICAgICAgICBpZiAocGFyc2VJbnQoY29pbikgPCBwYXJzZUludChtaW5DaW9uKSkge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0RpYWxvZyhnbEdhbWUuaTE4bi50KFwiVVNFUi5HT0xETEFDSy5USVRMRVwiKSwgZ2xHYW1lLmkxOG4udChcIlVTRVIuR09MRExBQ0suQ09OVEVOVFwiKSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dQYW5lbEJ5TmFtZShcInNob3BcIik7XHJcbiAgICAgICAgICAgIH0sIG51bGwpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRGbG9hdCh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiAoTnVtYmVyKHZhbHVlKS5kaXYoMTAwKSkudG9TdHJpbmcoKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbGljayhuYW1lLCBub2RlKSB7XHJcbiAgICAgICAgc3dpdGNoIChuYW1lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwcmltYXJ5XCI6IHRoaXMuZW50ZXJHYW1lKDk5KTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJpbnRlcm1lZGlhdGVcIjogdGhpcy5lbnRlckdhbWUoMSk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwic2VuaW9yXCI6IHRoaXMuZW50ZXJHYW1lKDIpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInR1aGFvXCI6IHRoaXMuZW50ZXJHYW1lKDMpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9iYWNrXCI6IHRoaXMuY2xpY2tfYmFjaygpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9oZWxwXCI6IHRoaXMuY2xpY2tfaGVscCgpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9yZWNvcmRcIjogdGhpcy5jbGlja19yZWNvcmQoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJteWNvaW5JbmZvXCI6IHRoaXMuY2xpY2tfYWRkZ29sZCgpOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImhlYWRiZ1wiOiB0aGlzLmNsaWNrX3VzZXJpbmZvKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2Nob25nemhpXCI6IHRoaXMuY2xpY2tfYWRkZ29sZCgpOyBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogY29uc29sZS5lcnJvcihcIm5vIGZpbmQgYnV0dG9uIG5hbWUgLT4gJXNcIiwgbmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOi/m+WFpemHkeW4geWcuuaIv+mXtFxyXG4gICAgICogQHBhcmFtIGxldmVsIOWcuuasoeexu+WeiyAxOuaZrumAmuWcuiAyOui0teWuvuWcuiAzOuWvjOixquWculxyXG4gICAgICovXHJcbiAgICBlbnRlckdhbWUobGV2ZWwpIHtcclxuICAgICAgICBnbEdhbWUucm9vbS5yZXFNeUdhbWVTdGF0ZSh0aGlzLmdhbWVJRCwgbGV2ZWwpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZ2FtZUlEID0gdGhpcy5nYW1lSUQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWVDb25maWdbbGV2ZWxdID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93TXNnQm94KCfmj5DnpLonLCAn6K+l5oi/6Ze05bCa5pyq5byA5pS+77yM6K+35bCd6K+V5YW25LuW5oi/6Ze044CCJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGdsR2FtZS51c2VyLmlzVG91cmlzdCgpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGV2ZWwgIT0gOTkpIHtcclxuICAgICAgICAgICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1JlZ2lzdGVyZWRHaWZ0KHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKChnbEdhbWUudXNlci5zdXNwaWNpb3VzID09IDEgJiZnbEdhbWUudXNlci5nYW1lID09IDIgKSB8fCBnbEdhbWUudXNlci5pc19nYW1lID09IDIgKXtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RGlhbG9nKFwiXCIsIFwi5oKo55qE6LSm5Y+35pWw5o2u5byC5bi477yM5pqC5pe256aB5q2i6L+b5YWl5ri45oiP77yM5aaC5pyJ55aR6Zeu77yM6K+36IGU57O75a6i5pyN77yBXCIsICgpID0+IHsgZ2xHYW1lLnBhbmVsLnNob3dTZXJ2aWNlKCkgfSwgKCkgPT4ge30sIFwi5oiR55+l6YGT5LqGXCIsIFwi6IGU57O75a6i5pyNXCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZUNvbmZpZ1tsZXZlbF0uRW50cmFuY2VSZXN0cmljdGlvbnMgPiBnbEdhbWUudXNlci5nZXQoXCJjb2luXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIui/meaYr+W9k+WJjeeahOaIv+mXtOmZkOWItlwiLCB0aGlzLmdhbWVDb25maWcpXHJcbiAgICAgICAgICAgICAgICBsZXQgc3RyaW5nID0gYDxjb2xvcj0jOTlDN0ZGPuaCqOeahOmHkeW4geS4jei2s++8jOivpeaIv+mXtOmcgOimgTwvYz4gPGNvbG9yPSNmZjAwMDA+ICR7dGhpcy5nZXRGbG9hdCh0aGlzLmdhbWVDb25maWdbbGV2ZWxdLkVudHJhbmNlUmVzdHJpY3Rpb25zKX0gIDwvYz48Y29sb3I9Izk5QzdGRj7ph5HluIHmiY3lj6/kuIvms6jvvIzmmK/lkKbpqazkuIrliY3lvoDlhYXlgLzvvJ88L2M+YFxyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dEaWFsb2coXCJcIiwgc3RyaW5nLCAoKSA9PiB7IGdsR2FtZS5wYW5lbC5zaG93U2hvcCgxMDApIH0sICgpID0+IHsgfSwgXCLlj5bmtohcIiwgXCLlhYXlgLxcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0p1SHVhKCk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoXHJcbiAgICAgICAgICAgICAgICBjYy5kZWxheVRpbWUoMTUpLFxyXG4gICAgICAgICAgICAgICAgY2MuY2FsbEZ1bmMoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5jbG9zZUp1SHVhKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZ2xHYW1lLnJvb20uc2V0R29sZFJvb21JbmZvKGdhbWVJRCwgbGV2ZWwpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dVc2VySW5mbygpIHtcclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1JlbW90ZUltYWdlKHRoaXMuUGxheWVyaGVhZCwgZ2xHYW1lLnVzZXIuZ2V0KFwiaGVhZFVSTFwiKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZXVzZXJJbmZvKCkge1xyXG4gICAgICAgIGxldCBjb2luID0gZ2xHYW1lLnVzZXIuZ2V0KFwiY29pblwiKVxyXG4gICAgICAgIHRoaXMuZ29sZENvdW50LnN0cmluZyA9IGdsR2FtZS51c2VyLkdvbGRUZW1wKGNvaW4pOyAvL2dsR2FtZS51c2VyLmN1dEZsb2F0KGNvaW4pO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRHYW1lSWQoZ2FtZWlkKSB7XHJcbiAgICAgICAgdGhpcy5nYW1laWQgPSBnYW1laWQ7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUJnSW5mbygpIHtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tfdXNlcmluZm8oKSB7XHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dQYW5lbEJ5TmFtZShcInVzZXJpbmZvXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja19hZGRnb2xkKCkge1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93U2hvcCgzMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrX2JhY2soKSB7XHJcbiAgICAgICAgZ2xHYW1lLnJlYWR5cm9vbS5yZXFFeGl0QXJlYSgpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrX2hlbHAoKSB7XHJcbiAgICAgICAgbGV0IHBhbmVsID0gZ2xHYW1lLnBhbmVsLnNob3dQYW5lbCh0aGlzLnNzc1J1bGUpO1xyXG4gICAgICAgIHBhbmVsLnpJbmRleCA9IDMwO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja19yZWNvcmQoKSB7XHJcbiAgICAgICAgbGV0IHBhbmVsID0gZ2xHYW1lLnBhbmVsLnNob3dQYW5lbCh0aGlzLnNzc1JlY29yZCk7XHJcbiAgICAgICAgcGFuZWwuekluZGV4ID0gMzA7XHJcbiAgICB9LFxyXG5cclxuICAgIHNldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpc1trZXldO1xyXG4gICAgfSxcclxuXHJcbiAgICBPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKE1FU1NBR0UuVUkuUk9PTV9FTlRFUl9TSE9XLHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihNRVNTQUdFLlVJLlJPT01fRU5URVJfSElERSx0aGlzKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vZmYoXCJub2RlUmVtb3ZlXCIsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcInVwZGF0ZVVzZXJEYXRhXCIsdGhpcyk7XHJcbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyRXZlbnQoKTtcclxuICAgIH1cclxufSk7XHJcbiJdfQ==