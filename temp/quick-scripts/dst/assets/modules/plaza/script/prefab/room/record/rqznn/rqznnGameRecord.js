
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/prefab/room/record/rqznn/rqznnGameRecord.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1f68fYwr6xCh49HZJJZYaAF', 'rqznnGameRecord');
// modules/plaza/script/prefab/room/record/rqznn/rqznnGameRecord.js

"use strict";

var ROUND_STRIP_NAME = "roundstrip";
glGame.baseclass.extend({
  properties: {
    //牌局
    gameData: cc.Node,
    UserData: cc.Node,
    gameContent: cc.Node,
    gameItem: cc.Node,
    labPage: cc.Label
  },
  onLoad: function onLoad() {
    this.gameDetails = {};
    this.PageIndex = 1;
    this.pageCount = 1;
    this.pageMax = 8;
    this.playerMax = 5;
    this.gameAllData = null;
    this.registerEvent();
  },
  initData: function initData(data) {
    this.gameAllData = data;
    this.gameContent.removeAllChildren();
    this.initRoomData();
    this.reqRoomGameRoundList();
  },
  registerEvent: function registerEvent() {},
  unRegisterEvent: function unRegisterEvent() {},
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_return":
        glGame.emitter.emit("openRoomList");
        break;

      case "btn_lastPage":
        this.lastPage_cb();
        break;

      case "btn_nextPage":
        this.nextPage_cb();
        break;

      default:
        if (name.indexOf(ROUND_STRIP_NAME) > -1) return this.click_roundStrip(name);
        break;
    }
  },
  lastPage_cb: function lastPage_cb() {
    if (this.PageIndex == 1 || this.PageIndex == 0) return glGame.panel.showTip("已经是第一页了！");
    this.PageIndex--;
    this.reqRoomGameRoundList();
  },
  nextPage_cb: function nextPage_cb() {
    if (this.PageIndex >= this.pageCount || this.PageIndex == 0) return glGame.panel.showTip("已经是最后一页了！");
    this.PageIndex++;
    this.reqRoomGameRoundList();
  },
  click_roundStrip: function click_roundStrip(name) {
    var string = name.substring(ROUND_STRIP_NAME.length);
    var data = this.gameDetails[this.gameAllData.gameId][this.gameAllData.summaryId][this.PageIndex][Number(string)];
    glGame.emitter.emit("openRoomRound", data);
  },
  reqRoomGameRoundList: function reqRoomGameRoundList() {
    var _this = this;

    var msg = {};
    msg.gameId = this.gameAllData.gameId;
    msg.summaryId = this.gameAllData.summaryId;
    msg.page = this.PageIndex;
    msg.pageSize = this.pageMax;

    if (this.gameDetails[msg.gameId] && this.gameDetails[msg.gameId][msg.summaryId] && this.gameDetails[msg.gameId][msg.summaryId][this.PageIndex]) {
      this.initGameContent(this.gameDetails[msg.gameId][msg.summaryId][this.PageIndex]);
    } else {
      glGame.gameNet.send_msg('http.ReqRoomGameRoundList', msg, function (route, data) {
        var result = data.result;
        _this.pageCount = result.totalPage;
        _this.gameDetails[msg.gameId] ? null : _this.gameDetails[msg.gameId] = {};
        _this.gameDetails[msg.gameId][msg.summaryId] ? null : _this.gameDetails[msg.gameId][msg.summaryId] = {};
        result.data = _this.sortUserData(result.data);
        _this.gameDetails[msg.gameId][msg.summaryId][_this.PageIndex] = result.data;

        _this.initGameTitle(result.data);

        _this.initGameContent(_this.gameDetails[msg.gameId][msg.summaryId][_this.PageIndex]);
      });
    }
  },
  initRoomData: function initRoomData() {
    var data = this.gameAllData;
    this.gameData.getChildByName("number").getComponent(cc.Label).string = data.summaryId;
    var timeStamp = new Date(data.createTime);
    var strTime = "".concat(timeStamp.getFullYear(), "/").concat(timeStamp.getMonth() + 1 >= 10 ? timeStamp.getMonth() + 1 : "0" + (timeStamp.getMonth() + 1), "/").concat(timeStamp.getDate() >= 10 ? timeStamp.getDate() : '0' + timeStamp.getDate());
    strTime += "\uFF08".concat(glGame.tips.WEEKNAME[timeStamp.getDay()], "\uFF09");
    strTime += "".concat(timeStamp.getHours() >= 10 ? timeStamp.getHours() : "0" + timeStamp.getHours(), ":");
    strTime += "".concat(timeStamp.getMinutes() >= 10 ? timeStamp.getMinutes() : "0" + timeStamp.getMinutes(), ":");
    strTime += "".concat(timeStamp.getSeconds() >= 10 ? timeStamp.getSeconds() : "0" + timeStamp.getSeconds());
    this.gameData.getChildByName("time").getComponent(cc.Label).string = strTime;
    this.gameData.getChildByName("game").getComponent(cc.Label).string = data.gameName;
    this.gameData.getChildByName("round").getComponent(cc.Label).string = data.totalRound;
    this.gameData.getChildByName("score").getComponent(cc.Label).string = this.getFixNumber(data.score);
    this.gameData.getChildByName("score").color = data.score > 0 ? cc.color(0x48, 0xd4, 0xa8) : cc.color(0xf6, 0x8e, 0x1e);
  },
  initGameTitle: function initGameTitle(list) {
    if (list.length == 0) return; // 便利出自己数据

    for (var index in list[0].detail) {
      var data = list[0].detail[index];
      if (!data) continue;

      if (Number(data.uid) == glGame.user.get("userID")) {
        this.UserData.getChildByName("seat1").active = true;
        this.UserData.getChildByName("seat1").getComponent(cc.Label).string = "\uFF3B\u6211\uFF3D";
        break;
      }
    } // 清理其他角色


    for (var _i = 2; _i < this.playerMax; _i++) {
      this.UserData.getChildByName("seat".concat(_i)).active = false;
    } // 便利出其他角色


    var i = 2;

    for (var _index in list[0].detail) {
      var _data = list[0].detail[_index];
      if (!_data) continue;

      if (Number(_data.uid) != glGame.user.get("userID")) {
        this.UserData.getChildByName("seat".concat(i)).active = true;
        this.UserData.getChildByName("seat".concat(i)).getComponent(cc.Label).string = "\uFF3B".concat(_data.nickname, "\uFF3D");
        i++;
      }
    }
  },
  initGameContent: function initGameContent(list) {
    this.gameContent.removeAllChildren();

    if (list.length == 0) {
      this.labPage.string = '第0/0页';
      return;
    }

    this.labPage.string = "\u7B2C".concat(this.PageIndex, "/").concat(this.pageCount, "\u9875");

    for (var i = list.length - 1; i >= 0; i--) {
      if (!list[i].detail) continue;
      var node = cc.instantiate(this.gameItem);
      node.name = "".concat(ROUND_STRIP_NAME).concat(i);
      node.getChildByName("bg").active = i % 2 != 0;
      node.parent = this.gameContent;
      node.active = true;
      node.getChildByName("round").getComponent(cc.Label).string = "\u7B2C".concat(list.length - i + (this.PageIndex - 1) * this.pageMax, "\u5C40"); // 便利出自己数据

      for (var index in list[i].detail) {
        var data = list[i].detail[index];
        if (!data) continue;

        if (Number(data.uid) == glGame.user.get("userID")) {
          node.getChildByName("score1").active = true;
          node.getChildByName("score1").getComponent(cc.Label).string = this.getFixNumber(data.scoreOffset);
          node.getChildByName("score1").color = data.scoreOffset > 0 ? cc.color(0x48, 0xd4, 0xa8) : cc.color(0xf6, 0x8e, 0x1e);
          break;
        }
      } // 便利出其他角色


      var count = 2;

      for (var _index2 in list[i].detail) {
        var _data2 = list[i].detail[_index2];
        if (!_data2) continue;

        if (Number(_data2.uid) != glGame.user.get("userID")) {
          node.getChildByName("score".concat(count)).active = true;
          node.getChildByName("score".concat(count)).getComponent(cc.Label).string = this.getFixNumber(_data2.scoreOffset);
          node.getChildByName("score".concat(count)).color = _data2.scoreOffset > 0 ? cc.color(0x48, 0xd4, 0xa8) : cc.color(0xf6, 0x8e, 0x1e);
          count++;
        }
      }
    }
  },
  sortUserData: function sortUserData(list) {
    for (var key in list) {
      if (!list[key].detail) continue;
      list[key].detail.sort(function (a, b) {
        return a.uid - b.uid;
      });
    }

    return list;
  },
  getFixNumber: function getFixNumber(value) {
    var value1 = Number(value).div(10);
    value = Number(value).div(100);
    if (isNaN(value)) return;

    if (~~value === value) {
      return value.toString();
    } else if (~~value1 === value1) {
      return value.toFixed(1);
    } else {
      return value.toFixed(2);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxccHJlZmFiXFxyb29tXFxyZWNvcmRcXHJxem5uXFxycXpubkdhbWVSZWNvcmQuanMiXSwibmFtZXMiOlsiUk9VTkRfU1RSSVBfTkFNRSIsImdsR2FtZSIsImJhc2VjbGFzcyIsImV4dGVuZCIsInByb3BlcnRpZXMiLCJnYW1lRGF0YSIsImNjIiwiTm9kZSIsIlVzZXJEYXRhIiwiZ2FtZUNvbnRlbnQiLCJnYW1lSXRlbSIsImxhYlBhZ2UiLCJMYWJlbCIsIm9uTG9hZCIsImdhbWVEZXRhaWxzIiwiUGFnZUluZGV4IiwicGFnZUNvdW50IiwicGFnZU1heCIsInBsYXllck1heCIsImdhbWVBbGxEYXRhIiwicmVnaXN0ZXJFdmVudCIsImluaXREYXRhIiwiZGF0YSIsInJlbW92ZUFsbENoaWxkcmVuIiwiaW5pdFJvb21EYXRhIiwicmVxUm9vbUdhbWVSb3VuZExpc3QiLCJ1blJlZ2lzdGVyRXZlbnQiLCJPbkRlc3Ryb3kiLCJvbkNsaWNrIiwibmFtZSIsIm5vZGUiLCJlbWl0dGVyIiwiZW1pdCIsImxhc3RQYWdlX2NiIiwibmV4dFBhZ2VfY2IiLCJpbmRleE9mIiwiY2xpY2tfcm91bmRTdHJpcCIsInBhbmVsIiwic2hvd1RpcCIsInN0cmluZyIsInN1YnN0cmluZyIsImxlbmd0aCIsImdhbWVJZCIsInN1bW1hcnlJZCIsIk51bWJlciIsIm1zZyIsInBhZ2UiLCJwYWdlU2l6ZSIsImluaXRHYW1lQ29udGVudCIsImdhbWVOZXQiLCJzZW5kX21zZyIsInJvdXRlIiwicmVzdWx0IiwidG90YWxQYWdlIiwic29ydFVzZXJEYXRhIiwiaW5pdEdhbWVUaXRsZSIsImdldENoaWxkQnlOYW1lIiwiZ2V0Q29tcG9uZW50IiwidGltZVN0YW1wIiwiRGF0ZSIsImNyZWF0ZVRpbWUiLCJzdHJUaW1lIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJ0aXBzIiwiV0VFS05BTUUiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRTZWNvbmRzIiwiZ2FtZU5hbWUiLCJ0b3RhbFJvdW5kIiwiZ2V0Rml4TnVtYmVyIiwic2NvcmUiLCJjb2xvciIsImxpc3QiLCJpbmRleCIsImRldGFpbCIsInVpZCIsInVzZXIiLCJnZXQiLCJhY3RpdmUiLCJpIiwibmlja25hbWUiLCJpbnN0YW50aWF0ZSIsInBhcmVudCIsInNjb3JlT2Zmc2V0IiwiY291bnQiLCJrZXkiLCJzb3J0IiwiYSIsImIiLCJ2YWx1ZSIsInZhbHVlMSIsImRpdiIsImlzTmFOIiwidG9TdHJpbmciLCJ0b0ZpeGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLGdCQUFnQixHQUFHLFlBQXpCO0FBRUFDLE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0I7QUFDcEJDLEVBQUFBLFVBQVUsRUFBRTtBQUNSO0FBQ0FDLElBQUFBLFFBQVEsRUFBRUMsRUFBRSxDQUFDQyxJQUZMO0FBR1JDLElBQUFBLFFBQVEsRUFBRUYsRUFBRSxDQUFDQyxJQUhMO0FBSVJFLElBQUFBLFdBQVcsRUFBRUgsRUFBRSxDQUFDQyxJQUpSO0FBS1JHLElBQUFBLFFBQVEsRUFBRUosRUFBRSxDQUFDQyxJQUxMO0FBTVJJLElBQUFBLE9BQU8sRUFBRUwsRUFBRSxDQUFDTTtBQU5KLEdBRFE7QUFTcEJDLEVBQUFBLE1BVG9CLG9CQVNYO0FBQ0wsU0FBS0MsV0FBTCxHQUFtQixFQUFuQjtBQUNBLFNBQUtDLFNBQUwsR0FBaUIsQ0FBakI7QUFDQSxTQUFLQyxTQUFMLEdBQWlCLENBQWpCO0FBQ0EsU0FBS0MsT0FBTCxHQUFlLENBQWY7QUFDQSxTQUFLQyxTQUFMLEdBQWlCLENBQWpCO0FBQ0EsU0FBS0MsV0FBTCxHQUFtQixJQUFuQjtBQUNBLFNBQUtDLGFBQUw7QUFDSCxHQWpCbUI7QUFtQnBCQyxFQUFBQSxRQW5Cb0Isb0JBbUJYQyxJQW5CVyxFQW1CTDtBQUNYLFNBQUtILFdBQUwsR0FBbUJHLElBQW5CO0FBQ0EsU0FBS2Is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ZHN0cmlwXCI7XHJcblxyXG5nbEdhbWUuYmFzZWNsYXNzLmV4dGVuZCh7XHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy/niYzlsYBcclxuICAgICAgICBnYW1lRGF0YTogY2MuTm9kZSxcclxuICAgICAgICBVc2VyRGF0YTogY2MuTm9kZSxcclxuICAgICAgICBnYW1lQ29udGVudDogY2MuTm9kZSxcclxuICAgICAgICBnYW1lSXRlbTogY2MuTm9kZSxcclxuICAgICAgICBsYWJQYWdlOiBjYy5MYWJlbCxcclxuICAgIH0sXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lRGV0YWlscyA9IHt9O1xyXG4gICAgICAgIHRoaXMuUGFnZUluZGV4ID0gMTtcclxuICAgICAgICB0aGlzLnBhZ2VDb3VudCA9IDE7XHJcbiAgICAgICAgdGhpcy5wYWdlTWF4ID0gODtcclxuICAgICAgICB0aGlzLnBsYXllck1heCA9IDU7XHJcbiAgICAgICAgdGhpcy5nYW1lQWxsRGF0YSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXREYXRhKGRhdGEpIHtcclxuICAgICAgICB0aGlzLmdhbWVBbGxEYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLmdhbWVDb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgdGhpcy5pbml0Um9vbURhdGEoKTtcclxuICAgICAgICB0aGlzLnJlcVJvb21HYW1lUm91bmRMaXN0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICB9LFxyXG4gICAgdW5SZWdpc3RlckV2ZW50KCkge1xyXG4gICAgfSxcclxuXHJcbiAgICBPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy51blJlZ2lzdGVyRXZlbnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25DbGljayhuYW1lLCBub2RlKSB7XHJcbiAgICAgICAgc3dpdGNoIChuYW1lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJidG5fcmV0dXJuXCI6IGdsR2FtZS5lbWl0dGVyLmVtaXQoXCJvcGVuUm9vbUxpc3RcIik7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2xhc3RQYWdlXCI6IHRoaXMubGFzdFBhZ2VfY2IoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJidG5fbmV4dFBhZ2VcIjogdGhpcy5uZXh0UGFnZV9jYigpOyBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5pbmRleE9mKFJPVU5EX1NUUklQX05BTUUpID4gLTEpIHJldHVybiB0aGlzLmNsaWNrX3JvdW5kU3RyaXAobmFtZSk7XHJcbiAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbGFzdFBhZ2VfY2IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuUGFnZUluZGV4ID09IDEgfHwgdGhpcy5QYWdlSW5kZXggPT0gMCkgcmV0dXJuIGdsR2FtZS5wYW5lbC5zaG93VGlwKFwi5bey57uP5piv56ys5LiA6aG15LqG77yBXCIpXHJcbiAgICAgICAgdGhpcy5QYWdlSW5kZXgtLTtcclxuICAgICAgICB0aGlzLnJlcVJvb21HYW1lUm91bmRMaXN0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG5leHRQYWdlX2NiKCkge1xyXG4gICAgICAgIGlmICh0aGlzLlBhZ2VJbmRleCA+PSB0aGlzLnBhZ2VDb3VudCB8fCB0aGlzLlBhZ2VJbmRleCA9PSAwKSByZXR1cm4gZ2xHYW1lLnBhbmVsLnNob3dUaXAoXCLlt7Lnu4/mmK/mnIDlkI7kuIDpobXkuobvvIFcIilcclxuICAgICAgICB0aGlzLlBhZ2VJbmRleCsrO1xyXG4gICAgICAgIHRoaXMucmVxUm9vbUdhbWVSb3VuZExpc3QoKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tfcm91bmRTdHJpcChuYW1lKSB7XHJcbiAgICAgICAgbGV0IHN0cmluZyA9IG5hbWUuc3Vic3RyaW5nKFJPVU5EX1NUUklQX05BTUUubGVuZ3RoKTtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMuZ2FtZURldGFpbHNbdGhpcy5nYW1lQWxsRGF0YS5nYW1lSWRdW3RoaXMuZ2FtZUFsbERhdGEuc3VtbWFyeUlkXVt0aGlzLlBhZ2VJbmRleF1bTnVtYmVyKHN0cmluZyldO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLmVtaXQoXCJvcGVuUm9vbVJvdW5kXCIsIGRhdGEpO1xyXG4gICAgfSxcclxuXHJcbiAgICByZXFSb29tR2FtZVJvdW5kTGlzdCgpIHtcclxuICAgICAgICBsZXQgbXNnID0ge307XHJcbiAgICAgICAgbXNnLmdhbWVJZCA9IHRoaXMuZ2FtZUFsbERhdGEuZ2FtZUlkO1xyXG4gICAgICAgIG1zZy5zdW1tYXJ5SWQgPSB0aGlzLmdhbWVBbGxEYXRhLnN1bW1hcnlJZDtcclxuICAgICAgICBtc2cucGFnZSA9IHRoaXMuUGFnZUluZGV4O1xyXG4gICAgICAgIG1zZy5wYWdlU2l6ZSA9IHRoaXMucGFnZU1heDtcclxuICAgICAgICBpZiAodGhpcy5nYW1lRGV0YWlsc1ttc2cuZ2FtZUlkXSAmJiB0aGlzLmdhbWVEZXRhaWxzW21zZy5nYW1lSWRdW21zZy5zdW1tYXJ5SWRdICYmIHRoaXMuZ2FtZURldGFpbHNbbXNnLmdhbWVJZF1bbXNnLnN1bW1hcnlJZF1bdGhpcy5QYWdlSW5kZXhdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdEdhbWVDb250ZW50KHRoaXMuZ2FtZURldGFpbHNbbXNnLmdhbWVJZF1bbXNnLnN1bW1hcnlJZF1bdGhpcy5QYWdlSW5kZXhdKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBnbEdhbWUuZ2FtZU5ldC5zZW5kX21zZygnaHR0cC5SZXFSb29tR2FtZVJvdW5kTGlzdCcsIG1zZywgKHJvdXRlLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gZGF0YS5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZ2VDb3VudCA9IHJlc3VsdC50b3RhbFBhZ2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVEZXRhaWxzW21zZy5nYW1lSWRdID8gbnVsbCA6IHRoaXMuZ2FtZURldGFpbHNbbXNnLmdhbWVJZF0gPSB7fTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZURldGFpbHNbbXNnLmdhbWVJZF1bbXNnLnN1bW1hcnlJZF0gPyBudWxsIDogdGhpcy5nYW1lRGV0YWlsc1ttc2cuZ2FtZUlkXVttc2cuc3VtbWFyeUlkXSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGEgPSB0aGlzLnNvcnRVc2VyRGF0YShyZXN1bHQuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVEZXRhaWxzW21zZy5nYW1lSWRdW21zZy5zdW1tYXJ5SWRdW3RoaXMuUGFnZUluZGV4XSA9IHJlc3VsdC5kYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbml0R2FtZVRpdGxlKHJlc3VsdC5kYXRhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdEdhbWVDb250ZW50KHRoaXMuZ2FtZURldGFpbHNbbXNnLmdhbWVJZF1bbXNnLnN1bW1hcnlJZF1bdGhpcy5QYWdlSW5kZXhdKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRSb29tRGF0YSgpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IHRoaXMuZ2FtZUFsbERhdGE7XHJcbiAgICAgICAgdGhpcy5nYW1lRGF0YS5nZXRDaGlsZEJ5TmFtZShcIm51bWJlclwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGRhdGEuc3VtbWFyeUlkO1xyXG5cclxuICAgICAgICBsZXQgdGltZVN0YW1wID0gbmV3IERhdGUoZGF0YS5jcmVhdGVUaW1lKTtcclxuICAgICAgICBsZXQgc3RyVGltZSA9IGAke3RpbWVTdGFtcC5nZXRGdWxsWWVhcigpfS8ke3RpbWVTdGFtcC5nZXRNb250aCgpICsgMSA+PSAxMCA/IHRpbWVTdGFtcC5nZXRNb250aCgpICsgMSA6IFwiMFwiICsgKHRpbWVTdGFtcC5nZXRNb250aCgpICsgMSl9LyR7dGltZVN0YW1wLmdldERhdGUoKSA+PSAxMCA/IHRpbWVTdGFtcC5nZXREYXRlKCkgOiAnMCcgKyB0aW1lU3RhbXAuZ2V0RGF0ZSgpfWBcclxuICAgICAgICBzdHJUaW1lICs9IGDvvIgke2dsR2FtZS50aXBzLldFRUtOQU1FW3RpbWVTdGFtcC5nZXREYXkoKV1977yJYFxyXG4gICAgICAgIHN0clRpbWUgKz0gYCR7dGltZVN0YW1wLmdldEhvdXJzKCkgPj0gMTAgPyB0aW1lU3RhbXAuZ2V0SG91cnMoKSA6IFwiMFwiICsgdGltZVN0YW1wLmdldEhvdXJzKCl9OmBcclxuICAgICAgICBzdHJUaW1lICs9IGAke3RpbWVTdGFtcC5nZXRNaW51dGVzKCkgPj0gMTAgPyB0aW1lU3RhbXAuZ2V0TWludXRlcygpIDogXCIwXCIgKyB0aW1lU3RhbXAuZ2V0TWludXRlcygpfTpgXHJcbiAgICAgICAgc3RyVGltZSArPSBgJHt0aW1lU3RhbXAuZ2V0U2Vjb25kcygpID49IDEwID8gdGltZVN0YW1wLmdldFNlY29uZHMoKSA6IFwiMFwiICsgdGltZVN0YW1wLmdldFNlY29uZHMoKX1gXHJcbiAgICAgICAgdGhpcy5nYW1lRGF0YS5nZXRDaGlsZEJ5TmFtZShcInRpbWVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBzdHJUaW1lO1xyXG4gICAgICAgIHRoaXMuZ2FtZURhdGEuZ2V0Q2hpbGRCeU5hbWUoXCJnYW1lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gZGF0YS5nYW1lTmFtZTtcclxuICAgICAgICB0aGlzLmdhbWVEYXRhLmdldENoaWxkQnlOYW1lKFwicm91bmRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBkYXRhLnRvdGFsUm91bmQ7XHJcbiAgICAgICAgdGhpcy5nYW1lRGF0YS5nZXRDaGlsZEJ5TmFtZShcInNjb3JlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5nZXRGaXhOdW1iZXIoZGF0YS5zY29yZSk7XHJcbiAgICAgICAgdGhpcy5nYW1lRGF0YS5nZXRDaGlsZEJ5TmFtZShcInNjb3JlXCIpLmNvbG9yID0gZGF0YS5zY29yZSA+IDAgPyBjYy5jb2xvcigweDQ4LCAweGQ0LCAweGE4KSA6IGNjLmNvbG9yKDB4ZjYsIDB4OGUsIDB4MWUpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbml0R2FtZVRpdGxlKGxpc3QpIHtcclxuICAgICAgICBpZiAobGlzdC5sZW5ndGggPT0gMCkgcmV0dXJuO1xyXG4gICAgICAgIC8vIOS+v+WIqeWHuuiHquW3seaVsOaNrlxyXG4gICAgICAgIGZvciAobGV0IGluZGV4IGluIGxpc3RbMF0uZGV0YWlsKSB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhID0gbGlzdFswXS5kZXRhaWxbaW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoIWRhdGEpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBpZiAoTnVtYmVyKGRhdGEudWlkKSA9PSBnbEdhbWUudXNlci5nZXQoXCJ1c2VySURcIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuVXNlckRhdGEuZ2V0Q2hpbGRCeU5hbWUoYHNlYXQxYCkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuVXNlckRhdGEuZ2V0Q2hpbGRCeU5hbWUoYHNlYXQxYCkuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBg77y75oiR77y9YDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa4heeQhuWFtuS7luinkuiJslxyXG4gICAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgdGhpcy5wbGF5ZXJNYXg7IGkrKykgdGhpcy5Vc2VyRGF0YS5nZXRDaGlsZEJ5TmFtZShgc2VhdCR7aX1gKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvLyDkvr/liKnlh7rlhbbku5bop5LoibJcclxuICAgICAgICBsZXQgaSA9IDI7XHJcbiAgICAgICAgZm9yIChsZXQgaW5kZXggaW4gbGlzdFswXS5kZXRhaWwpIHtcclxuICAgICAgICAgICAgbGV0IGRhdGEgPSBsaXN0WzBdLmRldGFpbFtpbmRleF07XHJcbiAgICAgICAgICAgIGlmICghZGF0YSkgY29udGludWU7XHJcbiAgICAgICAgICAgIGlmIChOdW1iZXIoZGF0YS51aWQpICE9IGdsR2FtZS51c2VyLmdldChcInVzZXJJRFwiKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Vc2VyRGF0YS5nZXRDaGlsZEJ5TmFtZShgc2VhdCR7aX1gKS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Vc2VyRGF0YS5nZXRDaGlsZEJ5TmFtZShgc2VhdCR7aX1gKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGDvvLske2RhdGEubmlja25hbWV977y9YDtcclxuICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgaW5pdEdhbWVDb250ZW50KGxpc3QpIHtcclxuICAgICAgICB0aGlzLmdhbWVDb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XHJcbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5sYWJQYWdlLnN0cmluZyA9ICfnrKwwLzDpobUnO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGFiUGFnZS5zdHJpbmcgPSBg56ysJHt0aGlzLlBhZ2VJbmRleH0vJHt0aGlzLnBhZ2VDb3VudH3pobVgO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSBsaXN0Lmxlbmd0aCAtIDE7IGkgPj0wOyBpLS0pIHtcclxuICAgICAgICAgICAgaWYgKCFsaXN0W2ldLmRldGFpbCkgY29udGludWU7XHJcbiAgICAgICAgICAgIGxldCBub2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy5nYW1lSXRlbSk7XHJcbiAgICAgICAgICAgIG5vZGUubmFtZSA9IGAke1JPVU5EX1NUUklQX05BTUV9JHtpfWA7XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZ1wiKS5hY3RpdmUgPSBpICUgMiAhPSAwO1xyXG4gICAgICAgICAgICBub2RlLnBhcmVudCA9IHRoaXMuZ2FtZUNvbnRlbnQ7XHJcbiAgICAgICAgICAgIG5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoYHJvdW5kYCkuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBg56ysJHsobGlzdC5sZW5ndGggLSBpKSArICgodGhpcy5QYWdlSW5kZXggLSAxKSAqIHRoaXMucGFnZU1heCl95bGAYDtcclxuXHJcbiAgICAgICAgICAgIC8vIOS+v+WIqeWHuuiHquW3seaVsOaNrlxyXG4gICAgICAgICAgICBmb3IgKGxldCBpbmRleCBpbiBsaXN0W2ldLmRldGFpbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSBsaXN0W2ldLmRldGFpbFtpbmRleF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKE51bWJlcihkYXRhLnVpZCkgPT0gZ2xHYW1lLnVzZXIuZ2V0KFwidXNlcklEXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5nZXRDaGlsZEJ5TmFtZShgc2NvcmUxYCkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKGBzY29yZTFgKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMuZ2V0Rml4TnVtYmVyKGRhdGEuc2NvcmVPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJzY29yZTFcIikuY29sb3IgPSBkYXRhLnNjb3JlT2Zmc2V0ID4gMCA/IGNjLmNvbG9yKDB4NDgsIDB4ZDQsIDB4YTgpIDogY2MuY29sb3IoMHhmNiwgMHg4ZSwgMHgxZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5L6/5Yip5Ye65YW25LuW6KeS6ImyXHJcbiAgICAgICAgICAgIGxldCBjb3VudCA9IDI7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGluZGV4IGluIGxpc3RbaV0uZGV0YWlsKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IGxpc3RbaV0uZGV0YWlsW2luZGV4XTtcclxuICAgICAgICAgICAgICAgIGlmICghZGF0YSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoTnVtYmVyKGRhdGEudWlkKSAhPSBnbEdhbWUudXNlci5nZXQoXCJ1c2VySURcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKGBzY29yZSR7Y291bnR9YCkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKGBzY29yZSR7Y291bnR9YCkuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLmdldEZpeE51bWJlcihkYXRhLnNjb3JlT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLmdldENoaWxkQnlOYW1lKGBzY29yZSR7Y291bnR9YCkuY29sb3IgPSBkYXRhLnNjb3JlT2Zmc2V0ID4gMCA/IGNjLmNvbG9yKDB4NDgsIDB4ZDQsIDB4YTgpIDogY2MuY29sb3IoMHhmNiwgMHg4ZSwgMHgxZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc29ydFVzZXJEYXRhKGxpc3QpIHtcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gbGlzdCkge1xyXG4gICAgICAgICAgICBpZiAoIWxpc3Rba2V5XS5kZXRhaWwpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBsaXN0W2tleV0uZGV0YWlsLnNvcnQoKGEsIGIpID0+IHsgcmV0dXJuIGEudWlkIC0gYi51aWQ7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0Rml4TnVtYmVyKHZhbHVlKSB7XHJcbiAgICAgICAgbGV0IHZhbHVlMSA9IE51bWJlcih2YWx1ZSkuZGl2KDEwKTtcclxuICAgICAgICB2YWx1ZSA9IE51bWJlcih2YWx1ZSkuZGl2KDEwMCk7XHJcbiAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh+fnZhbHVlID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKH5+dmFsdWUxID09PSB2YWx1ZTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvRml4ZWQoMSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvRml4ZWQoMik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==