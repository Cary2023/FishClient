
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/plaza/script/scene/plaza.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f516eO/lgVJDIUVzmMfqMDM', 'plaza');
// modules/plaza/script/scene/plaza.js

"use strict";

/**
 * 三个弹出的顺序：紧急公告，游客注册，七日签到;
 */
var WEBVIEW_NORMAL = 0;
var WEBVIEW_EXIT = 1;
var WEBVIEW_ERROR = 2;

var WebViewEx = require('./WebViewEx');

glGame.baseclass.extend({
  properties: {
    plaza_hall: cc.Prefab
  },
  onLoad: function onLoad() {
    var _this = this;

    this.game_web = null;
    this.webview_mask = null;
    glGame.emitter.on("updatePlazaSwitch", this.updatePlazaSwitch, this);
    glGame.emitter.on(MESSAGE.UI.WEBVIEW_ON, this.gameWebStart, this);
    glGame.emitter.on(MESSAGE.UI.WEBVIEW_OFF, this.gameWebExit, this);
    glGame.emitter.on("floatButton", this.onFloatButton, this);

    if (glGame.isfirstEnterPlaza) {
      this.node.stopAllActions();
      this.node.runAction(cc.sequence(cc.delayTime(0.2), cc.callFunc(function () {
        _this.checkShowPanel();
      })));
    } // glGame.user.reqHomeView();


    this.plazaNode = glGame.panel.showPanel(this.plaza_hall);
    this.showHriseRaceLamp();
    this.showRegister();
    glGame.panel.closelimitJuhua();
    var clickAction = cc.director.getScene().getChildByName("click_action");

    if (clickAction) {
      clickAction.active = true;
    }
  },
  start: function start() {// glGame.panel.showJuHua();
  },
  updatePlazaSwitch: function updatePlazaSwitch() {
    this.checkShowPanel();
  },
  showHriseRaceLamp: function showHriseRaceLamp() {
    var width = 1190,
        height = 68;
    var showsize = cc.size(this.node.width * 0.65, height);
    var bpersist = false;
    glGame.panel.showRollNotice(cc.v2(this.node.width / 2 + 439 / 2, this.node.height - 185), showsize, bpersist);
    glGame.notice.enterPlaza();

    if (glGame.scene.getUpScene() != glGame.scenetag.LOGIN) {
      glGame.notice.reqGetHorseRaceLamp();
    }
  },
  showRegister: function showRegister() {
    var arr = [];
    if (glGame.user.registerGetCoin && glGame.user.registerGetCoin > 0) arr.push({
      type: glGame.awardtype.COIN,
      value: glGame.user.cutFloat(glGame.user.registerGetCoin)
    });
    if (glGame.user.registerGetDiamond && glGame.user.registerGetDiamond > 0) arr.push({
      type: glGame.awardtype.DIAMOND,
      value: glGame.user.cutFloat(glGame.user.registerGetDiamond)
    });
    console.log("这是当前的数组", glGame.user.registerGetCoin, glGame.user.registerGetDiamond, arr);

    if (arr.length > 0) {
      glGame.panel.showAwardBox(glGame.tips.PLAZA.CONGRATULATE, arr, function () {
        glGame.user.resetAward();
      });
    }
  },

  /**
   * 第一次进入大厅，判断需要弹出哪些弹窗
   */
  checkShowPanel: function checkShowPanel() {
    glGame.panel.plazaShowPanel = []; // glGame.panel.hidejuhua();

    var isShowSetupPanel = glGame.storage.getItem('isShowSetupPanel'); // 1.每天启动第一次弹出
    // 2.安装后第一次进入弹出
    //new Date(new Date().toLocaleDateString()).getTime();

    if (cc.sys.platform == cc.sys.IPHONE) {
      var nowTime = new Date(new Date().toLocaleDateString()).getTime();

      if (!isShowSetupPanel) {
        glGame.storage.setItem('isShowSetupPanel', {
          isSetup: false,
          time: nowTime
        });
        glGame.panel.pushPlazaShowPanel("setupRepairTool");
      } else if (!isShowSetupPanel.isSetup && glGame.user.get("url").repair_switch && glGame.user.get("url").repair_switch == 1 && isShowSetupPanel.time < nowTime) {
        isShowSetupPanel.time = nowTime;
        glGame.storage.setItem('isShowSetupPanel', isShowSetupPanel);
        glGame.panel.pushPlazaShowPanel("setupRepairTool");
      }
    }

    if (!glGame.isfirstEnterPlaza) return;

    if (!glGame.panel.showSuspicious()) {
      glGame.panel.pushPlazaShowPanel("urgentnotice");
    }

    if (glGame.user.isTourist() && glGame.user.get('tips') && glGame.isfirstEnterPlaza) {
      glGame.panel.pushPlazaShowPanel("touristtip");
    }

    if (glGame.user.get("sign_state")) {
      glGame.panel.pushPlazaShowPanel("signin");
    }

    if (glGame.user.get("loginSwitch").activity_pop_up == 2) {
      glGame.panel.pushPlazaShowPanel("announcement");
    } else if (glGame.user.get("loginSwitch").activity_pop_up == 3) {
      var isAnnouncement = glGame.storage.getItem('isAnnouncement');

      var _nowTime = new Date(new Date().toLocaleDateString()).getTime();

      if (!isAnnouncement) {
        glGame.storage.setItem('isAnnouncement', {
          time: _nowTime
        });
        glGame.panel.pushPlazaShowPanel("announcement");
      } else if (isAnnouncement.time < _nowTime) {
        isAnnouncement.time = _nowTime;
        glGame.storage.setItem('isAnnouncement', isAnnouncement);
        glGame.panel.pushPlazaShowPanel("announcement");
      }
    }

    glGame.panel.showFirstEnterPanel();
    glGame.isfirstEnterPlaza = false;
  },

  /**
   * 设置回调
   * @param {*} target        //webview 对象 
   * @param {*} url           //回调scheme,带参数  scheme://state:0&code:0
   *                                      --state:状态（int）0为无状态 1为退出状态  2错误状态  
   *                                      --code:错误信息 --> 错误码(int)
   */
  jsCallback: function jsCallback(target, url) {
    //this.game_web.url = "";
    var str = url.replace(this.scheme + '://', ''); // str === 'a=1&b=2'

    var strData = str.split("&"),
        data = {};
    data.state = Number(strData[0].replace("state:", ""));
    data.code = Number(strData[1].replace("code:", ""));

    if (data.state == WEBVIEW_NORMAL && data.code == 0) {
      this.gameWebOpen();
    } else if (data.state != WEBVIEW_NORMAL && data.code != 0) {
      this.gameWebExit();
      glGame.platform.changeOrientation(true);
      glGame.systemclass.changeOrientation(true);
      glGame.platform.offSuspension();
      if (data.state == WEBVIEW_ERROR && THIRD_CODE[data.code]) glGame.panel.showTip(THIRD_CODE[data.code]);
    }
  },

  /**
   * 创建widget  全屏铺满
   * @param {object} adNode 需要添加的node对象
   */
  addNodeWidget: function addNodeWidget(adNode) {
    var webWidget = adNode.addComponent(cc.Widget);
    webWidget.isAlignTop = true;
    webWidget.isAlignBottom = true;
    webWidget.isAlignLeft = true;
    webWidget.isAlignRight = true;
    webWidget.top = 0;
    webWidget.bottom = 0;
    webWidget.left = 0;
    webWidget.right = 0;
    webWidget.alignMode = cc.Widget.AlignMode.ALWAYS;
    return webWidget;
  },

  /**
   * 动态创建web
   */
  gamewebNew: function gamewebNew() {
    if (this.game_web) return;

    if (!this.webview_mask) {
      this.webview_mask = cc.instantiate(glGame.panel.gameMaskPanel);
      this.webview_mask.parent = cc.director.getScene();
    }

    var webNode = new cc.Node();
    webNode.size = cc.size(this.node.width, this.node.height);
    this.addNodeWidget(webNode);

    if (cc.sys.isBrowser) {
      this.game_web = webNode.addComponent(WebViewEx);
      this.showFloatButton();
    } else {
      this.game_web = webNode.addComponent(cc.WebView);
      this.scheme = "ongamedata";
      this.game_web.setJavascriptInterfaceScheme(this.scheme);
      this.game_web.setOnJSCallback(this.jsCallback.bind(this));
    }

    this.node.addChild(webNode);
    this.plazaNode.active = false;
  },
  gameWebStart: function gameWebStart(data) {
    if (cc.sys.isBrowser) {
      this.preHandleH5(data);
    } else {
      this.preHandleNative(data);
    }
  },
  // 原生平台预处理
  preHandleNative: function preHandleNative(data) {
    this.gamewebNew();
    this.game_web.url = glGame.user.getWebGameUrl(data.gameid);
    glGame.audio.pauseAllMusic();
    this.scheduleOnce(this.changeOrientation, 1);
  },
  // h5平台预处理
  preHandleH5: function preHandleH5(data) {
    var _this2 = this;

    glGame.gameNet.send_msg("http.ForwardH5", {
      g: data.gameid
    }, function (route, msg) {
      var data = msg.result;

      _this2.gamewebNew();

      var url = data.url;

      if (data.action == 'post') {
        url = glGame.user.getWebGameUrlH5(data.url);
      }

      _this2.game_web.url = url;
      glGame.audio.pauseAllMusic();

      _this2.scheduleOnce(_this2.changeOrientation, 1);
    });
  },
  changeOrientation: function changeOrientation() {
    glGame.platform.changeOrientation(false);
  },
  gameWebOpen: function gameWebOpen() {
    var sendData = {};
    sendData.data = glGame.gameNet.getNetMgr().getLoginToken();
    sendData = JSON.stringify(sendData);
    this.game_web.evaluateJS("check(".concat(sendData, ")"));
  },
  gameWebExit: function gameWebExit() {
    var _this3 = this;

    this.unschedule(this.changeOrientation);
    this.plazaNode.active = true;

    if (this.game_web != null) {
      this.game_web.url = ""; //this.game_web.node.removeFromParent(true);

      this.game_web.node.destroy();
      this.game_web = null;

      if (this.webview_mask) {
        this.webview_mask.destroy();
        this.webview_mask = null;
      }

      glGame.audio.continueAllMusic();
      this.scheduleOnce(function () {
        if (!_this3.game_web) glGame.gameNet.send_msg("http.reqBack", {}, function (route, msg) {});
      }, 1);
    }
  },
  showFloatButton: function showFloatButton() {
    var drager = document.getElementById('drager');
    if (drager) drager.style.visibility = "visible";
  },
  hideFloatButton: function hideFloatButton() {
    var drager = document.getElementById('drager');
    if (drager) drager.style.visibility = "hidden";
  },
  onFloatButton: function onFloatButton() {
    this.hideFloatButton();
    this.gameWebExit();
  },
  OnDestroy: function OnDestroy() {
    glGame.emitter.off("updatePlazaSwitch", this);
    glGame.emitter.off(MESSAGE.UI.WEBVIEW_ON, this);
    glGame.emitter.off(MESSAGE.UI.WEBVIEW_OFF, this);
    glGame.emitter.off("floatButton", this);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccGxhemFcXHNjcmlwdFxcc2NlbmVcXHBsYXphLmpzIl0sIm5hbWVzIjpbIldFQlZJRVdfTk9STUFMIiwiV0VCVklFV19FWElUIiwiV0VCVklFV19FUlJPUiIsIldlYlZpZXdFeCIsInJlcXVpcmUiLCJnbEdhbWUiLCJiYXNlY2xhc3MiLCJleHRlbmQiLCJwcm9wZXJ0aWVzIiwicGxhemFfaGFsbCIsImNjIiwiUHJlZmFiIiwib25Mb2FkIiwiZ2FtZV93ZWIiLCJ3ZWJ2aWV3X21hc2siLCJlbWl0dGVyIiwib24iLCJ1cGRhdGVQbGF6YVN3aXRjaCIsIk1FU1NBR0UiLCJVSSIsIldFQlZJRVdfT04iLCJnYW1lV2ViU3RhcnQiLCJXRUJWSUVXX09GRiIsImdhbWVXZWJFeGl0Iiwib25GbG9hdEJ1dHRvbiIsImlzZmlyc3RFbnRlclBsYXphIiwibm9kZSIsInN0b3BBbGxBY3Rpb25zIiwicnVuQWN0aW9uIiwic2VxdWVuY2UiLCJkZWxheVRpbWUiLCJjYWxsRnVuYyIsImNoZWNrU2hvd1BhbmVsIiwicGxhemFOb2RlIiwicGFuZWwiLCJzaG93UGFuZWwiLCJzaG93SHJpc2VSYWNlTGFtcCIsInNob3dSZWdpc3RlciIsImNsb3NlbGltaXRKdWh1YSIsImNsaWNrQWN0aW9uIiwiZGlyZWN0b3IiLCJnZXRTY2VuZSIsImdldENoaWxkQnlOYW1lIiwiYWN0aXZlIiwic3RhcnQiLCJ3aWR0aCIsImhlaWdodCIsInNob3dzaXplIiwic2l6ZSIsImJwZXJzaXN0Iiwic2hvd1JvbGxOb3RpY2UiLCJ2MiIsIm5vdGljZSIsImVudGVyUGxhemEiLCJzY2VuZSIsImdldFVwU2NlbmUiLCJzY2VuZXRhZyIsIkxPR0lOIiwicmVxR2V0SG9yc2VSYWNlTGFtcCIsImFyciIsInVzZXIiLCJyZWdpc3RlckdldENvaW4iLCJwdXNoIiwidHlwZSIsImF3YXJkdHlwZSIsIkNPSU4iLCJ2YWx1ZSIsImN1dEZsb2F0IiwicmVnaXN0ZXJHZXREaWFtb25kIiwiRElBTU9ORCIsImNvbnNvbGUiLCJsb2ciLCJsZW5ndGgiLCJzaG93QXdhcmRCb3giLCJ0aXBzIiwiUExBWkEiLCJDT05HUkFUVUxBVEUiLCJyZXNldEF3YXJkIiwicGxhemFTaG93UGFuZWwiLCJpc1Nob3dTZXR1cFBhbmVsIiwic3RvcmFnZSIsImdldEl0ZW0iLCJzeXMiLCJwbGF0Zm9ybSIsIklQSE9ORSIsIm5vd1RpbWUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiZ2V0VGltZSIsInNldEl0ZW0iLCJpc1NldHVwIiwidGltZSIsInB1c2hQbGF6YVNob3dQYW5lbCIsImdldCIsInJlcGFpcl9zd2l0Y2giLCJzaG93U3VzcGljaW91cyIsImlzVG91cmlzdCIsImFjdGl2aXR5X3BvcF91cCIsImlzQW5ub3VuY2VtZW50Iiwic2hvd0ZpcnN0RW50ZXJQYW5lbCIsImpzQ2FsbGJhY2siLCJ0YXJnZXQiLCJ1cmwiLCJzdHIiLCJyZXBsYWNlIiwic2NoZW1lIiwic3RyRGF0YSIsInNwbGl0IiwiZGF0YSIsInN0YXRlIiwiTnVtYmVyIiwiY29kZSIsImdhbWVXZWJPcGVuIiwiY2hhbmdlT3JpZW50YXRpb24iLCJzeXN0ZW1jbGFzcyIsIm9mZlN1c3BlbnNpb24iLCJUSElSRF9DT0RFIiwic2hvd1RpcCIsImFkZE5vZGVXaWRnZXQiLCJhZE5vZGUiLCJ3ZWJXaWRnZXQiLCJhZGRDb21wb25lbnQiLCJXaWRnZXQiLCJpc0FsaWduVG9wIiwiaXNBbGlnbkJvdHRvbSIsImlzQWxpZ25MZWZ0IiwiaXNBbGlnblJpZ2h0IiwidG9wIiwiYm90dG9tIiwibGVmdCIsInJpZ2h0IiwiYWxpZ25Nb2RlIiwiQWxpZ25Nb2RlIiwiQUxXQVlTIiwiZ2FtZXdlYk5ldyIsImluc3RhbnRpYXRlIiwiZ2FtZU1hc2tQYW5lbCIsInBhcmVudCIsIndlYk5vZGUiLCJOb2RlIiwiaXNCcm93c2VyIiwic2hvd0Zsb2F0QnV0dG9uIiwiV2ViVmlldyIsInNldEphdmFzY3JpcHRJbnRlcmZhY2VTY2hlbWUiLCJzZXRPbkpTQ2FsbGJhY2siLCJiaW5kIiwiYWRkQ2hpbGQiLCJwcmVIYW5kbGVINSIsInByZUhhbmRsZU5hdGl2ZSIsImdldFdlYkdhbWVVcmwiLCJnYW1laWQiLCJhdWRpbyIsInBhdXNlQWxsTXVzaWMiLCJzY2hlZHVsZU9uY2UiLCJnYW1lTmV0Iiwic2VuZF9tc2ciLCJnIiwicm91dGUiLCJtc2ciLCJyZXN1bHQiLCJhY3Rpb24iLCJnZXRXZWJHYW1lVXJsSDUiLCJzZW5kRGF0YSIsImdldE5ldE1nciIsImdldExvZ2luVG9rZW4iLCJKU09OIiwic3RyaW5naWZ5IiwiZXZhbHVhdGVKUyIsInVuc2NoZWR1bGUiLCJkZXN0cm95IiwiY29udGludWVBbGxNdXNpYyIsImRyYWdlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJoaWRlRmxvYXRCdXR0b24iLCJPbkRlc3Ryb3kiLCJvZmYiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7OztBQUlBLElBQU1BLGNBQWMsR0FBRyxDQUF2QjtBQUNBLElBQU1DLFlBQVksR0FBRyxDQUFyQjtBQUNBLElBQU1DLGFBQWEsR0FBRyxDQUF0Qjs7QUFFQSxJQUFNQyxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxhQUFELENBQXpCOztBQUVBQyxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLE1BQWpCLENBQXdCO0FBQ3BCQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsVUFBVSxFQUFFQyxFQUFFLENBQUNDO0FBRFAsR0FEUTtBQUlwQkMsRUFBQUEsTUFKb0Isb0JBSVg7QUFBQTs7QUFDTCxTQUFLQyxRQUFMLEdBQWdCLElBQWhCO0FBQ0EsU0FBS0MsWUFBTCxHQUFvQixJQUFwQjtBQUNBVCxJQUFBQSxNQUFNLENBQUNVLE9BQVAsQ0FBZUMsRUFBZixDQUFrQixtQkFBbEIsRUFBdUMsS0FBS0MsaUJBQTVDLEVBQStELElBQS9EO0FBQ0FaLElBQUFBLE1BQU0sQ0FBQ1UsT0FBUCxDQUFlQyxFQUFmLENBQWtCRSxPQUFPLENBQUND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LEVBQTBDLElBQTFDO0FBQ0FmLElBQUFBLE1BQU0sQ0FBQ1UsT0FBUCxDQUFlbUssR0FBZixDQUFtQmhLLE9BQU8sQ0FBQ0MsRUFBUixDQUFXRyxXQUE5QixFQUEyQyxJQUEzQztBQUNBakIsSUFBQUEsTUFBTSxDQUFDVSxPQUFQLENBQWVtSyxHQUFmLENBQW1CLGFBQW5CLEVBQWtDLElBQWxDO0FBQ0g7QUEzUW1CLENBQXhCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog5LiJ5Liq5by55Ye655qE6aG65bqP77ya57Sn5oCl5YWs5ZGK77yM5ri45a6i5rOo5YaM77yM5LiD5pel562+5YiwO1xyXG4gKi9cclxuXHJcbmNvbnN0IFdFQlZJRVdfTk9STUFMID0gMDtcclxuY29uc3QgV0VCVklFV19FWElUID0gMTtcclxuY29uc3QgV0VCVklFV19FUlJPUiA9IDI7XHJcblxyXG5jb25zdCBXZWJWaWV3RXggPSByZXF1aXJlKCcuL1dlYlZpZXdFeCcpO1xyXG5cclxuZ2xHYW1lLmJhc2VjbGFzcy5leHRlbmQoe1xyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHBsYXphX2hhbGw6IGNjLlByZWZhYixcclxuICAgIH0sXHJcbiAgICBvbkxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5nYW1lX3dlYiA9IG51bGw7XHJcbiAgICAgICAgdGhpcy53ZWJ2aWV3X21hc2sgPSBudWxsO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKFwidXBkYXRlUGxhemFTd2l0Y2hcIiwgdGhpcy51cGRhdGVQbGF6YVN3aXRjaCwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oTUVTU0FHRS5VSS5XRUJWSUVXX09OLCB0aGlzLmdhbWVXZWJTdGFydCwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oTUVTU0FHRS5VSS5XRUJWSUVXX09GRiwgdGhpcy5nYW1lV2ViRXhpdCwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oXCJmbG9hdEJ1dHRvblwiLCB0aGlzLm9uRmxvYXRCdXR0b24sIHRoaXMpO1xyXG5cclxuICAgICAgICBpZiAoZ2xHYW1lLmlzZmlyc3RFbnRlclBsYXphKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5zdG9wQWxsQWN0aW9ucygpO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGNjLmRlbGF5VGltZSgwLjIpLCBjYy5jYWxsRnVuYygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2hvd1BhbmVsKCk7XHJcbiAgICAgICAgICAgIH0pKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBnbEdhbWUudXNlci5yZXFIb21lVmlldygpO1xyXG4gICAgICAgIHRoaXMucGxhemFOb2RlID0gZ2xHYW1lLnBhbmVsLnNob3dQYW5lbCh0aGlzLnBsYXphX2hhbGwpO1xyXG4gICAgICAgIHRoaXMuc2hvd0hyaXNlUmFjZUxhbXAoKTtcclxuICAgICAgICB0aGlzLnNob3dSZWdpc3RlcigpO1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5jbG9zZWxpbWl0SnVodWEoKTtcclxuXHJcbiAgICAgICAgbGV0IGNsaWNrQWN0aW9uID0gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKS5nZXRDaGlsZEJ5TmFtZShcImNsaWNrX2FjdGlvblwiKTtcclxuICAgICAgICBpZihjbGlja0FjdGlvbikge1xyXG4gICAgICAgICAgICBjbGlja0FjdGlvbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQoKSB7XHJcbiAgICAgICAgLy8gZ2xHYW1lLnBhbmVsLnNob3dKdUh1YSgpO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZVBsYXphU3dpdGNoKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tTaG93UGFuZWwoKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0hyaXNlUmFjZUxhbXAoKSB7XHJcbiAgICAgICAgbGV0IHdpZHRoID0gMTE5MCwgaGVpZ2h0ID0gNjg7XHJcbiAgICAgICAgbGV0IHNob3dzaXplID0gY2Muc2l6ZSh0aGlzLm5vZGUud2lkdGggKiAwLjY1LCBoZWlnaHQpO1xyXG4gICAgICAgIGxldCBicGVyc2lzdCA9IGZhbHNlO1xyXG4gICAgICAgIGdsR2FtZS5wYW5lbC5zaG93Um9sbE5vdGljZShjYy52Mih0aGlzLm5vZGUud2lkdGggLyAyICsgNDM5IC8gMiwgdGhpcy5ub2RlLmhlaWdodCAtIDE4NSksIHNob3dzaXplLCBicGVyc2lzdCk7XHJcbiAgICAgICAgZ2xHYW1lLm5vdGljZS5lbnRlclBsYXphKCk7XHJcbiAgICAgICAgaWYgKGdsR2FtZS5zY2VuZS5nZXRVcFNjZW5lKCkgIT0gZ2xHYW1lLnNjZW5ldGFnLkxPR0lOKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5ub3RpY2UucmVxR2V0SG9yc2VSYWNlTGFtcCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2hvd1JlZ2lzdGVyKCkge1xyXG4gICAgICAgIGxldCBhcnIgPSBbXTtcclxuICAgICAgICBpZiAoZ2xHYW1lLnVzZXIucmVnaXN0ZXJHZXRDb2luICYmIGdsR2FtZS51c2VyLnJlZ2lzdGVyR2V0Q29pbiA+IDApIGFyci5wdXNoKHsgdHlwZTogZ2xHYW1lLmF3YXJkdHlwZS5DT0lOLCB2YWx1ZTogZ2xHYW1lLnVzZXIuY3V0RmxvYXQoZ2xHYW1lLnVzZXIucmVnaXN0ZXJHZXRDb2luKSB9KTtcclxuICAgICAgICBpZiAoZ2xHYW1lLnVzZXIucmVnaXN0ZXJHZXREaWFtb25kICYmIGdsR2FtZS51c2VyLnJlZ2lzdGVyR2V0RGlhbW9uZCA+IDApIGFyci5wdXNoKHsgdHlwZTogZ2xHYW1lLmF3YXJkdHlwZS5ESUFNT05ELCB2YWx1ZTogZ2xHYW1lLnVzZXIuY3V0RmxvYXQoZ2xHYW1lLnVzZXIucmVnaXN0ZXJHZXREaWFtb25kKSB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIui/meaYr+W9k+WJjeeahOaVsOe7hFwiLCBnbEdhbWUudXNlci5yZWdpc3RlckdldENvaW4sIGdsR2FtZS51c2VyLnJlZ2lzdGVyR2V0RGlhbW9uZCwgYXJyKVxyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0F3YXJkQm94KGdsR2FtZS50aXBzLlBMQVpBLkNPTkdSQVRVTEFURSwgYXJyLCAoKSA9PiB7IGdsR2FtZS51c2VyLnJlc2V0QXdhcmQoKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOesrOS4gOasoei/m+WFpeWkp+WOhe+8jOWIpOaWremcgOimgeW8ueWHuuWTquS6m+W8ueeql1xyXG4gICAgICovXHJcbiAgICBjaGVja1Nob3dQYW5lbCgpIHtcclxuICAgICAgICBnbEdhbWUucGFuZWwucGxhemFTaG93UGFuZWwgPSBbXTtcclxuICAgICAgICAvLyBnbEdhbWUucGFuZWwuaGlkZWp1aHVhKCk7XHJcbiAgICAgICAgbGV0IGlzU2hvd1NldHVwUGFuZWwgPSBnbEdhbWUuc3RvcmFnZS5nZXRJdGVtKCdpc1Nob3dTZXR1cFBhbmVsJyk7XHJcbiAgICAgICAgLy8gMS7mr4/lpKnlkK/liqjnrKzkuIDmrKHlvLnlh7pcclxuICAgICAgICAvLyAyLuWuieijheWQjuesrOS4gOasoei/m+WFpeW8ueWHulxyXG4gICAgICAgIC8vbmV3IERhdGUobmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoKSkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGlmIChjYy5zeXMucGxhdGZvcm0gPT0gY2Muc3lzLklQSE9ORSkge1xyXG4gICAgICAgICAgICBsZXQgbm93VGltZSA9IG5ldyBEYXRlKG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpLmdldFRpbWUoKTtcclxuICAgICAgICAgICAgaWYgKCFpc1Nob3dTZXR1cFBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUuc3RvcmFnZS5zZXRJdGVtKCdpc1Nob3dTZXR1cFBhbmVsJywgeyBpc1NldHVwOiBmYWxzZSwgdGltZTogbm93VGltZSB9KTtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5wdXNoUGxhemFTaG93UGFuZWwoXCJzZXR1cFJlcGFpclRvb2xcIik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlzU2hvd1NldHVwUGFuZWwuaXNTZXR1cFxyXG4gICAgICAgICAgICAgICAgJiYgZ2xHYW1lLnVzZXIuZ2V0KFwidXJsXCIpLnJlcGFpcl9zd2l0Y2hcclxuICAgICAgICAgICAgICAgICYmIGdsR2FtZS51c2VyLmdldChcInVybFwiKS5yZXBhaXJfc3dpdGNoID09IDFcclxuICAgICAgICAgICAgICAgICYmIGlzU2hvd1NldHVwUGFuZWwudGltZSA8IG5vd1RpbWUpIHtcclxuICAgICAgICAgICAgICAgIGlzU2hvd1NldHVwUGFuZWwudGltZSA9IG5vd1RpbWU7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUuc3RvcmFnZS5zZXRJdGVtKCdpc1Nob3dTZXR1cFBhbmVsJywgaXNTaG93U2V0dXBQYW5lbCk7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUucGFuZWwucHVzaFBsYXphU2hvd1BhbmVsKFwic2V0dXBSZXBhaXJUb29sXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZ2xHYW1lLmlzZmlyc3RFbnRlclBsYXphKSByZXR1cm5cclxuICAgICAgICBpZiAoIWdsR2FtZS5wYW5lbC5zaG93U3VzcGljaW91cygpKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5wdXNoUGxhemFTaG93UGFuZWwoXCJ1cmdlbnRub3RpY2VcIilcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGdsR2FtZS51c2VyLmlzVG91cmlzdCgpICYmIGdsR2FtZS51c2VyLmdldCgndGlwcycpICYmIGdsR2FtZS5pc2ZpcnN0RW50ZXJQbGF6YSkge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwucHVzaFBsYXphU2hvd1BhbmVsKFwidG91cmlzdHRpcFwiKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZ2xHYW1lLnVzZXIuZ2V0KFwic2lnbl9zdGF0ZVwiKSkge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwucHVzaFBsYXphU2hvd1BhbmVsKFwic2lnbmluXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChnbEdhbWUudXNlci5nZXQoXCJsb2dpblN3aXRjaFwiKS5hY3Rpdml0eV9wb3BfdXAgPT0gMikge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwucHVzaFBsYXphU2hvd1BhbmVsKFwiYW5ub3VuY2VtZW50XCIpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZ2xHYW1lLnVzZXIuZ2V0KFwibG9naW5Td2l0Y2hcIikuYWN0aXZpdHlfcG9wX3VwID09IDMpIHtcclxuICAgICAgICAgICAgbGV0IGlzQW5ub3VuY2VtZW50ID0gZ2xHYW1lLnN0b3JhZ2UuZ2V0SXRlbSgnaXNBbm5vdW5jZW1lbnQnKTtcclxuICAgICAgICAgICAgbGV0IG5vd1RpbWUgPSBuZXcgRGF0ZShuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgIGlmICghaXNBbm5vdW5jZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5zdG9yYWdlLnNldEl0ZW0oJ2lzQW5ub3VuY2VtZW50JywgeyB0aW1lOiBub3dUaW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnB1c2hQbGF6YVNob3dQYW5lbChcImFubm91bmNlbWVudFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0Fubm91bmNlbWVudC50aW1lIDwgbm93VGltZSkge1xyXG4gICAgICAgICAgICAgICAgaXNBbm5vdW5jZW1lbnQudGltZSA9IG5vd1RpbWU7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUuc3RvcmFnZS5zZXRJdGVtKCdpc0Fubm91bmNlbWVudCcsIGlzQW5ub3VuY2VtZW50KTtcclxuICAgICAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5wdXNoUGxhemFTaG93UGFuZWwoXCJhbm5vdW5jZW1lbnRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dGaXJzdEVudGVyUGFuZWwoKTtcclxuICAgICAgICBnbEdhbWUuaXNmaXJzdEVudGVyUGxhemEgPSBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7lm57osINcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0ICAgICAgICAvL3dlYnZpZXcg5a+56LGhIFxyXG4gICAgICogQHBhcmFtIHsqfSB1cmwgICAgICAgICAgIC8v5Zue6LCDc2NoZW1lLOW4puWPguaVsCAgc2NoZW1lOi8vc3RhdGU6MCZjb2RlOjBcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLXN0YXRlOueKtuaAge+8iGludO+8iTDkuLrml6DnirbmgIEgMeS4uumAgOWHuueKtuaAgSAgMumUmeivr+eKtuaAgSAgXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLS1jb2RlOumUmeivr+S/oeaBryAtLT4g6ZSZ6K+v56CBKGludClcclxuICAgICAqL1xyXG4gICAganNDYWxsYmFjayh0YXJnZXQsIHVybCkge1xyXG4gICAgICAgIC8vdGhpcy5nYW1lX3dlYi51cmwgPSBcIlwiO1xyXG4gICAgICAgIHZhciBzdHIgPSB1cmwucmVwbGFjZSh0aGlzLnNjaGVtZSArICc6Ly8nLCAnJyk7IC8vIHN0ciA9PT0gJ2E9MSZiPTInXHJcbiAgICAgICAgbGV0IHN0ckRhdGEgPSBzdHIuc3BsaXQoXCImXCIpLCBkYXRhID0ge307XHJcbiAgICAgICAgZGF0YS5zdGF0ZSA9IE51bWJlcihzdHJEYXRhWzBdLnJlcGxhY2UoXCJzdGF0ZTpcIiwgXCJcIikpO1xyXG4gICAgICAgIGRhdGEuY29kZSA9IE51bWJlcihzdHJEYXRhWzFdLnJlcGxhY2UoXCJjb2RlOlwiLCBcIlwiKSk7XHJcbiAgICAgICAgaWYgKGRhdGEuc3RhdGUgPT0gV0VCVklFV19OT1JNQUwgJiYgZGF0YS5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lV2ViT3BlbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zdGF0ZSAhPSBXRUJWSUVXX05PUk1BTCAmJiBkYXRhLmNvZGUgIT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVXZWJFeGl0KCk7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wbGF0Zm9ybS5jaGFuZ2VPcmllbnRhdGlvbih0cnVlKTtcclxuICAgICAgICAgICAgZ2xHYW1lLnN5c3RlbWNsYXNzLmNoYW5nZU9yaWVudGF0aW9uKHRydWUpO1xyXG4gICAgICAgICAgICBnbEdhbWUucGxhdGZvcm0ub2ZmU3VzcGVuc2lvbigpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0ZSA9PSBXRUJWSUVXX0VSUk9SICYmIFRISVJEX0NPREVbZGF0YS5jb2RlXSkgZ2xHYW1lLnBhbmVsLnNob3dUaXAoVEhJUkRfQ09ERVtkYXRhLmNvZGVdKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yib5bu6d2lkZ2V0ICDlhajlsY/pk7rmu6FcclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBhZE5vZGUg6ZyA6KaB5re75Yqg55qEbm9kZeWvueixoVxyXG4gICAgICovXHJcbiAgICBhZGROb2RlV2lkZ2V0KGFkTm9kZSkge1xyXG4gICAgICAgIHZhciB3ZWJXaWRnZXQgPSBhZE5vZGUuYWRkQ29tcG9uZW50KGNjLldpZGdldCk7XHJcbiAgICAgICAgd2ViV2lkZ2V0LmlzQWxpZ25Ub3AgPSB0cnVlO1xyXG4gICAgICAgIHdlYldpZGdldC5pc0FsaWduQm90dG9tID0gdHJ1ZTtcclxuICAgICAgICB3ZWJXaWRnZXQuaXNBbGlnbkxlZnQgPSB0cnVlO1xyXG4gICAgICAgIHdlYldpZGdldC5pc0FsaWduUmlnaHQgPSB0cnVlO1xyXG4gICAgICAgIHdlYldpZGdldC50b3AgPSAwO1xyXG4gICAgICAgIHdlYldpZGdldC5ib3R0b20gPSAwO1xyXG4gICAgICAgIHdlYldpZGdldC5sZWZ0ID0gMDtcclxuICAgICAgICB3ZWJXaWRnZXQucmlnaHQgPSAwO1xyXG4gICAgICAgIHdlYldpZGdldC5hbGlnbk1vZGUgPSBjYy5XaWRnZXQuQWxpZ25Nb2RlLkFMV0FZUztcclxuICAgICAgICByZXR1cm4gd2ViV2lkZ2V0O1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWKqOaAgeWIm+W7undlYlxyXG4gICAgICovXHJcbiAgICBnYW1ld2ViTmV3KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmdhbWVfd2ViKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICghdGhpcy53ZWJ2aWV3X21hc2spIHtcclxuICAgICAgICAgICAgdGhpcy53ZWJ2aWV3X21hc2sgPSBjYy5pbnN0YW50aWF0ZShnbEdhbWUucGFuZWwuZ2FtZU1hc2tQYW5lbCk7XHJcbiAgICAgICAgICAgIHRoaXMud2Vidmlld19tYXNrLnBhcmVudCA9IGNjLmRpcmVjdG9yLmdldFNjZW5lKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgd2ViTm9kZSA9IG5ldyBjYy5Ob2RlKCk7XHJcblxyXG4gICAgICAgIHdlYk5vZGUuc2l6ZSA9IGNjLnNpemUodGhpcy5ub2RlLndpZHRoLCB0aGlzLm5vZGUuaGVpZ2h0KTtcclxuICAgICAgICB0aGlzLmFkZE5vZGVXaWRnZXQod2ViTm9kZSk7XHJcblxyXG4gICAgICAgIGlmKGNjLnN5cy5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lX3dlYiA9IHdlYk5vZGUuYWRkQ29tcG9uZW50KFdlYlZpZXdFeCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Zsb2F0QnV0dG9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5nYW1lX3dlYiA9IHdlYk5vZGUuYWRkQ29tcG9uZW50KGNjLldlYlZpZXcpO1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVtZSA9IFwib25nYW1lZGF0YVwiO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVfd2ViLnNldEphdmFzY3JpcHRJbnRlcmZhY2VTY2hlbWUodGhpcy5zY2hlbWUpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVfd2ViLnNldE9uSlNDYWxsYmFjayh0aGlzLmpzQ2FsbGJhY2suYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQod2ViTm9kZSk7XHJcbiAgICAgICAgdGhpcy5wbGF6YU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIGdhbWVXZWJTdGFydChkYXRhKSB7XHJcbiAgICAgICAgaWYoY2Muc3lzLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICB0aGlzLnByZUhhbmRsZUg1KGRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJlSGFuZGxlTmF0aXZlKGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5Y6f55Sf5bmz5Y+w6aKE5aSE55CGXHJcbiAgICBwcmVIYW5kbGVOYXRpdmUoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuZ2FtZXdlYk5ldygpO1xyXG4gICAgICAgIHRoaXMuZ2FtZV93ZWIudXJsID0gZ2xHYW1lLnVzZXIuZ2V0V2ViR2FtZVVybChkYXRhLmdhbWVpZCk7XHJcbiAgICAgICAgZ2xHYW1lLmF1ZGlvLnBhdXNlQWxsTXVzaWMoKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZSh0aGlzLmNoYW5nZU9yaWVudGF0aW9uLCAxKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gaDXlubPlj7DpooTlpITnkIZcclxuICAgIHByZUhhbmRsZUg1KGRhdGEpIHtcclxuICAgICAgICBnbEdhbWUuZ2FtZU5ldC5zZW5kX21zZyhcImh0dHAuRm9yd2FyZEg1XCIsIHtnOiBkYXRhLmdhbWVpZH0sIChyb3V0ZSwgbXNnKSA9PiB7IFxyXG4gICAgICAgICAgICBsZXQgZGF0YSA9IG1zZy5yZXN1bHQ7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZXdlYk5ldygpO1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gZGF0YS51cmw7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuYWN0aW9uID09ICdwb3N0Jykge1xyXG4gICAgICAgICAgICAgICAgdXJsID0gZ2xHYW1lLnVzZXIuZ2V0V2ViR2FtZVVybEg1KGRhdGEudXJsKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5nYW1lX3dlYi51cmwgPSB1cmw7XHJcbiAgICAgICAgICAgIGdsR2FtZS5hdWRpby5wYXVzZUFsbE11c2ljKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKHRoaXMuY2hhbmdlT3JpZW50YXRpb24sIDEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjaGFuZ2VPcmllbnRhdGlvbigpIHtcclxuICAgICAgICBnbEdhbWUucGxhdGZvcm0uY2hhbmdlT3JpZW50YXRpb24oZmFsc2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnYW1lV2ViT3BlbigpIHtcclxuICAgICAgICBsZXQgc2VuZERhdGEgPSB7fTtcclxuICAgICAgICBzZW5kRGF0YS5kYXRhID0gZ2xHYW1lLmdhbWVOZXQuZ2V0TmV0TWdyKCkuZ2V0TG9naW5Ub2tlbigpXHJcbiAgICAgICAgc2VuZERhdGEgPSBKU09OLnN0cmluZ2lmeShzZW5kRGF0YSk7XHJcbiAgICAgICAgdGhpcy5nYW1lX3dlYi5ldmFsdWF0ZUpTKGBjaGVjaygke3NlbmREYXRhfSlgKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2FtZVdlYkV4aXQoKSB7XHJcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuY2hhbmdlT3JpZW50YXRpb24pO1xyXG4gICAgICAgIHRoaXMucGxhemFOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2FtZV93ZWIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWVfd2ViLnVybCA9IFwiXCI7XHJcbiAgICAgICAgICAgIC8vdGhpcy5nYW1lX3dlYi5ub2RlLnJlbW92ZUZyb21QYXJlbnQodHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZV93ZWIubm9kZS5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZV93ZWIgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAodGhpcy53ZWJ2aWV3X21hc2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vidmlld19tYXNrLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vidmlld19tYXNrID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBnbEdhbWUuYXVkaW8uY29udGludWVBbGxNdXNpYygpO1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ2FtZV93ZWIpIGdsR2FtZS5nYW1lTmV0LnNlbmRfbXNnKFwiaHR0cC5yZXFCYWNrXCIsIHt9LCAocm91dGUsIG1zZykgPT4geyB9KTtcclxuICAgICAgICAgICAgfSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93RmxvYXRCdXR0b24oKSB7XHJcbiAgICAgICAgbGV0IGRyYWdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkcmFnZXInKTtcclxuICAgICAgICBpZihkcmFnZXIpXHJcbiAgICAgICAgICAgIGRyYWdlci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGVGbG9hdEJ1dHRvbigpIHtcclxuICAgICAgICBsZXQgZHJhZ2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RyYWdlcicpO1xyXG4gICAgICAgIGlmKGRyYWdlcilcclxuICAgICAgICAgICAgZHJhZ2VyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkZsb2F0QnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuaGlkZUZsb2F0QnV0dG9uKCk7XHJcbiAgICAgICAgdGhpcy5nYW1lV2ViRXhpdCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKFwidXBkYXRlUGxhemFTd2l0Y2hcIiwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKE1FU1NBR0UuVUkuV0VCVklFV19PTiwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKE1FU1NBR0UuVUkuV0VCVklFV19PRkYsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihcImZsb2F0QnV0dG9uXCIsIHRoaXMpO1xyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==