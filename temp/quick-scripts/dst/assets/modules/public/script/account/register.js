
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/public/script/account/register.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '5839d7mN+BEXrpjHshoYTqJ', 'register');
// modules/public/script/account/register.js

"use strict";

glGame.baseclass.extend({
  properties: {
    //登录
    login_accf: cc.Node,
    login_acc: cc.EditBox,
    login_psw: cc.EditBox,
    retrievepsw: cc.Prefab,
    protocol: cc.Prefab,
    node_agree: cc.Toggle,
    downFrame: cc.Node
  },
  onLoad: function onLoad() {
    this.registerEvent();
    this.iSagree = false;
  },
  start: function start() {
    this.initUI();
  },
  registerEvent: function registerEvent() {},
  unRegisterEvent: function unRegisterEvent() {},
  initUI: function initUI() {
    var strAcc = glGame.storage.getItem("accNumber") ? glGame.storage.getItem("accNumber").data : '';
    if (strAcc != '') this.login_accf.getSelfFunc().setString(strAcc);
    this.iSagree = glGame.storage.getItem("isAgree") ? glGame.storage.getItem("isAgree").data : true;
    this.node_agree.isChecked = this.iSagree;
  },
  //账号登录
  accLogin_cb: function accLogin_cb() {
    if (!this.iSagree) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PROTOCOL);
      return;
    } //将空格去除指令


    var regex = / /gi;
    this.login_acc.string = this.login_acc.string.replace(regex, '');
    var acc = this.checkAcc(this.login_acc.string);
    if (!acc) return;
    var psw = this.checkPassword(this.login_psw.string);
    if (!psw) return;
    glGame.logon.reqAccLogin({
      username: acc,
      password: md5(psw)
    }); //username:phone,code:验证码,plat:5

    glGame.storage.setItem("accNumber", {
      data: acc
    });
  },
  editCheckAcc: function editCheckAcc() {
    var str = this.login_acc.string;
    this.checkAcc(str);
  },
  // 账号检查
  checkAcc: function checkAcc(acc) {
    if (!acc || acc == '') {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCNULL);
      return false;
    }

    if (acc.length < 4) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCLENGTH);
      return false;
    } // let reg = /^\w{4,15}$/;


    var reg = /^[A-Za-z0-9]{4,15}$/;
    var acc_check = reg.test(acc);

    if (!acc_check) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCTYPE);
      return false;
    }

    return acc;
  },
  // 密码检查
  checkPassword: function checkPassword(psw, confimpsw) {
    if (!psw) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.LOGPSWNULL);
      return null;
    }

    if (psw.length < 6) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);
      return false;
    }

    if (!/\w$/.test(psw)) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWWRONGFUL);
      return null;
    }

    if (confimpsw == null) return psw;

    if (!confimpsw || psw !== confimpsw) {
      glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWCOFAIL);
      return null;
    }

    return psw;
  },
  onClick: function onClick(name, node) {
    switch (name) {
      case "btn_accLogin":
        this.accLogin_cb();
        break;

      case "btn_goregister":
        this.goRegister_cb();
        break;

      case "btn_forgetpas":
        this.showFindPsw();
        break;

      case "btn_explain":
        this.btn_protocol();
        break;

      case "checkExplain":
        this.selectExplain();
        break;

      case "btn_close":
        this.remove();
        break;

      default:
        break;
    }
  },
  //跳转立即注册
  goRegister_cb: function goRegister_cb() {
    this.remove(false);
    glGame.panel.showRegistration();
  },
  btn_protocol: function btn_protocol() {
    glGame.panel.showChildPanel(this.protocol, this.node);
  },
  showFindPsw: function showFindPsw() {
    if (glGame.user.get("loginSwitch").self_edit_login_pwd == 1) {
      glGame.panel.showChildPanel(this.retrievepsw, this.node);
    } else {
      glGame.panel.showServiceBox(glGame.tips.USER.PASSWORD.SERVICE);
    }
  },
  selectExplain: function selectExplain() {
    this.iSagree = this.node_agree.isChecked;
    glGame.storage.setItem("isAgree", {
      data: this.iSagree
    });
  },
  OnDestroy: function OnDestroy() {
    this.unRegisterEvent();
  } // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xccHVibGljXFxzY3JpcHRcXGFjY291bnRcXHJlZ2lzdGVyLmpzIl0sIm5hbWVzIjpbImdsR2FtZSIsImJhc2VjbGFzcyIsImV4dGVuZCIsInByb3BlcnRpZXMiLCJsb2dpbl9hY2NmIiwiY2MiLCJOb2RlIiwibG9naW5fYWNjIiwiRWRpdEJveCIsImxvZ2luX3BzdyIsInJldHJpZXZlcHN3IiwiUHJlZmFiIiwicHJvdG9jb2wiLCJub2RlX2FncmVlIiwiVG9nZ2xlIiwiZG93bkZyYW1lIiwib25Mb2FkIiwicmVnaXN0ZXJFdmVudCIsImlTYWdyZWUiLCJzdGFydCIsImluaXRVSSIsInVuUmVnaXN0ZXJFdmVudCIsInN0ckFjYyIsInN0b3JhZ2UiLCJnZXRJdGVtIiwiZGF0YSIsImdldFNlbGZGdW5jIiwic2V0U3RyaW5nIiwiaXNDaGVja2VkIiwiYWNjTG9naW5fY2IiLCJwYW5lbCIsInNob3dFcnJvclRpcCIsInRpcHMiLCJSRUdJU1RSQVRJT04iLCJQUk9UT0NPTCIsInJlZ2V4Iiwic3RyaW5nIiwicmVwbGFjZSIsImFjYyIsImNoZWNrQWNjIiwicHN3IiwiY2hlY2tQYXNzd29yZCIsImxvZ29uIiwicmVxQWNjTG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibWQ1Iiwic2V0SXRlbSIsImVkaXRDaGVja0FjYyIsInN0ciIsIkFDQ05VTEwiLCJsZW5ndGgiLCJBQ0NMRU5HVEgiLCJyZWciLCJhY2NfY2hlY2siLCJ0ZXN0IiwiQUNDVFlQRSIsImNvbmZpbXBzdyIsIkxPR1BTV05VTEwiLCJQU1dMRU5HVEgiLCJQU1dXUk9OR0ZVTCIsIlBTV0NPRkFJTCIsIm9uQ2xpY2siLCJuYW1lIiwibm9kZSIsImdvUmVnaXN0ZXJfY2IiLCJzaG93RmluZFBzdyIsImJ0bl9wcm90b2NvbCIsInNlbGVjdEV4cGxhaW4iLCJyZW1vdmUiLCJzaG93UmVnaXN0cmF0aW9uIiwic2hvd0NoaWxkUGFuZWwiLCJ1c2VyIiwiZ2V0Iiwic2VsZl9lZGl0X2xvZ2luX3B3ZCIsInNob3dTZXJ2aWNlQm94IiwiVVNFUiIsIlBBU1NXT1JEIiwiU0VSVklDRSIsIk9uRGVzdHJveSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQUEsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QjtBQUVwQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1I7QUFDQUMsSUFBQUEsVUFBVSxFQUFFQyxFQUFFLENBQUNDLElBRlA7QUFHUkMsSUFBQUEsU0FBUyxFQUFFRixFQUFFLENBQUNHLE9BSE47QUFJUkMsSUFBQUEsU0FBUyxFQUFFSixFQUFFLENBQUNHLE9BSk47QUFLUkUsSUFBQUEsV0FBVyxFQUFFTCxFQUFFLENBQUNNLE1BTFI7QUFNUkMsSUFBQUEsUUFBUSxFQUFFUCxFQUFFLENBQUNNLE1BTkw7QUFPUkUsSUFBQUEsVUFBVSxFQUFFUixFQUFFLENBQUNTLE1BUFA7QUFRUkMsSUFBQUEsU0FBUyxFQUFFVixFQUFFLENBQUNDO0FBUk4sR0FGUTtBQWFwQlUsRUFBQUEsTUFib0Isb0JBYVg7QUFDTCxTQUFLQyxhQUFMO0FBQ0EsU0FBS0MsT0FBTCxHQUFlLEtBQWY7QUFDSCxHQWhCbUI7QUFpQnBCQyxFQUFBQSxLQWpCb0IsbUJBaUJaO0FBQ0osU0FBS0MsTUFBTDtBQUNILEdBbkJtQjtBQW9CcEJILEVBQUFBLGFBcEJvQiwyQkFvQkosQ0FDZixDQXJCbUI7QUFzQnBCSSxFQUFBQSxlQXRCb0IsNkJBc0JGLENBQ2pCLENBdkJtQjtBQXlCcEJELEVBQUFBLE1BekJvQixvQkF5Qlg7QUFDTCxRQUFJRSxNQUFNLEdBQUd0QixNQUFNLENBQUN1QixPQUFQLENBQWVDLE9BQWYsQ0FBdUIsV0FBdkIsSUFBc0N4QixNQUFNLENBQUN1QixPQUFQLENBQWVDLE9BQWYsQ0FBdUIsV0FBdkIsRUFBb0NDLElBQTFFLEdBQWlGLEVBQTlGO0FBQ0EsUUFBSUgsTUFBTSxJQUFJLEVBQWQsRUFBa0IsS0FBS2xCLFVBQUwsQ0FBZ0JzQixXQUFoQixHQUE4QkMsU0FBOUIsQ0FBd0NMLE1BQXhDO0FBQ2xCLFNBQUtKLE9BQUwsR0FBZWxCLE1BQU0sQ0FBQ3VCLE9BQVAsQ0FBZUMsT0FBZixDQUF1QixTQUF2QixJQUFvQ3hCLE1BQU0sQ0FBQ3VCLE9BQVAsQ0FBZUMsT0FBZixDQUF1QixTQUF2QixFQUFrQ0MsSUFBdEUsR0FBNkUsSUFBNUY7QUFDQSxTQUFLWixVQUFMLENBQWdCZSxTQUFoQixHQUE0QixLQUFLVixPQUFqQztBQUNILEdBOUJtQjtBQWdDcEI7QUFDQVcsRUFBQUEsV0FqQ29CLHlCQWlDTjtBQUNWLFFBQUksQ0FBQyxLQUFLWCxPQUFWLEVBQW1CO0FBQ2ZsQixNQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWFDLFlBQWIsQ0FBMEIvQixNQUFNLENBQUNnQyxJQUFQLENBQVlDLFlBQVosQ0FBeUJDLFFBQW5EO0FBQ0E7QUFDSCxLQUpTLENBS1Y7OztBQUNBLFFBQU1DLEtBQUssR0FBRyxLQUFkO0FBQ0EsU0FBSzVCLFNBQUwsQ0FBZTZCLE1BQWYsR0FBd0IsS0FBSzdCLFNBQUwsQ0FBZTZCLE1BQWYsQ0FBc0JDLE9BQXRCLENBQThCRixLQUE5QixFQUFxQyxFQUFyQyxDQUF4QjtBQUVBLFFBQUlHLEdBQUcsR0FBRyxLQUFLQyxRQUFMLENBQWMsS0FBS2hDLFNBQUwsQ0FBZTZCLE1BQTdCLENBQVY7QUFDQSxRQUFJLENBQUNFLEdBQUwsRUFBVTtBQUNWLFFBQUlFLEdBQUcsR0FBRyxLQUFLQyxhQUFMLENBQW1CLEtBQUtoQyxTQUFMLENBQWUyQixNQUFsQyxDQUFWO0FBQ0EsUUFBSSxDQUFDSSxHQUFMLEVBQVU7QUFFVnhDLElBQUFBLE1BQU0sQ0FBQzBDLEtBQVAsQ0FBYUMsV0FBYixDQUF5QjtBQUFFQyxNQUFBQSxRQUFRLEVBQUVOLEdBQVo7QUFBaUJPLE1BQUFBLFFBQVEsRUFBRUMsR0FBRyxDQUFDTixHQUFEO0FBQTlCLEtBQXpCLEVBZFUsQ0FjMEQ7O0FBRXBFeEMsSUFBQUEsTUFBTSxDQUFDdUIsT0FBUCxDQUFld0IsT0FBZixDQUF1QixXQUF2QixFQUFvQztBQUFFdEIsTUFBQUEsSUFBSSxFQUFFYTtBQUFSLEtBQXBDO0FBQ0gsR0FsRG1CO0FBb0RwQlUsRUFBQUEsWUFwRG9CLDBCQW9ETDtBQUNYLFFBQUlDLEdBQUcsR0FBRyxLQUFLMUMsU0FBTCxDQUFlNkIsTUFBekI7QUFDQSxTQUFLRyxRQUFMLENBQWNVLEdBQWQ7QUFDSCxHQXZEbUI7QUF5RHBCO0FBQ0FWLEVBQUFBLFFBMURvQixvQkEwRFhELEdBMURXLEVBMEROO0FBQ1YsUUFBSSxDQUFDQSxHQUFELElBQVFBLEdBQUcsSUFBSSxFQUFuQixFQUF1QjtBQUNuQnRDLE1BQUFBLE1BQU0sQ0FBQzhCLEtBQVAsQ0FBYUMsWUFBYixDQUEwQi9CLE1BQU0sQ0FBQ2dDLElBQVAsQ0FBWUMsWUFBWixDQUF5QmlCLE9BQW5EO0FBQ0EsYUFBTyxLQUFQO0FBQ0g7O0FBQ0QsUUFBSVosR0FBRyxDQUFDYSxNQUFKLEdBQWEsQ0FBakIsRUFBb0I7QUFDaEJuRCxNQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWFDLFlBQWIsQ0FBMEIvQixNQUFNLENBQUNnQyxJQUFQLENBQVlDLFlBQVosQ0FBeUJtQixTQUFuRDtBQUNBLGFBQU8sS0FBUDtBQUNILEtBUlMsQ0FTVjs7O0FBQ0EsUUFBSUMsR0FBRyxHQUFHLHFCQUFWO0FBQ0EsUUFBSUMsU0FBUyxHQUFHRCxHQUFHLENBQUNFLElBQUosQ0FBU2pCLEdBQVQsQ0FBaEI7O0FBQ0EsUUFBSSxDQUFDZ0IsU0FBTCxFQUFnQjtBQUNadEQsTUFBQUEsTUFBTSxDQUFDOEIsS0FBUCxDQUFhQyxZQUFiLENBQTBCL0IsTUFBTSxDQUFDZ0MsSUFBUCxDQUFZQyxZQUFaLENBQXlCdUIsT0FBbkQ7QUFDQSxhQUFPLEtBQVA7QUFDSDs7QUFDRCxXQUFPbEIsR0FBUDtBQUNILEdBM0VtQjtBQTZFcEI7QUFDQUcsRUFBQUEsYUE5RW9CLHlCQThFTkQsR0E5RU0sRUE4RURpQixTQTlFQyxFQThFVTtBQUMxQixRQUFJLENBQUNqQixHQUFMLEVBQVU7QUFDTnhDLE1BQUFBLE1BQU0sQ0FBQzhCLEtBQVAsQ0FBYUMsWUFBYixDQUEwQi9CLE1BQU0sQ0FBQ2dDLElBQVAsQ0FBWUMsWUFBWixDQUF5QnlCLFVBQW5EO0FBQ0EsYUFBTyxJQUFQO0FBQ0g7O0FBQ0QsUUFBSWxCLEdBQUcsQ0FBQ1csTUFBSixHQUFhLENBQWpCLEVBQW9CO0FBQ2hCbkQsTUFBQUEsTUFBTSxDQUFDOEIsS0FBUCxDQUFhQyxZQUFiLENBQTBCL0IsTUFBTSxDQUFDZ0MsSUFBUCxDQUFZQyxZQUFaLENBQXlCMEIsU0FBbkQ7QUFDQSxhQUFPLEtBQVA7QUFDSDs7QUFDRCxRQUFJLENBQUMsTUFBTUosSUFBTixDQUFXZixHQUFYLENBQUwsRUFBc0I7QUFDbEJ4QyxNQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWFDLFlBQWIsQ0FBMEIvQixNQUFNLENBQUNnQyxJQUFQLENBQVlDLFlBQVosQ0FBeUIyQixXQUFuRDtBQUNBLGFBQU8sSUFBUDtBQUNIOztBQUNELFFBQUlILFNBQVMsSUFBSSxJQUFqQixFQUF1QixPQUFPakIsR0FBUDs7QUFDdkIsUUFBSSxDQUFDaUIsU0FBRCxJQUFjakIsR0FBRyxLQUFLaUIsU0FBMUIsRUFBcUM7QUFDakN6RCxNQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWFDLFlBQWIsQ0FBMEIvQixNQUFNLENBQUNnQyxJQUFQLENBQVlDLFlBQVosQ0FBeUI0QixTQUFuRDtBQUNBLGFBQU8sSUFBUDtBQUNIOztBQUNELFdBQU9yQixHQUFQO0FBQ0gsR0FqR21CO0FBbUdwQnNCLEVBQUFBLE9BbkdvQixtQkFtR1pDLElBbkdZLEVBbUdOQyxJQW5HTSxFQW1HQTtBQUNoQixZQUFRRCxJQUFSO0FBQ0ksV0FBSyxjQUFMO0FBQXFCLGFBQUtsQyxXQUFMO0FBQW9COztBQUN6QyxXQUFLLGdCQUFMO0FBQXVCLGFBQUtvQyxhQUFMO0FBQXNCOztBQUM3QyxXQUFLLGVBQUw7QUFBc0IsYUFBS0MsV0FBTDtBQUFvQjs7QUFDMUMsV0FBSyxhQUFMO0FBQW9CLGFBQUtDLFlBQUw7QUFBcUI7O0FBQ3pDLFdBQUssY0FBTDtBQUFxQixhQUFLQyxhQUFMO0FBQXNCOztBQUMzQyxXQUFLLFdBQUw7QUFBa0IsYUFBS0MsTUFBTDtBQUFlOztBQUNqQztBQUFTO0FBUGI7QUFTSCxHQTdHbUI7QUErR3BCO0FBQ0FKLEVBQUFBLGFBaEhvQiwyQkFnSEo7QUFDWixTQUFLSSxNQUFMLENBQVksS0FBWjtBQUNBckUsSUFBQUEsTUFBTSxDQUFDOEIsS0FBUCxDQUFhd0MsZ0JBQWI7QUFDSCxHQW5IbUI7QUFxSHBCSCxFQUFBQSxZQXJIb0IsMEJBcUhMO0FBQ1huRSxJQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWF5QyxjQUFiLENBQTRCLEtBQUszRCxRQUFqQyxFQUEyQyxLQUFLb0QsSUFBaEQ7QUFDSCxHQXZIbUI7QUF5SHBCRSxFQUFBQSxXQXpIb0IseUJBeUhOO0FBQ1YsUUFBSWxFLE1BQU0sQ0FBQ3dFLElBQVAsQ0FBWUMsR0FBWixDQUFnQixhQUFoQixFQUErQkMsbUJBQS9CLElBQXNELENBQTFELEVBQTZEO0FBQ3pEMUUsTUFBQUEsTUFBTSxDQUFDOEIsS0FBUCxDQUFheUMsY0FBYixDQUE0QixLQUFLN0QsV0FBakMsRUFBOEMsS0FBS3NELElBQW5EO0FBQ0gsS0FGRCxNQUVPO0FBQ0hoRSxNQUFBQSxNQUFNLENBQUM4QixLQUFQLENBQWE2QyxjQUFiLENBQTRCM0UsTUFBTSxDQUFDZ0MsSUFBUCxDQUFZNEMsSUFBWixDQUFpQkMsUUFBakIsQ0FBMEJDLE9BQXREO0FBQ0g7QUFDSixHQS9IbUI7QUFpSXBCVixFQUFBQSxhQWpJb0IsMkJBaUlKO0FBQ1osU0FBS2xELE9BQUwsR0FBZSxLQUFLTCxVQUFMLENBQWdCZSxTQUEvQjtBQUNBNUIsSUFBQUEsTUFBTSxDQUFDdUIsT0FBUCxDQUFld0IsT0FBZixDQUF1QixTQUF2QixFQUFrQztBQUFFdEIsTUFBQUEsSUFBSSxFQUFFLEtBQUtQO0FBQWIsS0FBbEM7QUFDSCxHQXBJbUI7QUF1SXBCNkQsRUFBQUEsU0F2SW9CLHVCQXVJUjtBQUNSLFNBQUsxRCxlQUFMO0FBQ0gsR0F6SW1CLENBMElwQjs7QUExSW9CLENBQXhCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZ2xHYW1lLmJhc2VjbGFzcy5leHRlbmQoe1xyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvL+eZu+W9lVxyXG4gICAgICAgIGxvZ2luX2FjY2Y6IGNjLk5vZGUsXHJcbiAgICAgICAgbG9naW5fYWNjOiBjYy5FZGl0Qm94LFxyXG4gICAgICAgIGxvZ2luX3BzdzogY2MuRWRpdEJveCxcclxuICAgICAgICByZXRyaWV2ZXBzdzogY2MuUHJlZmFiLFxyXG4gICAgICAgIHByb3RvY29sOiBjYy5QcmVmYWIsXHJcbiAgICAgICAgbm9kZV9hZ3JlZTogY2MuVG9nZ2xlLFxyXG4gICAgICAgIGRvd25GcmFtZTogY2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgICAgIHRoaXMuaVNhZ3JlZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuaW5pdFVJKCk7XHJcbiAgICB9LFxyXG4gICAgcmVnaXN0ZXJFdmVudCgpIHtcclxuICAgIH0sXHJcbiAgICB1blJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRVSSgpIHtcclxuICAgICAgICBsZXQgc3RyQWNjID0gZ2xHYW1lLnN0b3JhZ2UuZ2V0SXRlbShcImFjY051bWJlclwiKSA/IGdsR2FtZS5zdG9yYWdlLmdldEl0ZW0oXCJhY2NOdW1iZXJcIikuZGF0YSA6ICcnO1xyXG4gICAgICAgIGlmIChzdHJBY2MgIT0gJycpIHRoaXMubG9naW5fYWNjZi5nZXRTZWxmRnVuYygpLnNldFN0cmluZyhzdHJBY2MpO1xyXG4gICAgICAgIHRoaXMuaVNhZ3JlZSA9IGdsR2FtZS5zdG9yYWdlLmdldEl0ZW0oXCJpc0FncmVlXCIpID8gZ2xHYW1lLnN0b3JhZ2UuZ2V0SXRlbShcImlzQWdyZWVcIikuZGF0YSA6IHRydWU7XHJcbiAgICAgICAgdGhpcy5ub2RlX2FncmVlLmlzQ2hlY2tlZCA9IHRoaXMuaVNhZ3JlZTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/otKblj7fnmbvlvZVcclxuICAgIGFjY0xvZ2luX2NiKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pU2FncmVlKSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuUkVHSVNUUkFUSU9OLlBST1RPQ09MKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+WwhuepuuagvOWOu+mZpOaMh+S7pFxyXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gLyAvZ2k7XHJcbiAgICAgICAgdGhpcy5sb2dpbl9hY2Muc3RyaW5nID0gdGhpcy5sb2dpbl9hY2Muc3RyaW5nLnJlcGxhY2UocmVnZXgsICcnKTtcclxuXHJcbiAgICAgICAgbGV0IGFjYyA9IHRoaXMuY2hlY2tBY2ModGhpcy5sb2dpbl9hY2Muc3RyaW5nKTtcclxuICAgICAgICBpZiAoIWFjYykgcmV0dXJuO1xyXG4gICAgICAgIGxldCBwc3cgPSB0aGlzLmNoZWNrUGFzc3dvcmQodGhpcy5sb2dpbl9wc3cuc3RyaW5nKTtcclxuICAgICAgICBpZiAoIXBzdykgcmV0dXJuO1xyXG5cclxuICAgICAgICBnbEdhbWUubG9nb24ucmVxQWNjTG9naW4oeyB1c2VybmFtZTogYWNjLCBwYXNzd29yZDogbWQ1KHBzdykgfSk7ICAgIC8vdXNlcm5hbWU6cGhvbmUsY29kZTrpqozor4HnoIEscGxhdDo1XHJcblxyXG4gICAgICAgIGdsR2FtZS5zdG9yYWdlLnNldEl0ZW0oXCJhY2NOdW1iZXJcIiwgeyBkYXRhOiBhY2MgfSlcclxuICAgIH0sXHJcblxyXG4gICAgZWRpdENoZWNrQWNjKCkge1xyXG4gICAgICAgIGxldCBzdHIgPSB0aGlzLmxvZ2luX2FjYy5zdHJpbmc7XHJcbiAgICAgICAgdGhpcy5jaGVja0FjYyhzdHIpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDotKblj7fmo4Dmn6VcclxuICAgIGNoZWNrQWNjKGFjYykge1xyXG4gICAgICAgIGlmICghYWNjIHx8IGFjYyA9PSAnJykge1xyXG4gICAgICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0Vycm9yVGlwKGdsR2FtZS50aXBzLlJFR0lTVFJBVElPTi5BQ0NOVUxMKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWNjLmxlbmd0aCA8IDQpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uQUNDTEVOR1RIKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBsZXQgcmVnID0gL15cXHd7NCwxNX0kLztcclxuICAgICAgICBsZXQgcmVnID0gL15bQS1aYS16MC05XXs0LDE1fSQvXHJcbiAgICAgICAgbGV0IGFjY19jaGVjayA9IHJlZy50ZXN0KGFjYyk7XHJcbiAgICAgICAgaWYgKCFhY2NfY2hlY2spIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uQUNDVFlQRSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFjYztcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5a+G56CB5qOA5p+lXHJcbiAgICBjaGVja1Bhc3N3b3JkKHBzdywgY29uZmltcHN3KSB7XHJcbiAgICAgICAgaWYgKCFwc3cpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uTE9HUFNXTlVMTCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHN3Lmxlbmd0aCA8IDYpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uUFNXTEVOR1RIKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIS9cXHckLy50ZXN0KHBzdykpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dFcnJvclRpcChnbEdhbWUudGlwcy5SRUdJU1RSQVRJT04uUFNXV1JPTkdGVUwpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbmZpbXBzdyA9PSBudWxsKSByZXR1cm4gcHN3O1xyXG4gICAgICAgIGlmICghY29uZmltcHN3IHx8IHBzdyAhPT0gY29uZmltcHN3KSB7XHJcbiAgICAgICAgICAgIGdsR2FtZS5wYW5lbC5zaG93RXJyb3JUaXAoZ2xHYW1lLnRpcHMuUkVHSVNUUkFUSU9OLlBTV0NPRkFJTCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcHN3O1xyXG4gICAgfSxcclxuXHJcbiAgICBvbkNsaWNrKG5hbWUsIG5vZGUpIHtcclxuICAgICAgICBzd2l0Y2ggKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImJ0bl9hY2NMb2dpblwiOiB0aGlzLmFjY0xvZ2luX2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2dvcmVnaXN0ZXJcIjogdGhpcy5nb1JlZ2lzdGVyX2NiKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2ZvcmdldHBhc1wiOiB0aGlzLnNob3dGaW5kUHN3KCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2V4cGxhaW5cIjogdGhpcy5idG5fcHJvdG9jb2woKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJjaGVja0V4cGxhaW5cIjogdGhpcy5zZWxlY3RFeHBsYWluKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiYnRuX2Nsb3NlXCI6IHRoaXMucmVtb3ZlKCk7IGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v6Lez6L2s56uL5Y2z5rOo5YaMXHJcbiAgICBnb1JlZ2lzdGVyX2NiKCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlKGZhbHNlKTtcclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd1JlZ2lzdHJhdGlvbigpO1xyXG4gICAgfSxcclxuXHJcbiAgICBidG5fcHJvdG9jb2woKSB7XHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dDaGlsZFBhbmVsKHRoaXMucHJvdG9jb2wsIHRoaXMubm9kZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dGaW5kUHN3KCkge1xyXG4gICAgICAgIGlmIChnbEdhbWUudXNlci5nZXQoXCJsb2dpblN3aXRjaFwiKS5zZWxmX2VkaXRfbG9naW5fcHdkID09IDEpIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dDaGlsZFBhbmVsKHRoaXMucmV0cmlldmVwc3csIHRoaXMubm9kZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dTZXJ2aWNlQm94KGdsR2FtZS50aXBzLlVTRVIuUEFTU1dPUkQuU0VSVklDRSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzZWxlY3RFeHBsYWluKCkge1xyXG4gICAgICAgIHRoaXMuaVNhZ3JlZSA9IHRoaXMubm9kZV9hZ3JlZS5pc0NoZWNrZWQ7XHJcbiAgICAgICAgZ2xHYW1lLnN0b3JhZ2Uuc2V0SXRlbShcImlzQWdyZWVcIiwgeyBkYXRhOiB0aGlzLmlTYWdyZWUgfSlcclxuICAgIH0sXHJcblxyXG5cclxuICAgIE9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLnVuUmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgfSxcclxuICAgIC8vIHVwZGF0ZSAoZHQpIHt9LFxyXG59KTtcclxuIl19