
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/modules/games/nfish/script/scene/nfish.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b0477NJrFZHcYRGI2hl5vvQ', 'nfish');
// modules/games/nfish/script/scene/nfish.js

"use strict";

var CONST = require("nfishConst");

var LoadIng = "gameLoadingNode";
/***
 * 捕鱼
 * 主场景
 * **/

glGame.baseclass.extend({
  properties: {
    BGM: {
      //背景声音
      type: cc.AudioClip,
      "default": null
    },
    audioList2: {
      //音效2 新加的
      type: cc.AudioClip,
      "default": []
    },
    BGMList: {
      //背景声音 4：深渊龙王boss 进入， 5：玄武boss 进入
      type: cc.AudioClip,
      "default": []
    },
    fish_Bg: cc.Prefab,
    //捕鱼：背景
    fish_deskContainer: cc.Prefab,
    //捕鱼：桌子
    fish_deskUIContainer: cc.Prefab,
    //捕鱼：UI
    fish_box: cc.Prefab,
    //捕鱼：弹窗
    effect_pic: cc.SpriteFrame,
    //刷新点击资源图片替换
    json_fishResEdit: {
      "default": null,
      displayName: "fish res desc json",
      tooltip: "鱼资源描述，碰撞点，中心点",
      type: cc.JsonAsset
    },
    json_fishTable: {
      "default": null,
      displayName: "fish table",
      tooltip: "鱼表",
      type: cc.JsonAsset
    },
    json_fishLineGroup: {
      "default": null,
      displayName: "fish line group",
      tooltip: "鱼线组",
      type: cc.JsonAsset
    },
    audioList: {
      //音效
      type: cc.AudioClip,
      "default": []
    },
    rollnoticePanel: cc.Prefab,
    LOADING: cc.Prefab
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    console.log("Fish scene !!!!!!");
    glGame.emitter.emit("RootNodeHide"); // glGame.panel.showRoomLoading();
    //init netWork

    this.logic = require("nfishlogic").getInstance(); //初始化数据中心单利
    //************************ 全新的 ******************************

    this.logic.json_fishResEdit = this.json_fishResEdit.json;
    this.logic.json_fishTable = this.json_fishTable.json;
    this.logic.json_fishLineGroup = this.json_fishLineGroup.json; //************************ 全新的 ******************************

    var loading = cc.instantiate(this.LOADING);
    loading.name = LoadIng;
    loading.zIndex = 9999;
    this.node.addChild(loading);
    loading.getComponent("nfish_loading").setloadingTipsSprite();
    this.node.getChildByName(LoadIng).active = true; //!glGame.room.checkGameState();

    glGame.panel.showChildPanel(this.fish_Bg, this.node); //层级关系1：背景管理

    glGame.panel.showChildPanel(this.fish_deskContainer, this.node); //层级关系2：桌面 炮台

    glGame.panel.showChildPanel(this.fish_deskUIContainer, this.node); //层级关系2：桌面 按钮

    this.registerEvent();
    glGame.emitter.emit(MESSAGE.SYSTEM.TOUCH_STATE, this.effect_pic);
    var OffsexFrequency = 0.5;
    var OffsexFrequency2 = 0.55;
    var OffsexX = 150;
    var OffsexY = 68;
    var zIndex = 999;
    var pos = cc.v2(cc.winSize.width * OffsexFrequency, cc.winSize.height - OffsexX);
    var size = cc.size(cc.winSize.width * OffsexFrequency2, OffsexY);
    var speed = 3,
        bActive = false,
        bBottome = true;
    var panel = glGame.panel.showPanel(this.rollnoticePanel);
    panel.name = "fish_rollnotice";
    var rollnotice = panel.getComponent("rollnotice");
    rollnotice.setPosition(pos);
    rollnotice.setContentSize(size);
    rollnotice.setSpeed(speed);
    rollnotice.setActive(bActive);
    rollnotice.setBottom(bBottome);
    rollnotice.zIndex = zIndex;
  },
  //注册监听
  registerEvent: function registerEvent() {
    glGame.emitter.on(CONST.clientEvent.closeLoading, this.clseLoadingViewHandler, this); //关闭loading

    glGame.emitter.on(CONST.clientEvent.fishSound, this.playSoundHandler, this);
    glGame.emitter.on(CONST.clientEvent.fishBgSound, this.playBgSoundHandler, this);
    glGame.emitter.on(MESSAGE.UI.GAME_SON_MSGBOX, this.sonGameMsgbox, this);
  },
  //反注册监听
  unregisterEvent: function unregisterEvent() {
    glGame.emitter.off(CONST.clientEvent.fishSound, this);
    glGame.emitter.off(CONST.clientEvent.fishBgSound, this);
    glGame.emitter.off(MESSAGE.UI.GAME_SON_MSGBOX, this);
    glGame.emitter.off(CONST.clientEvent.closeLoading, this);
  },
  //关闭loading
  clseLoadingViewHandler: function clseLoadingViewHandler() {
    if (this.node.getChildByName(LoadIng)) this.node.getChildByName(LoadIng).active = false;
  },
  //子界面弹窗
  sonGameMsgbox: function sonGameMsgbox(data) {
    var panel = glGame.panel.showPanel(this.fish_box);
    panel.getComponent(panel.name).showMsg(data.content, data.single, data.next, data.cancel, data.center);
  },
  //开始播放
  playSoundHandler: function playSoundHandler(res) {
    if (res == "button") {
      return;
    }

    var BGMSE = glGame.audio.get("BGMSE");
    if (!BGMSE["SoundEffectPlayState"]) return;

    if (CONST.fishSounds[res] != null) {
      cc.audioEngine.play(this.audioList[CONST.fishSounds[res]], false, BGMSE["SoundEffectVolume"]);
    }

    if (CONST.fishSounds2[res] != null) {
      cc.audioEngine.play(this.audioList2[CONST.fishSounds2[res]], false, BGMSE["SoundEffectVolume"]);
    }
  },
  //开始播放背景声音
  playBgSoundHandler: function playBgSoundHandler() {
    var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;

    if (index == -1) {
      if (this.logic.bgIndex != -1) {
        if (this.logic.playBossBGM == 2) {
          if (this.logic.currPlayBgMusic != -1 && this.logic.currPlayBgMusic == this.logic.bgIndex) {
            //防止重复播放背景音乐
            return;
          }
        } else {
          if (this.logic.currPlayBgMusic == this.logic.bgIndex) {
            return;
          }
        }

        this.logic.currPlayBgMusic = this.logic.bgIndex;
        glGame.audio.playBGM(this.BGMList[this.logic.bgIndex]);
      }

      return;
    }

    var BgMusicMax = 4;

    if (index < BgMusicMax) {
      this.logic.bgIndex = index;
      this.logic.playBossBGM = 1;
    } else {
      this.logic.playBossBGM = 2;
    }

    if (this.logic.currPlayBgMusic != -1 && this.logic.currPlayBgMusic == index) {
      //防止重复播放背景音乐
      return;
    }

    this.logic.currPlayBgMusic = index;
    glGame.audio.playBGM(this.BGMList[index]);
  },
  OnDestroy: function OnDestroy() {
    this.unregisterEvent();
    this.logic = null;
    glGame.emitter.emit(MESSAGE.SYSTEM.TOUCH_STATE);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcbW9kdWxlc1xcZ2FtZXNcXG5maXNoXFxzY3JpcHRcXHNjZW5lXFxuZmlzaC5qcyJdLCJuYW1lcyI6WyJDT05TVCIsInJlcXVpcmUiLCJMb2FkSW5nIiwiZ2xHYW1lIiwiYmFzZWNsYXNzIiwiZXh0ZW5kIiwicHJvcGVydGllcyIsIkJHTSIsInR5cGUiLCJjYyIsIkF1ZGlvQ2xpcCIsImF1ZGlvTGlzdDIiLCJCR01MaXN0IiwiZmlzaF9CZyIsIlByZWZhYiIsImZpc2hfZGVza0NvbnRhaW5lciIsImZpc2hfZGVza1VJQ29udGFpbmVyIiwiZmlzaF9ib3giLCJlZmZlY3RfcGljIiwiU3ByaXRlRnJhbWUiLCJqc29uX2Zpc2hSZXNFZGl0IiwiZGlzcGxheU5hbWUiLCJ0b29sdGlwIiwiSnNvbkFzc2V0IiwianNvbl9maXNoVGFibGUiLCJqc29uX2Zpc2hMaW5lR3JvdXAiLCJhdWRpb0xpc3QiLCJyb2xsbm90aWNlUGFuZWwiLCJMT0FESU5HIiwib25Mb2FkIiwiY29uc29sZSIsImxvZyIsImVtaXR0ZXIiLCJlbWl0IiwibG9naWMiLCJnZXRJbnN0YW5jZSIsImpzb24iLCJsb2FkaW5nIiwiaW5zdGFudGlhdGUiLCJuYW1lIiwiekluZGV4Iiwibm9kZSIsImFkZENoaWxkIiwiZ2V0Q29tcG9uZW50Iiwic2V0bG9hZGluZ1RpcHNTcHJpdGUiLCJnZXRDaGlsZEJ5TmFtZSIsImFjdGl2ZSIsInBhbmVsIiwic2hvd0NoaWxkUGFuZWwiLCJyZWdpc3RlckV2ZW50IiwiTUVTU0FHRSIsIlNZU1RFTSIsIlRPVUNIX1NUQVRFIiwiT2Zmc2V4RnJlcXVlbmN5IiwiT2Zmc2V4RnJlcXVlbmN5MiIsIk9mZnNleFgiLCJPZmZzZXhZIiwicG9zIiwidjIiLCJ3aW5TaXplIiwid2lkdGgiLCJoZWlnaHQiLCJzaXplIiwic3BlZWQiLCJiQWN0aXZlIiwiYkJvdHRvbWUiLCJzaG93UGFuZWwiLCJyb2xsbm90aWNlIiwic2V0UG9zaXRpb24iLCJzZXRDb250ZW50U2l6ZSIsInNldFNwZWVkIiwic2V0QWN0aXZlIiwic2V0Qm90dG9tIiwib24iLCJjbGllbnRFdmVudCIsImNsb3NlTG9hZGluZyIsImNsc2VMb2FkaW5nVmlld0hhbmRsZXIiLCJmaXNoU291bmQiLCJwbGF5U291bmRIYW5kbGVyIiwiZmlzaEJnU291bmQiLCJwbGF5QmdTb3VuZEhhbmRsZXIiLCJVSSIsIkdBTUVfU09OX01TR0JPWCIsInNvbkdhbWVNc2dib3giLCJ1bnJlZ2lzdGVyRXZlbnQiLCJvZmYiLCJkYXRhIiwic2hvd01zZyIsImNvbnRlbnQiLCJzaW5nbGUiLCJuZXh0IiwiY2FuY2VsIiwiY2VudGVyIiwicmVzIiwiQkdNU0UiLCJhdWRpbyIsImdldCIsImZpc2hTb3VuZHMiLCJhdWRpb0VuZ2luZSIsInBsYXkiLCJmaXNoU291bmRzMiIsImluZGV4IiwiYmdJbmRleCIsInBsYXlCb3NzQkdNIiwiY3VyclBsYXlCZ011c2ljIiwicGxheUJHTSIsIkJnTXVzaWNNYXgiLCJPbkRlc3Ryb3kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsWUFBRCxDQUFuQjs7QUFDQSxJQUFNQyxPQUFPLEdBQUcsaUJBQWhCO0FBQ0E7Ozs7O0FBSUFDLE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0I7QUFDcEJDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxHQUFHLEVBQUU7QUFBK0I7QUFDaENDLE1BQUFBLElBQUksRUFBRUMsRUFBRSxDQUFDQyxTQURSO0FBRUQsaUJBQVM7QUFGUixLQURHO0FBS1JDLElBQUFBLFVBQVUsRUFBRTtBQUF5QjtBQUNqQ0gsTUFBQUEsSUFBSSxFQUFFQyxFQUFFLENBQUNDLFNBREQ7QUFFUixpQkFBUztBQUZELEtBTEo7QUFTUkUsSUFBQUEsT0FBTyxFQUFFO0FBQStCO0FBQ3BDSixNQUFBQSxJQUFJLEVBQUVDLEVBQUUsQ0FBQ0MsU0FESjtBQUVMLGlCQUFTO0FBRkosS0FURDtBQWFSRyxJQUFB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LEtBQUt0RSxLQUFMLENBQVdvRSxPQUF4QztBQUNBbkcsUUFBQUEsTUFBTSxDQUFDNEYsS0FBUCxDQUFhVSxPQUFiLENBQXFCLEtBQUs3RixPQUFMLENBQWEsS0FBS3NCLEtBQUwsQ0FBV29FLE9BQXhCLENBQXJCO0FBQ0g7O0FBQ0Q7QUFDSDs7QUFDRCxRQUFNSSxVQUFVLEdBQUcsQ0FBbkI7O0FBQ0EsUUFBSUwsS0FBSyxHQUFHSyxVQUFaLEVBQXdCO0FBQ3BCLFdBQUt4RSxLQUFMLENBQVdvRSxPQUFYLEdBQXFCRCxLQUFyQjtBQUNBLFdBQUtuRSxLQUFMLENBQVdxRSxXQUFYLEdBQXlCLENBQXpCO0FBQ0gsS0FIRCxNQUdPO0FBQ0gsV0FBS3JFLEtBQUwsQ0FBV3FFLFdBQVgsR0FBeUIsQ0FBekI7QUFDSDs7QUFDRCxRQUFJLEtBQUtyRSxLQUFMLENBQVdzRSxlQUFYLElBQThCLENBQUMsQ0FBL0IsSUFBb0MsS0FBS3RFLEtBQUwsQ0FBV3NFLGVBQVgsSUFBOEJILEtBQXRFLEVBQTZFO0FBQUM7QUFDMUU7QUFDSDs7QUFDRCxTQUFLbkUsS0FBTCxDQUFXc0UsZUFBWCxHQUE2QkgsS0FBN0I7QUFDQWxHLElBQUFBLE1BQU0sQ0FBQzRGLEtBQVAsQ0FBYVUsT0FBYixDQUFxQixLQUFLN0YsT0FBTCxDQUFheUYsS0FBYixDQUFyQjtBQUNILEdBOUptQjtBQStKcEJNLEVBQUFBLFNBL0pvQix1QkErSlI7QUFDUixTQUFLdkIsZUFBTDtBQUNBLFNBQUtsRCxLQUFMLEdBQWEsSUFBYjtBQUNBL0IsSUFBQUEsTUFBTSxDQUFDNkIsT0FBUCxDQUFlQyxJQUFmLENBQW9CaUIsT0FBTyxDQUFDQyxNQUFSLENBQWVDLFdBQW5DO0FBQ0g7QUFuS21CLENBQXhCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgQ09OU1QgPSByZXF1aXJlKFwibmZpc2hDb25zdFwiKTtcclxuY29uc3QgTG9hZEluZyA9IFwiZ2FtZUxvYWRpbmdOb2RlXCI7XHJcbi8qKipcclxuICog5o2V6bG8XHJcbiAqIOS4u+WcuuaZr1xyXG4gKiAqKi9cclxuZ2xHYW1lLmJhc2VjbGFzcy5leHRlbmQoe1xyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIEJHTTogeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6IOM5pmv5aOw6Z+zXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcCxcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGF1ZGlvTGlzdDI6IHsgICAgICAgICAgICAgICAgICAgICAgICAvL+mfs+aViDIg5paw5Yqg55qEXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcCxcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgfSxcclxuICAgICAgICBCR01MaXN0OiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/og4zmma/lo7Dpn7MgNO+8mua3sea4ium+meeOi2Jvc3Mg6L+b5YWl77yMIDXvvJrnjoTmraZib3NzIOi/m+WFpVxyXG4gICAgICAgICAgICB0eXBlOiBjYy5BdWRpb0NsaXAsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZmlzaF9CZzogY2MuUHJlZmFiLCAgICAgICAgICAgICAgLy/mjZXpsbzvvJrog4zmma9cclxuICAgICAgICBmaXNoX2Rlc2tDb250YWluZXI6IGNjLlByZWZhYiwgICAvL+aNlemxvO+8muahjOWtkFxyXG4gICAgICAgIGZpc2hfZGVza1VJQ29udGFpbmVyOiBjYy5QcmVmYWIsIC8v5o2V6bG877yaVUlcclxuICAgICAgICBmaXNoX2JveDogY2MuUHJlZmFiLCAgICAgICAgICAgICAvL+aNlemxvO+8muW8ueeql1xyXG4gICAgICAgIGVmZmVjdF9waWM6IGNjLlNwcml0ZUZyYW1lLCAgICAgIC8v5Yi35paw54K55Ye76LWE5rqQ5Zu+54mH5pu/5o2iXHJcbiAgICAgICAganNvbl9maXNoUmVzRWRpdDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogXCJmaXNoIHJlcyBkZXNjIGpzb25cIixcclxuICAgICAgICAgICAgdG9vbHRpcDogXCLpsbzotYTmupDmj4/ov7DvvIznorDmkp7ngrnvvIzkuK3lv4PngrlcIixcclxuICAgICAgICAgICAgdHlwZTogY2MuSnNvbkFzc2V0LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAganNvbl9maXNoVGFibGU6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IFwiZmlzaCB0YWJsZVwiLFxyXG4gICAgICAgICAgICB0b29sdGlwOiBcIumxvOihqFwiLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5Kc29uQXNzZXQsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBqc29uX2Zpc2hMaW5lR3JvdXA6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IFwiZmlzaCBsaW5lIGdyb3VwXCIsXHJcbiAgICAgICAgICAgIHRvb2x0aXA6IFwi6bG857q/57uEXCIsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkpzb25Bc3NldCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGF1ZGlvTGlzdDogeyAgICAgICAgICAgICAgICAgICAgICAgIC8v6Z+z5pWIXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkF1ZGlvQ2xpcCxcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgfSxcclxuICAgICAgICByb2xsbm90aWNlUGFuZWw6IGNjLlByZWZhYixcclxuXHJcbiAgICAgICAgTE9BRElORzogY2MuUHJlZmFiLFxyXG4gICAgfSxcclxuICAgIC8vIExJRkUtQ1lDTEUgQ0FMTEJBQ0tTOlxyXG4gICAgb25Mb2FkKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmlzaCBzY2VuZSAhISEhISFcIik7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIuZW1pdChcIlJvb3ROb2RlSGlkZVwiKTtcclxuICAgICAgICAvLyBnbEdhbWUucGFuZWwuc2hvd1Jvb21Mb2FkaW5nKCk7XHJcbiAgICAgICAgLy9pbml0IG5ldFdvcmtcclxuICAgICAgICB0aGlzLmxvZ2ljID0gcmVxdWlyZShcIm5maXNobG9naWNcIikuZ2V0SW5zdGFuY2UoKTsgICAgICAgICAgICAgIC8v5Yid5aeL5YyW5pWw5o2u5Lit5b+D5Y2V5YipXHJcbiAgICAgICAgLy8qKioqKioqKioqKioqKioqKioqKioqKiog5YWo5paw55qEICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG4gICAgICAgIHRoaXMubG9naWMuanNvbl9maXNoUmVzRWRpdCA9IHRoaXMuanNvbl9maXNoUmVzRWRpdC5qc29uO1xyXG4gICAgICAgIHRoaXMubG9naWMuanNvbl9maXNoVGFibGUgPSB0aGlzLmpzb25fZmlzaFRhYmxlLmpzb247XHJcbiAgICAgICAgdGhpcy5sb2dpYy5qc29uX2Zpc2hMaW5lR3JvdXAgPSB0aGlzLmpzb25fZmlzaExpbmVHcm91cC5qc29uO1xyXG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqIOWFqOaWsOeahCAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAgICAgICBsZXQgbG9hZGluZyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuTE9BRElORyk7XHJcbiAgICAgICAgbG9hZGluZy5uYW1lID0gTG9hZEluZztcclxuICAgICAgICBsb2FkaW5nLnpJbmRleCA9IDk5OTk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKGxvYWRpbmcpO1xyXG4gICAgICAgIGxvYWRpbmcuZ2V0Q29tcG9uZW50KFwibmZpc2hfbG9hZGluZ1wiKS5zZXRsb2FkaW5nVGlwc1Nwcml0ZSgpO1xyXG4gICAgICAgIHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShMb2FkSW5nKS5hY3RpdmUgPSB0cnVlOyAvLyFnbEdhbWUucm9vbS5jaGVja0dhbWVTdGF0ZSgpO1xyXG5cclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0NoaWxkUGFuZWwodGhpcy5maXNoX0JnLCB0aGlzLm5vZGUpOyAgICAgICAgICAgICAgICAgICAvL+Wxgue6p+WFs+ezuzHvvJrog4zmma/nrqHnkIZcclxuICAgICAgICBnbEdhbWUucGFuZWwuc2hvd0NoaWxkUGFuZWwodGhpcy5maXNoX2Rlc2tDb250YWluZXIsIHRoaXMubm9kZSk7ICAgICAgICAvL+Wxgue6p+WFs+ezuzLvvJrmoYzpnaIg54Ku5Y+wXHJcbiAgICAgICAgZ2xHYW1lLnBhbmVsLnNob3dDaGlsZFBhbmVsKHRoaXMuZmlzaF9kZXNrVUlDb250YWluZXIsIHRoaXMubm9kZSk7ICAgICAgLy/lsYLnuqflhbPns7sy77ya5qGM6Z2iIOaMiemSrlxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCgpO1xyXG5cclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5lbWl0KE1FU1NBR0UuU1lTVEVNLlRPVUNIX1NUQVRFLCB0aGlzLmVmZmVjdF9waWMpO1xyXG4gICAgICAgIGNvbnN0IE9mZnNleEZyZXF1ZW5jeSA9IDAuNTtcclxuICAgICAgICBjb25zdCBPZmZzZXhGcmVxdWVuY3kyID0gMC41NTtcclxuICAgICAgICBjb25zdCBPZmZzZXhYID0gMTUwO1xyXG4gICAgICAgIGNvbnN0IE9mZnNleFkgPSA2ODtcclxuICAgICAgICBjb25zdCB6SW5kZXggPSA5OTk7XHJcbiAgICAgICAgY29uc3QgcG9zID0gY2MudjIoY2Mud2luU2l6ZS53aWR0aCAqIE9mZnNleEZyZXF1ZW5jeSwgY2Mud2luU2l6ZS5oZWlnaHQgLSBPZmZzZXhYKTtcclxuICAgICAgICBjb25zdCBzaXplID0gY2Muc2l6ZShjYy53aW5TaXplLndpZHRoICogT2Zmc2V4RnJlcXVlbmN5MiwgT2Zmc2V4WSk7XHJcbiAgICAgICAgbGV0IHNwZWVkID0gMywgYkFjdGl2ZSA9IGZhbHNlLCBiQm90dG9tZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IHBhbmVsID0gZ2xHYW1lLnBhbmVsLnNob3dQYW5lbCh0aGlzLnJvbGxub3RpY2VQYW5lbCk7XHJcbiAgICAgICAgcGFuZWwubmFtZSA9IFwiZmlzaF9yb2xsbm90aWNlXCI7XHJcbiAgICAgICAgbGV0IHJvbGxub3RpY2UgPSBwYW5lbC5nZXRDb21wb25lbnQoXCJyb2xsbm90aWNlXCIpO1xyXG4gICAgICAgIHJvbGxub3RpY2Uuc2V0UG9zaXRpb24ocG9zKTtcclxuICAgICAgICByb2xsbm90aWNlLnNldENvbnRlbnRTaXplKHNpemUpO1xyXG4gICAgICAgIHJvbGxub3RpY2Uuc2V0U3BlZWQoc3BlZWQpO1xyXG4gICAgICAgIHJvbGxub3RpY2Uuc2V0QWN0aXZlKGJBY3RpdmUpO1xyXG4gICAgICAgIHJvbGxub3RpY2Uuc2V0Qm90dG9tKGJCb3R0b21lKTtcclxuICAgICAgICByb2xsbm90aWNlLnpJbmRleCA9IHpJbmRleDtcclxuXHJcbiAgICB9LFxyXG4gICAgLy/ms6jlhoznm5HlkKxcclxuICAgIHJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub24oQ09OU1QuY2xpZW50RXZlbnQuY2xvc2VMb2FkaW5nLCB0aGlzLmNsc2VMb2FkaW5nVmlld0hhbmRsZXIsIHRoaXMpOyAgICAgICAgIC8v5YWz6ZetbG9hZGluZ1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKENPTlNULmNsaWVudEV2ZW50LmZpc2hTb3VuZCwgdGhpcy5wbGF5U291bmRIYW5kbGVyLCB0aGlzKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vbihDT05TVC5jbGllbnRFdmVudC5maXNoQmdTb3VuZCwgdGhpcy5wbGF5QmdTb3VuZEhhbmRsZXIsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9uKE1FU1NBR0UuVUkuR0FNRV9TT05fTVNHQk9YLCB0aGlzLnNvbkdhbWVNc2dib3gsIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIC8v5Y+N5rOo5YaM55uR5ZCsXHJcbiAgICB1bnJlZ2lzdGVyRXZlbnQoKSB7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKENPTlNULmNsaWVudEV2ZW50LmZpc2hTb3VuZCwgdGhpcyk7XHJcbiAgICAgICAgZ2xHYW1lLmVtaXR0ZXIub2ZmKENPTlNULmNsaWVudEV2ZW50LmZpc2hCZ1NvdW5kLCB0aGlzKTtcclxuICAgICAgICBnbEdhbWUuZW1pdHRlci5vZmYoTUVTU0FHRS5VSS5HQU1FX1NPTl9NU0dCT1gsIHRoaXMpO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLm9mZihDT05TVC5jbGllbnRFdmVudC5jbG9zZUxvYWRpbmcsIHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+WFs+mXrWxvYWRpbmdcclxuICAgIGNsc2VMb2FkaW5nVmlld0hhbmRsZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShMb2FkSW5nKSkgdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKExvYWRJbmcpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8v5a2Q55WM6Z2i5by556qXXHJcbiAgICBzb25HYW1lTXNnYm94KGRhdGEpIHtcclxuICAgICAgICBsZXQgcGFuZWwgPSBnbEdhbWUucGFuZWwuc2hvd1BhbmVsKHRoaXMuZmlzaF9ib3gpO1xyXG4gICAgICAgIHBhbmVsLmdldENvbXBvbmVudChwYW5lbC5uYW1lKS5zaG93TXNnKGRhdGEuY29udGVudCwgZGF0YS5zaW5nbGUsIGRhdGEubmV4dCwgZGF0YS5jYW5jZWwsIGRhdGEuY2VudGVyKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/lvIDlp4vmkq3mlL5cclxuICAgIHBsYXlTb3VuZEhhbmRsZXIocmVzKSB7XHJcbiAgICAgICAgaWYocmVzID09IFwiYnV0dG9uXCIpe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBCR01TRSA9IGdsR2FtZS5hdWRpby5nZXQoXCJCR01TRVwiKTtcclxuICAgICAgICBpZiAoIUJHTVNFW1wiU291bmRFZmZlY3RQbGF5U3RhdGVcIl0pIHJldHVybjtcclxuICAgICAgICBpZiAoQ09OU1QuZmlzaFNvdW5kc1tyZXNdICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLmF1ZGlvTGlzdFtDT05TVC5maXNoU291bmRzW3Jlc11dLCBmYWxzZSwgQkdNU0VbXCJTb3VuZEVmZmVjdFZvbHVtZVwiXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChDT05TVC5maXNoU291bmRzMltyZXNdICE9IG51bGwpIHtcclxuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheSh0aGlzLmF1ZGlvTGlzdDJbQ09OU1QuZmlzaFNvdW5kczJbcmVzXV0sIGZhbHNlLCBCR01TRVtcIlNvdW5kRWZmZWN0Vm9sdW1lXCJdKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/lvIDlp4vmkq3mlL7og4zmma/lo7Dpn7NcclxuICAgIHBsYXlCZ1NvdW5kSGFuZGxlcihpbmRleCA9IC0xKSB7XHJcbiAgICAgICAgaWYgKGluZGV4ID09IC0xKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxvZ2ljLmJnSW5kZXggIT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvZ2ljLnBsYXlCb3NzQkdNID09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sb2dpYy5jdXJyUGxheUJnTXVzaWMgIT0gLTEgJiYgdGhpcy5sb2dpYy5jdXJyUGxheUJnTXVzaWMgPT0gdGhpcy5sb2dpYy5iZ0luZGV4KSB7Ly/pmLLmraLph43lpI3mkq3mlL7og4zmma/pn7PkuZBcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubG9naWMuY3VyclBsYXlCZ011c2ljID09IHRoaXMubG9naWMuYmdJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dpYy5jdXJyUGxheUJnTXVzaWMgPSB0aGlzLmxvZ2ljLmJnSW5kZXg7XHJcbiAgICAgICAgICAgICAgICBnbEdhbWUuYXVkaW8ucGxheUJHTSh0aGlzLkJHTUxpc3RbdGhpcy5sb2dpYy5iZ0luZGV4XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBCZ011c2ljTWF4ID0gNDtcclxuICAgICAgICBpZiAoaW5kZXggPCBCZ011c2ljTWF4KSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9naWMuYmdJbmRleCA9IGluZGV4O1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2ljLnBsYXlCb3NzQkdNID0gMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2ljLnBsYXlCb3NzQkdNID0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMubG9naWMuY3VyclBsYXlCZ011c2ljICE9IC0xICYmIHRoaXMubG9naWMuY3VyclBsYXlCZ011c2ljID09IGluZGV4KSB7Ly/pmLLmraLph43lpI3mkq3mlL7og4zmma/pn7PkuZBcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxvZ2ljLmN1cnJQbGF5QmdNdXNpYyA9IGluZGV4O1xyXG4gICAgICAgIGdsR2FtZS5hdWRpby5wbGF5QkdNKHRoaXMuQkdNTGlzdFtpbmRleF0pO1xyXG4gICAgfSxcclxuICAgIE9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLnVucmVnaXN0ZXJFdmVudCgpO1xyXG4gICAgICAgIHRoaXMubG9naWMgPSBudWxsO1xyXG4gICAgICAgIGdsR2FtZS5lbWl0dGVyLmVtaXQoTUVTU0FHRS5TWVNURU0uVE9VQ0hfU1RBVEUpO1xyXG4gICAgfVxyXG59KTtcclxuIl19