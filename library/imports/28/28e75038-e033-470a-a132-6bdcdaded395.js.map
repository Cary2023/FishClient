{"version":3,"sources":["assets\\modules\\games\\nfish\\script\\prefab\\nfish_Unit.js"],"names":["CONST","require","glGame","movieClip","extend","onLoad","initFishMovieClip","logic","getInstance","whirlpool","fishData","_bUpdate","moveList","posArray","isHit","hitTime","isPlayStartMc","addSpeed","showBubblesTime","closeBubblesTime","isQuickDie","isPlayerSound","isShowTip","cantainerName","initFish","hideTip","JSON","parse","stringify","showTime","localFishData","json_fishTable","fishTypeId","resGroupId","fishResData","json_fishResEdit","runTime","_time","Date","now","node","x","y","fishLocalData","zIndex","resHierarchy","frequency","undefined","runSpeed","frameRate","Runfrequency","liveTime","serverTime","createTime","_allTime","Number","newLiveTime","Math","abs","_startTime","death","dieType0","startMove","setBoxColliderSizeOffsetAndAnchor","getComponent","cc","Sprite","enabled","startFishRuning","NotSay","ChatVoiceType2","FishRunTime","chatVoiceType","P20","P40","getRandomNum","getIsRotation","oldScaleY","scaleY","move","dt","l_time","timeIndex","getIndexByTime","t","currTime","nextTime","lastIndex","getTimeByIndex","fz","fm","FIRST","SCENT","Bz_OnePos","Bz_TowPos","Bz_ThreePos","i","a","b","c","pow","gameZoomX","gameZoomY","newAngle","setAngle","position","fixedResource","angle","settingIcing","isInFreeze","quickDie","islow","collider","BoxCollider","stopAllActions","OneTime","runAction","sequence","delayTime","fadeTo","callFunc","dispose","isWellDie","lockSelf","nameID","name","lockFishID","emitter","emit","clientEvent","playLockSpine","isAuto","useAutoSkill","getFishID","id","update","playFishMovieClip","color","HitColor","Normal","startTalk","getClickArea","width","height","lastLockFishID","lockFishIndex","isLockAutoChange","existTime","HALF","OFFSEX","Not","time","length","index","addComponent","anchorX","anchorY","offset","v2","offsetX","offsetY","size","sizeW","sizeH","tag","hit","HitLongTime","Attack","x2","y2","point","x1","y1","atan2","PI","setscale","isAttack","playSoundTime","GAPTIME","lastPlayTime","chatBubble","ChatVoiceType1","ChatVoiceType3","ChatVoiceType4","ChatVoiceType5","ChatVoiceType6","BasePercentageFactor","IsShow","random","P1_20","P4_20","P5_20","showTip","FishVoice","fishSound","voiceFile","text","indexOf","str","split","followFishTip","TipTime","spriteFrame","getOriginalSize","direction","GoBack","oneX","scaleX","setTipText","bgAngle","desc","cantainer","getChildByName","lab","active","Label","string","dieType","seatNum","delayDieTime","clearFollowFishTip","fishId","scheduleOnce","deathNext","isStart","lockBulletList","len","deathFish","shock","onSshock","dieType1","Deat","TIME","EndAngle","SX","act","spawn","scaleTo","rotateTo","dieType3","oldAngle","repeat","dieType4","rotateBy","moveTo","clearTideCorrect","fishID","destroy","parent","removeChild","disposeFishNode","ind","bossIDList","splice","off","Node","EventType","TOUCH_START","fishPool","put","delayDestroy","MaxTime","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["/***\r\n *  捕鱼：鱼，初始化 播放图片、移动（同步状态）\r\n * **/\r\nlet CONST = require(\"nfishConst\");\r\nglGame.movieClip.extend({\r\n    onLoad () {\r\n        this.initFishMovieClip();//调用基类的初始化动画方法\r\n        this.logic = require(\"nfishlogic\").getInstance();//数据中心\r\n        this.whirlpool= null;\r\n        this.fishData = null;\r\n        this._bUpdate = false;\r\n        this.moveList = null;\r\n        this.posArray = null;\r\n        this.isHit    = false;\r\n        this.hitTime  = 0;\r\n        this.isPlayStartMc = false;\r\n        this.addSpeed = 0;\r\n        this.showBubblesTime = 1;\r\n        this.closeBubblesTime = -1;\r\n        this.isQuickDie = false;\r\n        this.isPlayerSound = false;\r\n        this.isShowTip  = false;\r\n        this.cantainerName = null;\r\n    },\r\n    //初始化鱼\r\n    initFish(fishData){\r\n        // this.node.getChildByName(\"bg\").active = false;\r\n        this.hideTip();\r\n        this.fishData     = JSON.parse(JSON.stringify(fishData));\r\n        this.moveList     = this.fishData.moveList;\r\n        this.posArray     = this.fishData.posArray;\r\n        this.showTime     = this.fishData.showTime;     //配置表默认 等待 时间\r\n        this.localFishData= this.logic.json_fishTable[this.fishData.fishTypeId+\"\"];\r\n        this.resGroupId   = this.localFishData.resGroupId;\r\n        this.fishResData  = this.logic.json_fishResEdit[\"fish\"+this.resGroupId];\r\n        this.runTime      = this.fishData.runTime;      //总时间\r\n        this._time        = Date.now();\r\n        this.node.x       = this.posArray[0].x;\r\n        this.node.y       = this.posArray[0].y;\r\n        let fishLocalData = this.logic.json_fishTable[this.fishData.fishTypeId+\"\"];\r\n\r\n        this.node.zIndex  = fishLocalData.resHierarchy;\r\n\r\n        if(this.fishData.frequency != undefined){\r\n            this.runSpeed = this.localFishData.frameRate * this.fishData.frequency * CONST.Runfrequency;\r\n        }\r\n\r\n        let liveTime = (fishData.serverTime - fishData.createTime)/1000; //出生时间\r\n        this._allTime = Number(this.runTime+this.showTime+\"\");     //最大寿命时间\r\n        let newLiveTime = Math.abs(liveTime);                            //矫正 已经出生时间\r\n        if(liveTime < 0){//没出生\r\n            this.showTime += newLiveTime;\r\n            this._startTime = 0;\r\n        }else{\r\n            let newLiveTime = Math.abs(liveTime);                        //矫正 已经出生时间\r\n            if(newLiveTime >= this._allTime){\r\n                this.death(CONST.dieType0);\r\n                return;\r\n            }\r\n\r\n            if(newLiveTime > this.showTime){\r\n                this._startTime = newLiveTime - this.showTime\r\n            }else{\r\n                this.showTime -= newLiveTime;\r\n                this._startTime = 0;\r\n            }\r\n        }\r\n        if(this._startTime > 0){\r\n            this.startMove();//直接开始移动\r\n        }else{\r\n            this._bUpdate     = true;\r\n        }\r\n    },\r\n    startMove(){\r\n        this.setBoxColliderSizeOffsetAndAnchor();\r\n        this.node.getComponent(cc.Sprite).enabled = true;\r\n        this._time = Date.now();\r\n        this.startFishRuning();\r\n        this.isPlayStartMc  = true;\r\n        this.showTime = -1;\r\n        this._bUpdate  = true;\r\n        const NotSay = 0;\r\n        const ChatVoiceType2 = 2;\r\n        const FishRunTime = this.runTime;\r\n\r\n        if(Number(this.localFishData.chatVoiceType) != NotSay || Number(this.localFishData.chatVoiceType) != ChatVoiceType2){\r\n            const P20 = FishRunTime * 0.2;\r\n            const P40 = FishRunTime * 0.35;\r\n            //计算运行时间 根据规则需要运行到 20-40% 的区间才可以播放\r\n            this.showBubblesTime = -Math.abs(this.logic.getRandomNum(P20,P40));\r\n        }\r\n        if(this.logic.getIsRotation()){\r\n            this.node.oldScaleY = -this.node.scaleY;\r\n            this.node.scaleY = this.node.oldScaleY;\r\n        }\r\n    },\r\n    move(dt){\r\n        //是否可以开始计时\r\n        if (this.moveList && this.showTime > -1){\r\n            this.showTime -= dt;\r\n            if(this.showTime<=0){\r\n                this.startMove();//开始移动\r\n            }\r\n        }\r\n        //移动\r\n        if (this._bUpdate && this.moveList && this.showTime <= 0) {\r\n            let l_time = Date.now()\r\n            this._startTime = (this._startTime + (l_time - this._time) / 1000) + (this._startTime * this.addSpeed);\r\n            this._time = l_time\r\n            //二阶贝塞尔曲线运动\r\n            this.timeIndex = this.getIndexByTime(this._startTime);\r\n            if (this.timeIndex == -1) {//到尽头了，销毁\r\n                this.death(CONST.dieType0);\r\n                return\r\n            }\r\n            let t;\r\n            let currTime;\r\n            let nextTime;\r\n            if(this.lastIndex == null || this.timeIndex != this.lastIndex){\r\n                currTime = this.getTimeByIndex(this.timeIndex);\r\n                nextTime = this.getTimeByIndex(this.timeIndex + 1);\r\n                this.currTime = currTime;\r\n                this.nextTime = nextTime;\r\n            }else\r\n            {\r\n                currTime = this.currTime;\r\n                nextTime = this.nextTime;\r\n            }\r\n            let fz = this._startTime - currTime;\r\n            let fm = nextTime - currTime;\r\n            t  = fz/fm;\r\n            const FIRST = 2;\r\n            const SCENT = 3;\r\n            const Bz_OnePos = 0;\r\n            const Bz_TowPos = 1;\r\n            const Bz_ThreePos = 2;\r\n            let i = this.timeIndex > 0 ?  SCENT * this.timeIndex : FIRST * this.timeIndex;\r\n            let a = this.posArray[i + Bz_OnePos];\r\n            let b = this.posArray[i + Bz_TowPos];\r\n            let c = this.posArray[i + Bz_ThreePos];\r\n            if(!a){//拿不到数据，到尽头了，销毁\r\n                this.death(CONST.dieType0);\r\n                return\r\n            }\r\n            //轨迹运动\r\n            let x = (Math.pow(1 - t, 2) * a.x + 2 * t * (1 - t) * b.x + Math.pow(t, 2) * c.x) * this.logic.gameZoomX;\r\n            let y = (Math.pow(1 - t, 2) * a.y + 2 * t * (1 - t) * b.y + Math.pow(t, 2) * c.y) * this.logic.gameZoomY;\r\n            //设置朝向\r\n            let newAngle = this.setAngle(x,y,this.node.position);\r\n            if(this.localFishData.fixedResource != 1){\r\n                this.node.angle = newAngle;\r\n            }\r\n            this.node.x = x;\r\n            this.node.y = y;\r\n            this.lastIndex = this.timeIndex;\r\n        }\r\n    },\r\n    //冰冻/解冻\r\n    settingIcing(isInFreeze){\r\n        if(isInFreeze){\r\n            this._time = Date.now();\r\n        }\r\n        this._bUpdate = isInFreeze;\r\n    },\r\n    //快速移动\r\n    quickDie(islow = true){\r\n        if(this._bUpdate){\r\n            this.isQuickDie = true;\r\n            this.runSpeed = islow ? 0.0003 : 0.0004; //加快帧播放 原来 0.0166\r\n            this.addSpeed = islow ? 0.02 : 0.003;\r\n            let collider = this.node.getComponent(cc.BoxCollider);\r\n            if(collider){\r\n                collider.enabled = false;\r\n            }\r\n\r\n            this.node.stopAllActions();\r\n            const OneTime = 3;\r\n            this.node.runAction(cc.sequence(cc.delayTime(OneTime),cc.fadeTo(0.5,0),cc.callFunc(()=>{\r\n                this.dispose();\r\n            })));\r\n        }\r\n    },\r\n    //是否正在快速移动死亡\r\n    isWellDie(){\r\n        return !this.isQuickDie;\r\n    },\r\n    //设定锁定鱼是自己\r\n    lockSelf(){\r\n        let nameID = Number(this.node.name);\r\n        if(this.logic.lockFishID != nameID){\r\n            glGame.emitter.emit(CONST.clientEvent.playLockSpine);\r\n        }\r\n        this.logic.lockFishID = nameID;\r\n        // cc.error(\">> 锁定 1  \",this.logic.lockFishID , \" id \",this.getFishID());\r\n        this.logic.isAuto = true;\r\n        glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n    },\r\n    //获取鱼线id 锁定、碰撞、死亡 等使用\r\n    getFishID(){\r\n        if(this.fishData != null){\r\n            return Number(this.fishData.id);\r\n        }\r\n        return null;\r\n    },\r\n    //循环体\r\n    update(dt){\r\n        //播放游的动画\r\n        if(this.isPlayStartMc){\r\n            this.playFishMovieClip(dt);\r\n        }\r\n        //移动\r\n        this.move(dt);\r\n        //子弹碰撞 变色 恢复颜色\r\n        if(this.isHit){\r\n            this.hitTime -= dt;\r\n            if(this.hitTime < 0){\r\n                this.isHit = false;\r\n                this.node.color = CONST.HitColor.Normal;\r\n            }\r\n        }\r\n        if(this.showBubblesTime != 1){\r\n            this.showBubblesTime += dt;\r\n            if(this.showBubblesTime >= 0){\r\n                this.showBubblesTime = 1;\r\n                this.startTalk(false,false);//鱼游到屏幕\r\n            }\r\n        }\r\n\r\n        if(this.closeBubblesTime > -1){\r\n            this.closeBubblesTime -= dt;\r\n            if(this.closeBubblesTime <= 0){\r\n                this.hideTip();\r\n                this.closeBubblesTime = -1;\r\n            }\r\n        }\r\n\r\n        if(this.logic != null && this.logic.lockFishID != null && this.logic.lockFishID == Number(this.node.name)){\r\n            if(!this.logic.getClickArea(this.node.position,this.node.width,this.node.height)){\r\n                // cc.error(\">> 解锁 9 \"+this.logic.lockFishID)\r\n                this.logic.lastLockFishID = Number(this.logic.lockFishID+\"\");\r\n                this.logic.lockFishID = null;\r\n                this.logic.lockFishIndex = null;\r\n                if(this.logic.isLockAutoChange == false){\r\n                    this.logic.isAuto = false;\r\n                    glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //获取时间\r\n    getIndexByTime(existTime) {\r\n        const HALF   = 2;\r\n        const OFFSEX = 1;\r\n        const Not    = -1;\r\n        let time     = 0\r\n        for (let i = 0; i < this.moveList.length / HALF; i++) {\r\n            time = time + this.moveList[HALF * i] + this.moveList[HALF * i + OFFSEX]\r\n            if (time >= existTime) {\r\n                return i\r\n            }\r\n        }\r\n        return Not\r\n    },\r\n    //获取时间\r\n    getTimeByIndex(index) {\r\n        const HALF   = 2;\r\n        const OFFSEX = 1;\r\n        let time     = 0\r\n        for (let i = 0; i < this.moveList.length / HALF; i++) {\r\n            if (i == index) {\r\n                break\r\n            }\r\n            time = time + this.moveList[HALF * i] + this.moveList[HALF * i + OFFSEX]\r\n        }\r\n        return time\r\n    },\r\n    //设置碰撞胶囊大小\r\n    setBoxColliderSizeOffsetAndAnchor(){\r\n        let collider = this.node.getComponent(cc.BoxCollider);\r\n        if(!collider){\r\n            collider = this.node.addComponent(cc.BoxCollider);\r\n        }\r\n        collider.enabled = true;\r\n        if(this.fishResData){\r\n            this.node.anchorX = this.fishResData.anchorX;\r\n            this.node.anchorY = this.fishResData.anchorY;\r\n            collider.offset    = cc.v2(this.fishResData.offsetX,this.fishResData.offsetY);\r\n            collider.size     = cc.size(this.fishResData.sizeW,this.fishResData.sizeH);\r\n        }\r\n        collider.tag = this.getFishID()+\"\";\r\n        this.node.name = \"\"+this.getFishID();\r\n    },\r\n    //受击\r\n    hit(){\r\n        const HitLongTime = 0.08;\r\n        this.node.color = CONST.HitColor.Attack;\r\n        this.hitTime    = HitLongTime;\r\n        this.isHit      = true;\r\n        this.startTalk(true,false);//鱼被击中\r\n    },\r\n    setAngle(x2,y2,point){\r\n        let x1 = point.x;\r\n        let y1 = point.y;\r\n        let angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;\r\n        this.setscale(angle);\r\n        return angle;\r\n    },\r\n    // 开始说话 isAttack = true 是被击中时候的时候  ，  death = true 死亡的时候\r\n    // ChatVoiceType:\r\n    // 0=不播放聊天及语音\r\n    // 1=入场屏幕20%~40%，20%随机播放音效及聊天\r\n    // 2=死亡仅播放音效\r\n    // 3=入场屏幕20%~40%，必然播放聊天和音效\r\n    // 4=入场屏幕20%~40%，50%概率播放聊天和音效\r\n    // 5=入场屏幕20%~40%，25%概率播放聊天和音效\r\n    // 6=入场屏幕20%~40%，被击中时，播放聊天和音效\r\n    startTalk(isAttack = false,death = false){\r\n        //test代码\r\n        // if(this.localFishData == null || this.localFishData.chatBubble == -1){\r\n        //     return;\r\n        // }\r\n        if(!this._bUpdate){\r\n            return;\r\n        }\r\n        if(!this.isPlayStartMc){\r\n            return;\r\n        }\r\n        if(this.logic == undefined || this.logic.playSoundTime == undefined){\r\n            return;\r\n        }\r\n        const GAPTIME = 10;//上一次播放时间和当前时间的间隔\r\n        let lastPlayTime = (Date.now() - this.logic.playSoundTime)/1000;\r\n        if(this.localFishData == null || this.localFishData.chatBubble == -1 || this.isPlayerSound || lastPlayTime < GAPTIME){\r\n            return;\r\n        }\r\n        this.isPlayerSound = true;\r\n        const ChatVoiceType1 = 1;\r\n        const ChatVoiceType2 = 2;\r\n        const ChatVoiceType3 = 3;\r\n        const ChatVoiceType4 = 4;\r\n        const ChatVoiceType5 = 5;\r\n        const ChatVoiceType6 = 6;\r\n        const BasePercentageFactor = 100;\r\n        const FishRunTime = this.runTime;\r\n\r\n        if(death){\r\n            this.isShowTip = true;\r\n        }\r\n        if(isAttack){\r\n            const P20 = FishRunTime * (20/BasePercentageFactor);\r\n            const P40 = FishRunTime * (40/BasePercentageFactor);\r\n            if(Number(this.localFishData.chatVoiceType) == ChatVoiceType6 && this._startTime > P20 && this._startTime < P40){\r\n                this.isShowTip = true;\r\n            }else{\r\n                return;\r\n            }\r\n        }\r\n        if(Number(this.localFishData.chatVoiceType) == ChatVoiceType3){\r\n            this.isShowTip = true;\r\n        }\r\n\r\n        let IsShow = Math.random() * BasePercentageFactor;\r\n        const P1_20 = 20/BasePercentageFactor;\r\n        const P4_20 = 50/BasePercentageFactor;\r\n        const P5_20 = 25/BasePercentageFactor;\r\n        switch (Number(this.localFishData.chatVoiceType)) {\r\n            case ChatVoiceType1:\r\n                if(IsShow > P1_20){\r\n                    this.isShowTip = true;\r\n                }\r\n                break;\r\n            case ChatVoiceType4:\r\n                if(IsShow > P4_20){\r\n                    this.isShowTip = true;\r\n                }\r\n                break;\r\n            case ChatVoiceType5:\r\n                if(IsShow > P5_20){\r\n                    this.isShowTip = true;\r\n                }\r\n                break;\r\n        }\r\n        if(this.isShowTip){\r\n            this.showTip();\r\n        }\r\n    },\r\n    //显示气泡\r\n    showTip(){\r\n        this.closeBubblesTime = 5;\r\n        this.logic.playSoundTime = Date.now();\r\n        const FishVoice = \"voiceFile\";\r\n        glGame.emitter.emit(CONST.clientEvent.fishSound,FishVoice+this.localFishData.voiceFile);\r\n        let text;\r\n        if(this.localFishData.chatBubble.indexOf(\"&&\") != -1){\r\n            let str = (this.localFishData.chatBubble+\"\").split(\"&&\");\r\n            text = str[0] + \"\\n\" + str[1];\r\n        }else{\r\n            text = this.localFishData.chatBubble;\r\n        }\r\n        glGame.emitter.emit(CONST.clientEvent.followFishTip, {\r\n                id:this.node.name,\r\n                text:text,\r\n                time:CONST.TipTime,\r\n                size:this.node.getComponent(cc.Sprite).spriteFrame.getOriginalSize(),\r\n                direction:this.posArray[0].x > 0,\r\n                // data:this.localFishData,\r\n        });\r\n    },\r\n    setscale(angle){\r\n        const Normal = 1;\r\n        const GoBack = -1;\r\n        let oneX = this.posArray[0].x;\r\n        if(this.logic.getIsRotation()){\r\n            if(this.localFishData.fixedResource == 1 && oneX > 0) {//悬浮鱼类特殊处理\r\n                this.node.scaleY = GoBack;\r\n                this.node.scaleX = oneX > 0 ? GoBack : Normal;\r\n            }else{\r\n                this.node.scaleY = oneX > 0 ?  Normal : GoBack;\r\n            }\r\n        }else{\r\n            if(this.localFishData.fixedResource == 1 && oneX > 0) {//悬浮鱼类特殊处理\r\n                this.node.scaleY = Normal;\r\n                this.node.scaleX = oneX > 0 ? GoBack : Normal;\r\n            }else{\r\n                this.node.scaleY = oneX > 0 ?  GoBack : Normal;\r\n            }\r\n        }\r\n        // if(this.isShowTip)this.setTipText(angle);\r\n    },\r\n    //设置tip\r\n    setTipText(angle){\r\n        if(this.localFishData == null || this.localFishData.chatBubble == -1){\r\n            return;\r\n        }\r\n        let oneX = this.posArray[0].x;\r\n        let bgAngle = 0;\r\n        let desc = \"\";\r\n        if(this.logic.getIsRotation()){\r\n            if(oneX > 0){\r\n                if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                    desc = \"A-f\";\r\n                }else{\r\n                    bgAngle = -angle;\r\n                    desc = \"A\";\r\n                }\r\n                this.cantainerName = \"A\";\r\n            }else{\r\n                if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                    desc = \"B-f\";\r\n                }else{\r\n                    bgAngle = angle;\r\n                    desc = \"B\";\r\n                }\r\n                this.cantainerName = \"B\";\r\n            }\r\n        }else{\r\n            if(oneX > 0){\r\n                if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                    desc = \"C-f\";\r\n                }else{\r\n                    desc = \"C\";\r\n                    bgAngle = angle;\r\n                }\r\n                this.cantainerName = \"C\";\r\n            }else{\r\n                if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                    desc = \"D-f\";\r\n                }else{\r\n                    desc = \"D-f\";\r\n                    bgAngle = -angle;\r\n                }\r\n                this.cantainerName = \"D\";\r\n            }\r\n        }\r\n        let cantainer = this.node.getChildByName(\"cantainer\" + this.cantainerName);\r\n        let lab = cantainer.getChildByName(\"bg\").getChildByName(\"lab\");\r\n        if(cantainer.width == 0 && this.node.getComponent(cc.Sprite).spriteFrame != null){\r\n            let size = this.node.getComponent(cc.Sprite).spriteFrame.getOriginalSize();\r\n            cantainer.active = true;\r\n            cantainer.width  = size.width;\r\n            cantainer.height = size.height;\r\n            if(this.localFishData.chatBubble.indexOf(\"&&\") != -1){\r\n                let str = (this.localFishData.chatBubble+\"\").split(\"&&\");\r\n                lab.getComponent(cc.Label).string = str[0] + \"\\n\" + str[1];\r\n            }else{\r\n                lab.getComponent(cc.Label).string = this.localFishData.chatBubble;\r\n            }\r\n        }\r\n\r\n        if(this.logic.getIsRotation()){\r\n            if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                if(oneX > 0){\r\n                    // lab.getComponent(cc.Label).string = \"- A-1 -\";\r\n                    lab.scaleY = 1;\r\n                }else{\r\n                    // lab.getComponent(cc.Label).string = \"- B-1 -\";\r\n                    lab.scaleY = 1;\r\n                }\r\n            }else{\r\n                if(oneX > 0){\r\n                    // lab.getComponent(cc.Label).string = \"- A-2 TTT -\";\r\n                    lab.scaleX = -1;\r\n                }else{\r\n                    // lab.getComponent(cc.Label).string = \"- B-2 -\";\r\n                }\r\n            }\r\n        }else{\r\n            if(this.localFishData.fixedResource == 1) {//悬浮鱼类特殊处理\r\n                if(oneX > 0){\r\n                    // lab.getComponent(cc.Label).string = \"- C-1 -\";\r\n                    lab.scaleX = -1;\r\n                }else{\r\n                    // lab.getComponent(cc.Label).string = \"- D-1 -\";\r\n                }\r\n            }else {\r\n                if(oneX > 0){\r\n                    lab.scaleY = -1;\r\n                    // lab.getComponent(cc.Label).string = \"- C-2 -\";\r\n                }else{\r\n                    // lab.getComponent(cc.Label).string = \"- D-2 -\";\r\n                }\r\n            }\r\n        }\r\n        if(this.localFishData.fixedResource != 1){\r\n            cantainer.angle  = bgAngle;\r\n        }\r\n    },\r\n    //隐藏Tip\r\n    hideTip(){\r\n        this.isShowTip = false;\r\n        // let cantainer = this.node.getChildByName(\"cantainer\" + this.cantainerName);\r\n        // if(cantainer){\r\n        //     cantainer.active = false;\r\n        // }\r\n    },\r\n    //死亡 - 开始 dieType: 0 自然死亡 1玩家攻击 2全屏炸弹 3闪电  4旋涡 delayDieTime 延迟死亡\r\n    death(dieType,seatNum = -1,delayDieTime = -1){\r\n        glGame.emitter.emit(CONST.clientEvent.clearFollowFishTip, {fishId:this.getFishID()+\"\"});\r\n        if(delayDieTime > 0){\r\n            this.scheduleOnce(()=>{\r\n                this.deathNext(dieType,seatNum);\r\n            },delayDieTime);\r\n        }else{\r\n            this.deathNext(dieType,seatNum);\r\n        }\r\n    },\r\n    //死亡 - 开始 dieType: 0 自然死亡 1玩家攻击 2全屏炸弹 3闪电  4旋涡\r\n    deathNext(dieType,seatNum = -1){\r\n        glGame.emitter.emit(CONST.clientEvent.clearFollowFishTip, {fishId:this.getFishID()+\"\"});\r\n        this.hideTip();\r\n        this.node.getComponent(cc.BoxCollider).enabled = false;\r\n        //播放死亡动画开始 结束后调用 dispose\r\n        this.isStart  = false;\r\n        this._bUpdate = false;\r\n        if(this.lockBulletList && this.lockBulletList.length > 0){\r\n            let len = this.lockBulletList.length;\r\n            for (let i = 0;i<len;i++){\r\n                this.lockBulletList[i].getComponent(\"nfish_Bullet\").deathFish(this.getFishID());\r\n            }\r\n        }\r\n\r\n        if(dieType != CONST.dieType0 && this.localFishData.shock == 1){\r\n            glGame.emitter.emit(CONST.clientEvent.onSshock);\r\n        }\r\n        this.lockBulletList = null;\r\n        if(dieType == CONST.dieType1){\r\n            this.isHit = false;\r\n            this.node.color = CONST.HitColor.Deat;\r\n            const TIME = 0.8;\r\n            let EndAngle;\r\n            const SX = 0;\r\n            let act;\r\n            if(this.logic.getIsRotation()){\r\n                EndAngle = -360 * 3;\r\n                act = cc.spawn(\r\n                    cc.scaleTo(TIME,SX),\r\n                    cc.rotateTo(TIME,EndAngle)\r\n                );\r\n            }else{\r\n                EndAngle = -360 * 3;\r\n                act = cc.spawn(\r\n                    cc.scaleTo(TIME,SX),\r\n                    cc.rotateTo(TIME,EndAngle)\r\n                );\r\n            }\r\n            this.startTalk(false,true);//鱼被玩家打死\r\n            this.node.stopAllActions();\r\n            this.node.runAction(cc.sequence(act,cc.callFunc(()=>{\r\n                this.dispose();\r\n            })));\r\n        }else if(dieType == CONST.dieType3){\r\n            let oldAngle = this.node.angle + \"\";\r\n            let angle = this.node.angle >　0 ? this.node.angle - 20 : this.node.angle + 20;\r\n            let act = cc.sequence(\r\n                cc.rotateTo(0.1,angle),\r\n                cc.rotateTo(0.1,Number(oldAngle))\r\n            );\r\n            this.node.stopAllActions();\r\n            this.node.runAction(cc.sequence(cc.repeat(act,7),cc.scaleTo(1,0),cc.callFunc(()=>{\r\n                this.dispose();\r\n            })));\r\n        }else if(dieType == CONST.dieType4){\r\n            this.node.stopAllActions();\r\n            let act = cc.spawn(\r\n                cc.scaleTo(2,0.01,0.01),\r\n                cc.repeat(cc.rotateBy(0.5,360),5),\r\n                cc.sequence(\r\n                    cc.moveTo(0.6,this.node.x + 9,this.node.y - 9),\r\n                    cc.moveTo(0.6,this.node.x - 9,this.node.y + 9),\r\n                )\r\n            );\r\n            this.node.runAction(cc.sequence(act,cc.callFunc(()=>{\r\n                this.dispose();\r\n            })));\r\n        }else{\r\n            this.dispose();\r\n        }\r\n    },\r\n    //卸载自己\r\n    dispose(){\r\n        this.clearTideCorrect();\r\n        let fishID = Number(this.getFishID()+\"\");\r\n        glGame.emitter.emit(CONST.clientEvent.clearFollowFishTip, {fishId:this.getFishID()+\"\"});\r\n        this.fishData = null;\r\n        this._bUpdate = false;\r\n        this.moveList = null;\r\n        this.posArray = null;\r\n        if(this.whirlpool)this.whirlpool.destroy();\r\n        if(this.node.parent){\r\n            this.node.parent.removeChild(this.node);\r\n        }\r\n        // this.node.destroy();\r\n        if(!this.isQuickDie){\r\n            glGame.emitter.emit(CONST.clientEvent.disposeFishNode,fishID);\r\n        }\r\n        if(this.logic){\r\n            let ind = this.logic.bossIDList.indexOf(fishID);\r\n            if(ind != -1){\r\n                this.logic.bossIDList.splice(ind,1);//如有boss 死亡的时候就删除\r\n            }\r\n            this.node.off(cc.Node.EventType.TOUCH_START);\r\n            this.logic.fishPool.put(this.node);\r\n        }\r\n        this.logic    = null;\r\n\r\n    },\r\n    //延迟销毁\r\n    delayDestroy(i){\r\n        let delayTime = 0.01 + 0.1*i;\r\n        const MaxTime = 3;\r\n        if(delayTime > MaxTime){\r\n            delayTime = Math.random() * MaxTime;\r\n        }\r\n        this.scheduleOnce(()=>{\r\n            if(this.node != null){\r\n                this.node.destroy();\r\n            }\r\n        },delayTime);\r\n    },\r\n    OnDestroy() {\r\n        this.moveList = [];\r\n        this.logic = null;\r\n        this.fishData = null;\r\n        this.posArray = null;\r\n        this.isHit    = false;\r\n        this.hitTime  = 0;\r\n    }\r\n});"]}