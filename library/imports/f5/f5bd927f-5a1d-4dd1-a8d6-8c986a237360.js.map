{"version":3,"sources":["assets\\modules\\games\\nfish\\script\\prefab\\nfish_deskContainer.js"],"names":["CONST","require","glGame","baseclass","extend","properties","ui_physicalPool","cc","Node","hitNode","ui_LockCantainer","partialBombEffect","fish_Bullet","Prefab","fish_Unit","explosionAndLightning_Atlas","displayName","tooltip","type","SpriteAtlas","bullet_Atlas","missilBullet_Atlas","fish_AtlaLists","onLoad","logic","getInstance","startRunFish","currTouchEvent","fireTime","fireTimeFrequency","isFire","shootTime","autoShootTime","lockBulletList","fishNodeList","fishNodeListLenght","oldPos","node","position","addComponent","active","isSshockIng","director","getCollisionManager","enabled","getPhysicsManager","debugDrawFlags","PhysicsManager","DrawBits","e_aabbBit","e_pairBit","registerEvent","start","emitter","on","clientEvent","adjustGunAngle","adjustGunAngleHandler","initFishPool","initFishPoolHandler","addFishPool","addFishPoolHandler","addFishTide","addFishTideHandler","playShootBullet","playShootBulletHandler","playFishnetEffect","playFishnetEffectHandler","onKillFish","onKillFishHandler","onFreezeStartStop","onFreezeStartStopHandler","useAutoSkill","useAutoSkillHandler","leaveRoomUnLock","leaveRoomUnLockHandler","seaWaveFishGroup","seaWaveFishGroupHandler","fishCancelShoot","onClickHandler","disposeFishNode","disposeFishNodeHandler","initBulletList","initBulletListHandler","onSshock","onShockHandler","playLockSpine","playLockSpineHandler","onSpecialBulletExp","onSpecialBulletExpHandler","onSpecialBomb","onSpecialBombHandler","changeCantainer","changeCantainerHandler","lockSelfFish","lockSelfFishHandler","checkBgMusic","checkBgMusicHandler","EventType","TOUCH_END","onFireHooHandler","TOUCH_START","TOUCH_CANCEL","unregisterEvent","off","res","bulletEffect","gunLevel","cannonType","CannonType","Missile","bulletNode","getChildByName","warn","fishNet","instantiate","parent","zIndex","maxScaleSet","m","getRandomNum","setScale","angle","addChild","getComponent","sp","Skeleton","setCompleteListener","trackEntry","loopCount","name","animation","SpineName","Attack","destroy","setAnimation","evt","emit","isLock","pos","getLocation","direction","convertToNodeSpaceAR","setClick","clickFishPool","y","ShootButtomMin","checkShoot","dt","ShotInterval","ShotIntervalTime","isAuto","lockFishID","undefined","Normal","playerInfo","Number","uid","error","seatNum","cannonAmount","checkSpecialCannon","Moving","log","aimFishId","fish","getClickArea","width","height","lock","lastAngle","updateGunRecoil","updateShootGold","offLine","myid","user","userID","isMe","cannonLevel","fishSound","ui_gun","oldAngle","fire","worldPoint","convertToWorldSpaceAR","localPoint","gunType","getTargetFishAngle","fishPoolData","placeOfBirth","v2","x","tpmAngle","Seat","LeftTop","RightTop","NormalAngel","Math","sin","PI","cos","bulletId","Date","now","currentUid","isHaveLaser","Laser","isHaveMissile","hitMax","isHavePartialBomb","PartialBomb","isHaveLightning","Lightning","currentBullteType","op","CannonOpention","dataAngle","Not","isFireLaser","CD","MaximumBulletCollisionTime","scheduleOnce","clearSpecialBulletPool","specialBulletPool","onLaserDispath","playFiringEffect","lastCammpmType","restoreCannon","isNow","upSpecialGunCoin","curWaitTime","fireSettingRecoil","isNeedSend","bullet","bulletPool","size","get","script","bullteNum","ReTime","initBulletAtlas","initBullet","push","hiddenLocationTip","data","isEnterRoom","gameNet","send_msg","room","getPlayerOp","scenetag","FISH2","key","startPos","getP1ToP2Angle","fishId","lastLockFishID","lockFishIndex","isLockAutoChange","_components","fishTypeId","BossGodOfWealth","quickDie","killType","dieType3","dieType1","death","delayDieTime","console","currBgMusicIndex","item","BossLavaBasalt","BossLavaBasaltBgMusic","BossSYLW","BossSYLWBgMusic","isWellDie","BossGodOfWealthBgMusic","fishBgSound","quickMove","initFishData","tmpArray","id","i","len","length","schedule","j","fishSetverData","used","fishData","ToScond","serverTime","time","createTime","runTime","showTime","createFish","fishNode","fishPool","isFish","JSON","parse","stringify","initAtlas","initFish","updateIcing","settingIcing","_time","firstNode","lockSelf","msg","showFishTideTitle","NotHaveFish","next","seaWaveChangeBg","bgIndex","onSurfStart","startFire","fishLenth","childrenCount","currNode","children","getFishID","bossIDList","indexOf","removeChild","specialFishListBorn","addTide","groupId","hideBossConinUI","MaxUserNum","ui_lock","SeaWaveRunTime","fData","tmpfish","put","hasOwnProperty","isInFreeze","update","window","s1","unLockFish","lockFishId","findFish","isPlaySpined","lockNode","currentLockUi","playSpine","LockStart","LockIng","priorityMax","isNext","priority","json_fishTable","offLineMissileData","PartialBombHit","MissileHit","LightningHit","killFishData","getFishByRange","runLightningEffect","killFishList","posList","creatpartialBombEffect","creatoMissil","sendHitFishData","num","Harf","EffectOffsexX","EffectOffsexY","EffectPosOffsexX","EffectPosOffsexY","Xdirection","random","Ydirection","creatBoomEffect","hitFishData","isNeedSet180Angle","creatRongYanBoomEffect","missileEffect","opacity","nodeZIndex","zIndexAni","getIsRotation","runAction","sequence","delayTime","callFunc","specialBoomEffect","killFishArr","nextFishPos","Gap","fishID","next_fishID","next_fishNode","no","mag","specialEffect","creatorEffect","zIndexAllBoom","temp","sub","anchorX","setAngle","scale","LightningW","h","LightningH","endH","EffectImage","Begin","End","Loop","IsHaveZero","Speed","PlayedRemove","initEffect","creatEffectBluePointLight","winSize","getCoin","rewardGold","floor","tmpList","fishKey","fishLineID","multiple","GetRunCoinTime","playCoinEffect","radius","roomRule","LightningRadius","ExplodeRadius","ExcaliburRadius","All","Haf","abs","curr","fishUnit","dis","getDistanceTwoPoint","LightningMaxFish","node1","node2","OffsexY","sqrt","pow","onClick","menuOptionViewHandler","LockTime","SshockTime","Widget","repeatForever","moveTo","stopAllActions","setPosition","OnDestroy","unscheduleAllCallbacks"],"mappings":"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","sourceRoot":"/","sourcesContent":["/***\r\n *  捕鱼：桌子：渔场 、 子弹池、部分UI(隐式大炮）,部分特效\r\n * **/\r\nlet CONST = require(\"nfishConst\");\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        ui_physicalPool:cc.Node,    //物理池： 鱼 子弹 参与碰撞检测的对象\r\n        hitNode:cc.Node,           //点击屏幕的碰撞快\r\n        ui_LockCantainer:cc.Node, //点击屏幕的碰撞快\r\n        partialBombEffect:cc.Node, //炎爆爆炸效果\r\n        fish_Bullet:cc.Prefab,    //子弹预制单位\r\n        fish_Unit:cc.Prefab,    //鱼预制单位\r\n        //子弹UI\r\n        explosionAndLightning_Atlas: {\r\n            default: null,\r\n            displayName: \"特效图集\",\r\n            tooltip: \"爆炸，灰烬，闪电\",\r\n            type:cc.SpriteAtlas,\r\n        },\r\n        //子弹UI\r\n        bullet_Atlas: {\r\n            default: null,\r\n            displayName: \"子弹UI\",\r\n            tooltip: \"子弹UI 1 - 10\",\r\n            type:cc.SpriteAtlas,\r\n        },\r\n        //仙剑子弹UI\r\n        missilBullet_Atlas: {\r\n            default: null,\r\n            displayName: \"仙剑子弹UI\",\r\n            tooltip: \"仙剑子弹UI\",\r\n            type:cc.SpriteAtlas,\r\n        },\r\n        //fish\r\n        fish_AtlaLists: {\r\n            default: [],\r\n            displayName: \"所有鱼\",\r\n            tooltip: \"鱼\",\r\n            type:[cc.SpriteAtlas],\r\n        },\r\n\r\n    },\r\n    onLoad () {\r\n        this.logic              = require(\"nfishlogic\").getInstance();//数据中心\r\n        this.logic.ui_physicalPool = this.ui_physicalPool;\r\n        this.startRunFish       = false;\r\n        this.currTouchEvent     = null;\r\n        this.fireTime           = 0;    //开火计时器\r\n        this.fireTimeFrequency  = 0.17; //开火频率\r\n        this.isFire             = true; //是否可以开火\r\n        this.shootTime          = 0;\r\n        this.autoShootTime      = 0;                                                             //隐藏特殊鱼 node\r\n        this.lockBulletList     = [];\r\n        this.fishNodeList       = {};\r\n        this.fishNodeListLenght = 0;\r\n        this.oldPos             = this.node.position;\r\n        this.hitNode.addComponent(\"nfish_hitNode\");\r\n        this.hitNode.active     = false;\r\n        this.isSshockIng        = false;\r\n        cc.director.getCollisionManager().enabled = true;                        //打开碰撞检测\r\n        cc.director.getPhysicsManager().enabled = true;                          //启用物理引擎相关功能\r\n        //调试模式\r\n        cc.director.getPhysicsManager().debugDrawFlags = cc.PhysicsManager.DrawBits.e_aabbBit ||cc.PhysicsManager.DrawBits.e_pairBit;\r\n        // cc.director.getCollisionManager().enabledDrawBoundingBox = true;         //是否绘制碰撞组件的包围盒\r\n        // cc.director.getCollisionManager().enabledDebugDraw = true;               //是否绘制碰撞组件的形状\r\n        this.registerEvent();\r\n    },\r\n    start () {\r\n    },\r\n    //注册监听\r\n    registerEvent() {\r\n        glGame.emitter.on(CONST.clientEvent.adjustGunAngle,this.adjustGunAngleHandler,this);        //调整高射炮角度\r\n        glGame.emitter.on(CONST.clientEvent.initFishPool,this.initFishPoolHandler,this);            //初始化鱼塘\r\n        glGame.emitter.on(CONST.clientEvent.addFishPool,this.addFishPoolHandler,this);              //加鱼\r\n        glGame.emitter.on(CONST.clientEvent.addFishTide,this.addFishTideHandler,this);              //加鱼潮\r\n        glGame.emitter.on(CONST.clientEvent.playShootBullet,this.playShootBulletHandler,this);      //用户射击\r\n        glGame.emitter.on(CONST.clientEvent.playFishnetEffect,this.playFishnetEffectHandler,this);  //生成渔网\r\n        glGame.emitter.on(CONST.clientEvent.onKillFish,this.onKillFishHandler,this);                //销毁鱼\r\n        glGame.emitter.on(CONST.clientEvent.onFreezeStartStop,this.onFreezeStartStopHandler,this);  //冰冻 开始-结束\r\n        glGame.emitter.on(CONST.clientEvent.useAutoSkill,this.useAutoSkillHandler,this);            //使用锁定技能\r\n        glGame.emitter.on(CONST.clientEvent.leaveRoomUnLock,this.leaveRoomUnLockHandler,this);      //用户离开解锁\r\n        glGame.emitter.on(CONST.clientEvent.seaWaveFishGroup,this.seaWaveFishGroupHandler,this);    //海浪鱼群 - 快速游走\r\n        glGame.emitter.on(CONST.clientEvent.fishCancelShoot,this.onClickHandler,this);              //停止射击\r\n        glGame.emitter.on(CONST.clientEvent.disposeFishNode,this.disposeFishNodeHandler,this);      //销毁鱼\r\n        glGame.emitter.on(CONST.clientEvent.initBulletList,this.initBulletListHandler,this);        //初始化鱼池子弹-断连\r\n        glGame.emitter.on(CONST.clientEvent.onSshock,this.onShockHandler,this);                     //震动屏幕\r\n        glGame.emitter.on(CONST.clientEvent.playLockSpine,this.playLockSpineHandler,this);          //播放锁定动画\r\n        glGame.emitter.on(CONST.clientEvent.onSpecialBulletExp,this.onSpecialBulletExpHandler,this);//特殊子弹爆炸\r\n        glGame.emitter.on(CONST.clientEvent.onSpecialBomb,this.onSpecialBombHandler,this);          //熔岩玄武 全屏爆炸\r\n        glGame.emitter.on(CONST.clientEvent.changeCantainer,this.changeCantainerHandler,this);      //改变物理容器 scale\r\n        glGame.emitter.on(CONST.clientEvent.changeCantainer,this.changeCantainerHandler,this);      //改变物理容器 scale\r\n        glGame.emitter.on(CONST.clientEvent.lockSelfFish,this.lockSelfFishHandler,this);            //锁定鱼\r\n        glGame.emitter.on(CONST.clientEvent.checkBgMusic,this.checkBgMusicHandler,this);            //根据是否有boss 检查切换背景音乐\r\n        this.ui_physicalPool.on(cc.Node.EventType.TOUCH_END,this.onFireHooHandler,this);            //结束点击 鱼池\r\n        this.ui_physicalPool.on(cc.Node.EventType.TOUCH_START,this.onFireHooHandler,this);          //开始点击 鱼池\r\n        this.ui_physicalPool.on(cc.Node.EventType.TOUCH_CANCEL,this.onFireHooHandler,this);         //取消点击 鱼池\r\n    },\r\n    //反注册监听\r\n    unregisterEvent() {\r\n        glGame.emitter.off(CONST.clientEvent.adjustGunAngle,this);\r\n        glGame.emitter.off(CONST.clientEvent.initFishPool,this);\r\n        glGame.emitter.off(CONST.clientEvent.addFishPool,this);\r\n        glGame.emitter.off(CONST.clientEvent.addFishTide,this);\r\n        glGame.emitter.off(CONST.clientEvent.playShootBullet,this);\r\n        glGame.emitter.off(CONST.clientEvent.playFishnetEffect,this);\r\n        glGame.emitter.off(CONST.clientEvent.onKillFish,this);\r\n        glGame.emitter.off(CONST.clientEvent.onFreezeStartStop,this);\r\n        glGame.emitter.off(CONST.clientEvent.useAutoSkill,this);\r\n        glGame.emitter.off(CONST.clientEvent.leaveRoomUnLock,this);\r\n        glGame.emitter.off(CONST.clientEvent.seaWaveFishGroup,this);\r\n        glGame.emitter.off(CONST.clientEvent.fishCancelShoot,this);\r\n        glGame.emitter.off(CONST.clientEvent.disposeFishNode,this);\r\n        glGame.emitter.off(CONST.clientEvent.initBulletList,this);\r\n        glGame.emitter.off(CONST.clientEvent.onSshock,this);\r\n        glGame.emitter.off(CONST.clientEvent.playLockSpine,this);\r\n        glGame.emitter.off(CONST.clientEvent.onSpecialBulletExp,this);\r\n        glGame.emitter.off(CONST.clientEvent.onSpecialBomb,this);\r\n        glGame.emitter.off(CONST.clientEvent.changeCantainer,this);\r\n        glGame.emitter.off(CONST.clientEvent.lockSelfFish,this);\r\n        glGame.emitter.off(CONST.clientEvent.checkBgMusic,this);\r\n    },\r\n    //生成渔网\r\n    playFishnetEffectHandler(res){\r\n        let bulletEffect  = null;\r\n        if(res.gunLevel >= 1 && res.gunLevel <= 3){\r\n            bulletEffect = \"bulletEffect1_3\";\r\n        }\r\n        if(res.gunLevel >= 4 && res.gunLevel <= 6){\r\n            bulletEffect = \"bulletEffect4_6\";\r\n        }\r\n        if(res.gunLevel >= 7 && res.gunLevel <= 9){\r\n            bulletEffect = \"bulletEffect7_9\";\r\n        }\r\n        if(res.gunLevel == 10){\r\n            bulletEffect = \"bulletEffect10\";\r\n        }\r\n        if(res.cannonType == CONST.CannonType.Missile){\r\n            bulletEffect = \"bulletEffectMissile\";\r\n        }\r\n        let bulletNode   = this.node.getChildByName(bulletEffect);\r\n        if(!bulletNode){\r\n            cc.warn(\">无 生成渔网\")\r\n            return;\r\n        }\r\n        //根据这两个参数 实例化相对于 子弹特效\r\n        let fishNet      = cc.instantiate(bulletNode);\r\n        fishNet.parent   = null;\r\n        fishNet.position = res.position;\r\n        fishNet.active   = true;\r\n        fishNet.zIndex   = res.zIndex;\r\n        const maxScaleSet= 1.5;\r\n        let m            = this.logic.getRandomNum(0.6,1);\r\n        if(res.gunLevel == 9){\r\n            m            = this.logic.getRandomNum(0.5,0.7);\r\n        }\r\n        if(res.gunLevel == 10){\r\n            m            = this.logic.getRandomNum(0.5,1);\r\n        }\r\n        if(res.cannonType == CONST.CannonType.Missile){\r\n            m = maxScaleSet;\r\n        }\r\n        fishNet.setScale(m);\r\n        fishNet.angle = this.logic.getRandomNum(0,360);\r\n        this.ui_physicalPool.addChild(fishNet);\r\n        fishNet.getComponent(sp.Skeleton).setCompleteListener((trackEntry, loopCount) => {\r\n            let name = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            if (name == CONST.SpineName.Attack) {\r\n                fishNet.destroy();\r\n            }\r\n        });\r\n        fishNet.getComponent(sp.Skeleton).setAnimation(0,CONST.SpineName.Attack,false);\r\n    },\r\n    //点击 鱼池\r\n    onFireHooHandler(evt){\r\n        if(evt != null && evt.type == cc.Node.EventType.TOUCH_START){\r\n            if(this.isFire){\r\n                this.isFire  = false;\r\n                glGame.emitter.emit(CONST.clientEvent.fishCancelShoot,evt);\r\n            }\r\n        }else{\r\n            this.shootTime = -1000;\r\n            this.currTouchEvent = null;\r\n            glGame.emitter.emit(CONST.clientEvent.fishCancelShoot,evt);\r\n        }\r\n    },\r\n    //点击 鱼池\r\n    onClickHandler(evt){\r\n        if(evt != null && evt.type == cc.Node.EventType.TOUCH_START){\r\n            if(this.logic.isLock) {//锁定鱼 逻辑重写\r\n                let pos = evt.getLocation();\r\n                let direction       = this.ui_physicalPool.convertToNodeSpaceAR(pos);\r\n                this.hitNode.active = true;\r\n                this.hitNode.getComponent(\"nfish_hitNode\").setClick(direction);\r\n            }\r\n            glGame.emitter.emit(CONST.clientEvent.clickFishPool,evt.getLocation().y > CONST.ShootButtomMin ? evt : null);\r\n            this.shootTime = 0;\r\n            this.currTouchEvent = evt;\r\n        }else{\r\n            this.shootTime = -1000;\r\n            this.currTouchEvent = null;\r\n        }\r\n    },\r\n    //检测射击\r\n    checkShoot(dt){\r\n        const ShotInterval = 0.2;\r\n        const ShotIntervalTime = -1000;\r\n        if(this.logic.isAuto){\r\n            //如果使用了锁定技能，那么必须有锁定对象\r\n            if(!this.logic.isLock || (this.logic.isLock && this.logic.lockFishID != undefined)){\r\n                this.autoShootTime += dt;\r\n                if(this.autoShootTime > ShotInterval){\r\n                    this.autoShootTime = 0;\r\n                    glGame.emitter.emit(CONST.clientEvent.clickFishPool,null);\r\n                }\r\n            }\r\n        }else if(this.currTouchEvent != null){\r\n            if(this.currTouchEvent.type == cc.Node.EventType.TOUCH_END){\r\n                this.currTouchEvent = null;\r\n                this.shootTime = ShotIntervalTime;\r\n                return;\r\n            }\r\n            if(this.currTouchEvent.type == cc.Node.EventType.TOUCH_START){\r\n                this.shootTime += dt;\r\n                if(this.shootTime > ShotInterval){\r\n                    this.shootTime = 0;\r\n                    let pos = this.currTouchEvent.getLocation();\r\n                    glGame.emitter.emit(CONST.clientEvent.clickFishPool,pos.y > CONST.ShootButtomMin ? this.currTouchEvent : null);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //服务器广播发射子弹\r\n    playShootBulletHandler(res){\r\n        if(res.cannonType == undefined){\r\n            res.cannonType = CONST.CannonType.Normal;\r\n        }\r\n        let playerInfo = this.logic.playerInfo[Number(res.uid)];\r\n        if(res.cannonType == CONST.CannonType.Normal && playerInfo.cannonType != CONST.CannonType.Normal){\r\n            cc.error(\"====服务器 onShoot 数据有误 \",res,\"  info \",playerInfo);\r\n        }\r\n        if(res.cannonType == CONST.CannonType.Normal && playerInfo.cannonType != CONST.CannonType.Normal){\r\n            cc.error(\">>服务器广播发射子弹  数据有误 纠正数据 \"+res.seatNum)\r\n            this.logic.playerInfo[Number(res.uid)].cannonType = CONST.CannonType.Normal;\r\n            this.logic.playerInfo[Number(res.uid)].cannonAmount = 0;\r\n            glGame.emitter.emit(CONST.clientEvent.checkSpecialCannon,true);//检查炮台\r\n        }\r\n        if(Number(res.seatNum) == Number(this.logic.seatNum)){\r\n            cc.error(\"服务器广播 发射子弹 过滤自己的！\");\r\n            return;\r\n        }\r\n        const Moving = 1;\r\n        if(this.logic[\"isGunMoving\"+res.seatNum] == Moving){\r\n            cc.log(\">正在更换炮台 播放特效 无法发射子弹!\")\r\n            return;\r\n        }\r\n        if(res.aimFishId != null){\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+res.aimFishId);\r\n            if(fish != null){//符合要求的鱼才可以锁定，否则解锁\r\n                if(this.logic.getClickArea(fish.position,fish.width,fish.height)){\r\n                    res.lock = Number(res.aimFishId);\r\n                    res.angle = null;\r\n                }else{\r\n                    res.lock = null;\r\n                    if(res.angle == undefined){//解锁时的角度可能为空\r\n                        if(this.lastAngle){\r\n                            res.angle = this.lastAngle;\r\n                        }else{\r\n                            res.angle = this.ui_physicalPool.getChildByName(\"ui_gun\"+res.seatNum).angle;\r\n                        }\r\n                    }\r\n                    cc.error(\">> 服务器广播发射子弹 :  锁定失败  fishID \"+res.aimFishId)\r\n                }\r\n            }\r\n            this.adjustGunAngleHandler(res);\r\n            glGame.emitter.emit(CONST.clientEvent.updateGunRecoil,res);\r\n            // cc.warn(\">> 广播 射击 更新其他用户的钱 5\")\r\n            glGame.emitter.emit(CONST.clientEvent.updateShootGold,res);\r\n        }else {\r\n            this.adjustGunAngleHandler(res);\r\n            glGame.emitter.emit(CONST.clientEvent.updateGunRecoil,res);\r\n            // cc.warn(\">> 广播 射击 更新其他用户的钱 5\")\r\n            glGame.emitter.emit(CONST.clientEvent.updateShootGold,res);\r\n        }\r\n    },\r\n    //断线重连 发射子弹\r\n    initBulletListHandler(res){\r\n        this.adjustGunAngleHandler(res,true);\r\n    },\r\n    //发射子弹 -> 炮台 转向，坐标，位置  offLine 是否是断线重连\r\n    adjustGunAngleHandler(res,offLine = false){\r\n        let myid = glGame.user.userID;\r\n        if(res.uid == null){\r\n            cc.error(\">>无法确定 子弹 身份 res\",res);\r\n            return;\r\n        }\r\n        let isMe = Number(res.uid) == myid;\r\n        if(isMe && !offLine){\r\n            switch (Number(this.logic.cannonLevel)) {\r\n                case 1:\r\n                case 2:\r\n                case 3:\r\n                    glGame.emitter.emit(CONST.clientEvent.fishSound,\"attack1_3\");\r\n                    break;\r\n                case 4:\r\n                case 5:\r\n                case 6:\r\n                    glGame.emitter.emit(CONST.clientEvent.fishSound,\"attack4_6\");\r\n                    break;\r\n                case 7:\r\n                case 8:\r\n                case 9:\r\n                    glGame.emitter.emit(CONST.clientEvent.fishSound,\"attack7_9\");\r\n                    break;\r\n                case 10:\r\n                    glGame.emitter.emit(CONST.clientEvent.fishSound,\"attack10\");\r\n                    break;\r\n            }\r\n        }//普通攻击\r\n        let ui_gun        = this.ui_physicalPool.getChildByName(\"ui_gun\"+res.seatNum);\r\n        if(ui_gun == undefined){\r\n            cc.error(\">>> 找不到炮台 \",res)\r\n            return;\r\n        }\r\n        let oldAngle      = Number(ui_gun.angle + \"\");\r\n        if(res.angle != undefined){\r\n            ui_gun.angle      = res.angle;\r\n        }\r\n        let fire          = ui_gun.getChildByName(\"point_bullet\"+res.seatNum);\r\n        let worldPoint    = fire.convertToWorldSpaceAR(fire.position);\r\n        let localPoint    = this.ui_physicalPool.convertToNodeSpaceAR(worldPoint);\r\n        if(res.gunType == null){\r\n            res.gunType == 1;\r\n        }\r\n        if(res.lock != undefined && res.angle == undefined){\r\n            res.angle = this.getTargetFishAngle(res.lock,res.seatNum);\r\n            if(res.angle == null){\r\n                cc.error(this.logic.lockFishID+\"  >>> fish  fishNodeList \",this.fishNodeList,\" fishPoolData \",this.logic.fishPoolData)\r\n                res.lock = null;//解锁\r\n                if(isMe){\r\n                    this.logic.lockFishID = null;//找不到鱼解锁\r\n                    cc.error(\">>>用户自己 发射子弹 找不到鱼 \"+res.lock)\r\n                }else{\r\n                    cc.error(\">>>其他人 发射子弹 找不到鱼 \"+res.lock)\r\n                }\r\n            }\r\n        }\r\n        res.placeOfBirth  = cc.v2(localPoint.x,localPoint.y);\r\n        let tpmAngle;\r\n        if(res.seatNum == CONST.Seat.LeftTop || res.seatNum == CONST.Seat.RightTop){\r\n            tpmAngle = res.angle;\r\n        }else{\r\n            tpmAngle = -res.angle;\r\n        }\r\n        const NormalAngel = 180;\r\n        res.placeOfBirth.x += Math.sin(tpmAngle / NormalAngel * Math.PI);\r\n        res.placeOfBirth.y += Math.cos(tpmAngle / NormalAngel * Math.PI);\r\n        if(res.angle != undefined){\r\n            ui_gun.angle      = res.angle;\r\n        }\r\n        if(res.bulletId == undefined){\r\n            res.bulletId = Number(this.logic.seatNum+Date.now());\r\n        }\r\n        let playerInfo;\r\n        let currentUid;\r\n        if (isMe){\r\n            currentUid = Number(glGame.user.userID);\r\n            playerInfo = this.logic.playerInfo[currentUid];\r\n        }else{\r\n            currentUid = Number(res.uid);\r\n            playerInfo = this.logic.playerInfo[currentUid];\r\n        }\r\n        let isHaveLaser       = playerInfo.cannonAmount != null && playerInfo.cannonAmount > 0 && playerInfo.cannonType == CONST.CannonType.Laser;      // 龙息\r\n        let isHaveMissile     = playerInfo.hitMax != null       && playerInfo.cannonAmount > 0 && playerInfo.cannonType == CONST.CannonType.Missile;    // 仙剑\r\n        let isHavePartialBomb = playerInfo.cannonAmount != null && playerInfo.cannonAmount > 0 && playerInfo.cannonType == CONST.CannonType.PartialBomb;// 炎爆\r\n        let isHaveLightning   = playerInfo.cannonAmount != null && playerInfo.cannonAmount > 0 && playerInfo.cannonType == CONST.CannonType.Lightning;  // 闪电\r\n        if (!isMe || offLine){//其他玩家 或者断线重连的时候\r\n            isHaveLaser = false;\r\n            isHaveMissile = false;\r\n            isHavePartialBomb = false;\r\n            isHaveLightning = false;\r\n            switch (res.cannonType) {\r\n                case CONST.CannonType.Laser :\r\n                    isHaveLaser = true;\r\n                    break;\r\n                case CONST.CannonType.Missile :\r\n                    isHaveMissile = true;\r\n                    break;\r\n                case CONST.CannonType.PartialBomb :\r\n                    isHavePartialBomb = true;\r\n                    break;\r\n                case CONST.CannonType.Lightning :\r\n                    isHaveLightning = true;\r\n                    break;\r\n            }\r\n            this.logic[\"lastBullteType\"+res.seatNum] = res.cannonType;\r\n            }else{\r\n            this.logic[\"lastBullteType\"+res.seatNum] = playerInfo.cannonType;\r\n        }\r\n        res.isHaveMissile     = false;\r\n        res.isHavePartialBomb = false;\r\n        res.isHaveLightning   = false;\r\n        if(!offLine){\r\n            res.cannonType    =  CONST.CannonType.Normal;//先给一个普通的标签\r\n        }\r\n        if(offLine && res.cannonType == CONST.CannonType.Missile){//仙剑断线重连特殊处理\r\n            cc.error(\">> 仙剑断线重连特殊处理 ========= \",res)\r\n            isHaveMissile = true;\r\n            this.logic[\"lastBullteType\"+res.seatNum] = CONST.CannonType.Missile;\r\n            if(isMe){\r\n                this.logic.currentBullteType = CONST.CannonType.Missile;//刷新限制\r\n            }\r\n        }\r\n        let op        = CONST.CannonOpention.Normal;\r\n        let dataAngle = res.angle ? res.angle : ui_gun.angle;\r\n        if(dataAngle == undefined){\r\n            dataAngle = oldAngle;\r\n        }\r\n        //->判断是否有 特殊炮弹 如果有就优先发射 特殊炮弹\r\n        if(playerInfo != null){//找不到用户信息 就无法发射子弹\r\n            if(isHaveLaser){//龙溪炮弹 发射逻辑\r\n                if(isMe && offLine){//如果是我自己，如果是断线重连\r\n                    cc.error(\">>断线重连 不发射 龙溪 \")\r\n                    return;\r\n                }\r\n                if(isMe && this.logic.currentBullteType != CONST.CannonType.Not){\r\n                    cc.error(\">>非法发射龙溪子弹\")\r\n                    return;\r\n                }\r\n                if(isMe){\r\n                    this.logic.currentBullteType = playerInfo.cannonType;\r\n                    this.logic.isFireLaser = true;\r\n                    let CD = CONST.MaximumBulletCollisionTime;\r\n                    if(playerInfo.cannonAmount == 1){\r\n                        CD+=0.4;\r\n                    }\r\n                    //发出去的子弹不一定能有鱼碰撞，需要手动恢复\r\n                    this.scheduleOnce(()=>{\r\n                        this.logic.isFireLaser = false;\r\n                        if(this.logic.currentBullteType != CONST.CannonType.Not && this.logic.currentBullteType == CONST.CannonType.Laser){\r\n                            this.logic.currentBullteType = CONST.CannonType.Not;\r\n                            // cc.error(\"======== delete ========= 炮弹 uid \"+Number(res.seatNum))\r\n                            glGame.emitter.emit(CONST.clientEvent.clearSpecialBulletPool,res.seatNum);\r\n                        }\r\n                    },CD);\r\n                }\r\n                this.logic.specialBulletPool[res.seatNum] = res.cannonType;//根据规则：每个玩家同屏下只允许有一个特殊子弹\r\n                glGame.emitter.emit(CONST.clientEvent.fishSound,\"LaserSend\");\r\n                glGame.emitter.emit(CONST.clientEvent.onLaserDispath,{seatNum:res.seatNum,angle:dataAngle,uid:currentUid});\r\n                //龙溪不发射实体子弹，显示激光柱即可\r\n                glGame.emitter.emit(CONST.clientEvent.playFiringEffect,{seatNum:res.seatNum,gunLevel:res.gunLevel,gunType:playerInfo.cannonType});\r\n                if(playerInfo.cannonAmount == 0){\r\n                    let lastCammpmType = Number(\"\" + this.logic.playerInfo[currentUid].cannonType);//记录老的炮台类型\r\n                    this.logic.playerInfo[currentUid].cannonType = CONST.CannonType.Normal;\r\n                    glGame.emitter.emit(CONST.clientEvent.restoreCannon,{uid:currentUid,isNow:true,lastCammpmType:lastCammpmType});\r\n                }else{\r\n                    glGame.emitter.emit(CONST.clientEvent.upSpecialGunCoin, {seatNum:res.seatNum,cannonLevel:playerInfo.cannonAmount});\r\n                }\r\n                if(isMe){\r\n                    this.logic.curWaitTime = Date.now();//重置时间\r\n                    glGame.emitter.emit(CONST.clientEvent.fireSettingRecoil,{angle:res.angle,gunType:res.gunType});\r\n                }\r\n                return;\r\n            }\r\n            let isNeedSend = false;\r\n            if(isHaveMissile){//仙剑 发射前赋值\r\n                if(!offLine){//如果是我自己，如果是断线重连\r\n                    res.cannonType  = CONST.CannonType.Missile;\r\n                    res.hitMax      = Number(playerInfo.hitMax + \"\");// 仙剑最大击中鱼数量(数据拷贝赋值)\r\n                }\r\n                op         = CONST.CannonOpention.Missile;\r\n                isNeedSend = true;\r\n            }\r\n            if(isHaveLightning){//闪电 发射前赋值\r\n                if(!offLine){//如果是断线重连\r\n                    res.cannonType  =  CONST.CannonType.Lightning;\r\n                }\r\n                isNeedSend      = true;\r\n                op              = CONST.CannonOpention.Lightning;\r\n                if(isMe){\r\n                    glGame.emitter.emit(CONST.clientEvent.fishSound,\"lightningDispath\");//闪电发射\r\n                }\r\n            }\r\n            if(isHavePartialBomb){//炎爆 发射前赋值\r\n                if(!offLine){//如果是断线重连\r\n                    res.cannonType  =  CONST.CannonType.PartialBomb;\r\n                }\r\n                isNeedSend = true;\r\n                op              = CONST.CannonOpention.PartialBomb;\r\n                glGame.emitter.emit(CONST.clientEvent.fishSound,\"PartialSend\");\r\n            }\r\n            if(isNeedSend){\r\n                //特殊炮弹 数量更新\r\n                if(playerInfo.cannonAmount == 0){\r\n                    let lastCammpmType = Number(\"\" + this.logic.playerInfo[currentUid].cannonType);//记录老的炮台类型\r\n                    this.logic.playerInfo[currentUid].cannonType = CONST.CannonType.Normal;\r\n                    glGame.emitter.emit(CONST.clientEvent.restoreCannon,{uid:currentUid,isNow:true,lastCammpmType:lastCammpmType});\r\n                }else{\r\n                    glGame.emitter.emit(CONST.clientEvent.upSpecialGunCoin, {seatNum:res.seatNum,cannonLevel:playerInfo.cannonAmount});\r\n                }\r\n            }\r\n            //这是一个 子弹 可能是 普通的 可能是 特殊子弹的三个之一\r\n            let bullet;\r\n            if(this.logic.bulletPool.size() > 0){\r\n                bullet = this.logic.bulletPool.get();\r\n            }else{\r\n                bullet = cc.instantiate(this.fish_Bullet);\r\n            }\r\n            bullet.name = \"\";\r\n            let script = bullet.getComponent(\"nfish_Bullet\");\r\n            this.ui_physicalPool.addChild(bullet);\r\n            if(isHaveMissile || isHavePartialBomb || isHaveLightning) {//自己的 特殊子计数\r\n                this.logic.specialBulletPool[res.seatNum] = res.cannonType;//根据规则：每个玩家同屏下只允许有一个特殊子弹\r\n            }\r\n            if(isMe){\r\n                res.uid = glGame.user.userID;\r\n                if(isHaveMissile || isHavePartialBomb || isHaveLightning){//自己的 特殊子计数\r\n                    this.logic.currentBullteType = res.cannonType;\r\n                }else{//自己的 普通子弹计数\r\n                   if(!offLine){\r\n                        this.logic.bullteNum ++;\r\n                   }\r\n                }\r\n\r\n                if(this.logic.currentBullteType == CONST.CannonType.PartialBomb || this.logic.currentBullteType == CONST.CannonType.Lightning){//定时 解锁发射锁定 炎爆 、闪电\r\n                    const ReTime = 1;\r\n                    this.scheduleOnce(()=>{\r\n                        this.logic.currentBullteType = CONST.CannonType.Not;\r\n                    },ReTime);\r\n                }\r\n            }\r\n            glGame.emitter.emit(CONST.clientEvent.playFiringEffect,{seatNum:res.seatNum,gunLevel:res.gunLevel,gunType:res.cannonType});//开炮效果\r\n            script.initBulletAtlas(isHaveMissile ? this.missilBullet_Atlas : this.bullet_Atlas);//初始化子弹图片资源\r\n\r\n            if(isMe){\r\n                this.logic.curWaitTime = Date.now();//重置时间\r\n                glGame.emitter.emit(CONST.clientEvent.fireSettingRecoil,{angle:res.angle,gunType:res.gunType});\r\n            }\r\n\r\n            script.initBullet(res);//子弹开始运动\r\n            if(bullet.lock != null){\r\n                this.lockBulletList.push(bullet);//辅助 解锁 存储\r\n            }\r\n            if(isMe && !offLine){//只管自己的正常子弹发射发送协议 ，无权替别人的子弹发发送发射协议 走断连协议的子弹不再发 发射协议\r\n                glGame.emitter.emit(CONST.clientEvent.hiddenLocationTip);\r\n                //发送 射击\r\n                let data = {\r\n                    \"op\":op,\r\n                    \"angle\": dataAngle\r\n                };\r\n                if(op == CONST.CannonOpention.Normal){\r\n                    data[\"shellId\"] = res.bulletId;\r\n                }else{\r\n                    cc.log(\">>发射特殊子弹 发射协议 :\",data)\r\n                }\r\n                if(res.lock != null){\r\n                    data[\"fishId\"] = res.lock;\r\n                }\r\n                if(this.logic.isEnterRoom){\r\n                    glGame.gameNet.send_msg(glGame.room.getPlayerOp(glGame.scenetag.FISH2),data);//是自己就发送 射击\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //获取炮的朝向：炮口到目标鱼的角度\r\n    getTargetFishAngle(key,seatNum){\r\n        let fish = this.ui_physicalPool.getChildByName(\"\"+key);\r\n        if(fish){\r\n            let startPos = this.ui_physicalPool.getChildByName(\"ui_gun\"+seatNum).position;\r\n            return this.logic.getP1ToP2Angle(startPos,fish.position);\r\n        }else{\r\n            return null;\r\n        }\r\n    },\r\n    //鱼的死亡\r\n    onKillFishHandler(res){\r\n        const Not = -1;//无人座位\r\n        let fish = this.ui_physicalPool.getChildByName(\"\"+res.fishId);\r\n        //销毁锁定的鱼\r\n        if(fish != null){\r\n            if(this.logic.lockFishID != null && Number(this.logic.lockFishID) == Number(fish.name)){\r\n                //cc.error(\">> 解锁 1 \"+this.logic.lockFishID)\r\n                this.logic.lastLockFishID = Number(this.logic.lockFishID+\"\");\r\n                this.logic.lockFishID = null;\r\n                this.logic.lockFishIndex = null;\r\n                if(this.logic.isLockAutoChange == false){\r\n                    this.logic.isAuto = false;\r\n                    glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n                }\r\n            }\r\n        }\r\n        if(fish && fish._components != undefined && fish.getComponent(\"nfish_Unit\")) {\r\n            if (this.logic.lockFishID != null && Number(this.logic.lockFishID) == Number(res.fishId)) {\r\n                this.ui_LockCantainer.getChildByName(\"ui_Lock\" + this.logic.seatNum).active = false;\r\n            }\r\n\r\n            if(res.fishTypeId != null && res.fishTypeId == CONST.BossGodOfWealth){//财神死亡方式是快速移动出屏外\r\n                fish.getComponent(\"nfish_Unit\").quickDie(false);\r\n                //解锁\r\n                if (this.logic.lockFishID != null && Number(this.logic.lockFishID) == Number(res.fishId)) {\r\n                    this.logic.lastLockFishID = Number(this.logic.lockFishID+\"\");\r\n                    this.logic.lockFishID = null;\r\n                    this.logic.lockFishIndex = null;\r\n                    glGame.emitter.emit(CONST.clientEvent.disposeFishNode,res.fishId);\r\n                    if(this.logic.isLockAutoChange == false){\r\n                        this.logic.isAuto = false;\r\n                        glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n                    }\r\n\r\n                    this.ui_LockCantainer.getChildByName(\"ui_Lock\" + this.logic.seatNum).active = false;\r\n                }\r\n            }else{\r\n                let type = res.killType == CONST.CannonType.Lightning ? CONST.dieType3 : CONST.dieType1;\r\n                fish.getComponent(\"nfish_Unit\").death(type,res.seatNum ? res.seatNum : Not,res.delayDieTime);\r\n            }\r\n        }else {\r\n            glGame.emitter.emit(CONST.clientEvent.disposeFishNode,res.fishId);\r\n            console.warn(\"鱼的死亡>>找不到鱼\",res,\"  fishNodeList \",this.fishNodeList,\" fishPoolData \",this.logic.fishPoolData);\r\n        }\r\n    },\r\n    //检查背景音乐播放\r\n    checkBgMusicHandler(){\r\n        let currBgMusicIndex = -1;\r\n        for (let fishId in this.fishNodeList){\r\n            let item = this.fishNodeList[fishId];\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+fishId);\r\n            if(fish != null){\r\n                let fishTypeId = Number(item.fishTypeId);\r\n                if(fishTypeId == CONST.BossLavaBasalt){//仍有 熔岩玄武\r\n                    currBgMusicIndex = CONST.BossLavaBasaltBgMusic;\r\n                }\r\n                if(fishTypeId == CONST.BossSYLW){//仍有 深渊龙王\r\n                    currBgMusicIndex = CONST.BossSYLWBgMusic;\r\n                }\r\n                if(fishTypeId == CONST.BossGodOfWealth && fish._components != undefined && fish.getComponent(\"nfish_Unit\") != undefined && fish.getComponent(\"nfish_Unit\").isWellDie()){//仍有 财神\r\n                    currBgMusicIndex = CONST.BossGodOfWealthBgMusic;\r\n                }\r\n            }\r\n        }\r\n        switch (currBgMusicIndex) {\r\n            case -1 :\r\n                glGame.emitter.emit(CONST.clientEvent.fishBgSound);//播放 春夏秋冬\r\n                break;\r\n            case CONST.BossLavaBasaltBgMusic :\r\n                glGame.emitter.emit(CONST.clientEvent.fishBgSound,CONST.BossLavaBasaltBgMusic);//播放 熔岩玄武 背景声音\r\n                break;\r\n            case CONST.BossSYLWBgMusic :\r\n                glGame.emitter.emit(CONST.clientEvent.fishBgSound,CONST.BossSYLWBgMusic);//播放 深渊龙王 背景声音\r\n                break;\r\n            case CONST.BossGodOfWealthBgMusic :\r\n                glGame.emitter.emit(CONST.clientEvent.fishBgSound,CONST.BossGodOfWealthBgMusic);//播放 财神 背景声音\r\n                break;\r\n        }\r\n    },\r\n    //加鱼\r\n    addFishPoolHandler(res){\r\n        if(this.logic.quickMove){\r\n            cc.error(\"加鱼失败，正在初始化鱼潮\")\r\n            return;\r\n        }\r\n        this.initFishData(res);\r\n    },\r\n    //加鱼潮\r\n    addFishTideHandler(res){\r\n        if(this.logic.quickMove){\r\n            cc.error(\"加鱼潮失败，鱼潮处理中\")\r\n            return;\r\n        }\r\n        let tmpArray = [];\r\n        for (let id in res) {\r\n            tmpArray.push(res[id]);\r\n        }\r\n        let i = 0;\r\n        const len = Number(tmpArray.length+\"\") - 1;\r\n        this.schedule(()=>{\r\n            for (let j=0;j<10;j++){\r\n                if(tmpArray[i] != null){\r\n                    this.initFishData(tmpArray[i]);\r\n                    i++;\r\n                }\r\n            }\r\n        },0.01,len);\r\n\r\n\r\n    },\r\n    //初始化渔场\r\n    initFishPoolHandler(){\r\n        if(this.logic.quickMove){\r\n            cc.error(\"初始化渔场 遇到问题 ： 正在初始化鱼潮，无法初始化\")\r\n            return;\r\n        }\r\n        for (let id in this.logic.fishPoolData) {\r\n            let fishSetverData = this.logic.fishPoolData[id];\r\n            if(fishSetverData.used == undefined){\r\n                fishSetverData.used = Number(id + \"\");\r\n                this.initFishData(this.logic.fishPoolData[Number(id)]);\r\n            }\r\n        }\r\n    },\r\n    //初始化 鱼 数据\r\n    initFishData(fishData){\r\n        if(this.logic.quickMove){\r\n            cc.error(\"正在初始化鱼潮 稍等\")\r\n            return;\r\n        }\r\n        const ToScond = 1000;\r\n        let serverTime = fishData.serverTime == undefined ? this.logic.serverTime : fishData.serverTime;\r\n        let time = (serverTime - fishData.createTime)/ToScond;//出生时间 默认 0 断线重连 可能是 2或5或别的\r\n        let runTime = fishData.runTime;//鱼的总运行时间\r\n        if(time < (fishData.showTime + runTime)){\r\n            this.createFish(fishData);\r\n        }else{\r\n            // cc.warn(\"无法出生 id \",fishData.id,\" 出生时间 \",time,\" serverTime \",fishData.serverTime,\" createTime \",fishData.createTime,\" 运行时间 \",runTime,\" 显示时间 \",fishData.showTime,\"data:\",fishData)\r\n        }\r\n    },\r\n    //鱼工厂：实例化一条鱼\r\n    createFish(fishData){\r\n        let fishNode;\r\n        if(this.logic.fishPool.size() > 0){\r\n            fishNode = this.logic.fishPool.get();\r\n        }else{\r\n            fishNode = cc.instantiate(this.fish_Unit);\r\n        }\r\n        fishNode.name   = \"nfish_Unit\";\r\n        fishNode.parent = null;\r\n        fishNode.active = true;\r\n        fishNode.isFish = true;\r\n        this.fishNodeList[Number(fishData.id + \"\")] = JSON.parse(JSON.stringify(fishData));//数据拷贝\r\n        this.fishNodeListLenght ++;\r\n        this.ui_physicalPool.addChild(fishNode);\r\n        fishNode.getComponent(\"nfish_Unit\").initAtlas(this.fish_AtlaLists);\r\n        fishNode.getComponent(\"nfish_Unit\").initFish(fishData);\r\n    },\r\n    //刷新冰冻状态 有就冻结 没有就解冻\r\n    updateIcing(){\r\n        for (let id in this.fishNodeList){\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+id);\r\n            if(fish)fish.getComponent(\"nfish_Unit\").settingIcing(this.startRunFish);\r\n        }\r\n        if(this.startRunFish){\r\n            this._time = Date.now();\r\n        }\r\n    },\r\n    //锁定鱼\r\n    lockSelfFishHandler(fishId){\r\n        let firstNode = this.ui_physicalPool.getChildByName(`${fishId}`);\r\n        if(firstNode != null && firstNode._components != undefined && firstNode.getComponent(\"nfish_Unit\") != null){\r\n            firstNode.getComponent(\"nfish_Unit\").lockSelf();\r\n        }\r\n    },\r\n    //浪潮鱼群来了，加速死亡\r\n    seaWaveFishGroupHandler(msg){\r\n        glGame.emitter.emit(CONST.clientEvent.showFishTideTitle);\r\n        const NotHaveFish = -1;\r\n        glGame.emitter.emit(CONST.clientEvent.fishSound,\"tideComin\");//鱼潮来袭使用\r\n        let next = ()=>{\r\n            glGame.emitter.emit(CONST.clientEvent.seaWaveChangeBg,this.logic.bgIndex);\r\n            glGame.emitter.emit(CONST.clientEvent.onSurfStart);\r\n            this.logic.startFire = true;\r\n            let fishLenth = this.ui_physicalPool.childrenCount;\r\n            for (let i=0;i<fishLenth;i++){\r\n                let currNode = this.ui_physicalPool.children[i];\r\n                if(currNode != null){\r\n                    let fish_Unit = currNode.getComponent(\"nfish_Unit\");\r\n                    if(fish_Unit != null && fish_Unit.getFishID() != null){\r\n                        if(this.logic.bossIDList.indexOf(Number(currNode.name)) == NotHaveFish)////除了boss不删除 其余都删除\r\n                        {\r\n                            this.ui_physicalPool.removeChild(currNode);\r\n                            currNode.destroy();\r\n                        }\r\n                    }else if(currNode.isFish != null && this.logic.bossIDList.indexOf(Number(currNode.name)) == NotHaveFish){////除了boss不删除 其余都删除\r\n                        this.ui_physicalPool.removeChild(currNode);\r\n                        currNode.destroy();\r\n                    }\r\n                }\r\n            }\r\n            this.logic.specialFishListBorn = {};\r\n            this.logic.addTide(msg,msg.groupId);\r\n            this.logic.quickMove = false;\r\n            glGame.emitter.emit(CONST.clientEvent.addFishTide,this.logic.fishPoolData);\r\n            glGame.emitter.emit(CONST.clientEvent.hideBossConinUI);\r\n        }\r\n\r\n        const MaxUserNum = 4;\r\n        for (let i = 0; i < MaxUserNum; i++) {\r\n            let ui_lock = this.ui_LockCantainer.getChildByName(\"ui_Lock\" + i);\r\n            ui_lock.active = false;\r\n        }\r\n        const SeaWaveRunTime = 4.5;\r\n        this.scheduleOnce(next,SeaWaveRunTime);\r\n\r\n        this.logic.startFire = false;\r\n        this.logic.quickMove = true;\r\n        //除了boss不删除 其余都删除\r\n        for (let id in this.fishNodeList){\r\n            if(this.logic.bossIDList.indexOf(id) == -1){\r\n                delete this.fishNodeList[id];\r\n                this.fishNodeListLenght --;\r\n            }\r\n        }\r\n        this.logic.fishPoolData = {};\r\n        let fishLenth = this.ui_physicalPool.childrenCount;\r\n        for (let i=0;i<fishLenth;i++){\r\n            let fish_Unit = this.ui_physicalPool.children[i].getComponent(\"nfish_Unit\");\r\n            if(fish_Unit != null && fish_Unit.getFishID() != null && this.logic.bossIDList.indexOf(fish_Unit.getFishID()) == NotHaveFish){////除了boss不删除 其余都删除\r\n                fish_Unit.getComponent(\"nfish_Unit\").quickDie();\r\n            }\r\n        }\r\n    },\r\n    //删除一条鱼 id Number 类型\r\n    disposeFishNodeHandler(id){\r\n        let fData = this.fishNodeList[Number(id)];\r\n        if(fData != null){\r\n            delete this.fishNodeList[Number(id)];\r\n            this.fishNodeListLenght --;\r\n        }else{\r\n            let tmpfish = this.ui_physicalPool.getChildByName(\"\"+id);\r\n            if(tmpfish){\r\n                // tmpfish.destroy();\r\n                this.logic.fishPool.put(tmpfish);\r\n            }\r\n        }\r\n        if(this.logic != null && this.logic.fishPoolData != null && this.logic.fishPoolData.hasOwnProperty(Number(id))){\r\n            delete this.logic.fishPoolData[Number(id)];\r\n        }\r\n        glGame.emitter.emit(CONST.clientEvent.checkBgMusic);\r\n    },\r\n    //冰冻 - 开始 - 结束\r\n    onFreezeStartStopHandler(){\r\n        this.startRunFish = !this.logic.isInFreeze;\r\n        this.updateIcing();\r\n    },\r\n    //游戏循环体\r\n    update(dt){\r\n        if(window.s1 != null){\r\n            cc.error(\"fishNodeList : \",this.fishNodeList[Number(window.s1 + \"\")]);\r\n            cc.error(\"ui_physicalPool : \",this.ui_physicalPool.getChildByName(window.s1 + \"\"));\r\n            window.s1 = null\r\n        }\r\n\r\n        if(!this.logic.startFire){\r\n            return;\r\n        }\r\n        this.checkShoot(dt);\r\n        this.unLockFish(dt);\r\n        if(!this.logic.quickMove && this.logic.isLock && this.logic.lockFishID == null && this.logic.isLockAutoChange){\r\n            let lockFishId = this.findFish();\r\n            if(lockFishId){\r\n                this.logic.lockFishID = lockFishId;\r\n                cc.error(\">>----findFish---- 锁定 \"+this.logic.lockFishID);\r\n                this.logic.isAuto = true;\r\n                glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n            }\r\n        }\r\n        if(this.logic.lockFishID != undefined){\r\n            if(this.logic.quickMove){\r\n                this.logic.lockFishID = null;\r\n            }\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+this.logic.lockFishID);\r\n            if(fish == null){\r\n                this.logic.lockFishID = null;\r\n            }else{\r\n                if(this.logic.getClickArea(fish.position,fish.width,fish.height)){\r\n\r\n                }else{\r\n                    this.logic.lastLockFishID = Number(this.logic.lockFishID+\"\");\r\n                    this.logic.lockFishID = null;\r\n                    this.logic.lockFishIndex = null;\r\n                    if(this.logic.isLockAutoChange == false){\r\n                        this.logic.isAuto = false;\r\n                        glGame.emitter.emit(CONST.clientEvent.useAutoSkill);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.fireTime += dt;\r\n        if(this.fireTime > this.fireTimeFrequency){\r\n            this.fireTime = 0;\r\n            this.isFire = true;\r\n        }\r\n    },\r\n    //解锁与死亡\r\n    unLockFish(dt){\r\n        const MaxUserNum = 4;\r\n        for (let i = 0; i < MaxUserNum; i++) {\r\n            let fish;\r\n            let ui_lock = this.ui_LockCantainer.getChildByName(\"ui_Lock\"+i);\r\n            if(this.logic.seatNum == i){\r\n                if(this.logic.lockFishID != null && this.logic.startFire){\r\n                    fish = this.ui_physicalPool.getChildByName(\"\"+this.logic.lockFishID);\r\n                }else{\r\n                    ui_lock.isPlaySpined = false;\r\n                    ui_lock.active = false;\r\n                }\r\n            }\r\n            if(fish == null){\r\n                ui_lock.active = false;\r\n                ui_lock.isPlaySpined = false;\r\n            }else{\r\n                ui_lock.x = fish.x;\r\n                ui_lock.y = fish.y;\r\n                if(ui_lock.active == false){\r\n                    ui_lock.active = true;\r\n                    if(ui_lock.isPlaySpined == null ||  ui_lock.isPlaySpined == false){\r\n                        ui_lock.isPlaySpined = true;\r\n                        this.playLockSpineHandler(ui_lock);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //播放锁定动画\r\n    playLockSpineHandler(lockNode){\r\n        let ui_lock;\r\n        if(lockNode == null){\r\n            ui_lock = this.currentLockUi;\r\n            if(ui_lock)ui_lock.isPlaySpined = true;\r\n        }else{\r\n            ui_lock = lockNode;\r\n        }\r\n        if(ui_lock == undefined){\r\n            ui_lock = this.ui_LockCantainer.getChildByName(\"ui_Lock\"+this.logic.seatNum);\r\n        }\r\n        if(ui_lock.isPlaySpined == null || ui_lock.isPlaySpined == false)return;\r\n        this.currentLockUi = ui_lock;\r\n\r\n        this.logic.playSpine(ui_lock.getChildByName(\"spine\"),false,false,CONST.SpineName.LockStart,null,CONST.SpineName.LockIng,true);\r\n    },\r\n    //用户离开 解锁\r\n    leaveRoomUnLockHandler(res){\r\n        this.ui_LockCantainer.getChildByName(\"ui_Lock\"+res.seatNum);\r\n    },\r\n    //寻找一条大鱼\r\n    findFish(){\r\n        //符合条件的鱼\r\n        let fishId = 0, priorityMax = 0;\r\n        for (let id in this.fishNodeList){\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+id);\r\n            if(fish != null && fish._components != null && fish.getComponent(\"nfish_Unit\")){\r\n                let isNext = false;\r\n                if(this.logic.lastLockFishID != undefined){\r\n                    if(fish != null && Number(this.logic.lastLockFishID) != Number(fish.name)){\r\n                        isNext = true;\r\n                    }\r\n                }else if(fish != null) isNext = true;\r\n                \r\n                if(isNext){\r\n                    if(this.logic.getClickArea(fish.position,fish.width,fish.height) && this.logic.fishPoolData[Number(id)] != null){\r\n                        let fishTypeId = this.logic.fishPoolData[Number(id)].fishTypeId;\r\n                        let priority = this.logic.json_fishTable[fishTypeId].priority;\r\n                        if (priorityMax <= priority){\r\n                            priorityMax = priority;\r\n                            fishId = Number(fish.getComponent(\"nfish_Unit\").getFishID());\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return fishId > 0 ? fishId : null;\r\n    },\r\n    //特殊子弹的最后爆炸\r\n    onSpecialBulletExpHandler(res){\r\n        if(!this.logic.isEnterRoom){\r\n            if(res.offLine != null){//如果是断线重\r\n                this.logic.offLineMissileData = res;\r\n            }\r\n            return;\r\n        }\r\n        let op;\r\n        if(res.cannonType == CONST.CannonType.PartialBomb){\r\n            op = CONST.CannonOpention.PartialBombHit;\r\n            glGame.emitter.emit(CONST.clientEvent.fishSound,\"PartialBomb\");\r\n        }\r\n        if(res.cannonType == CONST.CannonType.Missile){\r\n            op = CONST.CannonOpention.MissileHit;\r\n        }\r\n        if(res.cannonType == CONST.CannonType.Lightning){\r\n            op = CONST.CannonOpention.LightningHit;\r\n        }\r\n        let killFishData =  this.getFishByRange(res.pos,res.cannonType);\r\n        if(res.cannonType == CONST.CannonType.Lightning){\r\n            this.runLightningEffect(res,killFishData.killFishList);\r\n        }\r\n        let killFishList =  killFishData.killFishList;\r\n        let posList =  killFishData.posList;\r\n        if(killFishList.length > 0){\r\n            if(res.cannonType == CONST.CannonType.PartialBomb){\r\n                this.creatpartialBombEffect(res.pos);\r\n            }else if(res.cannonType == CONST.CannonType.Missile){\r\n                //仙剑爆炸效果\r\n                this.creatoMissil(res.pos,killFishList.length+10);\r\n                //协议要求添加至少2个0\r\n                killFishList.push(0);\r\n                killFishList.push(0);\r\n            }\r\n            let pos = null;\r\n            if(res.cannonType == CONST.CannonType.Missile){\r\n                pos = res.pos;\r\n            }\r\n            this.sendHitFishData(op,killFishList,res.uid,res.pos);\r\n        }else{\r\n            if(res.cannonType == CONST.CannonType.Missile){\r\n                killFishList = [0,0];\r\n                this.sendHitFishData(op,killFishList,res.uid,res.pos);\r\n            }\r\n            //仙剑的最后爆炸是一个特效 然后 半径则是 特效的宽度 并不是多个spine 播放\r\n            if(res.cannonType == CONST.CannonType.PartialBomb){\r\n                this.creatpartialBombEffect(res.pos);\r\n            }else if(res.cannonType == CONST.CannonType.Missile){\r\n                this.creatoMissil(res.pos,10);\r\n            }\r\n        }\r\n    },\r\n    //创建仙剑\r\n    creatoMissil(pos,num){\r\n        const Harf             = 50;\r\n        const EffectOffsexX    = 100;\r\n        const EffectOffsexY    = 100;\r\n        const EffectPosOffsexX = 200;\r\n        const EffectPosOffsexY = 200;\r\n        for (let i=0;i<num;i++){\r\n            let Xdirection = Math.random() * EffectOffsexX > Harf ? 1: -1;\r\n            let Ydirection = Math.random() * EffectOffsexY > Harf ? 1: -1;\r\n            this.creatBoomEffect(cc.v2(pos.x + (Math.random() * EffectPosOffsexX * Xdirection),pos.y + (Math.random() * EffectPosOffsexY * Ydirection)));\r\n        }\r\n    },\r\n    //特殊子弹 仙剑炸弹、闪电、炎爆炸弹 的碰撞 协议\r\n    sendHitFishData(op,killFishList,uid,pos){\r\n        let hitFishData = {\r\n            \"op\":op,\r\n            \"fishIds\": killFishList\r\n        };\r\n        if(Number(uid) != glGame.user.userID){\r\n            hitFishData[\"uid\"] = uid;\r\n            cc.log(\">> 其他人 特殊子弹的碰撞 : \",hitFishData);\r\n        }\r\n        if(pos != null){\r\n            hitFishData[\"pos\"] = {x:pos.x,y:pos.y};\r\n        }else{\r\n            hitFishData[\"pos\"] = {x:0,y:0};\r\n        }\r\n        if(this.logic.isEnterRoom){\r\n            cc.log(\"--==-->发送 特殊子弹 仙剑炸弹、闪电、炎爆炸弹 的碰撞 \",hitFishData);\r\n            cc.warn(\"======== 发送特殊子弹的碰撞 \",hitFishData);\r\n            glGame.gameNet.send_msg(glGame.room.getPlayerOp(glGame.scenetag.FISH2),hitFishData);//子弹碰撞\r\n        }\r\n    },\r\n    //设置旋转\r\n    changeCantainerHandler(){\r\n        cc.warn(\">> 角度旋转180  changeCantainerHandler\")\r\n        this.logic.isNeedSet180Angle(this.node);\r\n    },\r\n    //熔岩玄武 全屏爆炸\r\n    onSpecialBombHandler(res){\r\n        this.scheduleOnce(()=>{\r\n            glGame.emitter.emit(CONST.clientEvent.fishSound,\"rongYanBossBoom\");//熔岩玄武爆炸\r\n        },0.5);\r\n        if(this.logic.seatNum == Number(res.seatNum)) {\r\n            glGame.emitter.emit(CONST.clientEvent.fishSound, \"rongYanBossDie\");//熔岩玄武死亡\r\n        }\r\n        if(res.fishTypeId == CONST.BossLavaBasalt){\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+res.fishId);\r\n            if (fish) {\r\n                this.creatRongYanBoomEffect(fish.position);\r\n            }\r\n        }\r\n    },\r\n    //创建一个炸弹动画效果，传入一个坐标\r\n    creatBoomEffect(pos){\r\n        let missileEffect    = cc.instantiate(this.node.getChildByName(\"missileEffect\"));\r\n        missileEffect.active = true;\r\n        missileEffect.opacity = 0;\r\n        missileEffect.zIndex = CONST.nodeZIndex.zIndexAni;\r\n        if(this.logic.getIsRotation()){\r\n            missileEffect.angle = 180;\r\n        }\r\n        this.ui_physicalPool.addChild(missileEffect);\r\n        missileEffect.position = pos;\r\n        missileEffect.runAction(cc.sequence(cc.delayTime(Math.random()),cc.callFunc(()=>{\r\n            missileEffect.opacity = 255;\r\n            this.logic.playSpine(missileEffect,false,false,CONST.SpineName.Normal,()=>{\r\n                missileEffect.destroy();\r\n            });\r\n        })));\r\n    },\r\n    //创建一个熔岩玄武炸弹\r\n    creatRongYanBoomEffect(pos){\r\n        let specialBoomEffect = cc.instantiate(this.node.getChildByName(\"spine_RongYan\"));\r\n        specialBoomEffect.active   = true;\r\n        specialBoomEffect.position = pos;\r\n        this.ui_physicalPool.addChild(specialBoomEffect);\r\n        this.logic.playSpine(specialBoomEffect,false,false,CONST.SpineName.Normal,()=>{\r\n            specialBoomEffect.destroy();\r\n            glGame.emitter.emit(CONST.clientEvent.checkBgMusic);\r\n        });\r\n    },\r\n    //创建一个 炎爆炸弹动爆炸画效果 pos 爆炸中心点\r\n    creatpartialBombEffect(pos){\r\n        let specialBoomEffect = cc.instantiate(this.partialBombEffect);\r\n        specialBoomEffect.position = pos;\r\n        this.ui_physicalPool.addChild(specialBoomEffect);\r\n        this.logic.playSpine(specialBoomEffect,false,false,CONST.SpineName.Normal,()=>{\r\n            specialBoomEffect.destroy();\r\n        });\r\n    },\r\n    //播放闪电效果\r\n    runLightningEffect(res,killFishArr){\r\n        let myid = glGame.user.userID;\r\n        if(res.uid == myid){\r\n            glGame.emitter.emit(CONST.clientEvent.fishSound,\"lightningHit\");//闪电击中鱼\r\n        }\r\n        let len = killFishArr.length;\r\n        let nextFishPos = {};\r\n        const Gap = 0.1;\r\n        for (let i = 0; i < len; i++) {\r\n            let fishID         = killFishArr[i];\r\n            let next_fishID    = killFishArr[i+1];\r\n            let fishNode = this.ui_physicalPool.getChildByName(\"\"+fishID);\r\n            if(fishNode == null)continue;\r\n            let next_fishNode = null;\r\n            if(next_fishID != null) {\r\n                next_fishNode = this.ui_physicalPool.getChildByName(\"\"+next_fishID);\r\n            }\r\n            if (next_fishNode) {\r\n                nextFishPos.pos         = next_fishNode.position;\r\n                nextFishPos.no          = next_fishNode.no;\r\n            }\r\n            let mag = 0;\r\n            if(next_fishNode){\r\n                let specialEffect       = this.logic.creatorEffect();\r\n                specialEffect.parent    = null;\r\n                specialEffect.active    = true;\r\n                specialEffect.name      = \"lightning_\"+i;\r\n                specialEffect.zIndex    = CONST.nodeZIndex.zIndexAllBoom + i;\r\n                this.ui_physicalPool.addChild(specialEffect);\r\n                let temp                = fishNode.position.sub(nextFishPos.pos);\r\n                specialEffect.anchorX   = 0;\r\n                specialEffect.x         = fishNode.x;\r\n                specialEffect.y         = fishNode.y;\r\n                specialEffect.angle     = this.logic.setAngle(nextFishPos.pos.x,nextFishPos.pos.y,fishNode.position.x,fishNode.position.y);\r\n                mag = temp.mag();//距离\r\n                let scale = mag/CONST.LightningW;\r\n                let h = scale*CONST.LightningH;\r\n                specialEffect.width = mag;\r\n                let endH = h > CONST.LightningH ? CONST.LightningH : h;\r\n                // cc.error(\">> 闪电宽度 \",w,\" 高度 \",endH)\r\n                specialEffect.height = CONST.LightningH;\r\n                // specialEffect.height = CONST.LightningH;\r\n                const EffectImage    = \"img_shandian\";\r\n                const Begin          = 1;\r\n                const End            = 8;\r\n                const Loop           = 1;\r\n                const IsHaveZero     = false;\r\n                const Speed          = 0.12;\r\n                const PlayedRemove   = true;\r\n                specialEffect.getComponent(\"nfish_MovieClip\").initEffect(this.explosionAndLightning_Atlas,EffectImage,Begin,End,Loop,IsHaveZero,Speed,PlayedRemove,null,0,mag,h,i*Gap);\r\n            }\r\n            this.creatEffectBluePointLight(fishNode.x,fishNode.y,i,i*Gap,mag);\r\n        }\r\n    },\r\n    //创建一个 蓝光闪现 动画\r\n    creatEffectBluePointLight(x,y,i,mag){\r\n        let specialEffect  = this.logic.creatorEffect();\r\n        specialEffect.parent = null;\r\n        specialEffect.active = true;\r\n        if(mag > cc.winSize.height/3 && mag < cc.winSize.height/2){\r\n            specialEffect.scale  = 5.8;\r\n        }else if(mag > cc.winSize.height/2 && mag < cc.winSize.height){\r\n            specialEffect.scale  = 6.8;\r\n        }else{\r\n            specialEffect.scale  = 4.5;\r\n        }\r\n        specialEffect.zIndex = CONST.nodeZIndex.zIndexAni + i*3;\r\n        this.ui_physicalPool.addChild(specialEffect);\r\n        specialEffect.x = x;\r\n        specialEffect.y = y;\r\n\r\n        const EffectImage  = \"img_shandian_ball\";\r\n        const Begin        = 1;\r\n        const End          = 7;\r\n        const Loop         = 2;\r\n        const IsHaveZero   = false;\r\n        const Speed        = 0.072;\r\n        const PlayedRemove = true;\r\n        specialEffect.getComponent(\"nfish_MovieClip\").initEffect(this.explosionAndLightning_Atlas,EffectImage,Begin,End,Loop,IsHaveZero,Speed,PlayedRemove);\r\n    },\r\n    //获取金币\r\n    getCoin(res){\r\n        let rewardGold  = Math.floor(res.rewardGold / res.killFishArr.length);\r\n        let tmpList = [];\r\n        for (let i = 0; i < res.killFishArr.length; i++) {\r\n            let fishKey = res.killFishArr[i].fishLineID;\r\n            let fishNode = this.ui_physicalPool.getChildByName(\"\"+fishKey);\r\n            if(fishNode){\r\n                let item         = {};\r\n                item.rewardGold  = rewardGold;\r\n                item.seatNum     = res.seatNum;\r\n                item.uid         = res.uid;\r\n                item.position    = fishNode.position;\r\n                item.multiple    = this.logic.getRandomNum(0,100);\r\n                tmpList.push(item);\r\n            }\r\n        }\r\n        const GetRunCoinTime = 1;\r\n        this.scheduleOnce(()=>{\r\n            for (let i = 0; i < tmpList.length; i++) {\r\n                glGame.emitter.emit(CONST.clientEvent.playCoinEffect,tmpList[i]);\r\n            }\r\n        },GetRunCoinTime);\r\n    },\r\n    //获取id鱼的范围内的鱼\r\n    getFishByRange(pos,cannonType) {\r\n        if(!this.logic.isEnterRoom){\r\n            return;\r\n        }\r\n        let killFishList = [];\r\n        let posList = [];\r\n        let radius = 0;\r\n        if(cannonType == CONST.CannonType.Lightning){\r\n            posList.push(pos);\r\n            radius =  Number(this.logic.roomRule.LightningRadius);// 闪电炮弹产生的连锁闪电的连锁目标半径范围（单位：像素）\r\n        }\r\n        if(cannonType == CONST.CannonType.PartialBomb){\r\n            posList.push(pos);\r\n            radius =  Number(this.logic.roomRule.ExplodeRadius);// 炎爆炮弹的爆炸效果半径范围（单位：像素）\r\n        }\r\n        if(cannonType == CONST.CannonType.Missile){\r\n            radius =  Number(this.logic.roomRule.ExcaliburRadius);// 仙剑爆炸时的爆炸半径范围（单位：像素）\r\n        }\r\n        const All = 100;\r\n        const Haf = 50;\r\n        for (let id in this.fishNodeList) {\r\n            let fish = this.ui_physicalPool.getChildByName(\"\"+id);\r\n            if (fish && Math.abs(fish.x) < cc.winSize.width/2 && Math.abs(fish.y) < cc.winSize.height/2) {\r\n                let curr = Math.random() * All;\r\n                let fishUnit = fish.getComponent(\"nfish_Unit\");\r\n                if(fishUnit){\r\n                    let dis = this.getDistanceTwoPoint(pos, fish);//计算距离\r\n                    if(cannonType == CONST.CannonType.Lightning){\r\n                        if (curr < Haf && posList.length <= Number(this.logic.roomRule.LightningMaxFish)) {\r\n                            killFishList.push(fishUnit.getFishID());\r\n                            posList.push(cc.v2(fish.x,fish.y));\r\n                        }\r\n                    }else{\r\n                        if (dis <= radius) {\r\n                            killFishList.push(fishUnit.getFishID());\r\n                            posList.push(cc.v2(fish.x,fish.y));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return {killFishList:killFishList,posList:posList};\r\n    },\r\n    //计算距离\r\n    getDistanceTwoPoint(node1, node2) {\r\n        const OffsexY = 2;\r\n        return Math.sqrt(Math.pow(node1.x - node2.x, OffsexY) + Math.pow(node1.y - node2.y, OffsexY))\r\n    },\r\n    //点击所有按钮\r\n    onClick(name, node){\r\n        switch(name){\r\n            case \"ui_bg\":return this.menuOptionViewHandler();\r\n            default: console.error(\"no find button name -> %s\", name);\r\n        }\r\n    },\r\n    //打开\r\n    menuOptionViewHandler(res){\r\n        this.node.active = true;\r\n    },\r\n    //锁定\r\n    useAutoSkillHandler(){\r\n        const LockTime = 0.2;\r\n        this.autoShootTime = LockTime;\r\n    },\r\n    //震动 - 通用震动库\r\n    onShockHandler(){\r\n        if(this.isSshockIng)return;\r\n        const SshockTime = 0.8;\r\n        this.isSshockIng = true;\r\n        this.oldPos = this.node.position;\r\n        this.node.getComponent(cc.Widget).enabled = false;\r\n        this.node.runAction(cc.repeatForever(cc.sequence(cc.moveTo(0.02, cc.v2(this.oldPos.x+5, this.oldPos.y+7)), cc.moveTo(0.02, cc.v2(this.oldPos.x-6, this.oldPos.y+7)),    cc.moveTo(0.02, cc.v2(this.oldPos.x-13, this.oldPos.y+3)), cc.moveTo(0.02, cc.v2(this.oldPos.x+3, this.oldPos.y-6)),    cc.moveTo(0.02, cc.v2(this.oldPos.x-5, this.oldPos.y+5)), cc.moveTo(0.02, cc.v2(this.oldPos.x+2, this.oldPos.y-8)),    cc.moveTo(0.02, cc.v2(this.oldPos.x-8, this.oldPos.y-10)), cc.moveTo(0.02, cc.v2(this.oldPos.x+3, this.oldPos.y+10)),    cc.moveTo(0.02, cc.v2(this.oldPos.x+0, this.oldPos.y+0)))));\r\n        this.scheduleOnce(() => {\r\n            this.node.stopAllActions();\r\n            this.node.setPosition(this.oldPos);\r\n            this.node.getComponent(cc.Widget).enabled = true;\r\n            this.isSshockIng = false;\r\n        }, SshockTime);\r\n    },\r\n    //销毁\r\n    OnDestroy() {\r\n        this.unscheduleAllCallbacks();\r\n        this.unregisterEvent();\r\n        this.fishNodeList    = null;\r\n        this.fishNodeListLenght = 0;\r\n        this.startRunFish    = false;\r\n        this.logic           = null;\r\n        this.ui_physicalPool = null;\r\n    },\r\n});"]}