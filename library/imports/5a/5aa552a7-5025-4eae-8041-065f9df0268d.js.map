{"version":3,"sources":["assets\\frames\\model\\logon.js"],"names":["PROCESS_STATE","normal","maintain","close","STATE","open","CHECK_TYPE","game","platform","NetCode","LoginFromOtherDevice","KickPlayer","EmergencyMaintenance","Logon","registerEvent","resetData","logon","prototype","g_instance","serverCfg","_webRootUrl","_uid","connector_host","connector_port","b_switchAccount","verifiCD","logondata","loginupdata","isUpdatePlaza","pomeloConnect","glGame","emitter","on","MESSAGE","UPDATE_SERVER_CFG","onUpdateServerCfg","NETWORK","POMELO","ENTER_PLAT","connector_entryHandler_enterPlat","checkIP","obj","ip","indexOf","replace","toLowerCase","slice","length","exp","num","index","reg","match","servercfg","getServerCfg","host","port","gameNet","setWebHost","reqWxLogin","msg","gameSvrTag","plat","imei","getMachineCode","phone_version","getPhoneVersion","phone_model","getPhoneModel","phone_type","getPhoneType","password","md5","cc","sys","isNative","registration_id","getRegisID","isAutoLogin","storage","setItem","pd","username","le","String","RegisterFirst","getItem","user","reqUrl","getOpenInstall","send_msg","loginNext","bind","reqAccLogin","firstlogin","panel","showlimitJuhua","reqPhoneLogin","code","getVisitorData","Date","now","Math","random","toString","visitorCache","necessary","isLegal","every","prop","substr","removeItemByKey","reqTouLogin","VisitorFirst","reqDevelopTouLogin","autoLogin","loginCache","machineCode","phoneType","phoneVersion","getSystemVersion","os","OS_ANDROID","OS_IOS","getChannelData","text","getClipText","list","split","datalist","key","data","routeadress","promote","id","channel","type","isAndroid","channelData","isIos","getinstallCB","appData","player_id","channel_type","bindData","route","reqRegisterNext","JSON","parse","oiSdk","getInstall","reqRegister","psw","acc","reqPhoneRegister","phone","recordLoinData","bindAgent","myInfoData","myInfo","isTourist","grade_id","registerGetCoin","registerDiamond","registerGetDiamond","get","loginPomelo","ReqGameState","gameid","next","model","checkType","tip_txt","state","processState","showMsgBox","director","getScene","name","reStartGame","reqRegisterConfig","log","showJuHua","hidejuhua","RegisterConfig","emit","USER","REGISTER_CFG","isRegister","isfirstEnterPlaza","uid","getNetMgr","setLoginInfo","PODOT_ON","connect","connectConnector","enterPlat","defaultBindData","event_type","event","pomeloConnected","clearPomeloReqs","room","setServerGameId","pomeloDisconnected","platDisconnect","kicked","LOGIN","TOURIST_SUCCESS","ACCOUNT_SUCCESS","token","getLoginToken","loginPlat","platSucceed","reqMyRoomState","reason","logOutTo","offWebView","tips","LOGON","NETERROR","LOGINREPEAT","reLogon","logout","destroy","UI","WEBVIEW_OFF","changeOrientation","systemclass","offSuspension","set","value","module","exports"],"mappings":";;;;;;AAAA,IAAIA,aAAa,GAAG;AAChBC,EAAAA,MAAM,EAAE,CADQ;AAEhBC,EAAAA,QAAQ,EAAE,CAFM;AAGhBC,EAAAA,KAAK,EAAE;AAHS,CAApB;AAKA,IAAIC,KAAK,GAAG;AACRC,EAAAA,IAAI,EAAE,CADE;AAERF,EAAAA,KAAK,EAAE;AAFC,CAAZ;AAIA,IAAIG,UAAU,GAAG;AACbC,EAAAA,IAAI,EAAE,CADO;AAEbC,EAAAA,QAAQ,EAAE;AAFG,CAAjB;AAKA;;;;AAGA,IAAIC,OAAO,GAAG;AACVC,EAAAA,oBAAoB,EAAE,QADZ;AACsB;AAChCC,EAAAA,UAAU,EAAE,QAFF;AAEY;AACtBC,EAAAA,oBAAoB,EAAE,QAHZ,CAGsB;;AAHtB,CAAd;AAAA,IAKIC,KAAK,GAAG,SAARA,KAAQ,GAAY;AAChB,OAAKC,aAAL;AACA,OAAKC,SAAL;AACH,CARL;AAAA,IASIC,KAAK,GAAGH,KAAK,CAACI,SATlB;AAAA,IAUIC,UAAU,GAAG,IAVjB;AAYA;;;;;AAGAF,KAAK,CAACD,SAAN,GAAkB,YAAY;AAC1B,OAAKI,SAAL,GAAiB,IAAjB;AACA,OAAKC,WAAL,GAAmB,IAAnB;AACA,OAAKC,IAAL,GAAY,IAAZ;AACA,OAAKC,cAAL,GAAsB,IAAtB;AACA,OAAKC,cAAL,GAAsB,IAAtB;AACA,OAAKC,eAAL,GAAuB,IAAvB;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAKC,SAAL,GAAiB,IAAjB;AACA,OAAKC,WAAL,GAAmB,KAAnB;AACA,OAAKC,aAAL,GAAqB,KAArB;AACA,OAAKC,aAAL,GAAqB,KAArB;AACH,CAZD;AAaA;;;;;;;AAKAb,KAAK,CAACF,aAAN,GAAsB,YAAY;AAC9BgB,EAAAA,MAAM,CAACC,OAAP,CAAeC,EAAf,CAAkBC,OAAO,CAACC,iBAA1B,EAA6C,KAAKC,iBAAlD,EAAqE,IAArE;AACAL,EAAAA,MAAM,CAACC,OAAP,CAAeC,EAAf,CAAkBI,OAAO,CAACC,MAAR,CAAeC,UAAjC,EAA6C,KAAKC,gCAAlD,EAAoF,IAApF;AACH,CAHD;AAKA;;;;;;AAIAvB,KAAK,CAACwB,OAAN,GAAgB,UAAUC,GAAV,EAAe;AAC3B,MAAIC,EAAE,GAAGD,GAAT;;AACA,MAAIC,EAAE,CAACC,OAAH,CAAW,GAAX,KAAmB,CAAvB,EAA0B;AACtBD,IAAAA,EAAE,GAAGA,EAAE,CAACE,OAAH,CAAW,IAAX,EAAiB,EAAjB,CAAL;AACH;;AACD,MAAIF,EAAE,CAACG,WAAH,GAAiBF,OAAjB,CAAyB,SAAzB,KAAuC,CAA3C,EAA8C;AAC1CD,IAAAA,EAAE,GAAGA,EAAE,CAACI,KAAH,CAAS,CAAT,CAAL;AACH;;AACD,MAAIJ,EAAE,CAACG,WAAH,GAAiBF,OAAjB,CAAyB,UAAzB,KAAwC,CAA5C,EAA+C;AAC3CD,IAAAA,EAAE,GAAGA,EAAE,CAACI,KAAH,CAAS,CAAT,CAAL;AACH;;AACD,MAAIJ,EAAE,CAACI,KAAH,CAASJ,EAAE,CAACK,MAAH,GAAY,CAArB,KAA2B,GAA/B,EAAoC;AAChCL,IAAAA,EAAE,GAAGA,EAAE,CAACI,KAAH,CAAS,CAAT,EAAYJ,EAAE,CAACK,MAAH,GAAY,CAAxB,CAAL;AACH;;AACD,MAAIC,GAAG,GAAG,IAAV;AACA,MAAIC,GAAG,GAAG,CAAV,CAf2B,CAgB3B;;AACA,OAAK,IAAIC,KAAT,IAAkBR,EAAlB,EAAsB;AAAEA,IAAAA,EAAE,CAACQ,KAAD,CAAF,KAAc,GAAd,GAAoBD,GAAG,EAAvB,GAA4B,CAA5B;AAAgC;;AACxD,MAAIA,GAAG,IAAI,CAAX,EACID,GAAG,GAAG,0IAAN,CADJ,KAGIA,GAAG,GAAG,8MAAN;AACJ,MAAIG,GAAG,GAAGT,EAAE,CAACU,KAAH,CAASJ,GAAT,CAAV;AACA,MAAIG,GAAG,IAAI,IAAX,EAAiB,OAAO,KAAP,CAAjB,CAA8B;AAA9B,OACK,OAAO,IAAP,CAxBsB,CAwBT;AACrB,CAzBD;AA2BA;;;;;AAGAnC,KAAK,CAACmB,iBAAN,GAA0B,YAAY;AAClC,OAAKhB,SAAL,GAAiBW,MAAM,CAACuB,SAAP,CAAiBC,YAAjB,EAAjB;AACA,MAAIC,IAAI,GAAG,KAAKpC,SAAL,CAAe,aAAf,CAAX;AAAA,MACIqC,IAAI,GAAG,KAAKrC,SAAL,CAAe,aAAf,CADX;AAGA,MAAIoC,IAAI,CAACV,WAAL,GAAmBF,OAAnB,CAA2B,UAA3B,KAA0C,CAA1C,IAA+CY,IAAI,CAACV,WAAL,GAAmBF,OAAnB,CAA2B,SAA3B,KAAyC,CAA5F,EAA+F,KAAKvB,WAAL,GAAmBmC,IAAnB,CAA/F,KACK,KAAKnC,WAAL,oBAA6BmC,IAA7B;AAEL,MAAIC,IAAI,GAAG,CAAX,EAAc,KAAKpC,WAAL,aAAsB,KAAKA,WAA3B,cAA0CoC,IAA1C;AACd1B,EAAAA,MAAM,CAAC2B,OAAP,CAAeC,UAAf,CAA0B,KAAKtC,WAA/B;AACH,CAVD;AAWA;;;;;;AAIAJ,KAAK,CAAC2C,UAAN,GAAmB,UAAUC,GAAV,EAAe;AAC9BA,EAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,EAAAA,GAAG,CAACE,IAAJ,GAAW,CAAX;AACAF,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,EAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB;AACAN,EAAAA,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EAAlB;AACAR,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACAV,EAAAA,GAAG,CAACW,QAAJ,GAAeC,GAAG,CAAC,QAAD,CAAlB;;AACA,MAAIC,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjBf,IAAAA,GAAG,CAACgB,eAAJ,GAAsB9C,MAAM,CAACtB,QAAP,CAAgBqE,UAAhB,EAAtB;AACH;;AACD,OAAKC,WAAL,GAAmB,KAAnB;AACA,OAAKlD,aAAL,GAAqB,IAArB;AACAE,EAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,YAAvB,EAAqC;AAAElB,IAAAA,IAAI,EAAE,CAAR;AAAWmB,IAAAA,EAAE,EAAErB,GAAG,CAACsB,QAAJ,GAAetB,GAAG,CAACsB,QAAlC;AAA4CC,IAAAA,EAAE,EAAEC,MAAM,CAACxB,GAAG,CAACsB,QAAL,CAAN,CAAqBnC;AAArE,GAArC;AACA,MAAIsC,aAAa,GAAGvD,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,eAAvB,CAApB;AACAxD,EAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;;AACA,MAAI,CAACH,aAAD,IAAkBZ,EAAE,CAACC,GAAH,CAAOC,QAA7B,EAAuC;AACnC,SAAKc,cAAL,CAAoB7B,GAApB,EAAyB,eAAzB;AACA9B,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,eAAvB,EAAwC,EAAxC;AACA;AACH;;AACDlD,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AACH,CAtBD;AAuBA;;;;;;AAIA5E,KAAK,CAAC6E,WAAN,GAAoB,UAAUjC,GAAV,EAAe;AAC/B,OAAKkC,UAAL,GAAkB,KAAlB,CAD+B,CACP;;AACxBlC,EAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,EAAAA,GAAG,CAACE,IAAJ,GAAW,CAAX;AACAF,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,EAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB;AACAN,EAAAA,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EAAlB;AACAR,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACA,OAAK5C,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBS,IAAAA,QAAQ,EAAEX,GAAG,CAACW,QAAhC;AAA0CW,IAAAA,QAAQ,EAAEtB,GAAG,CAACsB;AAAxD,GAAjB;AACA,OAAKJ,WAAL,GAAmB,KAAnB;AACA,OAAKlD,aAAL,GAAqB,IAArB;AACAgC,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACAxC,EAAAA,MAAM,CAACiE,KAAP,CAAaC,cAAb;AACAlE,EAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;AACA1D,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AACH,CAfD;AAgBA;;;;;;AAIA5E,KAAK,CAACiF,aAAN,GAAsB,UAAUrC,GAAV,EAAe;AACjC,OAAKkC,UAAL,GAAkB,KAAlB,CADiC,CACT;;AACxBlC,EAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,EAAAA,GAAG,CAACE,IAAJ,GAAW,CAAX;AACAF,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,EAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB;AACAN,EAAAA,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EAAlB;AACAR,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACA,OAAK5C,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBoC,IAAAA,IAAI,EAAEtC,GAAG,CAACsC,IAA5B;AAAkChB,IAAAA,QAAQ,EAAEtB,GAAG,CAACsB;AAAhD,GAAjB;AACA,OAAKJ,WAAL,GAAmB,KAAnB;AACA,OAAKlD,aAAL,GAAqB,IAArB;AACAgC,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACAxC,EAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;AACA1D,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AACH,CAdD;AAeA;;;;;AAGA5E,KAAK,CAACmF,cAAN,GAAuB,YAAY;AAC/B,MAAIvC,GAAG,GAAG;AACNC,IAAAA,UAAU,EAAE,KAAK1C,SAAL,CAAe0C,UADrB;AAENC,IAAAA,IAAI,EAAE,CAFA;AAGNoB,IAAAA,QAAQ,EAAE,KAAKkB,IAAI,CAACC,GAAL,EAAL,GAAkBC,IAAI,CAACC,MAAL,EAHtB;AAINhC,IAAAA,QAAQ,EAAEC,GAAG,CAAC4B,IAAI,CAACC,GAAL,GAAWG,QAAX,EAAD,CAJP;AAKNzC,IAAAA,IAAI,EAAE,KAAKC,cAAL,EALA;AAMNC,IAAAA,aAAa,EAAE,KAAKC,eAAL,EANT;AAONC,IAAAA,WAAW,EAAE,KAAKC,aAAL,EAPP;AAQNC,IAAAA,UAAU,EAAE,KAAKC,YAAL;AARN,GAAV;AAUA,MAAImC,YAAY,GAAG3E,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,cAAvB,CAAnB;;AACA,MAAImB,YAAJ,EAAkB;AACd;AACA,QAAIC,SAAS,GAAG,CAAC,MAAD,EAAS,IAAT,EAAe,IAAf,CAAhB;AACA,QAAIC,OAAO,GAAGD,SAAS,CAACE,KAAV,CAAgB,UAAAC,IAAI,EAAI;AAClC,aAAO,OAAOJ,YAAY,CAACI,IAAD,CAAnB,KAA8B,WAA9B,IAA6CJ,YAAY,CAACI,IAAD,CAAZ,KAAuB,IAA3E;AACH,KAFa,CAAd;;AAGA,QAAIF,OAAJ,EAAa;AACT/C,MAAAA,GAAG,CAACsB,QAAJ,GAAeuB,YAAY,CAACxB,EAAb,CAAgB6B,MAAhB,CAAuB,CAACL,YAAY,CAACtB,EAArC,CAAf;AACAvB,MAAAA,GAAG,CAACW,QAAJ,GAAekC,YAAY,CAACxB,EAAb,CAAgB6B,MAAhB,CAAuB,CAAvB,EAA0BL,YAAY,CAACxB,EAAb,CAAgBlC,MAAhB,GAAyB0D,YAAY,CAACtB,EAAhE,CAAf;AACAvB,MAAAA,GAAG,CAACE,IAAJ,GAAW2C,YAAY,CAAC3C,IAAxB;AACH,KAJD,MAIO;AACHhC,MAAAA,MAAM,CAACiD,OAAP,CAAegC,eAAf,CAA+B,cAA/B;AACAjF,MAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,cAAvB,EAAuC;AAAElB,QAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBmB,QAAAA,EAAE,EAAErB,GAAG,CAACW,QAAJ,GAAeX,GAAG,CAACsB,QAAzC;AAAmDC,QAAAA,EAAE,EAAEC,MAAM,CAACxB,GAAG,CAACsB,QAAL,CAAN,CAAqBnC;AAA5E,OAAvC;AACH;AACJ,GAdD,MAcO;AACHjB,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,cAAvB,EAAuC;AAAElB,MAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBmB,MAAAA,EAAE,EAAErB,GAAG,CAACW,QAAJ,GAAeX,GAAG,CAACsB,QAAzC;AAAmDC,MAAAA,EAAE,EAAEC,MAAM,CAACxB,GAAG,CAACsB,QAAL,CAAN,CAAqBnC;AAA5E,KAAvC;AACH;;AACD,SAAOa,GAAP;AACH,CA9BD;AAgCA;;;;;AAGA5C,KAAK,CAACgG,WAAN,GAAoB,YAAY;AAC5B,MAAIpD,GAAG,GAAG,KAAKuC,cAAL,EAAV;;AACA,MAAI1B,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjBf,IAAAA,GAAG,CAACgB,eAAJ,GAAsB9C,MAAM,CAACtB,QAAP,CAAgBqE,UAAhB,EAAtB;AACH;;AACD,OAAKnD,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBS,IAAAA,QAAQ,EAAEX,GAAG,CAACW,QAAhC;AAA0CW,IAAAA,QAAQ,EAAEtB,GAAG,CAACsB;AAAxD,GAAjB;AACA,OAAKJ,WAAL,GAAmB,KAAnB;AACA,OAAKlD,aAAL,GAAqB,IAArB;AACA,MAAIqF,YAAY,GAAGnF,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,cAAvB,CAAnB,CAR4B,CAQ6B;;AACzDxD,EAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;;AACA,MAAI,CAACyB,YAAD,IAAiBxC,EAAE,CAACC,GAAH,CAAOC,QAA5B,EAAsC;AAClC,SAAKc,cAAL,CAAoB7B,GAApB,EAAyB,eAAzB;AACA9B,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,cAAvB,EAAuC,EAAvC;AACA;AACH;;AACDlD,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AACH,CAhBD;AAiBA;;;;;AAGA5E,KAAK,CAACkG,kBAAN,GAA2B,UAAUtD,GAAV,EAAe;AACtCA,EAAAA,GAAG,CAACW,QAAJ,GAAeC,GAAG,CAAC,QAAD,CAAlB;AACAZ,EAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,EAAAA,GAAG,CAACE,IAAJ,GAAW,CAAX;AACAF,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACA,OAAKtC,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBS,IAAAA,QAAQ,EAAEX,GAAG,CAACW,QAAhC;AAA0CW,IAAAA,QAAQ,EAAEtB,GAAG,CAACsB;AAAxD,GAAjB;AACA,OAAKJ,WAAL,GAAmB,KAAnB;AACAlB,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;AACAxC,EAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;AACA1D,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AAEH,CAXD;AAYA;;;;;AAGA5E,KAAK,CAACmG,SAAN,GAAkB,YAAY;AAC1B,MAAIC,UAAU,GAAGtF,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,YAAvB,CAAjB;;AACA,MAAI8B,UAAJ,EAAgB;AACZ;AACA,QAAIV,SAAS,GAAG,CAAC,MAAD,EAAS,IAAT,EAAe,IAAf,CAAhB;AACA,QAAIC,OAAO,GAAGD,SAAS,CAACE,KAAV,CAAgB,UAAAC,IAAI,EAAI;AAAE,aAAO,OAAOO,UAAU,CAACP,IAAD,CAAjB,KAA4B,WAA5B,IAA2CO,UAAU,CAACP,IAAD,CAAV,KAAqB,IAAvE;AAA8E,KAAxG,CAAd;;AACA,QAAIF,OAAJ,EAAa;AACT,UAAI/C,GAAG,GAAG,EAAV;AACAA,MAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,MAAAA,GAAG,CAACsB,QAAJ,GAAekC,UAAU,CAACnC,EAAX,CAAc6B,MAAd,CAAqB,CAACM,UAAU,CAACjC,EAAjC,CAAf;AACAvB,MAAAA,GAAG,CAACW,QAAJ,GAAe6C,UAAU,CAACnC,EAAX,CAAc6B,MAAd,CAAqB,CAArB,EAAwBM,UAAU,CAACnC,EAAX,CAAclC,MAAd,GAAuBqE,UAAU,CAACjC,EAA1D,CAAf;AACAvB,MAAAA,GAAG,CAACE,IAAJ,GAAWsD,UAAU,CAACtD,IAAtB;AACAF,MAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,MAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB,EACIN,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EADtB,EAEIR,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAFrB,EAGI,KAAKQ,WAAL,GAAmB,IAHvB;AAIAhD,MAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;AACA1D,MAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,eAAxB,EAAyC9B,GAAzC,EAA8C,KAAK+B,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAA9C;AACA,aAAO,IAAP;AACH,KAdD,MAcO;AACH9D,MAAAA,MAAM,CAACiD,OAAP,CAAegC,eAAf,CAA+B,YAA/B;AACH;AACJ;;AACD,SAAO,KAAP;AACH,CAzBD;;AA2BA/F,KAAK,CAACgD,cAAN,GAAuB,YAAY;AAC/B,MAAIqD,WAAW,GAAG5C,EAAE,CAACC,GAAH,CAAOC,QAAP,GAAkB7C,MAAM,CAACtB,QAAP,CAAgBwD,cAAhB,EAAlB,GAAqD,CAAvE;AACA,SAAOqD,WAAP;AACH,CAHD;;AAKArG,KAAK,CAACoD,aAAN,GAAsB,YAAY;AAC9B,MAAIkD,SAAS,GAAG7C,EAAE,CAACC,GAAH,CAAOC,QAAP,GAAkB7C,MAAM,CAACtB,QAAP,CAAgB4D,aAAhB,EAAlB,GAAoD,IAApE;AACA,SAAOkD,SAAP;AACH,CAHD;;AAIAtG,KAAK,CAACkD,eAAN,GAAwB,YAAY;AAChC,MAAIqD,YAAY,GAAG9C,EAAE,CAACC,GAAH,CAAOC,QAAP,GAAkB7C,MAAM,CAACtB,QAAP,CAAgBgH,gBAAhB,EAAlB,GAAuD,CAA1E;AACA,SAAOD,YAAP;AACH,CAHD;;AAIAvG,KAAK,CAACsD,YAAN,GAAqB,YAAY;AAC7B,MAAID,UAAJ;;AACA,MAAII,EAAE,CAACC,GAAH,CAAO+C,EAAP,KAAchD,EAAE,CAACC,GAAH,CAAOgD,UAAzB,EAAqC;AACjCrD,IAAAA,UAAU,GAAG,CAAb;AACH,GAFD,MAEO,IAAII,EAAE,CAACC,GAAH,CAAO+C,EAAP,KAAchD,EAAE,CAACC,GAAH,CAAOiD,MAAzB,EAAiC;AACpCtD,IAAAA,UAAU,GAAG,CAAb;AACH,GAFM,MAEA;AACHA,IAAAA,UAAU,GAAG,CAAb;AACH;;AACD,SAAOA,UAAP;AACH,CAVD;;AAYArD,KAAK,CAAC4G,cAAN,GAAuB,YAAY;AAC/B,MAAIC,IAAI,GAAG/F,MAAM,CAACtB,QAAP,CAAgBsH,WAAhB,EAAX;;AACA,MAAI,OAAOD,IAAP,IAAe,QAAf,IAA2BA,IAAI,IAAI,EAAvC,EAA2C;AACvC,QAAIE,IAAI,GAAGF,IAAI,CAACG,KAAL,CAAW,GAAX,CAAX;;AACA,QAAID,IAAI,CAAChF,MAAL,GAAc,CAAlB,EAAqB;AACjB,UAAIkF,QAAQ,GAAG,EAAf;;AACA,WAAK,IAAIC,GAAT,IAAgBH,IAAhB,EAAsB;AAClB,YAAII,IAAI,GAAGJ,IAAI,CAACG,GAAD,CAAJ,CAAUF,KAAV,CAAgB,GAAhB,CAAX;AACAC,QAAAA,QAAQ,CAACE,IAAI,CAAC,CAAD,CAAL,CAAR,GAAoBA,IAAI,CAAC,CAAD,CAAxB;AACH;;AACD,aAAOF,QAAP;AACH;AACJ;;AACD,SAAO,KAAP;AACH,CAdD;;AAgBAjH,KAAK,CAACyE,cAAN,GAAuB,UAAU7B,GAAV,EAAewE,WAAf,EAA4B;AAC/C,MAAI3D,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjB,QAAI0D,OAAO,GAAG;AAAEC,MAAAA,EAAE,EAAE,GAAN;AAAWC,MAAAA,OAAO,EAAE,GAApB;AAAyBC,MAAAA,IAAI,EAAE;AAA/B,KAAd;AACA,QAAIC,SAAS,IAAI3G,MAAM,CAAC4G,WAAxB,EAAqCL,OAAO,GAAGvG,MAAM,CAAC4G,WAAjB;;AACrC,QAAIC,KAAJ,EAAW;AACP,UAAIJ,OAAO,GAAG,KAAKX,cAAL,EAAd;AACAS,MAAAA,OAAO,GAAGE,OAAO,IAAIF,OAArB;AACH;;AACD,QAAIO,YAAY,GAAG,SAAfA,YAAe,CAAUC,OAAV,EAAmB;AAClCjF,MAAAA,GAAG,CAACkF,SAAJ,GAAgBT,OAAO,CAACC,EAAxB;AACA1E,MAAAA,GAAG,CAAC2E,OAAJ,GAAcF,OAAO,CAACE,OAAtB;AACA3E,MAAAA,GAAG,CAACmF,YAAJ,GAAmBV,OAAO,CAACG,IAA3B;AACA1G,MAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;;AACA,UAAIqD,OAAO,CAACG,QAAR,IAAoB,EAAxB,EAA4B;AACxBlH,QAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB0C,WAAxB,EAAqCxE,GAArC,EAA0C,UAACqF,KAAD,EAAQd,IAAR,EAAiB;AACvDC,UAAAA,WAAW,IAAI,eAAf,GAAiCtG,MAAM,CAACd,KAAP,CAAa2E,SAAb,CAAuBsD,KAAvB,EAA8Bd,IAA9B,CAAjC,GAAuErG,MAAM,CAACd,KAAP,CAAakI,eAAb,CAA6BD,KAA7B,EAAoCd,IAApC,CAAvE;AACH,SAFD;AAGA;AACH;;AACD,UAAIa,QAAQ,GAAGG,IAAI,CAACC,KAAL,CAAWP,OAAO,CAACG,QAAnB,CAAf;AACApF,MAAAA,GAAG,CAACkF,SAAJ,GAAgBE,QAAQ,CAACV,EAAT,GAAcU,QAAQ,CAACV,EAAvB,GAA4BD,OAAO,CAACC,EAApD;AACA1E,MAAAA,GAAG,CAAC2E,OAAJ,GAAcS,QAAQ,CAACT,OAAT,GAAmBS,QAAQ,CAACT,OAA5B,GAAsCF,OAAO,CAACE,OAA5D;AACA3E,MAAAA,GAAG,CAACmF,YAAJ,GAAmBC,QAAQ,CAACR,IAAT,GAAgBQ,QAAQ,CAACR,IAAzB,GAAgCH,OAAO,CAACG,IAA3D;AACA1G,MAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB0C,WAAxB,EAAqCxE,GAArC,EAA0C,UAACqF,KAAD,EAAQd,IAAR,EAAiB;AACvDC,QAAAA,WAAW,IAAI,eAAf,GAAiCtG,MAAM,CAACd,KAAP,CAAa2E,SAAb,CAAuBsD,KAAvB,EAA8Bd,IAA9B,CAAjC,GAAuErG,MAAM,CAACd,KAAP,CAAakI,eAAb,CAA6BD,KAA7B,EAAoCd,IAApC,CAAvE;AACH,OAFD;AAGH,KAlBD;;AAmBArG,IAAAA,MAAM,CAACuH,KAAP,CAAaC,UAAb,CAAwB,CAAxB,EAA2BV,YAA3B;AACH,GA3BD,MA2BO;AACHhF,IAAAA,GAAG,CAACkF,SAAJ,GAAgB,GAAhB;AACAlF,IAAAA,GAAG,CAAC2E,OAAJ,GAAc,GAAd;AACA3E,IAAAA,GAAG,CAACmF,YAAJ,GAAmB,GAAnB;AACAjH,IAAAA,MAAM,CAACyD,IAAP,CAAYC,MAAZ;AACA1D,IAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB0C,WAAxB,EAAqCxE,GAArC,EAA0C,UAACqF,KAAD,EAAQd,IAAR,EAAiB;AACvDC,MAAAA,WAAW,IAAI,eAAf,GAAiCtG,MAAM,CAACd,KAAP,CAAa2E,SAAb,CAAuBsD,KAAvB,EAA8Bd,IAA9B,CAAjC,GAAuErG,MAAM,CAACd,KAAP,CAAakI,eAAb,CAA6BD,KAA7B,EAAoCd,IAApC,CAAvE;AACH,KAFD;AAGH;AACJ,CArCD;AAsCA;;;;;;AAIAnH,KAAK,CAACuI,WAAN,GAAoB,UAAU3F,GAAV,EAAe;AAC/B,OAAKkC,UAAL,GAAkB,IAAlB,CAD+B,CACR;;AACvBlC,EAAAA,GAAG,CAACC,UAAJ,GAAiB,KAAK1C,SAAL,CAAe0C,UAAhC;AACAD,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,EAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB;AACAN,EAAAA,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EAAlB;AACAR,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;;AACA,MAAIG,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjBf,IAAAA,GAAG,CAACgB,eAAJ,GAAsB9C,MAAM,CAACtB,QAAP,CAAgBqE,UAAhB,EAAtB;AACH;;AACD,OAAKnD,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAE,CAAR;AAAWS,IAAAA,QAAQ,EAAEX,GAAG,CAAC4F,GAAzB;AAA8BtE,IAAAA,QAAQ,EAAEtB,GAAG,CAAC6F;AAA5C,GAAjB;AACA3H,EAAAA,MAAM,CAACiE,KAAP,CAAaC,cAAb;AACA,OAAKpE,aAAL,GAAqB,IAArB;AACA,MAAIyD,aAAa,GAAGvD,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,eAAvB,CAApB;;AACA,MAAI,CAACD,aAAD,IAAkBZ,EAAE,CAACC,GAAH,CAAOC,QAA7B,EAAuC;AACnC,SAAKc,cAAL,CAAoB7B,GAApB,EAAyB,kBAAzB;AACA9B,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,eAAvB,EAAwC,EAAxC;AACA;AACH;;AACDlD,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,kBAAxB,EAA4C9B,GAA5C,EAAiD,KAAKsF,eAAL,CAAqBtD,IAArB,CAA0B,IAA1B,CAAjD;AAEH,CArBD;AAuBA;;;;;;AAIA5E,KAAK,CAAC0I,gBAAN,GAAyB,UAAU9F,GAAV,EAAe;AACpC,OAAKkC,UAAL,GAAkB,IAAlB,CADoC,CACb;;AACvBlC,EAAAA,GAAG,CAACG,IAAJ,GAAW,KAAKC,cAAL,EAAX;AACAJ,EAAAA,GAAG,CAACK,aAAJ,GAAoB,KAAKC,eAAL,EAApB;AACAN,EAAAA,GAAG,CAACO,WAAJ,GAAkB,KAAKC,aAAL,EAAlB;AACAR,EAAAA,GAAG,CAACS,UAAJ,GAAiB,KAAKC,YAAL,EAAjB;;AACA,MAAIG,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjBf,IAAAA,GAAG,CAACgB,eAAJ,GAAsB9C,MAAM,CAACtB,QAAP,CAAgBqE,UAAhB,EAAtB;AACH;;AACD,OAAKnD,SAAL,GAAiB;AAAEoC,IAAAA,IAAI,EAAE,CAAR;AAAWS,IAAAA,QAAQ,EAAEX,GAAG,CAACW,QAAzB;AAAmCW,IAAAA,QAAQ,EAAEtB,GAAG,CAAC+F;AAAjD,GAAjB;AACA,MAAItE,aAAa,GAAGvD,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,eAAvB,CAApB;AACAxD,EAAAA,MAAM,CAACiE,KAAP,CAAaC,cAAb;AACA,OAAKpE,aAAL,GAAqB,IAArB;;AACA,MAAI,CAACyD,aAAD,IAAkBZ,EAAE,CAACC,GAAH,CAAOC,QAA7B,EAAuC;AACnC,SAAKc,cAAL,CAAoB7B,GAApB,EAAyB,uBAAzB;AACA9B,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,eAAvB,EAAwC,EAAxC;AACA;AACH;;AACDlD,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,uBAAxB,EAAiD9B,GAAjD,EAAsD,KAAKsF,eAAL,CAAqBtD,IAArB,CAA0B,IAA1B,CAAtD;AAEH,CApBD;AAsBA;;;;;;;AAKA5E,KAAK,CAACkI,eAAN,GAAwB,UAAUD,KAAV,EAAiBd,IAAjB,EAAuB;AAC3C,OAAKyB,cAAL;AACA,OAAKC,SAAL,GAAiB,IAAjB;AACA,OAAKC,UAAL,GAAkB3B,IAAI,CAAC4B,MAAL,CAAY5B,IAA9B;AACA,OAAK6B,SAAL,GAAiB7B,IAAI,CAAC4B,MAAL,CAAY5B,IAAZ,CAAiB8B,QAAjB,IAA6B,CAA7B,GAAiC,IAAjC,GAAwC,KAAzD;AAEA,MAAI9B,IAAI,CAAC+B,eAAL,IAAwB/B,IAAI,CAAC+B,eAAL,GAAuB,CAAnD,EAAsDpI,MAAM,CAACyD,IAAP,CAAY2E,eAAZ,GAA8B/B,IAAI,CAAC+B,eAAnC;AACtD,MAAI/B,IAAI,CAACgC,eAAL,IAAwBhC,IAAI,CAACgC,eAAL,GAAuB,CAAnD,EAAsDrI,MAAM,CAACyD,IAAP,CAAY6E,kBAAZ,GAAiCjC,IAAI,CAACgC,eAAtC;;AACtD,MAAIrI,MAAM,CAACyD,IAAP,CAAY8E,GAAZ,CAAgB,QAAhB,CAAJ,EAA+B;AAC3B;AAEA,SAAKC,WAAL,CAAiBnC,IAAjB;AACH,GAJD,MAIO,KAAKmC,WAAL,CAAiBnC,IAAjB;AACV,CAbD;AAcA;;;;;AAGAnH,KAAK,CAAC4I,cAAN,GAAuB,YAAY;AAC/B,MAAI,CAAC,KAAKlI,SAAV,EAAqB;AACrB,MAAIkC,GAAG,GAAG,KAAKlC,SAAf;AACAI,EAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,YAAvB,EAAqC;AAAElB,IAAAA,IAAI,EAAEF,GAAG,CAACE,IAAZ;AAAkBmB,IAAAA,EAAE,EAAErB,GAAG,CAACW,QAAJ,GAAeX,GAAG,CAACsB,QAAzC;AAAmDC,IAAAA,EAAE,EAAEC,MAAM,CAACxB,GAAG,CAACsB,QAAL,CAAN,CAAqBnC;AAA5E,GAArC,EAH+B,CAI/B;;AACA,MAAIa,GAAG,CAACE,IAAJ,IAAY,CAAhB,EAAmB;AACfhC,IAAAA,MAAM,CAACiD,OAAP,CAAegC,eAAf,CAA+B,YAA/B;AACH;;AACD,OAAKrF,SAAL,GAAiB,IAAjB;AACH,CATD,EAWA;;;AACAV,KAAK,CAACuJ,YAAN,GAAqB,UAAUC,MAAV,EAAkBC,IAAlB,EAAkC;AAAA,MAAVjC,IAAU,uEAAH,CAAG;AACnD,MAAIkC,KAAK,GAAG5I,MAAM,CAACyD,IAAP,CAAY8E,GAAZ,CAAgB,iBAAhB,CAAZ;AACAvI,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,mBAAxB,EAA6C;AAAE4C,IAAAA,EAAE,EAAEkC,MAAN;AAAcG,IAAAA,SAAS,EAAEnC,IAAzB;AAA+BkC,IAAAA,KAAK,EAAEA;AAAtC,GAA7C,EAA4F,UAACzB,KAAD,EAAQd,IAAR,EAAiB;AACzG,QAAIyC,OAAO,GAAG,IAAd;;AACA,QAAIzC,IAAI,CAAC0C,KAAL,IAAczK,KAAK,CAACC,IAApB,IAA4B8H,IAAI,CAAC2C,YAAL,IAAqB9K,aAAa,CAACC,MAAnE,EAA2E;AACvEwK,MAAAA,IAAI,CAACtC,IAAI,CAACG,EAAN,CAAJ;AACH,KAFD,MAEO;AACH,UAAIH,IAAI,CAAC0C,KAAL,IAAczK,KAAK,CAACD,KAApB,IAA6BgI,IAAI,CAAC2C,YAAL,IAAqB9K,aAAa,CAACG,KAApE,EAA2E;AACvEyK,QAAAA,OAAO,GAAG,UAAV;;AACA,YAAIzC,IAAI,CAACwC,SAAL,IAAkBrK,UAAU,CAACE,QAAjC,EAA2C;AACvCoK,UAAAA,OAAO,GAAG,UAAV;AACH;AACJ,OALD,MAKO;AACHA,QAAAA,OAAO,GAAG,mBAAV;;AACA,YAAIzC,IAAI,CAACwC,SAAL,IAAkBrK,UAAU,CAACE,QAAjC,EAA2C;AACvCoK,UAAAA,OAAO,GAAG,mBAAV;AACH;AACJ;AACJ;;AAED,QAAIA,OAAJ,EAAa;AACT9I,MAAAA,MAAM,CAACiE,KAAP,CAAagF,UAAb,CAAwB,EAAxB,EAA4BH,OAA5B,EAAqC,YAAM;AACvC,YAAInG,EAAE,CAACuG,QAAH,CAAYC,QAAZ,GAAuBC,IAAvB,IAA+B,OAAnC,EAA4C;AACxCC,UAAAA,WAAW;AACd;AACJ,OAJD;AAKH;AACJ,GAzBD;AA0BH,CA5BD;AA8BA;;;;;AAGAnK,KAAK,CAACoK,iBAAN,GAA0B,YAAY;AAAA;;AAClC3G,EAAAA,EAAE,CAAC4G,GAAH,CAAO,QAAP;AACAvJ,EAAAA,MAAM,CAACiE,KAAP,CAAauF,SAAb;AACAxJ,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,wBAAxB,EAAkD,IAAlD,EAAwD,UAACuD,KAAD,EAAQd,IAAR,EAAiB;AACrErG,IAAAA,MAAM,CAACiE,KAAP,CAAawF,SAAb;AACA,IAAA,KAAI,CAACC,cAAL,GAAsBrD,IAAtB;AACArG,IAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAACyJ,IAAR,CAAaC,YAAjC,EAA+CxD,IAA/C;AACH,GAJD;AAKH,CARD;AAUA;;;;;;;AAKAnH,KAAK,CAAC2E,SAAN,GAAkB,UAAUsD,KAAV,EAAiBd,IAAjB,EAAuB;AACrC,OAAKyB,cAAL;AACA,OAAKC,SAAL,GAAiB1B,IAAI,CAACyD,UAAL,IAAmB,CAApC;AACA9J,EAAAA,MAAM,CAAC+J,iBAAP,GAA2B,IAA3B;AACA,OAAK/B,UAAL,GAAkB3B,IAAI,CAAC4B,MAAL,CAAY5B,IAA9B;AACA,OAAK6B,SAAL,GAAiB7B,IAAI,CAAC4B,MAAL,CAAY5B,IAAZ,CAAiB8B,QAAjB,IAA6B,CAA7B,GAAiC,IAAjC,GAAwC,KAAzD;AAEA,OAAKK,WAAL,CAAiBnC,IAAjB;AACH,CARD;AASA;;;;;;AAIAnH,KAAK,CAACsJ,WAAN,GAAoB,UAAU1G,GAAV,EAAe;AAC/B,OAAKvC,IAAL,GAAYuC,GAAG,CAACkI,GAAhB,CAD+B,CAE/B;;AACAhK,EAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2BC,YAA3B,CAAwC,KAAK3K,IAA7C,EAH+B,CAI/B;;AACA,MAAIgC,SAAS,GAAGvB,MAAM,CAACuB,SAAP,CAAiBC,YAAjB,EAAhB;AACA,OAAKhC,cAAL,GAAsB+B,SAAS,CAAC,aAAD,CAA/B;AACA,OAAK9B,cAAL,GAAsB8B,SAAS,CAAC,aAAD,CAA/B;AACAvB,EAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAACG,OAAR,CAAgB6J,QAApC,EAA8C,IAA9C;;AAEA,MAAI,CAAC,KAAKpK,aAAV,EAAyB;AACrB,SAAKA,aAAL,GAAqB,IAArB;AACAC,IAAAA,MAAM,CAAC2B,OAAP,CAAeyI,OAAf,CAAuB,KAAK5K,cAA5B,EAA4C,KAAKC,cAAjD,EAAiE,KAAK4K,gBAAL,CAAsBvG,IAAtB,CAA2B,IAA3B,CAAjE;AACH,GAHD,MAGO;AACH,SAAKwG,SAAL;AACH,GAf8B,CAgB/B;;;AACA,MAAI,KAAKvC,SAAT,EAAoB;AAChB,QAAIpF,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjB,UAAIiE,YAAY,GAAG,SAAfA,YAAe,CAAUC,OAAV,EAAmB;AAClC,YAAIR,OAAO,GAAG;AAAEC,UAAAA,EAAE,EAAE,GAAN;AAAWC,UAAAA,OAAO,EAAE,GAApB;AAAyBC,UAAAA,IAAI,EAAE;AAA/B,SAAd;AACA,YAAI6D,eAAe,GAAG;AAAE,uBAAa,GAAf;AAAoB,qBAAW,GAA/B;AAAoC,kBAAQ;AAA5C,SAAtB;AACA,YAAI5D,SAAS,IAAI3G,MAAM,CAAC4G,WAAxB,EAAqCL,OAAO,GAAGvG,MAAM,CAAC4G,WAAjB;;AACrC,YAAIC,KAAJ,EAAW;AACP,cAAIJ,OAAO,GAAGzG,MAAM,CAACd,KAAP,CAAa4G,cAAb,EAAd;AACAS,UAAAA,OAAO,GAAGE,OAAO,IAAIF,OAArB;AACH;;AACD,YAAIQ,OAAO,CAACG,QAAR,IAAoB,EAAxB,EAA4B;AACxBqD,UAAAA,eAAe,CAACvD,SAAhB,GAA4BT,OAAO,CAACC,EAApC;AACA+D,UAAAA,eAAe,CAAC9D,OAAhB,GAA0BF,OAAO,CAACE,OAAlC;AACA8D,UAAAA,eAAe,CAAC7D,IAAhB,GAAuBH,OAAO,CAACG,IAA/B;AACA1G,UAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,mBAAxB,EAA6C2G,eAA7C,EAA8D,UAACpD,KAAD,EAAQd,IAAR,EAAiB,CAC9E,CADD;AAEA;AACH;;AACD,YAAIa,QAAQ,GAAGG,IAAI,CAACC,KAAL,CAAWP,OAAO,CAACG,QAAnB,CAAf;AACAqD,QAAAA,eAAe,CAACvD,SAAhB,GAA4BE,QAAQ,CAACV,EAAT,GAAcU,QAAQ,CAACV,EAAvB,GAA4BD,OAAO,CAACC,EAAhE;AACA+D,QAAAA,eAAe,CAAC9D,OAAhB,GAA0BS,QAAQ,CAACT,OAAT,GAAmBS,QAAQ,CAACT,OAA5B,GAAsCF,OAAO,CAACE,OAAxE;AACA8D,QAAAA,eAAe,CAAC7D,IAAhB,GAAuBQ,QAAQ,CAACR,IAAT,GAAgBQ,QAAQ,CAACR,IAAzB,GAAgCH,OAAO,CAACG,IAA/D;AACA1G,QAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,mBAAxB,EAA6C2G,eAA7C,EAA8D,UAACpD,KAAD,EAAQd,IAAR,EAAiB,CAAG,CAAlF;AACH,OArBD;;AAsBArG,MAAAA,MAAM,CAACuH,KAAP,CAAaC,UAAb,CAAwB,EAAxB,EAA4BV,YAA5B;AACH,KAxBD,MAwBO;AACH,UAAII,QAAQ,GAAG;AAAE,qBAAa,GAAf;AAAoB,mBAAW,GAA/B;AAAoC,gBAAQ;AAA5C,OAAf;AACAlH,MAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,mBAAxB,EAA6CsD,QAA7C,EAAuD,UAACC,KAAD,EAAQd,IAAR,EAAiB,CAAG,CAA3E;AACH;;AACD,SAAK0B,SAAL,GAAiB,KAAjB;AACH;AACJ,CAhDD;AAiDA;;;;;;;AAKA7I,KAAK,CAACmL,gBAAN,GAAyB,UAAUG,UAAV,EAAsBC,KAAtB,EAA6B;AAClD,UAAQD,UAAR;AACI,SAAK,SAAL;AACIxK,MAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2BS,eAA3B,GADJ,CAEI;;AACA1K,MAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2BU,eAA3B,GAHJ,CAII;;AACA3K,MAAAA,MAAM,CAAC4K,IAAP,CAAYC,eAAZ,GALJ,CAMI;;AACA,WAAKP,SAAL;AACA;;AACJ,SAAK,YAAL;AACI;AACAtK,MAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2Ba,kBAA3B,GAFJ,CAGI;;AACA9K,MAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2Bc,cAA3B,GAJJ,CAKI;;AACA/K,MAAAA,MAAM,CAAC2B,OAAP,CAAeyI,OAAf,CAAuB,KAAK5K,cAA5B,EAA4C,KAAKC,cAAjD,EAAiE,KAAK4K,gBAAL,CAAsBvG,IAAtB,CAA2B,IAA3B,CAAjE;AACA;;AACJ,SAAK,QAAL;AACI;AACA9D,MAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2Bc,cAA3B;AAEA,WAAKC,MAAL,CAAYP,KAAZ;AACA;AAvBR;AAyBH,CA1BD,EA4BA;;;AACAvL,KAAK,CAACoL,SAAN,GAAkB,YAAY;AAC1B,MAAI,KAAKtC,UAAT,EAAqB;AACjB,QAAI,KAAKE,SAAT,EAAoB;AAChBlI,MAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAAC8K,KAAR,CAAcC,eAAlC,EAAmD,KAAKlD,UAAxD;AACH,KAFD,MAEO;AACHhI,MAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAAC8K,KAAR,CAAcE,eAAlC,EAAmD,KAAKnD,UAAxD;AACH;;AACD,SAAKA,UAAL,GAAkB,IAAlB;AACH;;AAED,MAAIlG,GAAG,GAAG;AACNsJ,IAAAA,KAAK,EAAEpL,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2BoB,aAA3B,EADD;AAENC,IAAAA,SAAS,EAAE;AAFL,GAAV;AAKAtL,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwBtD,OAAO,CAACC,MAAR,CAAeC,UAAvC,EAAmDsB,GAAnD;AACH,CAhBD;AAkBA;;;;;AAGA5C,KAAK,CAACuB,gCAAN,GAAyC,UAAUqB,GAAV,EAAe;AACpD9B,EAAAA,MAAM,CAAC2B,OAAP,CAAesI,SAAf,GAA2BsB,WAA3B;AACAvL,EAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAACG,OAAR,CAAgB6J,QAApC,EAA8C,KAA9C;AACAnK,EAAAA,MAAM,CAAC4K,IAAP,CAAYY,cAAZ;AACH,CAJD;;AAMAtM,KAAK,CAAC8L,MAAN,GAAe,UAAUP,KAAV,EAAiB;AAC5B,MAAIA,KAAK,CAACgB,MAAN,IAAgB9M,OAAO,CAACE,UAA5B,EAAwC;AACpC,SAAK6M,QAAL;;AACA,QAAI,KAAKhM,eAAT,EAA0B;AACtB,WAAKA,eAAL,GAAuB,KAAvB;AACA2J,MAAAA,WAAW;AACd,KAHD,MAGO;AACH,WAAKsC,UAAL;AACA3L,MAAAA,MAAM,CAACiE,KAAP,CAAagF,UAAb,CAAwB,EAAxB,EAA4BjJ,MAAM,CAAC4L,IAAP,CAAYC,KAAZ,CAAkBC,QAA9C,EAAwDzC,WAAxD;AACH;AACJ,GATD,MASO,IAAIoB,KAAK,CAACgB,MAAN,IAAgB9M,OAAO,CAACC,oBAA5B,EAAkD;AACrD,SAAK8M,QAAL;;AACA,QAAI,KAAKhM,eAAT,EAA0B;AACtB,WAAKA,eAAL,GAAuB,KAAvB;AACA2J,MAAAA,WAAW;AACd,KAHD,MAGO;AACH,WAAKsC,UAAL;AACA3L,MAAAA,MAAM,CAACiE,KAAP,CAAagF,UAAb,CAAwB,EAAxB,EAA4BjJ,MAAM,CAAC4L,IAAP,CAAYC,KAAZ,CAAkBE,WAA9C,EAA2D1C,WAA3D;AACH;AACJ,GATM,MASA,IAAIoB,KAAK,CAACgB,MAAN,IAAgB9M,OAAO,CAACG,oBAA5B,EAAkD;AACrD,QAAI,KAAKY,eAAT,EAA0B;AACtB,WAAKA,eAAL,GAAuB,KAAvB;AACA2J,MAAAA,WAAW;AACd,KAHD,MAGO;AACH,WAAKsC,UAAL;AACA3L,MAAAA,MAAM,CAACiE,KAAP,CAAagF,UAAb,CAAwB,EAAxB,EAA4BjJ,MAAM,CAAC4L,IAAP,CAAYC,KAAZ,CAAkBC,QAA9C,EAAwDzC,WAAxD;AACH;AACJ;AACJ,CA5BD;;AA+BAnK,KAAK,CAAC8M,OAAN,GAAgB,YAAY;AACxB,MAAI1G,UAAU,GAAGtF,MAAM,CAACiD,OAAP,CAAeO,OAAf,CAAuB,YAAvB,CAAjB;;AACA,MAAI8B,UAAJ,EAAgB;AACZ,QAAIlC,QAAQ,GAAGkC,UAAU,CAACnC,EAAX,CAAc6B,MAAd,CAAqB,CAACM,UAAU,CAACjC,EAAjC,CAAf;AACArD,IAAAA,MAAM,CAACiD,OAAP,CAAeC,OAAf,CAAuB,QAAvB,EAAiC;AAAEmD,MAAAA,IAAI,EAAEjD;AAAR,KAAjC;AACH,GALuB,CAMxB;;;AACApD,EAAAA,MAAM,CAACiD,OAAP,CAAegC,eAAf,CAA+B,YAA/B,EAPwB,CAQxB;;AACAoE,EAAAA,WAAW;AACd,CAVD;AAWA;;;;;AAGAnK,KAAK,CAAC+M,MAAN,GAAe,YAAY;AACvB,OAAKvM,eAAL,GAAuB,IAAvB;AACAM,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,+BAAxB;AACH,CAHD;AAIA;;;;;AAGA1E,KAAK,CAACwM,QAAN,GAAiB,YAAY;AACzB1L,EAAAA,MAAM,CAACiD,OAAP,CAAegC,eAAf,CAA+B,YAA/B,EADyB,CAEzB;;AACAjF,EAAAA,MAAM,CAAC2B,OAAP,CAAeuK,OAAf;AACH,CAJD;;AAMAhN,KAAK,CAACyM,UAAN,GAAmB,YAAY;AAC3B3L,EAAAA,MAAM,CAACC,OAAP,CAAe0J,IAAf,CAAoBxJ,OAAO,CAACgM,EAAR,CAAWC,WAA/B;AACApM,EAAAA,MAAM,CAACtB,QAAP,CAAgB2N,iBAAhB,CAAkC,IAAlC;AACArM,EAAAA,MAAM,CAACsM,WAAP,CAAmBD,iBAAnB,CAAqC,IAArC;AACArM,EAAAA,MAAM,CAACtB,QAAP,CAAgB6N,aAAhB;AACAvM,EAAAA,MAAM,CAAC2B,OAAP,CAAeiC,QAAf,CAAwB,cAAxB,EAAwC,EAAxC,EAA4C,UAACuD,KAAD,EAAQrF,GAAR,EAAgB,CAAG,CAA/D;AACH,CAND;;AAQA5C,KAAK,CAACgN,OAAN,GAAgB,YAAY;AACxB,OAAKjN,SAAL;AACH,CAFD;;AAGAC,KAAK,CAACsN,GAAN,GAAY,UAAUpG,GAAV,EAAeqG,KAAf,EAAsB;AAC9B,OAAKrG,GAAL,IAAYqG,KAAZ;AACH,CAFD;;AAGAvN,KAAK,CAACqJ,GAAN,GAAY,UAAUnC,GAAV,EAAe;AACvB,SAAO,KAAKA,GAAL,CAAP;AACH,CAFD;;AAIAsG,MAAM,CAACC,OAAP,GAAiB,YAAY;AACzB,MAAI,CAACvN,UAAL,EAAiB;AACbA,IAAAA,UAAU,GAAG,IAAIL,KAAJ,EAAb;AACH;;AACD,SAAOK,UAAP;AACH,CALD","sourceRoot":"/","sourcesContent":["let PROCESS_STATE = {\r\n    normal: 1,\r\n    maintain: 2,\r\n    close: 3,\r\n}\r\nlet STATE = {\r\n    open: 1,\r\n    close: 2,\r\n}\r\nlet CHECK_TYPE = {\r\n    game: 1,\r\n    platform: 2,\r\n}\r\n\r\n/**\r\n * 登陆数据模块\r\n */\r\nlet NetCode = {\r\n    LoginFromOtherDevice: 20100014, // 在别的设备登入\r\n    KickPlayer: 20100015, // 踢下线\r\n    EmergencyMaintenance: 20100016, // 紧急维护\r\n},\r\n    Logon = function () {\r\n        this.registerEvent();\r\n        this.resetData();\r\n    },\r\n    logon = Logon.prototype,\r\n    g_instance = null;\r\n\r\n/**\r\n * 数据重置\r\n */\r\nlogon.resetData = function () {\r\n    this.serverCfg = null;\r\n    this._webRootUrl = null;\r\n    this._uid = null;\r\n    this.connector_host = null;\r\n    this.connector_port = null;\r\n    this.b_switchAccount = null;\r\n    this.verifiCD = 60;\r\n    this.logondata = null;\r\n    this.loginupdata = false;\r\n    this.isUpdatePlaza = false;\r\n    this.pomeloConnect = false;\r\n}\r\n/**\r\n * 注册事件监听\r\n * 数据模型的事件无需销毁\r\n * 理论上重启游戏后自动就不存在了\r\n */\r\nlogon.registerEvent = function () {\r\n    glGame.emitter.on(MESSAGE.UPDATE_SERVER_CFG, this.onUpdateServerCfg, this);\r\n    glGame.emitter.on(NETWORK.POMELO.ENTER_PLAT, this.connector_entryHandler_enterPlat, this);\r\n}\r\n\r\n/**\r\n * 判定是否为ip\r\n * @param {String} obj\r\n */\r\nlogon.checkIP = function (obj) {\r\n    var ip = obj;\r\n    if (ip.indexOf(\" \") >= 0) {\r\n        ip = ip.replace(/ /g, \"\");\r\n    }\r\n    if (ip.toLowerCase().indexOf(\"http://\") == 0) {\r\n        ip = ip.slice(7);\r\n    }\r\n    if (ip.toLowerCase().indexOf(\"https://\") == 0) {\r\n        ip = ip.slice(8);\r\n    }\r\n    if (ip.slice(ip.length - 1) == \"/\") {\r\n        ip = ip.slice(0, ip.length - 1);\r\n    }\r\n    var exp = null;\r\n    let num = 0;\r\n    // ipv4  ipv6\r\n    for (let index in ip) { ip[index] === \".\" ? num++ : 0; }\r\n    if (num <= 4)\r\n        exp = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])$/;\r\n    else\r\n        exp = /^(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d{1,2}|1\\d\\d|2[0-4]\\d|25[0-5])$/;\r\n    var reg = ip.match(exp);\r\n    if (reg == null) return false;//不合法\r\n    else return true; //合法\r\n}\r\n\r\n/**\r\n * 更新连接服务器配置\r\n */\r\nlogon.onUpdateServerCfg = function () {\r\n    this.serverCfg = glGame.servercfg.getServerCfg();\r\n    let host = this.serverCfg[\"platSvrHost\"],\r\n        port = this.serverCfg[\"platSvrPort\"];\r\n\r\n    if (host.toLowerCase().indexOf(\"https://\") >= 0 || host.toLowerCase().indexOf(\"http://\") >= 0) this._webRootUrl = host;\r\n    else this._webRootUrl = `http://${host}`;\r\n\r\n    if (port > 0) this._webRootUrl = `${this._webRootUrl}:${port}`;\r\n    glGame.gameNet.setWebHost(this._webRootUrl);\r\n}\r\n/**\r\n * 微信号登陆\r\n * @param {Object} msg\r\n */\r\nlogon.reqWxLogin = function (msg) {\r\n    msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n    msg.plat = 4;\r\n    msg.imei = this.getMachineCode();\r\n    msg.phone_version = this.getPhoneVersion();\r\n    msg.phone_model = this.getPhoneModel();\r\n    msg.phone_type = this.getPhoneType();\r\n    msg.password = md5(\"123456\")\r\n    if (cc.sys.isNative) {\r\n        msg.registration_id = glGame.platform.getRegisID();\r\n    }\r\n    this.isAutoLogin = false;\r\n    this.isUpdatePlaza = true;\r\n    glGame.storage.setItem(\"loginCache\", { plat: 4, pd: msg.username + msg.username, le: String(msg.username).length });\r\n    let RegisterFirst = glGame.storage.getItem(\"RegisterFirst\")\r\n    glGame.user.reqUrl();\r\n    if (!RegisterFirst && cc.sys.isNative) {\r\n        this.getOpenInstall(msg, 'http.reqLogin');\r\n        glGame.storage.setItem(\"RegisterFirst\", {})\r\n        return;\r\n    }\r\n    glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n}\r\n/**\r\n * 账号登陆\r\n * @param {Object} msg\r\n */\r\nlogon.reqAccLogin = function (msg) {\r\n    this.firstlogin = false;//是否为第一次注册登录\r\n    msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n    msg.plat = 1;\r\n    msg.imei = this.getMachineCode();\r\n    msg.phone_version = this.getPhoneVersion();\r\n    msg.phone_model = this.getPhoneModel();\r\n    msg.phone_type = this.getPhoneType();\r\n    this.logondata = { plat: msg.plat, password: msg.password, username: msg.username };\r\n    this.isAutoLogin = false;\r\n    this.isUpdatePlaza = true;\r\n    msg.phone_type = this.getPhoneType();\r\n    glGame.panel.showlimitJuhua();\r\n    glGame.user.reqUrl();\r\n    glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n}\r\n/**\r\n * 手机号登陆\r\n * @param {Object} msg\r\n */\r\nlogon.reqPhoneLogin = function (msg) {\r\n    this.firstlogin = false;//是否为第一次注册登录\r\n    msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n    msg.plat = 5;\r\n    msg.imei = this.getMachineCode();\r\n    msg.phone_version = this.getPhoneVersion();\r\n    msg.phone_model = this.getPhoneModel();\r\n    msg.phone_type = this.getPhoneType();\r\n    this.logondata = { plat: msg.plat, code: msg.code, username: msg.username };\r\n    this.isAutoLogin = false;\r\n    this.isUpdatePlaza = true;\r\n    msg.phone_type = this.getPhoneType();\r\n    glGame.user.reqUrl();\r\n    glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n}\r\n/**\r\n * 游客数据获取\r\n */\r\nlogon.getVisitorData = function () {\r\n    let msg = {\r\n        gameSvrTag: this.serverCfg.gameSvrTag,\r\n        plat: 2,\r\n        username: \"\" + Date.now() + Math.random(),\r\n        password: md5(Date.now().toString()),\r\n        imei: this.getMachineCode(),\r\n        phone_version: this.getPhoneVersion(),\r\n        phone_model: this.getPhoneModel(),\r\n        phone_type: this.getPhoneType(),\r\n    };\r\n    let visitorCache = glGame.storage.getItem(\"visitorCache\");\r\n    if (visitorCache) {\r\n        // 判断登录缓存中的参数是否合法\r\n        let necessary = [\"plat\", \"pd\", \"le\"];\r\n        let isLegal = necessary.every(prop => {\r\n            return typeof visitorCache[prop] !== \"undefined\" && visitorCache[prop] !== null;\r\n        });\r\n        if (isLegal) {\r\n            msg.username = visitorCache.pd.substr(-visitorCache.le);\r\n            msg.password = visitorCache.pd.substr(0, visitorCache.pd.length - visitorCache.le);\r\n            msg.plat = visitorCache.plat;\r\n        } else {\r\n            glGame.storage.removeItemByKey(\"visitorCache\");\r\n            glGame.storage.setItem(\"visitorCache\", { plat: msg.plat, pd: msg.password + msg.username, le: String(msg.username).length });\r\n        }\r\n    } else {\r\n        glGame.storage.setItem(\"visitorCache\", { plat: msg.plat, pd: msg.password + msg.username, le: String(msg.username).length });\r\n    }\r\n    return msg;\r\n}\r\n\r\n/**\r\n * 游客登陆\r\n */\r\nlogon.reqTouLogin = function () {\r\n    let msg = this.getVisitorData();\r\n    if (cc.sys.isNative) {\r\n        msg.registration_id = glGame.platform.getRegisID();\r\n    }\r\n    this.logondata = { plat: msg.plat, password: msg.password, username: msg.username };\r\n    this.isAutoLogin = false;\r\n    this.isUpdatePlaza = true;\r\n    let VisitorFirst = glGame.storage.getItem(\"VisitorFirst\")//第一次游客登录要发openstall信息\r\n    glGame.user.reqUrl();\r\n    if (!VisitorFirst && cc.sys.isNative) {\r\n        this.getOpenInstall(msg, 'http.reqLogin');\r\n        glGame.storage.setItem(\"VisitorFirst\", {});\r\n        return;\r\n    }\r\n    glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n}\r\n/**\r\n * 开发模式的账号登录\r\n */\r\nlogon.reqDevelopTouLogin = function (msg) {\r\n    msg.password = md5(\"123456\");\r\n    msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n    msg.plat = 3;\r\n    msg.imei = this.getMachineCode();\r\n    this.logondata = { plat: msg.plat, password: msg.password, username: msg.username };\r\n    this.isAutoLogin = false;\r\n    msg.phone_type = this.getPhoneType();\r\n    glGame.user.reqUrl();\r\n    glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n\r\n}\r\n/**\r\n * 自动登陆\r\n */\r\nlogon.autoLogin = function () {\r\n    let loginCache = glGame.storage.getItem(\"loginCache\");\r\n    if (loginCache) {\r\n        // 判断登录缓存中的参数是否合法\r\n        let necessary = [\"plat\", \"pd\", \"le\"];\r\n        let isLegal = necessary.every(prop => { return typeof loginCache[prop] !== \"undefined\" && loginCache[prop] !== null; });\r\n        if (isLegal) {\r\n            let msg = {}\r\n            msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n            msg.username = loginCache.pd.substr(-loginCache.le);\r\n            msg.password = loginCache.pd.substr(0, loginCache.pd.length - loginCache.le);\r\n            msg.plat = loginCache.plat;\r\n            msg.imei = this.getMachineCode();\r\n            msg.phone_version = this.getPhoneVersion(),\r\n                msg.phone_model = this.getPhoneModel(),\r\n                msg.phone_type = this.getPhoneType(),\r\n                this.isAutoLogin = true;\r\n            glGame.user.reqUrl();\r\n            glGame.gameNet.send_msg('http.reqLogin', msg, this.loginNext.bind(this));\r\n            return true;\r\n        } else {\r\n            glGame.storage.removeItemByKey(\"loginCache\");\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nlogon.getMachineCode = function () {\r\n    let machineCode = cc.sys.isNative ? glGame.platform.getMachineCode() : 0;\r\n    return machineCode;\r\n}\r\n\r\nlogon.getPhoneModel = function () {\r\n    let phoneType = cc.sys.isNative ? glGame.platform.getPhoneModel() : null;\r\n    return phoneType;\r\n}\r\nlogon.getPhoneVersion = function () {\r\n    let phoneVersion = cc.sys.isNative ? glGame.platform.getSystemVersion() : 0;\r\n    return phoneVersion\r\n}\r\nlogon.getPhoneType = function () {\r\n    let phone_type;\r\n    if (cc.sys.os === cc.sys.OS_ANDROID) {\r\n        phone_type = 1;\r\n    } else if (cc.sys.os === cc.sys.OS_IOS) {\r\n        phone_type = 2;\r\n    } else {\r\n        phone_type = 0;\r\n    }\r\n    return phone_type;\r\n}\r\n\r\nlogon.getChannelData = function () {\r\n    let text = glGame.platform.getClipText();\r\n    if (typeof text == \"string\" && text != \"\") {\r\n        let list = text.split(\"&\");\r\n        if (list.length > 1) {\r\n            let datalist = {};\r\n            for (let key in list) {\r\n                let data = list[key].split(\"=\");\r\n                datalist[data[0]] = data[1];\r\n            }\r\n            return datalist;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nlogon.getOpenInstall = function (msg, routeadress) {\r\n    if (cc.sys.isNative) {\r\n        let promote = { id: \"0\", channel: \"0\", type: \"0\" }\r\n        if (isAndroid && glGame.channelData) promote = glGame.channelData;\r\n        if (isIos) {\r\n            let channel = this.getChannelData();\r\n            promote = channel || promote;\r\n        }\r\n        let getinstallCB = function (appData) {\r\n            msg.player_id = promote.id;\r\n            msg.channel = promote.channel;\r\n            msg.channel_type = promote.type;\r\n            glGame.user.reqUrl();\r\n            if (appData.bindData == \"\") {\r\n                glGame.gameNet.send_msg(routeadress, msg, (route, data) => {\r\n                    routeadress == \"http.reqLogin\" ? glGame.logon.loginNext(route, data) : glGame.logon.reqRegisterNext(route, data)\r\n                });\r\n                return;\r\n            }\r\n            let bindData = JSON.parse(appData.bindData);\r\n            msg.player_id = bindData.id ? bindData.id : promote.id;\r\n            msg.channel = bindData.channel ? bindData.channel : promote.channel;\r\n            msg.channel_type = bindData.type ? bindData.type : promote.type;\r\n            glGame.gameNet.send_msg(routeadress, msg, (route, data) => {\r\n                routeadress == \"http.reqLogin\" ? glGame.logon.loginNext(route, data) : glGame.logon.reqRegisterNext(route, data)\r\n            });\r\n        }\r\n        glGame.oiSdk.getInstall(0, getinstallCB);\r\n    } else {\r\n        msg.player_id = \"0\";\r\n        msg.channel = \"0\";\r\n        msg.channel_type = \"1\";\r\n        glGame.user.reqUrl();\r\n        glGame.gameNet.send_msg(routeadress, msg, (route, data) => {\r\n            routeadress == \"http.reqLogin\" ? glGame.logon.loginNext(route, data) : glGame.logon.reqRegisterNext(route, data)\r\n        });\r\n    }\r\n}\r\n/**\r\n * 账号注册\r\n * @param {Object} msg\r\n */\r\nlogon.reqRegister = function (msg) {\r\n    this.firstlogin = true;//是否为第一次注册登录\r\n    msg.gameSvrTag = this.serverCfg.gameSvrTag;\r\n    msg.imei = this.getMachineCode();\r\n    msg.phone_version = this.getPhoneVersion();\r\n    msg.phone_model = this.getPhoneModel();\r\n    msg.phone_type = this.getPhoneType();\r\n    if (cc.sys.isNative) {\r\n        msg.registration_id = glGame.platform.getRegisID();\r\n    }\r\n    this.logondata = { plat: 1, password: msg.psw, username: msg.acc };\r\n    glGame.panel.showlimitJuhua();\r\n    this.isUpdatePlaza = true\r\n    let RegisterFirst = glGame.storage.getItem(\"RegisterFirst\")\r\n    if (!RegisterFirst && cc.sys.isNative) {\r\n        this.getOpenInstall(msg, 'http.reqRegister');\r\n        glGame.storage.setItem(\"RegisterFirst\", {})\r\n        return;\r\n    }\r\n    glGame.gameNet.send_msg('http.reqRegister', msg, this.reqRegisterNext.bind(this));\r\n\r\n};\r\n\r\n/**\r\n * 手机注册\r\n * @param {Object} msg\r\n */\r\nlogon.reqPhoneRegister = function (msg) {\r\n    this.firstlogin = true;//是否为第一次注册登录\r\n    msg.imei = this.getMachineCode();\r\n    msg.phone_version = this.getPhoneVersion();\r\n    msg.phone_model = this.getPhoneModel();\r\n    msg.phone_type = this.getPhoneType();\r\n    if (cc.sys.isNative) {\r\n        msg.registration_id = glGame.platform.getRegisID();\r\n    }\r\n    this.logondata = { plat: 1, password: msg.password, username: msg.phone };\r\n    let RegisterFirst = glGame.storage.getItem(\"RegisterFirst\")\r\n    glGame.panel.showlimitJuhua();\r\n    this.isUpdatePlaza = true\r\n    if (!RegisterFirst && cc.sys.isNative) {\r\n        this.getOpenInstall(msg, 'http.reqPhoneRegister');\r\n        glGame.storage.setItem(\"RegisterFirst\", {})\r\n        return;\r\n    }\r\n    glGame.gameNet.send_msg('http.reqPhoneRegister', msg, this.reqRegisterNext.bind(this));\r\n\r\n}\r\n\r\n/**\r\n * 注册接口回调\r\n * @param {String} route\r\n * @param {Object} data\r\n */\r\nlogon.reqRegisterNext = function (route, data) {\r\n    this.recordLoinData();\r\n    this.bindAgent = true;\r\n    this.myInfoData = data.myInfo.data\r\n    this.isTourist = data.myInfo.data.grade_id == 1 ? true : false;\r\n\r\n    if (data.registerGetCoin && data.registerGetCoin > 0) glGame.user.registerGetCoin = data.registerGetCoin;\r\n    if (data.registerDiamond && data.registerDiamond > 0) glGame.user.registerGetDiamond = data.registerDiamond;\r\n    if (glGame.user.get(\"userID\")) {\r\n        // glGame.gameNet.disconnect();\r\n\r\n        this.loginPomelo(data);\r\n    } else this.loginPomelo(data);\r\n};\r\n/**\r\n * 账号登入数据记录\r\n */\r\nlogon.recordLoinData = function () {\r\n    if (!this.logondata) return;\r\n    let msg = this.logondata;\r\n    glGame.storage.setItem(\"loginCache\", { plat: msg.plat, pd: msg.password + msg.username, le: String(msg.username).length });\r\n    //手机不让它自动登录\r\n    if (msg.plat == 5) {\r\n        glGame.storage.removeItemByKey(\"loginCache\");\r\n    }\r\n    this.logondata = null;\r\n}\r\n\r\n//获取游戏当前状态\r\nlogon.ReqGameState = function (gameid, next, type = 1) {\r\n    let model = glGame.user.get(\"gameDisplayType\");\r\n    glGame.gameNet.send_msg('http.ReqGameState', { id: gameid, checkType: type, model: model }, (route, data) => {\r\n        let tip_txt = null;\r\n        if (data.state == STATE.open && data.processState == PROCESS_STATE.normal) {\r\n            next(data.id);\r\n        } else {\r\n            if (data.state == STATE.close || data.processState == PROCESS_STATE.close) {\r\n                tip_txt = '本游戏已经关闭！'\r\n                if (data.checkType == CHECK_TYPE.platform) {\r\n                    tip_txt = '本平台已经关闭！'\r\n                }\r\n            } else {\r\n                tip_txt = '该游戏正在维护升级中，请稍后重试！'\r\n                if (data.checkType == CHECK_TYPE.platform) {\r\n                    tip_txt = '该平台正在维护升级中，请稍后重试！'\r\n                }\r\n            }\r\n        }\r\n\r\n        if (tip_txt) {\r\n            glGame.panel.showMsgBox('', tip_txt, () => {\r\n                if (cc.director.getScene().name != 'plaza') {\r\n                    reStartGame();\r\n                }\r\n            });\r\n        }\r\n    })\r\n};\r\n\r\n/**\r\n * 获取注册配表\r\n */\r\nlogon.reqRegisterConfig = function () {\r\n    cc.log(\"获取注册配表\")\r\n    glGame.panel.showJuHua();\r\n    glGame.gameNet.send_msg('http.ReqRegisterConfig', null, (route, data) => {\r\n        glGame.panel.hidejuhua();\r\n        this.RegisterConfig = data;\r\n        glGame.emitter.emit(MESSAGE.USER.REGISTER_CFG, data);\r\n    });\r\n};\r\n\r\n/**\r\n * 登陆接口回调\r\n * @param {String} route\r\n * @param {Object} data\r\n */\r\nlogon.loginNext = function (route, data) {\r\n    this.recordLoinData();\r\n    this.bindAgent = data.isRegister != 0;\r\n    glGame.isfirstEnterPlaza = true;\r\n    this.myInfoData = data.myInfo.data\r\n    this.isTourist = data.myInfo.data.grade_id == 1 ? true : false;\r\n\r\n    this.loginPomelo(data);\r\n};\r\n/**\r\n * 链接 pomelo\r\n * @param {Object} msg\r\n */\r\nlogon.loginPomelo = function (msg) {\r\n    this._uid = msg.uid;\r\n    //在网络管理中记录下登录信息\r\n    glGame.gameNet.getNetMgr().setLoginInfo(this._uid);\r\n    //登录成功后连接gate\r\n    let servercfg = glGame.servercfg.getServerCfg();\r\n    this.connector_host = servercfg[\"gameSvrHost\"];\r\n    this.connector_port = servercfg[\"gameSvrPort\"];\r\n    glGame.emitter.emit(MESSAGE.NETWORK.PODOT_ON, true);\r\n\r\n    if (!this.pomeloConnect) {\r\n        this.pomeloConnect = true;\r\n        glGame.gameNet.connect(this.connector_host, this.connector_port, this.connectConnector.bind(this));\r\n    } else {\r\n        this.enterPlat();\r\n    }\r\n    //推广绑定\r\n    if (this.bindAgent) {\r\n        if (cc.sys.isNative) {\r\n            let getinstallCB = function (appData) {\r\n                let promote = { id: \"0\", channel: \"0\", type: \"1\" }\r\n                let defaultBindData = { \"player_id\": \"0\", \"channel\": \"0\", \"type\": \"1\" };\r\n                if (isAndroid && glGame.channelData) promote = glGame.channelData;\r\n                if (isIos) {\r\n                    let channel = glGame.logon.getChannelData();\r\n                    promote = channel || promote;\r\n                }\r\n                if (appData.bindData == \"\") {\r\n                    defaultBindData.player_id = promote.id;\r\n                    defaultBindData.channel = promote.channel;\r\n                    defaultBindData.type = promote.type;\r\n                    glGame.gameNet.send_msg(\"http.ReqBindAgent\", defaultBindData, (route, data) => {\r\n                    })\r\n                    return;\r\n                }\r\n                let bindData = JSON.parse(appData.bindData);\r\n                defaultBindData.player_id = bindData.id ? bindData.id : promote.id;\r\n                defaultBindData.channel = bindData.channel ? bindData.channel : promote.channel;\r\n                defaultBindData.type = bindData.type ? bindData.type : promote.type;\r\n                glGame.gameNet.send_msg(\"http.ReqBindAgent\", defaultBindData, (route, data) => { })\r\n            }\r\n            glGame.oiSdk.getInstall(10, getinstallCB);\r\n        } else {\r\n            let bindData = { \"player_id\": \"0\", \"channel\": \"0\", \"type\": \"1\" };\r\n            glGame.gameNet.send_msg(\"http.ReqBindAgent\", bindData, (route, data) => { })\r\n        }\r\n        this.bindAgent = false;\r\n    }\r\n};\r\n/**\r\n * pomelo connect 服链接回调\r\n * @param event_type\r\n * @param event\r\n */\r\nlogon.connectConnector = function (event_type, event) {\r\n    switch (event_type) {\r\n        case 'connect':\r\n            glGame.gameNet.getNetMgr().pomeloConnected();\r\n            // 就清除pomelo的发送记录,那么房间那里会自己恢复房间\r\n            glGame.gameNet.getNetMgr().clearPomeloReqs();\r\n            // 设置记录房间id\r\n            glGame.room.setServerGameId();\r\n            // 进入平台服务\r\n            this.enterPlat();\r\n            break;\r\n        case 'disconnect':\r\n            //告诉网络管理pomelo断开了\r\n            glGame.gameNet.getNetMgr().pomeloDisconnected();\r\n            // 关闭连接平台服链接\r\n            glGame.gameNet.getNetMgr().platDisconnect();\r\n            // 重新捆绑回调\r\n            glGame.gameNet.connect(this.connector_host, this.connector_port, this.connectConnector.bind(this));\r\n            break;\r\n        case 'onKick':\r\n            // 关闭连接平台服链接\r\n            glGame.gameNet.getNetMgr().platDisconnect();\r\n\r\n            this.kicked(event);\r\n            break;\r\n    }\r\n};\r\n\r\n//进入平台服\r\nlogon.enterPlat = function () {\r\n    if (this.myInfoData) {\r\n        if (this.isTourist) {\r\n            glGame.emitter.emit(MESSAGE.LOGIN.TOURIST_SUCCESS, this.myInfoData);\r\n        } else {\r\n            glGame.emitter.emit(MESSAGE.LOGIN.ACCOUNT_SUCCESS, this.myInfoData);\r\n        }\r\n        this.myInfoData = null\r\n    }\r\n\r\n    let msg = {\r\n        token: glGame.gameNet.getNetMgr().getLoginToken(),\r\n        loginPlat: 1,\r\n    };\r\n\r\n    glGame.gameNet.send_msg(NETWORK.POMELO.ENTER_PLAT, msg);\r\n};\r\n\r\n/**\r\n * 进入平台\r\n */\r\nlogon.connector_entryHandler_enterPlat = function (msg) {\r\n    glGame.gameNet.getNetMgr().platSucceed();\r\n    glGame.emitter.emit(MESSAGE.NETWORK.PODOT_ON, false);\r\n    glGame.room.reqMyRoomState();\r\n};\r\n\r\nlogon.kicked = function (event) {\r\n    if (event.reason == NetCode.KickPlayer) {\r\n        this.logOutTo();\r\n        if (this.b_switchAccount) {\r\n            this.b_switchAccount = false;\r\n            reStartGame();\r\n        } else {\r\n            this.offWebView();\r\n            glGame.panel.showMsgBox(\"\", glGame.tips.LOGON.NETERROR, reStartGame);\r\n        }\r\n    } else if (event.reason == NetCode.LoginFromOtherDevice) {\r\n        this.logOutTo();\r\n        if (this.b_switchAccount) {\r\n            this.b_switchAccount = false;\r\n            reStartGame();\r\n        } else {\r\n            this.offWebView();\r\n            glGame.panel.showMsgBox(\"\", glGame.tips.LOGON.LOGINREPEAT, reStartGame);\r\n        }\r\n    } else if (event.reason == NetCode.EmergencyMaintenance) {\r\n        if (this.b_switchAccount) {\r\n            this.b_switchAccount = false;\r\n            reStartGame();\r\n        } else {\r\n            this.offWebView();\r\n            glGame.panel.showMsgBox(\"\", glGame.tips.LOGON.NETERROR, reStartGame);\r\n        }\r\n    }\r\n};\r\n\r\n\r\nlogon.reLogon = function () {\r\n    let loginCache = glGame.storage.getItem(\"loginCache\");\r\n    if (loginCache) {\r\n        let username = loginCache.pd.substr(-loginCache.le);\r\n        glGame.storage.setItem(\"number\", { data: username })\r\n    }\r\n    //清除登录缓存\r\n    glGame.storage.removeItemByKey(\"loginCache\");\r\n    // 重启游戏\r\n    reStartGame();\r\n};\r\n/**\r\n * 退出登陆\r\n */\r\nlogon.logout = function () {\r\n    this.b_switchAccount = true;\r\n    glGame.gameNet.send_msg('connector.entryHandler.logout');\r\n};\r\n/**\r\n * 注销登陆\r\n */\r\nlogon.logOutTo = function () {\r\n    glGame.storage.removeItemByKey(\"loginCache\");\r\n    // this.destroy();\r\n    glGame.gameNet.destroy();\r\n};\r\n\r\nlogon.offWebView = function () {\r\n    glGame.emitter.emit(MESSAGE.UI.WEBVIEW_OFF);\r\n    glGame.platform.changeOrientation(true);\r\n    glGame.systemclass.changeOrientation(true);\r\n    glGame.platform.offSuspension();\r\n    glGame.gameNet.send_msg(\"http.reqBack\", {}, (route, msg) => { });\r\n}\r\n\r\nlogon.destroy = function () {\r\n    this.resetData();\r\n};\r\nlogon.set = function (key, value) {\r\n    this[key] = value;\r\n};\r\nlogon.get = function (key) {\r\n    return this[key];\r\n};\r\n\r\nmodule.exports = function () {\r\n    if (!g_instance) {\r\n        g_instance = new Logon();\r\n    }\r\n    return g_instance;\r\n};\r\n"]}