{"version":3,"sources":["assets\\modules\\public\\script\\account\\retrievepsw.js"],"names":["glGame","baseclass","extend","properties","retrieve_phone","cc","EditBox","retrieve_verifica","retrieve_psw","retrieve_cpsw","retrieve_sendVerifica","Node","label_retrivevcode","Label","btn_retrievePswSend","Button","onLoad","registerEvent","start","emitter","on","retrievePswCD","changePswSuccess","unRegisterEvent","off","remove","onClick","name","node","retrievePsw_cb","retrievePswSend_cb","msg","phone","checkPhone","string","psw","checkPassword","code","pwd","user","ReqRetrievePwd","ReqPostPhoneCode","type","get","getChildByName","active","interactable","acc","panel","showErrorTip","tips","REGISTRATION","PHONENULL","reg","isacc_matcher","test","confimpsw","LOGPSWNULL","length","PSWLENGTH","PSWWRONGFUL","PSWCOFAIL","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nglGame.baseclass.extend({\r\n\r\n    properties: {\r\n        retrieve_phone: cc.EditBox,\r\n        retrieve_verifica: cc.EditBox,\r\n        retrieve_psw: cc.EditBox,\r\n        retrieve_cpsw: cc.EditBox,\r\n        retrieve_sendVerifica: [cc.Node],\r\n        label_retrivevcode: cc.Label,\r\n        btn_retrievePswSend: cc.Button,\r\n    },\r\n\r\n    onLoad() {\r\n        this.registerEvent();\r\n    },\r\n    start() {\r\n\r\n    },\r\n    registerEvent() {\r\n        glGame.emitter.on(\"retrievePswCD\", this.retrievePswCD, this);\r\n        glGame.emitter.on(\"changePswSuccess\", this.changePswSuccess, this);\r\n    },\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"retrievePswCD\", this);\r\n        glGame.emitter.off(\"changePswSuccess\", this);\r\n    },\r\n\r\n    changePswSuccess(){\r\n        this.remove();\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_retrievePsw\": this.retrievePsw_cb(); break;\r\n            case \"btn_retrievePswSend\": this.retrievePswSend_cb(); break;\r\n            case \"btn_close\": this.remove(); break;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    //找回密码\r\n    retrievePsw_cb() {\r\n        let msg = {};\r\n        let phone = this.checkPhone(this.retrieve_phone.string)\r\n        if (!phone) return;\r\n        let psw = this.checkPassword(this.retrieve_psw.string, this.retrieve_cpsw.string);\r\n        if (!psw) return;\r\n\r\n        let code = this.retrieve_verifica.string;\r\n        msg.phone = phone;\r\n        msg.pwd = psw;\r\n        msg.code = code;\r\n        glGame.user.ReqRetrievePwd(msg);\r\n    },\r\n    //找回密码发送验证码\r\n    retrievePswSend_cb() {\r\n        let phone = this.checkPhone(this.retrieve_phone.string)\r\n        if (!phone) return;\r\n        glGame.user.ReqPostPhoneCode({ phone: phone, type: 8 });\r\n    },\r\n\r\n    //找回密码验证码\r\n    retrievePswCD(msg) {\r\n        if (glGame.user.get(\"retrievePswState\") && msg > 0) {\r\n            this.btn_retrievePswSend.node.getChildByName(\"img_liang\").active = false;\r\n            this.btn_retrievePswSend.node.getChildByName(\"img_an\").active = true;\r\n            this.btn_retrievePswSend.interactable = false;\r\n            this.retrieve_sendVerifica[0].active = false;\r\n            this.retrieve_sendVerifica[1].active = true;\r\n            this.label_retrivevcode.string = `${msg}秒`;\r\n        } else {\r\n            this.btn_retrievePswSend.node.getChildByName(\"img_liang\").active = true;\r\n            this.btn_retrievePswSend.node.getChildByName(\"img_an\").active = false;\r\n            this.btn_retrievePswSend.interactable = true;\r\n            this.retrieve_sendVerifica[0].active = true;\r\n            this.retrieve_sendVerifica[1].active = false;\r\n        }\r\n    },\r\n\r\n    // 手机号码检查\r\n    checkPhone(acc) {\r\n        if (!acc) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PHONENULL);\r\n            return null;\r\n        }\r\n        //放开限定\r\n        //var reg = /^1[3|4|5|6|7|8|9][0-9]{9}$/;\r\n        //使用服务端限定正则方式\r\n        var reg = /^134[0-8]\\d{7}$|^13[^4]\\d{8}$|^14[5-9]\\d{8}$|^15[^4]\\d{8}$|^16[6]\\d{8}$|^17[0-8]\\d{8}$|^18[\\d]{9}$|^19[0-9]\\d{8}$/;\r\n        // let reg = /^\\d{11}$/; //验证规则\r\n        let isacc_matcher = reg.test(acc);\r\n        if (!isacc_matcher) {\r\n            glGame.panel.showErrorTip('请输入正确的手机号')\r\n            return false;\r\n        }\r\n        return acc;\r\n    },\r\n\r\n    // 密码检查\r\n    checkPassword(psw, confimpsw) {\r\n        if (!psw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.LOGPSWNULL);\r\n            return null;\r\n        }\r\n        if (psw.length < 6) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);\r\n            return false;\r\n        }\r\n        if (!/\\w$/.test(psw)) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWWRONGFUL);\r\n            return null;\r\n        }\r\n        if (confimpsw == null) return psw;\r\n        if (!confimpsw || psw !== confimpsw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWCOFAIL);\r\n            return null;\r\n        }\r\n        return psw;\r\n    },\r\n\r\n\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}