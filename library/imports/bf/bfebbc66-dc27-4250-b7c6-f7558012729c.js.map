{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\plaza_hall.js"],"names":["bgImg","glGame","baseclass","extend","properties","audio_welcome","type","cc","AudioClip","prefab_up","Prefab","prefab_center","prefab_comprehensive","prefab_down","prefab_arrvalTip","sprite_bg","Sprite","bg_list","SpriteFrame","onLoad","user","get","reqUrl","bgIndex","panel","closeLoading","isfirstEnterPlaza","audio","playSoundEffect","emitter","on","MESSAGE","UI","PLAZA_OPEN","plazaOpen","setPlazaBg","emit","SCENE","gameDisplayType","showChildPanel","node","arrvalTip","showPanel","zIndex","sys","localStorage","removeItem","nodeName","active","data","name","i","length","spriteFrame","width","winSize","getComponent","Widget","left","updateAlignment","bg_width","OnDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["// 设置背景图对应关系\r\nconst bgImg = [\"chessCard\",\"fishing\",\"arcade\",\"realPerson\",\"lottery\",\"sports\",\"compete\",\"room\",\"hot\",]\r\n\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        audio_welcome: {\r\n            type: cc.AudioClip,\r\n            default: null\r\n        },\r\n        prefab_up: cc.Prefab,\r\n        prefab_center: cc.Prefab,\r\n        prefab_comprehensive: cc.Prefab,\r\n        prefab_down: cc.Prefab,\r\n        prefab_arrvalTip: cc.Prefab,\r\n        sprite_bg: cc.Sprite,\r\n        bg_list: [cc.SpriteFrame],\r\n    },\r\n\r\n    onLoad() {\r\n\r\n        if (!glGame.user.get(\"url\")) {\r\n            glGame.user.reqUrl();\r\n        }\r\n        this.bgIndex = 0;\r\n\r\n        glGame.panel.closeLoading();\r\n        if (glGame.isfirstEnterPlaza) {\r\n            glGame.audio.playSoundEffect(this.audio_welcome, true);\r\n        }\r\n        glGame.emitter.on(MESSAGE.UI.PLAZA_OPEN, this.plazaOpen, this);\r\n        glGame.emitter.on(\"setplazabg\", this.setPlazaBg, this);\r\n\r\n\r\n        glGame.emitter.emit(MESSAGE.UI.SCENE);\r\n\r\n        //大厅主要预支初始化\r\n        let gameDisplayType = glGame.user.get(\"gameDisplayType\");\r\n        if (gameDisplayType == 2) {\r\n            // 综合版\r\n            glGame.panel.showChildPanel(this.prefab_comprehensive, this.node);\r\n            // glGame.panel.showPanelByName(\"comprehensive\");\r\n        } else {\r\n            // 棋牌版\r\n            glGame.panel.showChildPanel(this.prefab_center, this.node);\r\n            // glGame.panel.showPanelByName(\"center\");\r\n        }\r\n\r\n        glGame.panel.showChildPanel(this.prefab_up, this.node);\r\n        glGame.panel.showChildPanel(this.prefab_down, this.node);\r\n        let arrvalTip = glGame.panel.showPanel(this.prefab_arrvalTip);\r\n        arrvalTip.zIndex = 99;\r\n        \r\n        cc.sys.localStorage.removeItem(\"isAudioPlay\");\r\n    },\r\n\r\n    plazaOpen(nodeName) {\r\n        if (nodeName) {\r\n            this.node.active = true;\r\n            return;\r\n        }\r\n    },\r\n\r\n    setPlazaBg(data) {\r\n        if (data && data.name != null) {\r\n            for (let i = 0; i < bgImg.length; i++) {\r\n                if (data.name == bgImg[i]) {\r\n                    this.sprite_bg.spriteFrame = this.bg_list[i];\r\n\r\n                    // let gamegroup = this.node//.getChildByName(\"\").getChildByName(\"gamegroup\").width;\r\n                    let width = cc.winSize.width - data.width - 15;\r\n                    this.sprite_bg.node.getComponent(cc.Widget).left = data.width - 19;\r\n                    this.sprite_bg.node.getComponent(cc.Widget).updateAlignment();\r\n                    let bg_width = this.sprite_bg.node.width;\r\n                    if (width >= bg_width) {\r\n                        this.sprite_bg.node.width = width;\r\n                    }\r\n                }\r\n            }\r\n            // let bgIndex = data.index >= this.bg_list.lenght ? 0 : data.index;\r\n            // if (this.bgIndex != bgIndex) {\r\n            //     this.sprite_bg.spriteFrame = this.bg_list[this.bgIndex];\r\n            // }\r\n        } else {\r\n            this.sprite_bg.node.active = false;\r\n        }\r\n    },\r\n\r\n    OnDestroy() {\r\n        glGame.emitter.off(MESSAGE.UI.PLAZA_OPEN, this);\r\n        glGame.emitter.off(\"setplazabg\", this);\r\n    },\r\n});\r\n"]}