{"version":3,"sources":["assets\\modules\\public\\script\\account\\register.js"],"names":["glGame","baseclass","extend","properties","login_accf","cc","Node","login_acc","EditBox","login_psw","retrievepsw","Prefab","protocol","node_agree","Toggle","downFrame","onLoad","registerEvent","iSagree","start","initUI","unRegisterEvent","strAcc","storage","getItem","data","getSelfFunc","setString","isChecked","accLogin_cb","panel","showErrorTip","tips","REGISTRATION","PROTOCOL","regex","string","replace","acc","checkAcc","psw","checkPassword","logon","reqAccLogin","username","password","md5","setItem","editCheckAcc","str","ACCNULL","length","ACCLENGTH","reg","acc_check","test","ACCTYPE","confimpsw","LOGPSWNULL","PSWLENGTH","PSWWRONGFUL","PSWCOFAIL","onClick","name","node","goRegister_cb","showFindPsw","btn_protocol","selectExplain","remove","showRegistration","showChildPanel","user","get","self_edit_login_pwd","showServiceBox","USER","PASSWORD","SERVICE","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nglGame.baseclass.extend({\r\n\r\n    properties: {\r\n        //登录\r\n        login_accf: cc.Node,\r\n        login_acc: cc.EditBox,\r\n        login_psw: cc.EditBox,\r\n        retrievepsw: cc.Prefab,\r\n        protocol: cc.Prefab,\r\n        node_agree: cc.Toggle,\r\n        downFrame: cc.Node,\r\n    },\r\n\r\n    onLoad() {\r\n        this.registerEvent();\r\n        this.iSagree = false;\r\n    },\r\n    start() {\r\n        this.initUI();\r\n    },\r\n    registerEvent() {\r\n    },\r\n    unRegisterEvent() {\r\n    },\r\n\r\n    initUI() {\r\n        let strAcc = glGame.storage.getItem(\"accNumber\") ? glGame.storage.getItem(\"accNumber\").data : '';\r\n        if (strAcc != '') this.login_accf.getSelfFunc().setString(strAcc);\r\n        this.iSagree = glGame.storage.getItem(\"isAgree\") ? glGame.storage.getItem(\"isAgree\").data : true;\r\n        this.node_agree.isChecked = this.iSagree;\r\n    },\r\n\r\n    //账号登录\r\n    accLogin_cb() {\r\n        if (!this.iSagree) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PROTOCOL);\r\n            return;\r\n        }\r\n        //将空格去除指令\r\n        const regex = / /gi;\r\n        this.login_acc.string = this.login_acc.string.replace(regex, '');\r\n\r\n        let acc = this.checkAcc(this.login_acc.string);\r\n        if (!acc) return;\r\n        let psw = this.checkPassword(this.login_psw.string);\r\n        if (!psw) return;\r\n\r\n        glGame.logon.reqAccLogin({ username: acc, password: md5(psw) });    //username:phone,code:验证码,plat:5\r\n\r\n        glGame.storage.setItem(\"accNumber\", { data: acc })\r\n    },\r\n\r\n    editCheckAcc() {\r\n        let str = this.login_acc.string;\r\n        this.checkAcc(str);\r\n    },\r\n\r\n    // 账号检查\r\n    checkAcc(acc) {\r\n        if (!acc || acc == '') {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCNULL);\r\n            return false;\r\n        }\r\n        if (acc.length < 4) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCLENGTH);\r\n            return false;\r\n        }\r\n        // let reg = /^\\w{4,15}$/;\r\n        let reg = /^[A-Za-z0-9]{4,15}$/\r\n        let acc_check = reg.test(acc);\r\n        if (!acc_check) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.ACCTYPE);\r\n            return false;\r\n        }\r\n        return acc;\r\n    },\r\n\r\n    // 密码检查\r\n    checkPassword(psw, confimpsw) {\r\n        if (!psw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.LOGPSWNULL);\r\n            return null;\r\n        }\r\n        if (psw.length < 6) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);\r\n            return false;\r\n        }\r\n        if (!/\\w$/.test(psw)) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWWRONGFUL);\r\n            return null;\r\n        }\r\n        if (confimpsw == null) return psw;\r\n        if (!confimpsw || psw !== confimpsw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWCOFAIL);\r\n            return null;\r\n        }\r\n        return psw;\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_accLogin\": this.accLogin_cb(); break;\r\n            case \"btn_goregister\": this.goRegister_cb(); break;\r\n            case \"btn_forgetpas\": this.showFindPsw(); break;\r\n            case \"btn_explain\": this.btn_protocol(); break;\r\n            case \"checkExplain\": this.selectExplain(); break;\r\n            case \"btn_close\": this.remove(); break;\r\n            default: break;\r\n        }\r\n    },\r\n\r\n    //跳转立即注册\r\n    goRegister_cb() {\r\n        this.remove(false);\r\n        glGame.panel.showRegistration();\r\n    },\r\n\r\n    btn_protocol() {\r\n        glGame.panel.showChildPanel(this.protocol, this.node);\r\n    },\r\n\r\n    showFindPsw() {\r\n        if (glGame.user.get(\"loginSwitch\").self_edit_login_pwd == 1) {\r\n            glGame.panel.showChildPanel(this.retrievepsw, this.node);\r\n        } else {\r\n            glGame.panel.showServiceBox(glGame.tips.USER.PASSWORD.SERVICE);\r\n        }\r\n    },\r\n\r\n    selectExplain() {\r\n        this.iSagree = this.node_agree.isChecked;\r\n        glGame.storage.setItem(\"isAgree\", { data: this.iSagree })\r\n    },\r\n\r\n\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}