{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\enterRoom\\sangongentry.js"],"names":["glGame","baseclass","extend","properties","sgRecord","cc","Prefab","sgRule","goldCount","Label","level","type","Node","kmdContent","kmd","BGM","AudioClip","onLoad","gameid","node","zIndex","topRight","getChildByName","position","emitter","on","MESSAGE","UI","ROOM_ENTER_SHOW","RootNodeShow","ROOM_ENTER_HIDE","RootNodeHide","click_back","updateuserInfo","registerEvent","reqEnterArea","playEnterAnimation","active","unregisterEvent","onGameConfig","off","msg","gameConfig","initUI","gameID","scenetag","SANGONG","readyroom","configure","count","length","i","layout","dizhu","zhunru","getComponent","string","getFloat","BaseChips","EntranceRestrictions","onClick","name","enterGame","click_help","click_record","click_addgold","console","error","onScrollview","sys","localStorage","getItem","runAction","sequence","delayTime","callFunc","setItem","nCount","rightPos","lvNode","originPos","opacity","setPosition","v2","x","y","delay","moveTo1","moveTo","fadeIn","easing","easeBackOut","spawn","kmdCaches","kmdUsed","kmdDelay","kmdDelta","kmdYure","update","dt","createKmd","kmdNode","speed","splice","push","randValue","Math","random","cloneNode","pop","instantiate","parent","angle","scale","getRandomX","distance","randx","j","abs","room","reqMyGameState","then","panel","showMsgBox","user","isTourist","showRegisteredGift","suspicious","game","is_game","showDialog","showService","get","showShop","showJuHua","closeJuHua","setGoldRoomInfo","checkGold","coin","minCion","parseInt","i18n","t","showPanelByName","value","Number","div","toString","GoldTemp","setGameId","updateBgInfo","reqExitArea","remove","showPanel","set","key","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["glGame.baseclass.extend({\r\n\r\n    properties: {\r\n        sgRecord: cc.Prefab,\r\n        sgRule: cc.Prefab,\r\n        goldCount: cc.Label,\r\n        level: {\r\n            type: cc.Node,\r\n            default: []\r\n        },\r\n        kmdContent: cc.Node,\r\n        kmd: {\r\n            type: cc.Node,\r\n            default: []\r\n        },\r\n        BGM: {\r\n            type: cc.AudioClip,\r\n            default: null,\r\n        },\r\n    },\r\n\r\n    onLoad() {\r\n        this.gameid = 0;\r\n        this.node.zIndex = 20;\r\n        this.topRight = this.kmdContent.getChildByName(\"topright\").position;\r\n        glGame.emitter.on(MESSAGE.UI.ROOM_ENTER_SHOW, this.RootNodeShow, this);\r\n        glGame.emitter.on(MESSAGE.UI.ROOM_ENTER_HIDE, this.RootNodeHide, this);\r\n        glGame.emitter.on(\"nodeRemove\", this.click_back, this);\r\n        glGame.emitter.on(\"updateUserData\", this.updateuserInfo, this);\r\n        this.registerEvent();\r\n        this.reqEnterArea();\r\n        this.updateuserInfo();\r\n        this.playEnterAnimation();\r\n    },\r\n\r\n    RootNodeShow(){\r\n        this.node.active = true;\r\n        this.registerEvent();\r\n        this.reqEnterArea();\r\n    },\r\n\r\n    RootNodeHide(){\r\n        this.node.active = false;\r\n        this.unregisterEvent();\r\n    },\r\n\r\n    registerEvent() {\r\n        glGame.emitter.on(\"onGameConfig\", this.onGameConfig, this);\r\n    },\r\n\r\n    unregisterEvent() {\r\n        glGame.emitter.off(\"onGameConfig\", this);\r\n    },\r\n\r\n    onGameConfig(msg) {\r\n        this.gameConfig = msg;\r\n        this.initUI();\r\n    },\r\n    \r\n    reqEnterArea() {\r\n        this.gameID = glGame.scenetag.SANGONG;\r\n        glGame.readyroom.reqEnterArea(glGame.scenetag.SANGONG);\r\n    },\r\n   \r\n    initUI() {\r\n        this.node.active = true;\r\n        let configure = this.gameConfig;\r\n        let count = this.level.length;\r\n        for (let i = 1; i < count; i++) {\r\n            let layout = this.level[i].getChildByName(\"layout\");\r\n            let dizhu = layout.getChildByName(\"dizhu\");\r\n            let zhunru = layout.getChildByName(\"zhunrun\");\r\n\r\n            dizhu.getChildByName(\"dizhu_num\").getComponent(cc.Label).string = this.getFloat(configure[i].BaseChips);\r\n            zhunru.getChildByName(\"zhunru_num\").getComponent(cc.Label).string = this.getFloat(configure[i].EntranceRestrictions);\r\n        }\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"primary\": this.enterGame(99); break;\r\n            case \"intermediate\": this.enterGame(1); break;\r\n            case \"senior\": this.enterGame(2); break;\r\n            case \"tuhao\": this.enterGame(3); break;\r\n            case \"btn_back\": this.click_back(); break;\r\n            case \"btn_help\": this.click_help(); break;\r\n            case \"btn_record\": this.click_record(); break;\r\n            case \"mycoinInfo\": this.click_addgold(); break;\r\n            case \"btn_chongzhi\": this.click_addgold(); break;\r\n            default: console.error(\"no find button name -> %s\", name);\r\n        }\r\n    },\r\n\r\n    onScrollview() {\r\n        this.node.getChildByName(\"gesture\").active = false;\r\n    },\r\n\r\n    // 播放进入动画\r\n    playEnterAnimation() {\r\n        // 手势动画\r\n        if(!cc.sys.localStorage.getItem(\"zjh_gesture\")) {\r\n            this.node.getChildByName(\"gesture\").active = true;\r\n            this.node.runAction(cc.sequence(cc.delayTime(3), cc.callFunc(()=> {\r\n                this.node.getChildByName(\"gesture\").active = false;\r\n            })));\r\n\r\n            cc.sys.localStorage.setItem(\"zjh_gesture\", true);\r\n        }\r\n\r\n        let nCount = this.level.length;\r\n        let rightPos = this.level[nCount - 2].position;\r\n\r\n        for(let i = 0; i < nCount; i++) {\r\n            let lvNode = this.level[i];\r\n            let originPos = lvNode.position;\r\n            lvNode.opacity = 0;\r\n            lvNode.setPosition(cc.v2(originPos.x + 400, originPos.y));\r\n            let delay = cc.delayTime(i * 0.05);\r\n            let moveTo1 = cc.moveTo(0.3, cc.v2(originPos, originPos.y));\r\n            let fadeIn = cc.fadeIn(0.1);\r\n            moveTo1.easing(cc.easeBackOut());\r\n            lvNode.runAction(cc.sequence(delay, cc.spawn(moveTo1, fadeIn)));\r\n        }\r\n\r\n        this.kmdCaches = [];    // 孔明灯缓存\r\n        this.kmdUsed = [];      // 孔明灯列表\r\n        this.kmdDelay = 2;      // 孔明灯生成间隔\r\n        this.kmdDelta = 0;      // 孔明灯累计时间\r\n        this.kmdYure();\r\n    },\r\n\r\n    update(dt) {\r\n        this.kmdDelta += dt;\r\n        if(this.kmdDelta > this.kmdDelay) {\r\n            this.kmdDelta = 0;\r\n            this.createKmd();\r\n\r\n            // console.log(\"cached length: \" + this.kmdCaches.length);\r\n            // console.log(\"used length: \" + this.kmdUsed.length);\r\n        }\r\n\r\n        // 移动位置\r\n        let kmdNode;\r\n        for(let i = 0, count = this.kmdUsed.length; i < count; i++) {\r\n            kmdNode = this.kmdUsed[i];\r\n            kmdNode.x += kmdNode.speed.x * dt;\r\n            kmdNode.y += kmdNode.speed.y * dt;\r\n        }\r\n\r\n        for(let i = 0, count = this.kmdUsed.length; i < count; i++) {\r\n            kmdNode = this.kmdUsed[i];\r\n            if(kmdNode.x > this.topRight.x || kmdNode.y > this.topRight.y) {\r\n                this.kmdUsed.splice(i, 1);\r\n                this.kmdCaches.push(kmdNode);\r\n                kmdNode.active = false;\r\n                return;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    // 孔明灯预热\r\n    kmdYure() {\r\n        for(let i = 0; i < 300; i++) {\r\n            this.update(1);\r\n        }\r\n    },\r\n\r\n    // 创建新的孔明灯\r\n    createKmd() {\r\n        let randValue = Math.random() * 0.9 + 0.1;\r\n\r\n        if(Math.random() < 0.7) {\r\n            randValue = Math.random() * 0.3 + 0.1;\r\n        }\r\n\r\n        let cloneNode;\r\n        if(this.kmdCaches.length > 0) {\r\n           cloneNode = this.kmdCaches.pop();\r\n        }\r\n\r\n        if(!cloneNode) {\r\n            cloneNode = cc.instantiate(Math.random() < 0.5 ? this.kmd[0] : this.kmd[1]);\r\n        }\r\n        cloneNode.active = true;\r\n    \r\n        cloneNode.parent = this.kmdContent;\r\n        if(randValue > 0.5) {\r\n            cloneNode.speed = cc.v2(Math.random() * 2,  randValue * 20 + 10);\r\n        } else {\r\n            cloneNode.speed = cc.v2(0,  randValue * 20 + 10);\r\n        }\r\n\r\n        cloneNode.angle = (Math.random() - 0.5) * 10; \r\n        cloneNode.scale = randValue;\r\n        cloneNode.opacity = randValue * 255;\r\n        cloneNode.x = this.getRandomX();\r\n        cloneNode.y = randValue < 0.5 ? 0 : -640;\r\n        this.kmdUsed.push(cloneNode);\r\n    },\r\n\r\n    // 获取随机x坐标\r\n    getRandomX() {\r\n        let nCount = this.kmdUsed.length;\r\n        let distance = nCount > 9 ? 50 : 150;\r\n        if(nCount == 0) {\r\n            return (Math.random() - 0.5) * 1800;\r\n        }\r\n\r\n        let randx = 0;\r\n\r\n        for(let i = 0; i < 20; i++) {\r\n            randx = (Math.random() - 0.5) * 1800;\r\n            for(let j = 0; j < nCount; j++) {\r\n                if(Math.abs(randx - this.kmdUsed[j].x) > distance) {\r\n                    return randx;\r\n                }\r\n            }\r\n        }\r\n\r\n        return randx;\r\n    },\r\n\r\n    /**\r\n     * 进入金币场房间\r\n     * @param level 99：体验场 场次类型 1:普通车 2:贵宾场 3:富豪场 \r\n     */\r\n    enterGame(level) {\r\n        glGame.room.reqMyGameState(this.gameID, level).then(() => {\r\n            let gameID = this.gameID;\r\n            if (this.gameConfig[level] == null) {\r\n                glGame.panel.showMsgBox('提示', '该房间尚未开放，请尝试其他房间。');\r\n                return;\r\n            }\r\n\r\n            if (glGame.user.isTourist()) {\r\n                if (level != 99) {\r\n                    glGame.panel.showRegisteredGift(true);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if((glGame.user.suspicious == 1 && glGame.user.game == 2 ) || glGame.user.is_game == 2 ){\r\n                glGame.panel.showDialog(\"\", \"您的账号数据异常，暂时禁止进入游戏，如有疑问，请联系客服！\", () => { glGame.panel.showService() }, () => {}, \"我知道了\", \"联系客服\")\r\n                return;\r\n            }\r\n\r\n            if (this.gameConfig[level].EntranceRestrictions > glGame.user.get(\"coin\")) {\r\n                let string = `<color=#99C7FF>您的金币不足，该房间需要</c> <color=#ff0000> ${this.getFloat(this.gameConfig[level].EntranceRestrictions)}  </c><color=#99C7FF>金币才可下注，是否马上前往充值？</c>`\r\n                glGame.panel.showDialog(\"\", string, () => { glGame.panel.showShop(100) }, () => { }, \"取消\", \"充值\");\r\n                return;\r\n            }\r\n\r\n            glGame.panel.showJuHua();\r\n            this.node.runAction(cc.sequence(\r\n                cc.delayTime(15),\r\n                cc.callFunc(() => {\r\n                    glGame.panel.closeJuHua();\r\n                })\r\n            ))\r\n            \r\n            glGame.room.setGoldRoomInfo(gameID, level);\r\n        })\r\n    },\r\n\r\n    /**\r\n     * 检查玩家金币是否足够\r\n     * @returns {boolean}\r\n     */\r\n    checkGold(coin, minCion) {\r\n        if (parseInt(coin) < parseInt(minCion)) {\r\n            glGame.panel.showDialog(glGame.i18n.t(\"USER.GOLDLACK.TITLE\"), glGame.i18n.t(\"USER.GOLDLACK.CONTENT\"), () => {\r\n                glGame.panel.showPanelByName(\"shop\");\r\n            }, null);\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    getFloat(value) {\r\n        return (Number(value).div(100)).toString();\r\n    },\r\n\r\n    updateuserInfo() {\r\n        let coin = glGame.user.get(\"coin\")\r\n        this.goldCount.string = glGame.user.GoldTemp(coin);\r\n    },\r\n\r\n    setGameId(gameid) {\r\n        this.gameid = gameid;\r\n    },\r\n\r\n    updateBgInfo() {\r\n    },\r\n\r\n    click_addgold() {\r\n        glGame.panel.showShop(30);\r\n    },\r\n\r\n    click_back() {\r\n        glGame.readyroom.reqExitArea();\r\n        this.remove();\r\n    },\r\n\r\n    click_help() {\r\n        let panel = glGame.panel.showPanel(this.sgRule);\r\n        panel.zIndex = 30;\r\n    },\r\n\r\n    click_record() {\r\n        let panel = glGame.panel.showPanel(this.sgRecord);\r\n        panel.zIndex = 30;\r\n    },\r\n\r\n    set(key, value) {\r\n        this[key] = value;\r\n    },\r\n\r\n    get(key) {\r\n        return this[key];\r\n    },\r\n\r\n    OnDestroy() {\r\n        glGame.emitter.off(MESSAGE.UI.ROOM_ENTER_SHOW,this);\r\n        glGame.emitter.off(MESSAGE.UI.ROOM_ENTER_HIDE,this);\r\n        glGame.emitter.off(\"nodeRemove\", this);\r\n        glGame.emitter.off(\"updateUserData\",this);\r\n        this.unregisterEvent();\r\n    }\r\n});\r\n"]}