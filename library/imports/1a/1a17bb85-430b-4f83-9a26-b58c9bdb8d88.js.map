{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\setting\\settingModifypsd.js"],"names":["EditBoxCustom","require","glGame","baseclass","extend","properties","modifypsd","cc","Node","contactkefu","psw","EditBox","newpsw","confirmpsw","cuspsw","cusnewpsd","cusconfirm","onLoad","registerEvent","initUI","onClick","name","node","click_confirm","panel","showService","user","get","self_edit_login_pwd","active","checkPassword","string","reqEditPwd","old_pwd","md5","pwd","type","showErrorTip","tips","EDITBOX","PSWNULL","length","REGISTRATION","PSWLENGTH","test","PSWWRONGFUL","NEWPSWNULL","NEWPSWWRONGFUL","CONFIRMPSWNULL","CONFIRMPSWWRONGFUL","OLDNEWPSWEQUALS","PSWCOFAIL","msg","showTip","clearUIData","setString","emitter","on","editpswsuccess","unRegisterEvent","off","OnDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 设置\r\n */\r\n\r\nlet EditBoxCustom = require(\"EditBoxCustom\");\r\n\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        modifypsd: cc.Node,\r\n        contactkefu: cc.Node,\r\n\r\n        psw: cc.EditBox,        // 旧密码\r\n        newpsw: cc.EditBox,     // 新密码\r\n        confirmpsw: cc.EditBox,  // 确认新密码\r\n\r\n        cuspsw: EditBoxCustom,\r\n        cusnewpsd: EditBoxCustom,\r\n        cusconfirm: EditBoxCustom,\r\n    },\r\n\r\n    onLoad() {\r\n        this.registerEvent();\r\n        this.initUI();\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"confirm\":\r\n                this.click_confirm();\r\n                break;\r\n            case \"kefu\":\r\n                glGame.panel.showService(false);\r\n                break;\r\n        }\r\n    },\r\n\r\n    initUI() {\r\n        if (glGame.user.get(\"loginSwitch\").self_edit_login_pwd == 1) {\r\n            this.modifypsd.active = true;\r\n            this.contactkefu.active = false;\r\n        } else {\r\n            this.contactkefu.active = true;\r\n            this.modifypsd.active = false;\r\n        }\r\n    },\r\n\r\n    // 确认更改密码\r\n    click_confirm() {\r\n        let psw = this.checkPassword(this.psw.string, this.newpsw.string, this.confirmpsw.string);\r\n        if (psw) {\r\n            glGame.user.reqEditPwd({ old_pwd: md5(this.psw.string), pwd: md5(this.newpsw.string), type: 1 });\r\n        }\r\n    },\r\n\r\n    // 密码检查\r\n    checkPassword(psw, newpsw, confirmpsw) {\r\n        if (!psw) return this.showErrorTip(glGame.tips.EDITBOX.PSWNULL);\r\n        if (psw.length < 6) return glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);\r\n        if (!/\\w$/.test(psw)) return this.showErrorTip(glGame.tips.EDITBOX.PSWWRONGFUL);\r\n        if (!newpsw) return this.showErrorTip(glGame.tips.EDITBOX.NEWPSWNULL);\r\n        if (newpsw.length < 6) return glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);\r\n        if (!/\\w$/.test(newpsw)) return this.showErrorTip(glGame.tips.EDITBOX.NEWPSWWRONGFUL);\r\n        if (!confirmpsw) return this.showErrorTip(glGame.tips.EDITBOX.CONFIRMPSWNULL);\r\n        if (confirmpsw.length < 6) return glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWLENGTH);\r\n        if (!/\\w$/.test(confirmpsw)) return this.showErrorTip(glGame.tips.EDITBOX.CONFIRMPSWWRONGFUL);\r\n        if (psw === newpsw) return this.showErrorTip(glGame.tips.EDITBOX.OLDNEWPSWEQUALS);\r\n        if (newpsw !== confirmpsw) return this.showErrorTip(glGame.tips.EDITBOX.PSWCOFAIL);\r\n        return psw;\r\n    },\r\n\r\n    showErrorTip(msg) {\r\n        glGame.panel.showTip(msg);\r\n        return null;\r\n    },\r\n\r\n    clearUIData() {\r\n        this.cuspsw.setString(\"\");\r\n        this.cusnewpsd.setString(\"\");\r\n        this.cusconfirm.setString(\"\");\r\n    },\r\n\r\n    // 注册界面监听事件\r\n    registerEvent() {\r\n        glGame.emitter.on(\"editpswsuccess\", this.editpswsuccess, this);\r\n    },\r\n\r\n    // 销毁界面监听事件\r\n    unRegisterEvent() {\r\n        glGame.emitter.off(\"editpswsuccess\", this);\r\n    },\r\n\r\n    editpswsuccess() {\r\n        this.clearUIData();\r\n    },\r\n\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n});\r\n"]}