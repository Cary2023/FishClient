{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\luckDraw\\luckDraw.js"],"names":["glGame","baseclass","extend","properties","leftbtns","cc","Node","fnt_needScore","Font","spin_node","Sprite","img_spin","SpriteFrame","start_node","img_start","startbg_node","img_startbg","outside_node","img_outside","turnTable","img_turnTable","selectPanel","fullService","fullServiceItem","personRecord","nopersonRecord","recordItem","lab_needScore","Label","lab_myScore","lab_getRule","allGift","turnFlash","sp_turnFlash","sp","SkeletonData","maskButton","drawAudio","type","AudioClip","point_node","img_point","onLoad","registerEvent","in_type","angle","startTurnTable","time","switchPanel","btnStart","children","playBtnAni","emitter","on","updateDialPrizeList","updateTopPrize","getDialResult","updateMyRecord","updateDialScore","node","name","MESSAGE","UI","ACTION_END","reqData","closeLuckDrawMaskButton","unregisterEvent","off","checkRedDot","dialPrizeList","consume_integral","div","Number","string","user","redDotData","dialRed","emit","active","stopAllActions","runAction","repeatForever","sequence","scaleTo","getFloat","reqDialIntegral","updateAwardNum","dialTopPrize","length","console","log","initTopPrize","childrenCount","recordIndex","Count","i","instantiate","parent","nickname","lab_type","dial_type","prize","getChildByName","getComponent","RichText","panel","showEffectNode","playScrollNotice","scheduleOnce","reqDialTopPrizeLog","Math","random","delayTime","callFunc","addItem","award","item","destroy","setSiblingIndex","myDialRecord","destroyAllChildren","removeAllChildren","create_time","color","plazaColor","gain","dialScore","myDialResult","treasure","setFlash","Button","interactable","setScale","audioEngine","setVolume","audio","getBGM","runTurnTable","reqDial","isTourist","showRegisteredGift","showErrorTip","tips","LUCKDRAW","SCORENOTENOUGH","reqDialPrize","onClick","switchTable","remove","error","selectType","flash","Skeleton","setAnimation","setCompleteListener","trackEntry","loopCount","changeSkin","index","spriteFrame","font","_children","zIndex","reqDialPersonal","scoreBet","dialRefreshTime","get","getIndex","playSoundEffect","targetAngle","abs","rotateBy","easing","easeExponentialOut","showAwardBox","CONGRATULATE","awardtype","COIN","value","coin","getBGMVolume","_easeExponentialOutObj","dt","pow","reverse","_easeExponentialInObj","allItem","id","item_id","toString","OnDestroy"],"mappings":";;;;;;AACAA,MAAM,CAACC,SAAP,CAAiBC,MAAjB,CAAwB;AAEpBC,EAAAA,UAAU,EAAE;AACRC,IAAAA,QAAQ,EAAEC,EAAE,CAACC,IADL;AAERC,IAAAA,aAAa,EAAE,CAACF,EAAE,CAACG,IAAJ,CAFP;AAGRC,IAAAA,SAAS,EAAEJ,EAAE,CAACK,MAHN;AAIRC,IAAAA,QAAQ,EAAE,CAACN,EAAE,CAACO,WAAJ,CAJF;AAKRC,IAAAA,UAAU,EAAER,EAAE,CAACC,IALP;AAMRQ,IAAAA,SAAS,EAAE,CAACT,EAAE,CAACO,WAAJ,CANH;AAORG,IAAAA,YAAY,EAAEV,EAAE,CAACK,MAPT;AAQRM,IAAAA,WAAW,EAAE,CAACX,EAAE,CAACO,WAAJ,CARL;AASRK,IAAAA,YAAY,EAAEZ,EAAE,CAACK,MATT;AAURQ,IAAAA,WAAW,EAAE,CAACb,EAAE,CAACO,WAAJ,CAVL;AAWRO,IAAAA,SAAS,EAAEd,EAAE,CAACC,IAXN;AAYRc,IAAAA,aAAa,EAAE,CAACf,EAAE,CAACO,WAAJ,CAZP;AAaRS,IAAAA,WAAW,EAAEhB,EAAE,CAACC,IAbR;AAcRgB,IAAAA,WAAW,EAAEjB,EAAE,CAACC,IAdR;AAeRiB,IAAAA,eAAe,EAAElB,EAAE,CAACC,IAfZ;AAgBRkB,IAAAA,YAAY,EAAEnB,EAAE,CAACC,IAhBT;AAiBRmB,IAAAA,cAAc,EAAEpB,EAAE,CAACC,IAjBX;AAkBRoB,IAAAA,UAAU,EAAErB,EAAE,CAACC,IAlBP;AAmBRqB,IAAAA,aAAa,EAAEtB,EAAE,CAACuB,KAnBV;AAoBRC,IAAAA,WAAW,EAAExB,EAAE,CAACuB,KApBR;AAqBRE,IAAAA,WAAW,EAAEzB,EAAE,CAACuB,KArBR;AAsBRG,IAAAA,OAAO,EAAE1B,EAAE,CAACC,IAtBJ;AAsBS;AACjB0B,IAAAA,SAAS,EAAE3B,EAAE,CAACC,IAvBN;AAwBR2B,IAAAA,YAAY,EAAE,CAACC,EAAE,CAACC,YAAJ,CAxBN;AAyBRC,IAAAA,UAAU,EAAE/B,EAAE,CAACC,IAzBP;AAyBa;AACrB+B,IAAAA,SAAS,EAAE;AACPC,MAAAA,IAAI,EAAEjC,EAAE,CAACkC,SADF;AAEP,iBAAS;AAFF,KA1BH;AA8BRC,IAAAA,UAAU,EAAEnC,EAAE,CAACK,MA9BP;AA+BR+B,IAAAA,SAAS,EAAE,CAACpC,EAAE,CAACO,WAAJ;AA/BH,GAFQ;AAoCpB;AAEA8B,EAAAA,MAtCoB,oBAsCX;AACL,SAAKC,aAAL,GADK,CAEL;;AACA,SAAKC,OAAL,GAAe,CAAf;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,cAAL,GAAsB,IAAtB,CALK,CAKsB;;AAC3B,SAAKC,IAAL,GAAY,IAAZ,CANK,CAMY;;AACjB,SAAKC,WAAL,CAAiB,aAAjB;AACA,SAAKC,QAAL,GAAgB,KAAKpC,UAAL,CAAgBqC,QAAhB,CAAyB,CAAzB,CAAhB;AACA,SAAKC,UAAL;AACH,GAhDmB;AAiDpBR,EAAAA,aAjDoB,2BAiDJ;AACZ3C,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,qBAAlB,EAAyC,KAAKC,mBAA9C,EAAmE,IAAnE;AACAtD,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,gBAAlB,EAAoC,KAAKE,cAAzC,EAAyD,IAAzD;AACAvD,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,eAAlB,EAAmC,KAAKG,aAAxC,EAAuD,IAAvD;AACAxD,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,gBAAlB,EAAoC,KAAKI,cAAzC,EAAyD,IAAzD;AACAzD,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,iBAAlB,EAAqC,KAAKK,eAA1C,EAA2D,IAA3D;AACA1D,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,WAAqB,KAAKM,IAAL,CAAUC,IAA/B,SAAsCC,OAAO,CAACC,EAAR,CAAWC,UAAjD,GAA+D,KAAKC,OAApE,EAA6E,IAA7E;AACAhE,IAAAA,MAAM,CAACoD,OAAP,CAAeC,EAAf,CAAkB,yBAAlB,EAA6C,KAAKY,uBAAlD,EAA2E,IAA3E;AACH,GAzDmB;AA2DpBC,EAAAA,eA3DoB,6BA2DF;AACdlE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,qBAAnB,EAA0C,IAA1C;AACAnE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,gBAAnB,EAAqC,IAArC;AACAnE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,eAAnB,EAAoC,IAApC;AACAnE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,gBAAnB,EAAqC,IAArC;AACAnE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,iBAAnB,EAAsC,IAAtC;AACAnE,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,WAAsB,KAAKR,IAAL,CAAUC,IAAhC,SAAuCC,OAAO,CAACC,EAAR,CAAWC,UAAlD,GAAgE,IAAhE;AACA/D,IAAAA,MAAM,CAACoD,OAAP,CAAee,GAAf,CAAmB,yBAAnB,EAA8C,IAA9C;AACH,GAnEmB;AAoEpB;AACAC,EAAAA,WArEoB,yBAqEP;AACT,QAAK,KAAKC,aAAL,CAAmB,CAAnB,EAAsBC,gBAAvB,CAAyCC,GAAzC,CAA6C,GAA7C,KAAqDC,MAAM,CAAC,KAAK3C,WAAL,CAAiB4C,MAAlB,CAA/D,EAA0F;AACtFzE,MAAAA,MAAM,CAAC0E,IAAP,CAAYC,UAAZ,CAAuBC,OAAvB,GAAiC,CAAjC;AACH,KAFD,MAEK;AACD5E,MAAAA,MAAM,CAAC0E,IAAP,CAAYC,UAAZ,CAAuBC,OAAvB,GAAiC,CAAjC;AACH;;AACD5E,IAAAA,MAAM,CAACoD,OAAP,CAAeyB,IAAf,CAAoB,WAApB;AACH,GA5EmB;AA6EpBZ,EAAAA,uBA7EoB,qCA6EM;AACtB,SAAK7B,UAAL,CAAgB0C,MAAhB,GAAyB,KAAzB;AACA,SAAKhC,cAAL,GAAsB,IAAtB;AACH,GAhFmB;AAiFpBK,EAAAA,UAjFoB,wBAiFR;AACR,SAAKF,QAAL,CAAc8B,cAAd;AACA,SAAK9B,QAAL,CAAc+B,SAAd,CAAwB3E,EAAE,CAAC4E,aAAH,CACpB5E,EAAE,CAAC6E,QAAH,CACI7E,EAAE,CAAC8E,OAAH,CAAW,IAAX,EAAgB,GAAhB,EAAoB,GAApB,CADJ,EAEI9E,EAAE,CAAC8E,OAAH,CAAW,IAAX,EAAgB,CAAhB,EAAkB,CAAlB,CAFJ,CADoB,CAAxB;AAMH,GAzFmB;AA0FpB;AACA7B,EAAAA,mBA3FoB,iCA2FE;AAClB,SAAKe,aAAL,GAAqBrE,MAAM,CAAC0E,IAAP,CAAYL,aAAjC;AACA,SAAK1C,aAAL,CAAmB8C,MAAnB,cAAgC,KAAKW,QAAL,CAAc,KAAKf,aAAL,CAAmB,KAAKzB,OAAxB,EAAiC0B,gBAA/C,CAAhC;AACAtE,IAAAA,MAAM,CAAC0E,IAAP,CAAYW,eAAZ;AACA,SAAKC,cAAL;AACH,GAhGmB;AAiGpB;AACA/B,EAAAA,cAlGoB,4BAkGH;AACb,SAAKgC,YAAL,GAAoBvF,MAAM,CAAC0E,IAAP,CAAYa,YAAhC;;AACA,QAAG,KAAKA,YAAL,CAAkBC,MAAlB,GAAyB,CAA5B,EAA8B;AAC1B,WAAKzC,IAAL,GAAY,KAAKwC,YAAL,CAAkB,KAAKA,YAAL,CAAkBC,MAAlB,GAA2B,CAA7C,EAAgDzC,IAA5D;AACH;;AACD0C,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyB,KAAKH,YAA9B;AACA,SAAKI,YAAL;AACH,GAzGmB;AA0GpB;AACAA,EAAAA,YA3GoB,0BA2GL;AACX,QAAI,KAAKrE,WAAL,CAAiBsE,aAAjB,IAAkC,CAAtC,EAAyC;AACrC,WAAKC,WAAL,GAAmB,CAAnB;AACH,KAFD,MAEO;AACH,WAAKA,WAAL,GAAmB,EAAnB;AACA,UAAIC,KAAK,GAAG,KAAKP,YAAL,CAAkBC,MAAlB,IAA4B,EAA5B,GAAiC,EAAjC,GAAsC,KAAKD,YAAL,CAAkBC,MAApE;;AACA,WAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAApB,EAA2BC,CAAC,EAA5B,EAAgC;AAC5B,YAAIxE,eAAe,GAAGlB,EAAE,CAAC2F,WAAH,CAAe,KAAKzE,eAApB,CAAtB;AACAA,QAAAA,eAAe,CAAC0E,MAAhB,GAAyB,KAAK3E,WAA9B,CAF4B,CAG5B;;AACA,YAAIsC,IAAI,GAAG,KAAK2B,YAAL,CAAkBQ,CAAlB,EAAqBG,QAAhC;AAAA,YAA0CC,QAAQ,GAAG,KAAKZ,YAAL,CAAkBQ,CAAlB,EAAqBK,SAA1E;AAAA,YAAqFC,KAAK,GAAG,KAAKjB,QAAL,CAAc,KAAKG,YAAL,CAAkBQ,CAAlB,EAAqBM,KAAnC,CAA7F;AACA9E,QAAAA,eAAe,CAAC+E,cAAhB,CAA+B,QAA/B,EAAyCC,YAAzC,CAAsDlG,EAAE,CAACmG,QAAzD,EAAmE/B,MAAnE,yCACyBb,IADzB,4CAC0DuC,QAD1D,iEACgGE,KADhG;AAEA9E,QAAAA,eAAe,CAAC+E,cAAhB,CAA+B,IAA/B,EAAqCxB,MAArC,GAA8CiB,CAAC,GAAG,CAAJ,IAAS,CAAvD;AACH;;AACD/F,MAAAA,MAAM,CAACyG,KAAP,CAAaC,cAAb,CAA4B,IAA5B,EAAkC,KAAKpF,WAAvC,EAAoD,IAApD,EAA0D,IAA1D;AACH;;AACD,SAAKqF,gBAAL;AACH,GA7HmB;AA8HpBA,EAAAA,gBA9HoB,8BA8HD;AAAA;;AACf,QAAG,KAAKpB,YAAL,CAAkBC,MAAlB,IAA4B,CAA/B,EAAiC;AAC7B,WAAKoB,YAAL,CAAkB,YAAI;AAClB5G,QAAAA,MAAM,CAAC0E,IAAP,CAAYmC,kBAAZ,CAA+B,KAAI,CAAC9D,IAApC;AACH,OAFD,EAEE,CAFF;AAGA;AACH;;AACD,QAAIA,IAAI,GAAG+D,IAAI,CAACC,MAAL,KAAgB,CAAhB,GAAoB,CAA/B;AACA,SAAKpD,IAAL,CAAUqB,SAAV,CAAoB3E,EAAE,CAAC6E,QAAH,CAChB7E,EAAE,CAAC2G,SAAH,CAAajE,IAAb,CADgB,EAEhB1C,EAAE,CAAC4G,QAAH,CAAY,YAAM;AACd,MAAA,KAAI,CAACC,OAAL;;AACA,MAAA,KAAI,CAACrB,WAAL;;AACA,UAAI,KAAI,CAACA,WAAL,IAAoB,KAAI,CAACN,YAAL,CAAkBC,MAA1C,EAAkD;AAC9CxF,QAAAA,MAAM,CAAC0E,IAAP,CAAYmC,kBAAZ,CAA+B,KAAI,CAAC9D,IAApC;AACH,OAFD,MAEO;AACH,QAAA,KAAI,CAAC4D,gBAAL;AACH;AACJ,KARD,CAFgB,CAApB;AAYH,GAlJmB;AAmJpB;AACArB,EAAAA,cApJoB,4BAoJH;AACb,SAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhE,OAAL,CAAa6D,aAAjC,EAAgDG,CAAC,EAAjD,EAAqD;AACjD,UAAIoB,KAAK,GAAG,KAAK/B,QAAL,CAAc,KAAKf,aAAL,CAAmB,KAAKzB,OAAxB,EAAiCwE,IAAjC,CAAsCrB,CAAtC,EAAyCoB,KAAvD,CAAZ;AACA,WAAKpF,OAAL,CAAamB,QAAb,CAAsB6C,CAAtB,EAAyBO,cAAzB,CAAwC,QAAxC,EAAkDC,YAAlD,CAA+DlG,EAAE,CAACuB,KAAlE,EAAyE6C,MAAzE,GAAkF0C,KAAlF;AACH;AACJ,GAzJmB;AA0JpB;AACAD,EAAAA,OA3JoB,qBA2JV;AACN,QAAI,CAAC,KAAK3B,YAAL,CAAkB,KAAKM,WAAvB,CAAL,EAA0C;AAC1C,QAAI,KAAKvE,WAAL,CAAiBsE,aAAjB,IAAkC,EAAtC,EAA0C,KAAKtE,WAAL,CAAiB4B,QAAjB,CAA0B,KAAK5B,WAAL,CAAiBsE,aAAjB,GAAiC,CAA3D,EAA8DyB,OAA9D;AAC1C,QAAI9F,eAAe,GAAGlB,EAAE,CAAC2F,WAAH,CAAe,KAAKzE,eAApB,CAAtB;AACAA,IAAAA,eAAe,CAAC0E,MAAhB,GAAyB,KAAK3E,WAA9B;AACAC,IAAAA,eAAe,CAAC+F,eAAhB,CAAgC,CAAhC;AACA/F,IAAAA,eAAe,CAACuD,MAAhB,GAAyB,IAAzB;AACA,QAAIlB,IAAI,GAAG,KAAK2B,YAAL,CAAkB,KAAKM,WAAvB,EAAoCK,QAA/C;AAAA,QACIC,QAAQ,GAAG,KAAKZ,YAAL,CAAkB,KAAKM,WAAvB,EAAoCO,SADnD;AAAA,QAEIC,KAAK,GAAG,KAAKjB,QAAL,CAAc,KAAKG,YAAL,CAAkB,KAAKM,WAAvB,EAAoCQ,KAAlD,CAFZ;AAGA9E,IAAAA,eAAe,CAAC+E,cAAhB,CAA+B,QAA/B,EAAyCC,YAAzC,CAAsDlG,EAAE,CAACmG,QAAzD,EAAmE/B,MAAnE,yCACyBb,IADzB,6CAC2DuC,QAD3D,iEACiGE,KADjG;AAEA9E,IAAAA,eAAe,CAAC+E,cAAhB,CAA+B,IAA/B,EAAqCxB,MAArC,GAA8C,KAAKe,WAAL,GAAmB,CAAnB,IAAwB,CAAtE;AACH,GAxKmB;AAyKpB;AACApC,EAAAA,cA1KoB,4BA0KH;AACb,SAAK8D,YAAL,GAAoBvH,MAAM,CAAC0E,IAAP,CAAY6C,YAAhC;AACA,SAAK/F,YAAL,CAAkBgG,kBAAlB;AACA,SAAKhG,YAAL,CAAkBiG,iBAAlB;AACA,SAAKhG,cAAL,CAAoBqD,MAApB,GAA6B,KAAKyC,YAAL,CAAkB/B,MAAlB,IAA4B,CAAzD;;AACA,SAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKwB,YAAL,CAAkB/B,MAAtC,EAA8CO,CAAC,EAA/C,EAAmD;AAC/C,UAAIrE,UAAU,GAAGrB,EAAE,CAAC2F,WAAH,CAAe,KAAKtE,UAApB,CAAjB;AACAA,MAAAA,UAAU,CAACuE,MAAX,GAAoB,KAAKzE,YAAzB;AACAE,MAAAA,UAAU,CAAC4E,cAAX,CAA0B,MAA1B,EAAkCC,YAAlC,CAA+ClG,EAAE,CAACuB,KAAlD,EAAyD6C,MAAzD,GAAkE,KAAK8C,YAAL,CAAkBxB,CAAlB,EAAqB2B,WAAvF;AACAhG,MAAAA,UAAU,CAAC4E,cAAX,CAA0B,MAA1B,EAAkCC,YAAlC,CAA+ClG,EAAE,CAACuB,KAAlD,EAAyD6C,MAAzD,GAAkE,KAAK8C,YAAL,CAAkBxB,CAAlB,EAAqBK,SAAvF;AACA1E,MAAAA,UAAU,CAAC4E,cAAX,CAA0B,MAA1B,EAAkCC,YAAlC,CAA+ClG,EAAE,CAACuB,KAAlD,EAAyD6C,MAAzD,GAAkE,KAAKW,QAAL,CAAc,KAAKmC,YAAL,CAAkBxB,CAAlB,EAAqBM,KAAnC,IAA4C,GAA9G;AACA3E,MAAAA,UAAU,CAAC4E,cAAX,CAA0B,MAA1B,EAAkCqB,KAAlC,GAA0C3H,MAAM,CAAC4H,UAAP,CAAkBC,IAA5D;AACAnG,MAAAA,UAAU,CAAC4E,cAAX,CAA0B,IAA1B,EAAgCxB,MAAhC,GAAyCiB,CAAC,GAAG,CAAJ,IAAS,CAAlD,CAP+C,CAQ/C;AACH;;AACD/F,IAAAA,MAAM,CAACyG,KAAP,CAAaC,cAAb,CAA4B,IAA5B,EAAkC,KAAKlF,YAAvC,EAAqD,IAArD,EAA2D,IAA3D;AACH,GA1LmB;AA2LpB;AACAkC,EAAAA,eA5LoB,6BA4LF;AACd,SAAK7B,WAAL,CAAiB4C,MAAjB,GAA0B,KAAKW,QAAL,CAAcpF,MAAM,CAAC0E,IAAP,CAAYoD,SAA1B,CAA1B;AACA,SAAK1D,WAAL;AACH,GA/LmB;AAgMpB;AACAZ,EAAAA,aAjMoB,2BAiMJ;AACZ;AACA;AAEA;AAEA,SAAKuE,YAAL,GAAoB/H,MAAM,CAAC0E,IAAP,CAAYqD,YAAhC;AACA,SAAKlG,WAAL,CAAiB4C,MAAjB,GAA0B,KAAKW,QAAL,CAAc,KAAK2C,YAAL,CAAkBC,QAAhC,CAA1B;AACA,SAAKC,QAAL,CAAc,KAAKrF,OAAnB;AACA,SAAKK,QAAL,CAAcsD,YAAd,CAA2BlG,EAAE,CAAC6H,MAA9B,EAAsCC,YAAtC,GAAqD,KAArD;AACA,SAAKlF,QAAL,CAAc8B,cAAd;AACA,SAAK9B,QAAL,CAAcC,QAAd,CAAuB,CAAvB,EAA0BkF,QAA1B,CAAmC,GAAnC;AACA,SAAKnF,QAAL,CAAcC,QAAd,CAAuB,CAAvB,EAA0BkF,QAA1B,CAAmC,GAAnC;AACA/H,IAAAA,EAAE,CAACgI,WAAH,CAAeC,SAAf,CAAyBtI,MAAM,CAACuI,KAAP,CAAaC,MAAb,EAAzB,EAAgD,GAAhD;AACA,SAAKC,YAAL;AACH,GAhNmB;AAiNpB;AACAC,EAAAA,OAlNoB,qBAkNV;AACN,QAAI1I,MAAM,CAAC0E,IAAP,CAAYiE,SAAZ,EAAJ,EAA6B;AACzB3I,MAAAA,MAAM,CAACyG,KAAP,CAAamC,kBAAb,CAAgC,IAAhC;AACA;AACH;;AACD,QAAK,KAAKvE,aAAL,CAAmB,KAAKzB,OAAxB,EAAiC0B,gBAAlC,CAAoDC,GAApD,CAAwD,GAAxD,IAA+DC,MAAM,CAAC,KAAK3C,WAAL,CAAiB4C,MAAlB,CAAzE,EAAoG;AAChG,aAAOzE,MAAM,CAACyG,KAAP,CAAaoC,YAAb,CAA0B7I,MAAM,CAAC8I,IAAP,CAAYC,QAAZ,CAAqBC,cAA/C,CAAP;AACH;;AACD,QAAI,CAAC,KAAKlG,cAAV,EAA0B;AAC1B,SAAKA,cAAL,GAAsB,KAAtB;AACA,SAAKV,UAAL,CAAgB0C,MAAhB,GAAyB,CAAC,KAAKhC,cAA/B;AACA2C,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACA,QAAIpD,IAAI,GAAG,KAAKM,OAAL,GAAe,CAA1B;AACA5C,IAAAA,MAAM,CAAC0E,IAAP,CAAYgE,OAAZ,CAAoBpG,IAApB;AACH,GAhOmB;AAiOpB;AACA0B,EAAAA,OAlOoB,qBAkOV;AACNhE,IAAAA,MAAM,CAAC0E,IAAP,CAAYuE,YAAZ;AACAjJ,IAAAA,MAAM,CAAC0E,IAAP,CAAYmC,kBAAZ;AACH,GArOmB;AAsOpBqC,EAAAA,OAtOoB,mBAsOZtF,IAtOY,EAsOND,IAtOM,EAsOA;AAChB,YAAQC,IAAR;AACI,WAAK,QAAL;AAAe,WAAK,MAAL;AAAa,WAAK,UAAL;AACxB,aAAKuF,WAAL,CAAiBvF,IAAjB,EAAuBD,IAAvB;AACA;;AACJ,WAAK,WAAL;AAAkB,aAAKyF,MAAL;AAAe;;AACjC,WAAK,WAAL;AACI,aAAKV,OAAL;AACA;;AACJ,WAAK,aAAL;AAAoB,WAAK,cAAL;AAAqB,WAAK,SAAL;AACrC,aAAK1F,WAAL,CAAiBY,IAAjB;AACA;;AACJ;AACI6B,QAAAA,OAAO,CAAC4D,KAAR,CAAc,mBAAd,EAAmCzF,IAAnC;AACA;AAbR;AAeH,GAtPmB;AAuPpB;AACAuF,EAAAA,WAxPoB,uBAwPRvF,IAxPQ,EAwPFD,IAxPE,EAwPI;AACpB,QAAI2F,UAAU,GAAG;AAAE,gBAAU,CAAZ;AAAe,cAAQ,CAAvB;AAA0B,kBAAY;AAAtC,KAAjB;AACA,QAAIC,KAAK,GAAG5F,IAAI,CAAC2C,cAAL,CAAoB,WAApB,EAAiCA,cAAjC,CAAgD,OAAhD,EAAyDC,YAAzD,CAAsErE,EAAE,CAACsH,QAAzE,CAAZ;AACAD,IAAAA,KAAK,CAAC5F,IAAN,CAAWmB,MAAX,GAAoB,IAApB;AACAyE,IAAAA,KAAK,CAACE,YAAN,CAAmB,CAAnB,EAAsB7F,IAAI,IAAI,MAAR,GAAiB,UAAjB,GAA8B,QAApD,EAA8D,KAA9D;AACA2F,IAAAA,KAAK,CAACG,mBAAN,CAA0B,UAACC,UAAD,EAAaC,SAAb,EAA2B;AACjDL,MAAAA,KAAK,CAAC5F,IAAN,CAAWmB,MAAX,GAAoB,KAApB;AACH,KAFD;AAGA,SAAKlC,OAAL,GAAe0G,UAAU,CAAC1F,IAAD,CAAzB,CARoB,CAUpB;AACA;;AACA,SAAKiG,UAAL,CAAgB,KAAKjH,OAArB;AACA,SAAK0C,cAAL;AACH,GAtQmB;AAwQpB;AACAuE,EAAAA,UAzQoB,sBAyQTC,KAzQS,EAyQF;AACd,SAAKrJ,SAAL,CAAesJ,WAAf,GAA6B,KAAKpJ,QAAL,CAAcmJ,KAAd,CAA7B,CADc,CAEd;;AACA,SAAK/I,YAAL,CAAkBgJ,WAAlB,GAAgC,KAAK/I,WAAL,CAAiB8I,KAAjB,CAAhC;AACA,SAAK7I,YAAL,CAAkB8I,WAAlB,GAAgC,KAAK7I,WAAL,CAAiB4I,KAAjB,CAAhC;AACA,SAAK3I,SAAL,CAAeoF,YAAf,CAA4BlG,EAAE,CAACK,MAA/B,EAAuCqJ,WAAvC,GAAqD,KAAK3I,aAAL,CAAmB0I,KAAnB,CAArD;AACA,SAAKtH,UAAL,CAAgBuH,WAAhB,GAA8B,KAAKtH,SAAL,CAAeqH,KAAf,CAA9B;;AACA,SAAK,IAAI/D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKlF,UAAL,CAAgB+E,aAApC,EAAmDG,CAAC,EAApD,EAAwD;AACpD,UAAIA,CAAC,IAAI+D,KAAT,EAAgB;AACZ,aAAKjJ,UAAL,CAAgBqC,QAAhB,CAAyB6C,CAAzB,EAA4BjB,MAA5B,GAAqC,IAArC;AACA,aAAKjE,UAAL,CAAgBqC,QAAhB,CAAyB6C,CAAzB,EAA4BO,cAA5B,CAA2C,WAA3C,EAAwDC,YAAxD,CAAqElG,EAAE,CAACuB,KAAxE,EAA+EoI,IAA/E,GAAsF,KAAKzJ,aAAL,CAAmBuJ,KAAnB,CAAtF;AACA,aAAKjJ,UAAL,CAAgBqC,QAAhB,CAAyB6C,CAAzB,EAA4BO,cAA5B,CAA2C,WAA3C,EAAwDC,YAAxD,CAAqElG,EAAE,CAACuB,KAAxE,EAA+E6C,MAA/E,cAA4F,KAAKW,QAAL,CAAc,KAAKf,aAAL,CAAmB,KAAKzB,OAAxB,EAAiC0B,gBAA/C,CAA5F;AACA,aAAKrB,QAAL,GAAgB,KAAKpC,UAAL,CAAgBqC,QAAhB,CAAyB6C,CAAzB,CAAhB;AACA,aAAK5C,UAAL;AACH,OAND,MAMO;AACH,aAAKtC,UAAL,CAAgBqC,QAAhB,CAAyB6C,CAAzB,EAA4BjB,MAA5B,GAAqC,KAArC;AACH;AACJ;AACJ,GA3RmB;AA6RpB;AACA9B,EAAAA,WA9RoB,uBA8RRY,IA9RQ,EA8RF;AACd,SAAK,IAAImC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK3F,QAAL,CAAcwF,aAAlC,EAAiDG,CAAC,EAAlD,EAAsD;AAClD,UAAIkE,SAAS,GAAG,KAAK7J,QAAL,CAAc8C,QAAd,CAAuB6C,CAAvB,CAAhB;AACA,UAAI+D,KAAK,GAAG,CAAZ;AACA,UAAIG,SAAS,CAACrG,IAAV,IAAkBA,IAAtB,EAA4BkG,KAAK,GAAG,CAAR;AAC5BG,MAAAA,SAAS,CAACC,MAAV,GAAmBJ,KAAnB;AACH;;AAED,QAAIlG,IAAI,IAAI,cAAR,IAA0B,CAAC,KAAK2D,YAApC,EAAkD;AAC9CvH,MAAAA,MAAM,CAAC0E,IAAP,CAAYyF,eAAZ;AACH,KAFD,MAEO,IAAIvG,IAAI,IAAI,SAAR,IAAqB,CAAC,KAAKwG,QAA3B,IAAuC,CAAC,KAAKC,eAAjD,EAAkE;AACrE,WAAKA,eAAL,GAAuBrK,MAAM,CAAC0E,IAAP,CAAY4F,GAAZ,CAAgB,iBAAhB,CAAvB;AACA,WAAKF,QAAL,GAAgBpK,MAAM,CAAC0E,IAAP,CAAY4F,GAAZ,CAAgB,UAAhB,CAAhB;;AACA,UAAItK,MAAM,CAAC0E,IAAP,CAAY4F,GAAZ,CAAgB,iBAAhB,KAAsC,CAA1C,EAA6C;AACzC,aAAKxI,WAAL,CAAiB2C,MAAjB,uCACa,KAAK4F,eADlB,qTAC4F,KAAKjF,QAAL,CAAc,KAAKgF,QAAnB,CAD5F;AAEH,OAHD,MAGO;AACH,aAAKtI,WAAL,CAAiB2C,MAAjB,+JAA4D,KAAKW,QAAL,CAAc,KAAKgF,QAAnB,CAA5D;AACH;AAEJ;;AACD,SAAK,IAAIrE,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAG,KAAK1E,WAAL,CAAiBuE,aAArC,EAAoDG,EAAC,EAArD,EAAyD;AACrD,UAAI,KAAK1E,WAAL,CAAiB6B,QAAjB,CAA0B6C,EAA1B,EAA6BnC,IAA7B,IAAqCA,IAAzC,EAA+C;AAC3C,aAAKvC,WAAL,CAAiB6B,QAAjB,CAA0B6C,EAA1B,EAA6BjB,MAA7B,GAAsC,IAAtC;AACH,OAFD,MAEO;AACH,aAAKzD,WAAL,CAAiB6B,QAAjB,CAA0B6C,EAA1B,EAA6BjB,MAA7B,GAAsC,KAAtC;AACH;AACJ;AACJ,GA1TmB;AA2TpB;AACA2D,EAAAA,YA5ToB,0BA4TL;AAAA;;AACX,QAAI1F,IAAI,GAAG,CAAX;AACA,QAAI+G,KAAK,GAAG,KAAKS,QAAL,EAAZ,CAFW,CAGX;;AACAvK,IAAAA,MAAM,CAACuI,KAAP,CAAaiC,eAAb,CAA6B,KAAKnI,SAAlC,EAJW,CAKX;AACA;;AACA,QAAI,KAAKlB,SAAL,CAAe0B,KAAf,IAAwB,CAA5B,EAA+B;AAC3B,WAAKA,KAAL,GAAa,OAAO,KAAKiH,KAAK,GAAG,EAApB,IAA0B,MAAM,CAA7C;AACH,KAFD,MAEO;AACH,UAAIW,WAAW,GAAG,MAAO,CAACX,KAAK,GAAG,CAAT,IAAc,EAAvC;AACA,WAAKjH,KAAL,GAAa4H,WAAW,GAAG3D,IAAI,CAAC4D,GAAL,CAAS,KAAKvJ,SAAL,CAAe0B,KAAf,GAAuB,GAAhC,CAAd,GAAqD,EAArD,GAA0D,MAAM,CAA7E;AACH;;AACD,SAAK1B,SAAL,CAAe4D,cAAf;AACA,SAAK5D,SAAL,CAAe6D,SAAf,CAAyB3E,EAAE,CAAC6E,QAAH,CACrB7E,EAAE,CAACsK,QAAH,CAAY5H,IAAZ,EAAkB,KAAKF,KAAvB,EAA8B+H,MAA9B,CAAqC,KAAKC,kBAAL,EAArC,CADqB,EAErBxK,EAAE,CAAC4G,QAAH,CAAY,YAAM;AACd,MAAA,MAAI,CAACgB,QAAL;;AACAxC,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB,MAAI,CAACvE,SAAL,CAAe0B,KAArC,EAA4C,MAAI,CAACA,KAAjD;AACA7C,MAAAA,MAAM,CAAC0E,IAAP,CAAYyF,eAAZ;AACAnK,MAAAA,MAAM,CAACyG,KAAP,CAAaqE,YAAb,CAA0B9K,MAAM,CAAC8I,IAAP,CAAYC,QAAZ,CAAqBgC,YAA/C,EAA6D,CAAC;AAAEzI,QAAAA,IAAI,EAAEtC,MAAM,CAACgL,SAAP,CAAiBC,IAAzB;AAA+BC,QAAAA,KAAK,EAAE,MAAI,CAAC9F,QAAL,CAAc,MAAI,CAAC2C,YAAL,CAAkBoD,IAAhC;AAAtC,OAAD,CAA7D;AACA9K,MAAAA,EAAE,CAACgI,WAAH,CAAeC,SAAf,CAAyBtI,MAAM,CAACuI,KAAP,CAAaC,MAAb,EAAzB,EAAgDxI,MAAM,CAACuI,KAAP,CAAa6C,YAAb,EAAhD;AACA,MAAA,MAAI,CAACnI,QAAL,CAAcsD,YAAd,CAA2BlG,EAAE,CAAC6H,MAA9B,EAAsCC,YAAtC,GAAqD,IAArD;;AACA,MAAA,MAAI,CAAChF,UAAL;;AACA,MAAA,MAAI,CAACF,QAAL,CAAcC,QAAd,CAAuB,CAAvB,EAA0BkF,QAA1B,CAAmC,CAAnC;;AACA,MAAA,MAAI,CAACnF,QAAL,CAAcC,QAAd,CAAuB,CAAvB,EAA0BkF,QAA1B,CAAmC,CAAnC;;AACA,MAAA,MAAI,CAACtF,cAAL,GAAsB,IAAtB;AACA,MAAA,MAAI,CAACV,UAAL,CAAgB0C,MAAhB,GAAyB,CAAC,MAAI,CAAChC,cAA/B;;AACA,MAAA,MAAI,CAACsB,WAAL;AACH,KAbD,CAFqB,CAAzB,EAdW,CA+BX;AACA;AACA;AACA;AACA;AACA;AACH,GAjWmB;AAkWpB6D,EAAAA,QAlWoB,sBAkWE;AAAA,QAAb6B,KAAa,uEAAL,IAAK;;AAClB,SAAI,IAAI/D,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,KAAK/D,SAAL,CAAe4D,aAA7B,EAA2CG,CAAC,EAA5C,EAA+C;AAC3C,UAAGA,CAAC,IAAI+D,KAAR,EAAc,KAAK9H,SAAL,CAAekB,QAAf,CAAwB6C,CAAxB,EAA2BjB,MAA3B,GAAoC,IAApC,CAAd,KACK,KAAK9C,SAAL,CAAekB,QAAf,CAAwB6C,CAAxB,EAA2BjB,MAA3B,GAAoC,KAApC;AACR;AACJ,GAvWmB;AAwWpB+F,EAAAA,kBAxWoB,gCAwWC;AACjB,QAAIQ,sBAAsB,GAAG;AACzBT,MAAAA,MAAM,EAAE,gBAAUU,EAAV,EAAc;AAClB,eAAQ,CAAExE,IAAI,CAACyE,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAMD,EAAlB,CAAF,GAA2B,CAAnC;AACH,OAHwB;AAIzBE,MAAAA,OAAO,EAAE,mBAAY;AACjB,eAAOC,qBAAP;AACH;AANwB,KAA7B;AAQA,WAAOJ,sBAAP;AACH,GAlXmB;AAmXpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAd,EAAAA,QAhYoB,sBAgYT;AACP,QAAImB,OAAO,GAAG,KAAKrH,aAAL,CAAmB,KAAKzB,OAAxB,EAAiCwE,IAA/C;;AACA,SAAK,IAAIrB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2F,OAAO,CAAClG,MAA5B,EAAoCO,CAAC,EAArC,EAAyC;AACrC,UAAI2F,OAAO,CAAC3F,CAAD,CAAP,CAAW4F,EAAX,IAAiB,KAAK5D,YAAL,CAAkB6D,OAAvC,EAAgD;AAC5C,eAAO7F,CAAP;AACH;AACJ;AACJ,GAvYmB;AAwYpBX,EAAAA,QAxYoB,oBAwYX8F,KAxYW,EAwYJ;AACZ,WAAQ1G,MAAM,CAAC0G,KAAD,CAAN,CAAc3G,GAAd,CAAkB,GAAlB,CAAD,CAAyBsH,QAAzB,EAAP;AACH,GA1YmB;AA4YpBC,EAAAA,SA5YoB,uBA4YR;AACR,SAAK5H,eAAL;AACH;AA9YmB,CAAxB","sourceRoot":"/","sourcesContent":["\r\nglGame.baseclass.extend({\r\n\r\n    properties: {\r\n        leftbtns: cc.Node,\r\n        fnt_needScore: [cc.Font],\r\n        spin_node: cc.Sprite,\r\n        img_spin: [cc.SpriteFrame],\r\n        start_node: cc.Node,\r\n        img_start: [cc.SpriteFrame],\r\n        startbg_node: cc.Sprite,\r\n        img_startbg: [cc.SpriteFrame],\r\n        outside_node: cc.Sprite,\r\n        img_outside: [cc.SpriteFrame],\r\n        turnTable: cc.Node,\r\n        img_turnTable: [cc.SpriteFrame],\r\n        selectPanel: cc.Node,\r\n        fullService: cc.Node,\r\n        fullServiceItem: cc.Node,\r\n        personRecord: cc.Node,\r\n        nopersonRecord: cc.Node,\r\n        recordItem: cc.Node,\r\n        lab_needScore: cc.Label,\r\n        lab_myScore: cc.Label,\r\n        lab_getRule: cc.Label,\r\n        allGift: cc.Node,//转盘上所有图标\r\n        turnFlash: cc.Node,\r\n        sp_turnFlash: [sp.SkeletonData],\r\n        maskButton: cc.Node, // 屏蔽按钮\r\n        drawAudio: {\r\n            type: cc.AudioClip,\r\n            default: null\r\n        },\r\n        point_node: cc.Sprite,\r\n        img_point: [cc.SpriteFrame]\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.registerEvent();\r\n        //this.reqData();\r\n        this.in_type = 0;\r\n        this.angle = 0;\r\n        this.startTurnTable = true;//转盘转动过程中限制点击\r\n        this.time = null //全服大奖记录刷新\r\n        this.switchPanel(\"fullService\");\r\n        this.btnStart = this.start_node.children[0];\r\n        this.playBtnAni();\r\n    },\r\n    registerEvent() {\r\n        glGame.emitter.on(\"updateDialPrizeList\", this.updateDialPrizeList, this);\r\n        glGame.emitter.on(\"updateTopPrize\", this.updateTopPrize, this);\r\n        glGame.emitter.on(\"getDialResult\", this.getDialResult, this);\r\n        glGame.emitter.on(\"updateMyRecord\", this.updateMyRecord, this);\r\n        glGame.emitter.on(\"updateDialScore\", this.updateDialScore, this);\r\n        glGame.emitter.on(`${this.node.name}${MESSAGE.UI.ACTION_END}`, this.reqData, this);\r\n        glGame.emitter.on(\"closeLuckDrawMaskButton\", this.closeLuckDrawMaskButton, this);\r\n    },\r\n\r\n    unregisterEvent() {\r\n        glGame.emitter.off(\"updateDialPrizeList\", this);\r\n        glGame.emitter.off(\"updateTopPrize\", this);\r\n        glGame.emitter.off(\"getDialResult\", this);\r\n        glGame.emitter.off(\"updateMyRecord\", this);\r\n        glGame.emitter.off(\"updateDialScore\", this);\r\n        glGame.emitter.off(`${this.node.name}${MESSAGE.UI.ACTION_END}`, this);\r\n        glGame.emitter.off(\"closeLuckDrawMaskButton\", this);\r\n    },\r\n    //检查当前红点\r\n    checkRedDot(){\r\n        if ((this.dialPrizeList[0].consume_integral).div(100) <= Number(this.lab_myScore.string)) {\r\n            glGame.user.redDotData.dialRed = 1;\r\n        }else{\r\n            glGame.user.redDotData.dialRed = 2;\r\n        }\r\n        glGame.emitter.emit(\"ReqRedDot\");\r\n    },\r\n    closeLuckDrawMaskButton() {\r\n        this.maskButton.active = false;\r\n        this.startTurnTable = true;\r\n    },\r\n    playBtnAni(){\r\n        this.btnStart.stopAllActions();\r\n        this.btnStart.runAction(cc.repeatForever(\r\n            cc.sequence(\r\n                cc.scaleTo(0.35,1.1,1.1),\r\n                cc.scaleTo(0.35,1,1),\r\n            )\r\n        ))\r\n    },\r\n    //界面我的积分等数据\r\n    updateDialPrizeList() {\r\n        this.dialPrizeList = glGame.user.dialPrizeList;\r\n        this.lab_needScore.string = `(${this.getFloat(this.dialPrizeList[this.in_type].consume_integral)}积分)`;\r\n        glGame.user.reqDialIntegral();\r\n        this.updateAwardNum();\r\n    },\r\n    //全服大奖记录\r\n    updateTopPrize() {\r\n        this.dialTopPrize = glGame.user.dialTopPrize;\r\n        if(this.dialTopPrize.length>0){\r\n            this.time = this.dialTopPrize[this.dialTopPrize.length - 1].time\r\n        }\r\n        console.log(\"这是当前全服大奖记录\",this.dialTopPrize)\r\n        this.initTopPrize();\r\n    },\r\n    //刚开始界面的生成\r\n    initTopPrize() {\r\n        if (this.fullService.childrenCount != 0) {\r\n            this.recordIndex = 0;\r\n        } else {\r\n            this.recordIndex = 10;\r\n            let Count = this.dialTopPrize.length >= 10 ? 10 : this.dialTopPrize.length;\r\n            for (let i = 0; i < Count; i++) {\r\n                let fullServiceItem = cc.instantiate(this.fullServiceItem);\r\n                fullServiceItem.parent = this.fullService;\r\n                //fullServiceItem.active = true;\r\n                let name = this.dialTopPrize[i].nickname, lab_type = this.dialTopPrize[i].dial_type, prize = this.getFloat(this.dialTopPrize[i].prize);\r\n                fullServiceItem.getChildByName(\"notice\").getComponent(cc.RichText).string =\r\n                    `恭喜 <color=#0fe6ff>${name}</color>在 <color=#ab9afe>[${lab_type}]</c> 中获得奖励 <color=#f4c404>${prize}元</c>！`;\r\n                fullServiceItem.getChildByName(\"bg\").active = i % 2 != 0;\r\n            }\r\n            glGame.panel.showEffectNode(this, this.fullService, 0.01, true)\r\n        }\r\n        this.playScrollNotice();\r\n    },\r\n    playScrollNotice() {\r\n        if(this.dialTopPrize.length == 0){\r\n            this.scheduleOnce(()=>{\r\n                glGame.user.reqDialTopPrizeLog(this.time);\r\n            },5)\r\n            return\r\n        } \r\n        let time = Math.random() * 2 + 3;\r\n        this.node.runAction(cc.sequence(\r\n            cc.delayTime(time),\r\n            cc.callFunc(() => {\r\n                this.addItem();\r\n                this.recordIndex++;\r\n                if (this.recordIndex >= this.dialTopPrize.length) {\r\n                    glGame.user.reqDialTopPrizeLog(this.time);\r\n                } else {\r\n                    this.playScrollNotice();\r\n                }\r\n            })\r\n        ))\r\n    },\r\n    //刷新转盘上的数字\r\n    updateAwardNum() {\r\n        for (let i = 0; i < this.allGift.childrenCount; i++) {\r\n            let award = this.getFloat(this.dialPrizeList[this.in_type].item[i].award);\r\n            this.allGift.children[i].getChildByName(\"number\").getComponent(cc.Label).string = award;\r\n        }\r\n    },\r\n    //刷新记录\r\n    addItem() {\r\n        if (!this.dialTopPrize[this.recordIndex]) return\r\n        if (this.fullService.childrenCount >= 10) this.fullService.children[this.fullService.childrenCount - 1].destroy();\r\n        let fullServiceItem = cc.instantiate(this.fullServiceItem);\r\n        fullServiceItem.parent = this.fullService;\r\n        fullServiceItem.setSiblingIndex(0)\r\n        fullServiceItem.active = true;\r\n        let name = this.dialTopPrize[this.recordIndex].nickname,\r\n            lab_type = this.dialTopPrize[this.recordIndex].dial_type,\r\n            prize = this.getFloat(this.dialTopPrize[this.recordIndex].prize);\r\n        fullServiceItem.getChildByName(\"notice\").getComponent(cc.RichText).string =\r\n            `恭喜 <color=#0fe6ff>${name}</color> 在 <color=#ab9afe>[${lab_type}]</c> 中获得奖励 <color=#f4c404>${prize}元</c>！`;\r\n        fullServiceItem.getChildByName(\"bg\").active = this.recordIndex % 2 != 0;\r\n    },\r\n    //更新个人记录\r\n    updateMyRecord() {\r\n        this.myDialRecord = glGame.user.myDialRecord;\r\n        this.personRecord.destroyAllChildren();\r\n        this.personRecord.removeAllChildren();\r\n        this.nopersonRecord.active = this.myDialRecord.length == 0;\r\n        for (let i = 0; i < this.myDialRecord.length; i++) {\r\n            let recordItem = cc.instantiate(this.recordItem);\r\n            recordItem.parent = this.personRecord;\r\n            recordItem.getChildByName(\"time\").getComponent(cc.Label).string = this.myDialRecord[i].create_time;\r\n            recordItem.getChildByName(\"type\").getComponent(cc.Label).string = this.myDialRecord[i].dial_type;\r\n            recordItem.getChildByName(\"coin\").getComponent(cc.Label).string = this.getFloat(this.myDialRecord[i].prize) + '元';\r\n            recordItem.getChildByName(\"coin\").color = glGame.plazaColor.gain;\r\n            recordItem.getChildByName(\"bg\").active = i % 2 != 0;\r\n            //recordItem.active = true;\r\n        }\r\n        glGame.panel.showEffectNode(this, this.personRecord, 0.01, true)\r\n    },\r\n    //当前我的积分\r\n    updateDialScore() {\r\n        this.lab_myScore.string = this.getFloat(glGame.user.dialScore);\r\n        this.checkRedDot();\r\n    },\r\n    //开奖结果\r\n    getDialResult() {\r\n        // //转盘四秒左右可以点击抽奖按钮\r\n        // this.scheduleOnce(() => {\r\n           \r\n        // }, 4)\r\n\r\n        this.myDialResult = glGame.user.myDialResult;\r\n        this.lab_myScore.string = this.getFloat(this.myDialResult.treasure);\r\n        this.setFlash(this.in_type);\r\n        this.btnStart.getComponent(cc.Button).interactable = false;\r\n        this.btnStart.stopAllActions();\r\n        this.btnStart.children[0].setScale(0.9)\r\n        this.btnStart.children[1].setScale(0.9);\r\n        cc.audioEngine.setVolume(glGame.audio.getBGM(), 0.1);\r\n        this.runTurnTable();\r\n    },\r\n    //请求获奖数据\r\n    reqDial() {\r\n        if (glGame.user.isTourist()) {\r\n            glGame.panel.showRegisteredGift(true);\r\n            return;\r\n        }\r\n        if ((this.dialPrizeList[this.in_type].consume_integral).div(100) > Number(this.lab_myScore.string)) {\r\n            return glGame.panel.showErrorTip(glGame.tips.LUCKDRAW.SCORENOTENOUGH);\r\n        }\r\n        if (!this.startTurnTable) return\r\n        this.startTurnTable = false;\r\n        this.maskButton.active = !this.startTurnTable\r\n        console.log('开启请求')\r\n        let type = this.in_type + 1;\r\n        glGame.user.reqDial(type);\r\n    },\r\n    //刚开始进入界面的数据\r\n    reqData() {\r\n        glGame.user.reqDialPrize();\r\n        glGame.user.reqDialTopPrizeLog();\r\n    },\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"silver\": case \"gold\": case \"diamonds\":\r\n                this.switchTable(name, node);\r\n                break;\r\n            case \"btn_close\": this.remove(); break;\r\n            case \"btn_start\":\r\n                this.reqDial(); \r\n                break;\r\n            case \"fullService\": case \"personRecord\": case \"getRule\":\r\n                this.switchPanel(name);\r\n                break;\r\n            default:\r\n                console.error('luckDraw->onClick', name);\r\n                break;\r\n        }\r\n    },\r\n    //转换转盘颜色\r\n    switchTable(name, node) {\r\n        let selectType = { \"silver\": 0, \"gold\": 1, \"diamonds\": 2 };\r\n        let flash = node.getChildByName(\"checkmark\").getChildByName(\"flash\").getComponent(sp.Skeleton);\r\n        flash.node.active = true;\r\n        flash.setAnimation(0, name == \"gold\" ? \"huangjin\" : \"baiyin\", false);\r\n        flash.setCompleteListener((trackEntry, loopCount) => {\r\n            flash.node.active = false;\r\n        })\r\n        this.in_type = selectType[name];\r\n\r\n        //this.img_turnTable.spriteFrame = this.turnTableArr[this.in_type];\r\n        //this.img_title.spriteFrame = this.titleArr[this.in_type];\r\n        this.changeSkin(this.in_type);\r\n        this.updateAwardNum();\r\n    },\r\n\r\n    //修改轮盘的皮肤\r\n    changeSkin(index) {\r\n        this.spin_node.spriteFrame = this.img_spin[index];\r\n        //this.start_node.spriteFrame = this.img_start[index];\r\n        this.startbg_node.spriteFrame = this.img_startbg[index];\r\n        this.outside_node.spriteFrame = this.img_outside[index];\r\n        this.turnTable.getComponent(cc.Sprite).spriteFrame = this.img_turnTable[index];\r\n        this.point_node.spriteFrame = this.img_point[index];\r\n        for (let i = 0; i < this.start_node.childrenCount; i++) {\r\n            if (i == index) {\r\n                this.start_node.children[i].active = true;\r\n                this.start_node.children[i].getChildByName(\"needScore\").getComponent(cc.Label).font = this.fnt_needScore[index];\r\n                this.start_node.children[i].getChildByName(\"needScore\").getComponent(cc.Label).string = `(${this.getFloat(this.dialPrizeList[this.in_type].consume_integral)}积分)`;\r\n                this.btnStart = this.start_node.children[i];\r\n                this.playBtnAni();\r\n            } else {\r\n                this.start_node.children[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    //切换三个界面\r\n    switchPanel(name) {\r\n        for (let i = 0; i < this.leftbtns.childrenCount; i++) {\r\n            let _children = this.leftbtns.children[i];\r\n            let index = 0;\r\n            if (_children.name == name) index = 1;\r\n            _children.zIndex = index;\r\n        }\r\n\r\n        if (name == \"personRecord\" && !this.myDialRecord) {\r\n            glGame.user.reqDialPersonal();\r\n        } else if (name == \"getRule\" && !this.scoreBet && !this.dialRefreshTime) {\r\n            this.dialRefreshTime = glGame.user.get(\"dialRefreshTime\");\r\n            this.scoreBet = glGame.user.get(\"scoreBet\");\r\n            if (glGame.user.get(\"dialRefreshType\") == 2) {\r\n                this.lab_getRule.string =\r\n                    `1.积分每日${this.dialRefreshTime}进行更新，更新时，将未使用的积分清零。然后将前24小时内的有效投注转化为积分。\\n\\n2.积分转化比例：有效投注${this.getFloat(this.scoreBet)}金币=1积分。\\n\\n3.转盘档次越高，每次抽奖需消耗的积分越多，奖励也越高`\r\n            } else {\r\n                this.lab_getRule.string = `1.每日积分会实时结算刷新。\\n\\n2.积分转化比例：有效投注${this.getFloat(this.scoreBet)}金币=1积分。\\n\\n3.转盘档次越高，每次抽奖需消耗的积分越多，奖励也越高`\r\n            }\r\n\r\n        }\r\n        for (let i = 0; i < this.selectPanel.childrenCount; i++) {\r\n            if (this.selectPanel.children[i].name == name) {\r\n                this.selectPanel.children[i].active = true;\r\n            } else {\r\n                this.selectPanel.children[i].active = false;\r\n            }\r\n        }\r\n    },\r\n    // //启动转盘\r\n    runTurnTable() {\r\n        let time = 5\r\n        let index = this.getIndex();\r\n        //let angle = null\r\n        glGame.audio.playSoundEffect(this.drawAudio);\r\n        //this.btnStartFlash.active = false;\r\n        //this.turnTable.angle = this.angle;\r\n        if (this.turnTable.angle == 0) {\r\n            this.angle = 360 - (18 + index * 36) + 360 * 3;\r\n        } else {\r\n            let targetAngle = 360 - ((index + 1) * 36);\r\n            this.angle = targetAngle - Math.abs(this.turnTable.angle % 360) + 18 + 360 * 3;\r\n        }\r\n        this.turnTable.stopAllActions();\r\n        this.turnTable.runAction(cc.sequence(\r\n            cc.rotateBy(time, this.angle).easing(this.easeExponentialOut()),\r\n            cc.callFunc(() => {\r\n                this.setFlash();\r\n                console.log(\"这是当前角度\", this.turnTable.angle, this.angle)\r\n                glGame.user.reqDialPersonal();\r\n                glGame.panel.showAwardBox(glGame.tips.LUCKDRAW.CONGRATULATE, [{ type: glGame.awardtype.COIN, value: this.getFloat(this.myDialResult.coin) }]);\r\n                cc.audioEngine.setVolume(glGame.audio.getBGM(), glGame.audio.getBGMVolume());\r\n                this.btnStart.getComponent(cc.Button).interactable = true;\r\n                this.playBtnAni();\r\n                this.btnStart.children[0].setScale(1)\r\n                this.btnStart.children[1].setScale(1)\r\n                this.startTurnTable = true;\r\n                this.maskButton.active = !this.startTurnTable\r\n                this.checkRedDot();\r\n            })\r\n        ))\r\n        // this.angle = angle;\r\n        // this.startAngle = this.turnTable.angle;\r\n        // this.range = this.angle - this.startAngle;\r\n        // this.delta = 0;\r\n        // this.duration = 4;\r\n        // this.abcstart = true\r\n    },\r\n    setFlash(index = null){\r\n        for(let i=0;i<this.turnFlash.childrenCount;i++){\r\n            if(i == index)this.turnFlash.children[i].active = true;\r\n            else this.turnFlash.children[i].active = false;\r\n        }\r\n    },\r\n    easeExponentialOut() {\r\n        let _easeExponentialOutObj = {\r\n            easing: function (dt) {\r\n                return (-(Math.pow(2, -10 * dt)) + 1);\r\n            },\r\n            reverse: function () {\r\n                return _easeExponentialInObj;\r\n            }\r\n        }\r\n        return _easeExponentialOutObj;\r\n    },\r\n    //函数思想\r\n    // update(dt) {\r\n    //     if(!this.abcstart)return;\r\n    //     this.delta += dt;\r\n    //     let percent = this.delta / this.duration;\r\n    //     percent = this.easing(percent);\r\n    //     this.turnTable.angle = this.startAngle + (this.angle - this.startAngle) * percent;\r\n    // },\r\n    // //转换当前指数函数\r\n    // easing(dt) {\r\n    //     return dt === 1 ? 1 : (-(Math.pow(2, -10 * dt)) + 1);\r\n    // },\r\n    //获取索引\r\n    getIndex() {\r\n        let allItem = this.dialPrizeList[this.in_type].item;\r\n        for (let i = 0; i < allItem.length; i++) {\r\n            if (allItem[i].id == this.myDialResult.item_id) {\r\n                return i;\r\n            }\r\n        }\r\n    },\r\n    getFloat(value) {\r\n        return (Number(value).div(100)).toString();\r\n    },\r\n\r\n    OnDestroy() {\r\n        this.unregisterEvent();\r\n    },\r\n\r\n\r\n});\r\n"]}