{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\userInfo\\userinfoSetting.js"],"names":["glGame","baseclass","extend","properties","BGM","cc","Toggle","SE","content","Node","item","onLoad","page","size","totalPage","musicList","audio","data","storage","getItem","selectAudio","selectItem","showPanelInfo","initBgMusic","registerEvent","node","on","click_music","click_effect","unRegisterEvent","OnDestroy","BGMSE","get","isChecked","getChildByName","active","onClick","name","changepsw_cb","switchacc_cb","indexOf","click_itemAudio","event","target","openBGM","closeBGM","openSE","closeSE","click_switchacc","logon","logout","removeItemByKey","user","self_edit_login_pwd","panel","showPanelByName","showServiceBox","tips","USER","PASSWORD","SERVICE","ReqBackgroundMusic","gameNet","send_msg","pageSize","route","msg","addBgMusic","destroyAllChildren","removeAllChildren","count","length","i","instantiate","getComponent","Label","string","setTaggle","parent","bol","index","Number","substring","children","setItem","playPathBGM"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * 设置面板\r\n */\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        BGM: cc.Toggle,\r\n        SE: cc.Toggle,\r\n\r\n        content: cc.Node,\r\n        item: cc.Node,\r\n    },\r\n    onLoad() {\r\n        this.page = 1;\r\n        this.size = 10;\r\n        this.totalPage = 0;\r\n        this.musicList = glGame.audio.musicList;\r\n        let data = glGame.storage.getItem(\"bgName\") || { audio: this.musicList[0] };\r\n        this.selectAudio = data.audio;\r\n        this.selectItem = null;\r\n\r\n        this.showPanelInfo();\r\n        this.initBgMusic();\r\n        this.registerEvent();\r\n    },\r\n    registerEvent() {\r\n        this.BGM.node.on(\"toggle\", this.click_music, this);\r\n        this.SE.node.on(\"toggle\", this.click_effect, this);\r\n    },\r\n    unRegisterEvent() {\r\n    },\r\n    OnDestroy() {\r\n        this.unRegisterEvent();\r\n    },\r\n    showPanelInfo() {\r\n        // 根据本地缓存的声音数据来更新按钮状态\r\n        let BGMSE = glGame.audio.get(\"BGMSE\");\r\n        this.BGM.isChecked = BGMSE[\"BGMPlayState\"];\r\n        this.BGM.node.getChildByName(\"music\").active = !BGMSE[\"BGMPlayState\"];\r\n        this.SE.isChecked = BGMSE[\"SoundEffectPlayState\"];\r\n        this.SE.node.getChildByName(\"effect\").active = !BGMSE[\"SoundEffectPlayState\"];\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_changepsw\": this.changepsw_cb(); break;\r\n            case \"btn_exit\": this.switchacc_cb(); break;\r\n            default:\r\n                if (name.indexOf(\"item\") > -1) return this.click_itemAudio(name);\r\n                break;\r\n        }\r\n    },\r\n\r\n    click_music(event) {\r\n        let node = event.target\r\n        let isChecked = event.isChecked;\r\n        node.active = !isChecked;\r\n        if (isChecked) glGame.audio.openBGM();\r\n        else glGame.audio.closeBGM();\r\n    },\r\n    click_effect(event) {\r\n        let node = event.target\r\n        let isChecked = event.isChecked;\r\n        node.active = !isChecked;\r\n        if (isChecked) glGame.audio.openSE();\r\n        else glGame.audio.closeSE();\r\n    },\r\n    click_switchacc() {\r\n        glGame.logon.logout();\r\n        glGame.storage.removeItemByKey(\"loginCache\");\r\n    },\r\n\r\n    //修改密码\r\n    changepsw_cb() {\r\n        if (glGame.user.get(\"loginSwitch\").self_edit_login_pwd == 1) {\r\n            glGame.panel.showPanelByName(\"modifypsw\");\r\n        } else {\r\n            glGame.panel.showServiceBox(glGame.tips.USER.PASSWORD.SERVICE);\r\n        }\r\n    },\r\n    //设置\r\n    switchacc_cb() {\r\n        //退出登录清楚缓存是记录密码\r\n        glGame.panel.showPanelByName(\"exitAcc\");\r\n    },\r\n\r\n    /*\r\n    {\r\n      \"total\": 3,\r\n      \"totalPage\": 1,\r\n      \"data\": [\r\n        {\r\n          \"id\": 1,\r\n          \"name\": \"爱你斯柯达\",\r\n          \"url\": \"http://192.168.3.101:10005/music/askdjsal.mp3\",\r\n          \"downloads\": 999,\r\n          \"isDefault\": 1,\r\n          \"isDefaultDes\": \"默认\"\r\n        },\r\n        ......\r\n      ],\r\n      \"page\": 1,\r\n      \"pageSize\": 10\r\n    }\r\n    */\r\n\r\n    ReqBackgroundMusic() {\r\n        glGame.gameNet.send_msg('http.ReqBackgroundMusic', { page, pageSize }, (route, msg) => {\r\n\r\n            this.addBgMusic();\r\n        });\r\n    },\r\n\r\n\r\n    initBgMusic() {\r\n        this.content.destroyAllChildren();\r\n        this.content.removeAllChildren();\r\n        let count = this.musicList.length;\r\n        for (let i = 0; i < count; i++) {\r\n            let item = cc.instantiate(this.item);\r\n            item.active = true;\r\n            item.name = `item_${i}`;\r\n            item.getChildByName(\"name\").getComponent(cc.Label).string = this.musicList[i];\r\n            if (this.musicList[i] == this.selectAudio) {\r\n                this.setTaggle(item, true);\r\n                this.selectItem = item;\r\n            } \r\n            item.parent = this.content;\r\n        }\r\n    },\r\n\r\n    addBgMusic() {\r\n\r\n    },\r\n\r\n    setTaggle(item, bol) {\r\n        item.getChildByName(\"Toggle\").getChildByName(\"checkmark\").active = bol;\r\n    },\r\n\r\n    click_itemAudio(name) {\r\n        if (this.selectItem) this.setTaggle(this.selectItem, false);\r\n        let index = Number(name.substring(5));\r\n        this.selectItem = this.content.children[index];\r\n        this.setTaggle(this.selectItem, true);\r\n        glGame.storage.setItem(\"bgName\", { audio: this.musicList[index] });\r\n        glGame.audio.playPathBGM();\r\n    },\r\n});\r\n"]}