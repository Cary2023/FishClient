{"version":3,"sources":["assets\\frames\\model\\gamelistcfg.js"],"names":["GameListCfg","resetData","gameListCfg","prototype","g_instance","gameList","loadedGame","gameupdate","cc","sys","isNative","base_path","rootPath","jsb","fileUtils","getWritablePath","gamesSearchPaths","initGameList","next","glGame","user","get","reqGameGroup","webGameUrl","reqPlayerExtensionPromoUrl","interFaceMode","gameDisplayType","gameDisplayToken","gameDisplayTypeList","trye","gameNet","send_msg","route","data","console","log","promote_url","result","promoUrl","reqGamesList","gamesList","selfGameList","gameListArray","Object","values","map","item","platList","concat","gameTypeList","usedIdMap","forEach","id","push","getGameGroup","GameGroup","gametypeList","j","length","i","getGamelistType","type","game","getWebGamelistType","external_game","getWebGameUrl","setGameUpdate","gameName","isUpdate","getGameUpdate","closeGameUpdate","enterSubGame","gameid","checkDownloadGames","keys","count","downloadGameIDArr","key","gamesSearchPath","isDirectoryExist","sort","a","b","getGameList","gameID","Number","num","c","unshift","splice","getGameSearchPaths","getGameVersion","wholeurl","Promise","resolve","reject","xhr","loader","getXMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","JSON","parse","version","timeout","open","send","openTripartiteGame","isTourist","panel","showRegisteredGift","showSuspicious","checkEnterWebGame","showTip","tips","WEBGAME","ENTER_ERROR","format","getEnterWebGameCoin","logon","ReqGameState","nature","defaultGameId","emitter","emit","MESSAGE","UI","WEBVIEW_ON","isNeedUpdate","gameId","scene","getSceneNameByID","update_data","storage","getItem","hotUpdateURL","servercfg","getHotupdateVersionUrl","url","gamelistcfg","then","onEnterGame","isShow","assetsManager","isUpdateQueue","UPDATE","STARTUPATE","room","getGameDictById","gameUpdata","manifestUrl","scenetag","LABA","reqMyGameState","enterRoomVerification","reqGoldRoomVerify","setGoldRoomInfo","showPanelByName","entryGame","addPersistRootNode","script","getComponent","setGameId","updateBgInfo","BGM","audio","playBGM","setGamesUpdateData","value","gamesUpdateData","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;AAAA,IACIA,WAAW,GAAG,SAAdA,WAAc,GAAY;AACtB,OAAKC,SAAL;AACH,CAHL;AAAA,IAIIC,WAAW,GAAGF,WAAW,CAACG,SAJ9B;AAAA,IAKIC,UAAU,GAAG,IALjB;;AAOAF,WAAW,CAACD,SAAZ,GAAwB,YAAY;AAChC,OAAKI,QAAL,GAAgB,IAAhB;AACA,OAAKC,UAAL,GAAkB,EAAlB;AACA,OAAKC,UAAL,GAAkB,EAAlB;;AACA,MAAIC,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AAEjB,QAAIC,SAAS,GAAG,qBAAhB,CAFiB,CAEqB;;AACtC,QAAIC,QAAQ,GAAG,CAACC,GAAG,CAACC,SAAJ,GAAgBD,GAAG,CAACC,SAAJ,CAAcC,eAAd,EAAhB,GAAkD,GAAnD,IAA0DJ,SAAzE;AACA,SAAKK,gBAAL,GAAwB;AACpB,SAAGJ,QAAQ,GAAG,OADM;AACG,UAAIA,QAAQ,GAAG,WADlB;AAC+B,UAAIA,QAAQ,GAAG,MAD9C;AAEpB,UAAIA,QAAQ,GAAG,MAFK;AAEG,UAAIA,QAAQ,GAAG,SAFlB;AAE6B,UAAIA,QAAQ,GAAG,SAF5C;AAGpB,UAAIA,QAAQ,GAAG,WAHK;AAGQ,UAAIA,QAAQ,GAAG,WAHvB;AAGoC,UAAIA,QAAQ,GAAG,MAHnD;AAIpB,UAAIA,QAAQ,GAAG,UAJK;AAIO,UAAIA,QAAQ,GAAG,QAJtB;AAIgC,UAAIA,QAAQ,GAAG,eAJ/C;AAKpB,UAAIA,QAAQ,GAAG,MALK;AAKG,UAAIA,QAAQ,GAAG,KALlB;AAMpB,UAAIA,QAAQ,GAAG,OANK;AAMI,UAAIA,QAAQ,GAAG,MANnB;AAM2B,UAAIA,QAAQ,GAAG,KAN1C;AAMiD,UAAIA,QAAQ,GAAG,MANhE;AAOpB,UAAIA,QAAQ,GAAG,OAPK;AAOI,UAAIA,QAAQ,GAAG,KAPnB;AAO0B,UAAIA,QAAQ,GAAG,MAPzC;AAOiD,UAAIA,QAAQ,GAAG,MAPhE;AAQpB,UAAIA,QAAQ,GAAG;AARK,KAAxB;AAUH;AACJ,CAnBD;;AAoBAV,WAAW,CAACe,YAAZ,GAA2B,UAAUC,IAAV,EAAgB;AACvC;AACI,OAAKb,QAAL,GAAgBc,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,UAAhB,CAAhB,CAFmC,CAEQ;;AAC3CH,EAAAA,IAAI,GAH+B,CAIvC;AACH,CALD;;AAOAhB,WAAW,CAACoB,YAAZ,GAA2B,UAAUJ,IAAV,EAAgB;AACvC;AACI,OAAKb,QAAL,GAAgBc,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,UAAhB,CAAhB;AACA,OAAKE,UAAL,GAAkBJ,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,YAAhB,CAAlB,CAHmC,CAGa;;AAChD,OAAKG,0BAAL,GAJmC,CAMnC;;AACA,OAAKC,aAAL,GAAsBN,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,eAAhB,CAAtB;AACA,OAAKK,eAAL,GAAuBP,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,iBAAhB,CAAvB;AACA,OAAKM,gBAAL,GAAwBR,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,kBAAhB,CAAxB;AACA,OAAKO,mBAAL,GAA2BT,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,qBAAhB,CAA3B,CAVmC,CAYnC;;AACAH,EAAAA,IAAI,GAb+B,CAcvC;AACH,CAfD,EAiBA;;;AACAhB,WAAW,CAACsB,0BAAZ,GAAyC,UAAUK,IAAV,EAAgBX,IAAhB,EAAsB;AAC3DC,EAAAA,MAAM,CAACW,OAAP,CAAeC,QAAf,CAAwB,iCAAxB,EAA2D,IAA3D,EAAiE,UAACC,KAAD,EAAQC,IAAR,EAAiB;AAC9EC,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BF,IAA1B;AACAd,IAAAA,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgB,KAAhB,EAAuBe,WAAvB,GAAqCH,IAAI,CAACI,MAAL,CAAYC,QAAjD;AACH,GAHD;AAIH,CALD,EAOA;;;AACApC,WAAW,CAACqC,YAAZ,GAA2B,UAAUV,IAAV,EAAgBX,IAAhB,EAAsB;AAAA;;AAC7CC,EAAAA,MAAM,CAACW,OAAP,CAAeC,QAAf,CAAwB,eAAxB,EAAyCF,IAAzC,EAA+C,UAACG,KAAD,EAAQC,IAAR,EAAiB;AAC5DC,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BF,IAA1B;AACA,IAAA,KAAI,CAACO,SAAL,GAAiBP,IAAjB;;AACA,IAAA,KAAI,CAACQ,YAAL,CAAkBR,IAAlB;;AACAf,IAAAA,IAAI;AACP,GALD;AAMH,CAPD,EASA;;;AACAhB,WAAW,CAACuC,YAAZ,GAA2B,UAAUD,SAAV,EAAqB;AAAA;;AAC5C,MAAIE,aAAa,GAAEC,MAAM,CAACC,MAAP,CAAcJ,SAAd,EAClBK,GADkB,CACd,UAAAC,IAAI,EAAE;AACP,QAAGA,IAAI,CAACC,QAAR,EAAiB;AAAA;;AACb,aAAO,YAAGC,MAAH,gCAAaL,MAAM,CAACC,MAAP,CAAcE,IAAI,CAACC,QAAnB,EAA6BF,GAA7B,CAAiC,UAAAC,IAAI;AAAA,eAAGH,MAAM,CAACC,MAAP,CAAcE,IAAI,CAACzC,QAAnB,CAAH;AAAA,OAArC,CAAb,EAAP;AACH;;AACD,WAAOsC,MAAM,CAACC,MAAP,CAAcE,IAAI,CAACzC,QAAnB,CAAP;AACH,GANkB,CAAnB;AAQA,OAAK4C,YAAL,GAAoB,EAApB;AACA,MAAIC,SAAS,GAAC,EAAd;AACAR,EAAAA,aAAa,CAACS,OAAd,CAAsB,UAAAL,IAAI,EAAE;AACxBA,IAAAA,IAAI,CAACK,OAAL,CAAa,UAAAL,IAAI,EAAE;AACf,UAAIA,IAAI,CAACM,EAAL,GAAU,KAAV,IAAmBN,IAAI,CAACM,EAAL,IAAW,EAAlC,EAAsC;AAClC,YAAGF,SAAS,CAACJ,IAAI,CAACM,EAAN,CAAZ,EAAsB;AAClB;AACH;;AACDF,QAAAA,SAAS,CAACJ,IAAI,CAACM,EAAN,CAAT,GAAqBN,IAArB;;AACA,QAAA,MAAI,CAACG,YAAL,CAAkBI,IAAlB,CAAuBP,IAAvB;AACH;AACJ,KARD;AASH,GAVD;AAWAZ,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwB,KAAKc,YAA7B;AACH,CAvBD,EAyBA;;;AACA/C,WAAW,CAACoD,YAAZ,GAA2B,YAAY;AACnC,OAAKC,SAAL,GAAiB,EAAjB;AACA,MAAIC,YAAY,GAAG,KAAKA,YAAL,CAAkB,CAAlB,EAAqBnD,QAAxC;;AACA,OAAK,IAAIoD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,YAAY,CAACE,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC1C,SAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKtD,QAAL,CAAcqD,MAAlC,EAA0CC,CAAC,EAA3C,EAA+C;AAC3C,UAAIH,YAAY,CAACC,CAAD,CAAZ,IAAmB,KAAKpD,QAAL,CAAcsD,CAAd,EAAiBP,EAAxC,EAA4C;AACxC,aAAKG,SAAL,CAAeF,IAAf,CAAoBG,YAAY,CAACC,CAAD,CAAhC;AACA;AACH;AACJ;AACJ;;AACD,SAAO,KAAKF,SAAZ;AACH,CAZD,EAcA;;;AACArD,WAAW,CAAC0D,eAAZ,GAA8B,UAAUC,IAAV,EAAgB;AAC1C,OAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKH,YAAL,CAAkBE,MAAtC,EAA8CC,CAAC,EAA/C,EAAmD;AAC/C,QAAI,KAAKH,YAAL,CAAkBG,CAAlB,EAAqBP,EAArB,IAA2BS,IAA/B,EAAqC;AACjC,aAAO,KAAKL,YAAL,CAAkBG,CAAlB,EAAqBG,IAA5B;AACH;AACJ;AACJ,CAND,EAQA;;;AACA5D,WAAW,CAAC6D,kBAAZ,GAAiC,YAAY;AACzC,OAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKH,YAAL,CAAkBE,MAAtC,EAA8CC,CAAC,EAA/C,EAAmD;AAC/C,QAAI,KAAKH,YAAL,CAAkBG,CAAlB,EAAqBP,EAArB,IAA2B,CAA/B,EAAkC;AAC9B,aAAO,KAAKI,YAAL,CAAkBG,CAAlB,EAAqBK,aAA5B;AACH;AACJ;AACJ,CAND;;AAQA9D,WAAW,CAAC+D,aAAZ,GAA4B,YAAY;AACpC,SAAO,KAAK1C,UAAZ;AACH,CAFD;;AAIArB,WAAW,CAACgE,aAAZ,GAA4B,UAAUC,QAAV,EAAqC;AAAA,MAAjBC,QAAiB,uEAAN,IAAM;AAC7D,OAAK7D,UAAL,CAAgB4D,QAAhB,IAA4BC,QAA5B;AACH,CAFD;;AAIAlE,WAAW,CAACmE,aAAZ,GAA4B,UAAUF,QAAV,EAAoB;AAC5C,SAAO,KAAK5D,UAAL,CAAgB4D,QAAhB,CAAP;AACH,CAFD;;AAIAjE,WAAW,CAACoE,eAAZ,GAA8B,YAAY;AACtC,OAAK/D,UAAL,GAAkB,EAAlB;AACH,CAFD;;AAIAL,WAAW,CAACqE,YAAZ,GAA2B,UAAUC,MAAV,EAAkB;AACzC,MAAI,CAAChE,EAAE,CAACC,GAAH,CAAOC,QAAZ,EAAsB;AACtB,MAAI,KAAKJ,UAAL,CAAgBkE,MAAhB,CAAJ,EAA6B,OAFY,CAGzC;;AACA,OAAKlE,UAAL,CAAgBkE,MAAhB,IAA0B,IAA1B;AACH,CALD;AAQA;;;;;AAGAtE,WAAW,CAACuE,kBAAZ,GAAiC,YAAY;AACzC,MAAIC,IAAI,GAAG/B,MAAM,CAAC+B,IAAP,CAAY,KAAK1D,gBAAjB,CAAX;AACA,MAAI2D,KAAK,GAAGD,IAAI,CAAChB,MAAjB;AACA,MAAIkB,iBAAiB,GAAG,EAAxB;;AACA,OAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgB,KAApB,EAA2BhB,CAAC,EAA5B,EAAgC;AAC5B,QAAIkB,GAAG,GAAGH,IAAI,CAACf,CAAD,CAAd;AACA,QAAImB,eAAe,GAAG,KAAK9D,gBAAL,CAAsB6D,GAAtB,CAAtB;AACA,QAAIhE,GAAG,CAACC,SAAJ,CAAciE,gBAAd,CAA+BD,eAA/B,KAAmDD,GAAG,KAAK,GAA/D,EACID,iBAAiB,CAACvB,IAAlB,CAAuBwB,GAAvB;AACP;;AACD,SAAOD,iBAAiB,CAACI,IAAlB,CAAuB,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC1C,WAAOD,CAAC,GAAGC,CAAX;AACH,GAFM,CAAP;AAGH,CAbD;AAcA;;;;;AAGAhF,WAAW,CAACiF,WAAZ,GAA0B,YAAY;AAClC,MAAI,CAAC3E,EAAE,CAACC,GAAH,CAAOC,QAAZ,EAAsB,OAAO,KAAKL,QAAZ;AACtB,MAAIuE,iBAAiB,GAAG,KAAKH,kBAAL,EAAxB;AACA,MAAIE,KAAK,GAAGC,iBAAiB,CAAClB,MAAlB,GAA2B,CAAvC;;AACA,OAAK,IAAIC,CAAC,GAAGgB,KAAb,EAAoBhB,CAAC,IAAI,CAAzB,EAA4BA,CAAC,EAA7B,EAAiC;AAC7B,QAAIyB,MAAM,GAAGC,MAAM,CAACT,iBAAiB,CAACjB,CAAD,CAAlB,CAAnB;AACA,QAAI2B,GAAG,GAAG,KAAKjF,QAAL,CAAcqD,MAAxB;;AACA,SAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,GAApB,EAAyBC,CAAC,EAA1B,EAA8B;AAC1B,UAAI,KAAKlF,QAAL,CAAckF,CAAd,EAAiB,IAAjB,MAA2BH,MAA/B,EAAuC;AACnC,aAAK/E,QAAL,CAAcmF,OAAd,CAAsB,KAAKnF,QAAL,CAAcoF,MAAd,CAAqBF,CAArB,EAAwB,CAAxB,EAA2B,CAA3B,CAAtB;AACA;AACH;AACJ;AACJ;;AACD,SAAO,KAAKlF,QAAZ;AACH,CAfD;;AAgBAH,WAAW,CAACwF,kBAAZ,GAAiC,UAAUN,MAAV,EAAkB;AAC/C,SAAO,KAAKpE,gBAAL,CAAsBoE,MAAtB,CAAP;AACH,CAFD;;AAKAlF,WAAW,CAACyF,cAAZ,GAA6B,UAAUC,QAAV,EAAoB;AAC7C1D,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACA,SAAO,IAAI0D,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC1C,QAAIC,GAAG,GAAGxF,EAAE,CAACyF,MAAH,CAAUC,iBAAV,EAAV;;AACAF,IAAAA,GAAG,CAACG,kBAAJ,GAAyB,YAAM;AAC3B,UAAIH,GAAG,CAACI,UAAJ,KAAmB,CAAnB,IAAyBJ,GAAG,CAACK,MAAJ,IAAc,GAAd,IAAqBL,GAAG,CAACK,MAAJ,GAAa,GAA/D,EAAqE;AACjE,YAAIC,OAAO,GAAGN,GAAG,CAACO,YAAlB;AACA,YAAItE,IAAI,GAAGuE,IAAI,CAACC,KAAL,CAAWH,OAAX,CAAX;AACApE,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,IAAxB,EAA8BA,IAAI,CAACyE,OAAnC;AACAZ,QAAAA,OAAO,CAAC7D,IAAD,CAAP;AACH;AACJ,KAPD;;AAQA+D,IAAAA,GAAG,CAACW,OAAJ,GAAc,IAAd;AACAzE,IAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCyD,QAAxC;AACAI,IAAAA,GAAG,CAACY,IAAJ,CAAS,KAAT,EAAgBhB,QAAhB,EAA0B,IAA1B;AACAI,IAAAA,GAAG,CAACa,IAAJ;AACH,GAdM,CAAP;AAeH,CAjBD,EAmBA;;;AACA3G,WAAW,CAAC4G,kBAAZ,GAAiC,UAAU7E,IAAV,EAAgB;AAC7C;AACA;AACA;AACA,MAAId,MAAM,CAACC,IAAP,CAAY2F,SAAZ,EAAJ,EAA6B;AACzB5F,IAAAA,MAAM,CAAC6F,KAAP,CAAaC,kBAAb,CAAgC,IAAhC;AACA;AACH,GAP4C,CAS7C;;;AACA,MAAI9F,MAAM,CAAC6F,KAAP,CAAaE,cAAb,CAA4B,MAA5B,CAAJ,EAAyC;;AAGzC,MAAI,CAAC/F,MAAM,CAACC,IAAP,CAAY+F,iBAAZ,EAAL,EAAsC;AAClChG,IAAAA,MAAM,CAAC6F,KAAP,CAAaI,OAAb,CAAqBjG,MAAM,CAACkG,IAAP,CAAYC,OAAZ,CAAoBC,WAApB,CAAgCC,MAAhC,WAA0CrG,MAAM,CAACC,IAAP,CAAYqG,mBAAZ,EAA1C,EAArB;AACA;AACH;;AAEDtG,EAAAA,MAAM,CAACuG,KAAP,CAAaC,YAAb,CAA0B1F,IAAI,CAACO,SAAL,CAAeY,EAAzC,EAA6C,UAAAoB,MAAM,EAAI;AACnD,QAAIvC,IAAI,CAAC2F,MAAL,IAAe,CAAnB,EAAsB;AAClBpD,MAAAA,MAAM,GAAGvC,IAAI,CAACO,SAAL,CAAeqF,aAAxB;AACH;;AACD1G,IAAAA,MAAM,CAAC2G,OAAP,CAAeC,IAAf,CAAoBC,OAAO,CAACC,EAAR,CAAWC,UAA/B,EAA2C;AAAE1D,MAAAA,MAAM,EAAEA;AAAV,KAA3C;AAEH,GAND,EAMGvC,IAAI,CAAC4B,IANR;AAOH,CAzBD,EA4BA;;;AACA3D,WAAW,CAACiI,YAAZ,GAA2B,UAAUC,MAAV,EAAkB;AACzC,SAAO,IAAIvC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,QAAI,CAACvF,EAAE,CAACC,GAAH,CAAOC,QAAZ,EAAsB,OAAOoF,OAAO,CAAC,KAAD,CAAd;AACtB,QAAI3B,QAAQ,GAAGhD,MAAM,CAACkH,KAAP,CAAaC,gBAAb,CAA8BF,MAA9B,CAAf;AACAlG,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BgC,QAA9B;AACA,QAAIoE,WAAW,GAAGpH,MAAM,CAACqH,OAAP,CAAeC,OAAf,CAAuB,aAAvB,CAAlB;;AACA,QAAIF,WAAW,IAAIA,WAAW,CAACpE,QAAD,CAA9B,EAA0C;AACtC,UAAIuE,YAAY,GAAGvH,MAAM,CAACwH,SAAP,CAAiBC,sBAAjB,EAAnB;AACA,UAAIC,GAAG,aAAMH,YAAN,SAAqBvE,QAArB,cAAiCA,QAAjC,qBAAP;AACAjC,MAAAA,OAAO,CAACC,GAAR,CAAY0G,GAAZ;AACA1H,MAAAA,MAAM,CAAC2H,WAAP,CAAmBnD,cAAnB,CAAkCkD,GAAlC,EAAuCE,IAAvC,CAA4C,UAAA9G,IAAI,EAAI;AAChDC,QAAAA,OAAO,CAACC,GAAR,CAAYF,IAAI,CAACyE,OAAjB;AACA,YAAIzE,IAAI,CAACyE,OAAL,KAAiB6B,WAAW,CAACpE,QAAD,CAAhC,EAA4C2B,OAAO,CAAC,KAAD,CAAP,CAA5C,KACKA,OAAO,CAAC,IAAD,CAAP;AACR,OAJD,EAIG,YAAM;AAAEA,QAAAA,OAAO,CAAC,IAAD,CAAP;AAAe,OAJ1B;AAKH,KATD,MASOA,OAAO,CAAC,IAAD,CAAP;AACV,GAfM,CAAP;AAgBH,CAjBD,EAmBA;;;AACA5F,WAAW,CAAC8I,WAAZ,GAA0B,UAAUZ,MAAV,EAAkBa,MAAlB,EAA0B;AAChD/G,EAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EADgD,CAGhD;;AACA,MAAI3B,EAAE,CAACC,GAAH,CAAOC,QAAX,EAAqB;AACjB;AACA,QAAIS,MAAM,CAAC+H,aAAP,CAAqBC,aAArB,CAAmCf,MAAnC,CAAJ,EAAgD;AAEhD,QAAIjE,QAAQ,GAAGhD,MAAM,CAACkH,KAAP,CAAaC,gBAAb,CAA8BF,MAA9B,CAAf,CAJiB,CAMjB;;AACA,QAAIG,WAAW,GAAGpH,MAAM,CAACqH,OAAP,CAAeC,OAAf,CAAuB,aAAvB,CAAlB;;AACA,QAAI,CAACF,WAAD,IAAgB,CAACA,WAAW,CAACpE,QAAD,CAAhC,EAA4C;AACxC,UAAI8E,MAAJ,EAAY;AACR9H,QAAAA,MAAM,CAAC6F,KAAP,CAAaI,OAAb,CAAqBjG,MAAM,CAACkG,IAAP,CAAY+B,MAAZ,CAAmBC,UAAnB,CAA8B7B,MAA9B,WAAwCrG,MAAM,CAACmI,IAAP,CAAYC,eAAZ,CAA4BnB,MAA5B,CAAxC,EAArB;AACH;;AACDjH,MAAAA,MAAM,CAAC+H,aAAP,CAAqBM,UAArB,CAAgC;AAACpE,QAAAA,MAAM,EAAEgD,MAAT;AAAiBqB,QAAAA,WAAW,EAAE;AAA9B,OAAhC;AACA;AACH,KAdgB,CAejB;;;AACA,QAAI,CAACtI,MAAM,CAAC2H,WAAP,CAAmBzE,aAAnB,CAAiCF,QAAjC,CAAL,EAAiD;AAC7C,UAAI8E,MAAJ,EAAY;AACR9H,QAAAA,MAAM,CAAC6F,KAAP,CAAaI,OAAb,CAAqBjG,MAAM,CAACkG,IAAP,CAAY+B,MAAZ,CAAmBC,UAAnB,CAA8B7B,MAA9B,WAAwCrG,MAAM,CAACmI,IAAP,CAAYC,eAAZ,CAA4BnB,MAA5B,CAAxC,EAArB;AACH;;AACDjH,MAAAA,MAAM,CAAC+H,aAAP,CAAqBM,UAArB,CAAgC;AAACpE,QAAAA,MAAM,EAAEgD,MAAT;AAAiBqB,QAAAA,WAAW,EAAE;AAA9B,OAAhC;AACA;AACH;AACJ,GA3B+C,CA4BhD;;;AACA,MAAItI,MAAM,CAAC6F,KAAP,CAAaE,cAAb,CAA4B,MAA5B,CAAJ,EAAyC,OA7BO,CA8BhD;;AACA/F,EAAAA,MAAM,CAAC2H,WAAP,CAAmBvE,YAAnB,CAAgC6D,MAAhC,EA/BgD,CAgChD;;AACA,MAAIA,MAAM,KAAKjH,MAAM,CAACuI,QAAP,CAAgBC,IAA/B,EAAqC;AACjC,QAAIxI,MAAM,CAACC,IAAP,CAAY2F,SAAZ,EAAJ,EAA6B;AACzB5F,MAAAA,MAAM,CAAC6F,KAAP,CAAaC,kBAAb,CAAgC,IAAhC;AACA;AACH;;AACD9F,IAAAA,MAAM,CAACmI,IAAP,CAAYM,cAAZ,CAA2BxB,MAA3B,EAAmCW,IAAnC,CAAwC,YAAM;AAC1C5H,MAAAA,MAAM,CAACuG,KAAP,CAAaC,YAAb,CAA0BS,MAA1B,EAAkC,YAAM;AACpC;AACA,YAAIjH,MAAM,CAAC0I,qBAAX,EAAkC;AAC9B1I,UAAAA,MAAM,CAACmI,IAAP,CAAYQ,iBAAZ,CAA8B3I,MAAM,CAACuI,QAAP,CAAgBC,IAA9C,EAAoD,CAApD;AACH,SAFD,MAEO;AACHxI,UAAAA,MAAM,CAACmI,IAAP,CAAYS,eAAZ,CAA4B5I,MAAM,CAACuI,QAAP,CAAgBC,IAA5C,EAAkD,CAAlD;AACH;AACJ,OAPD;AAQH,KATD;AAUA;AACH,GAjD+C,CAkDhD;;;AACAxI,EAAAA,MAAM,CAACuG,KAAP,CAAaC,YAAb,CAA0BS,MAA1B,EAAkC,UAAA5D,MAAM,EAAI;AACxCrD,IAAAA,MAAM,CAAC6F,KAAP,CAAagD,eAAb,WAAgC7I,MAAM,CAACkH,KAAP,CAAa4B,SAAb,CAAuB7B,MAAvB,CAAhC,YAAuEW,IAAvE,CAA4E,UAAA/B,KAAK,EAAI;AACjFxG,MAAAA,EAAE,CAACsD,IAAH,CAAQoG,kBAAR,CAA2BlD,KAA3B;AACA,UAAImD,MAAM,GAAGnD,KAAK,CAACoD,YAAN,WAAsBjJ,MAAM,CAACkH,KAAP,CAAa4B,SAAb,CAAuB7B,MAAvB,CAAtB,WAAb;AACA+B,MAAAA,MAAM,CAACE,SAAP,CAAiB7F,MAAjB;AACA2F,MAAAA,MAAM,CAACG,YAAP,GAJiF,CAKjF;;AACA,UAAGH,MAAM,CAACI,GAAV,EAAcpJ,MAAM,CAACqJ,KAAP,CAAaC,OAAb,CAAqBN,MAAM,CAACI,GAA5B;AACjB,KAPD;AAQH,GATD;AAUH,CA7DD;;AA+DArK,WAAW,CAACmB,GAAZ,GAAkB,UAAUwD,GAAV,EAAe;AAC7B,SAAO,KAAKA,GAAL,CAAP;AACH,CAFD;;AAGA3E,WAAW,CAACwK,kBAAZ,GAAiC,UAAUlG,MAAV,EAAkBK,GAAlB,EAAuB8F,KAAvB,EAA8B;AAC3D,OAAKC,eAAL,CAAqBpG,MAArB,EAA6BK,GAA7B,IAAoC8F,KAApC;AACH,CAFD;;AAGAE,MAAM,CAACC,OAAP,GAAiB,YAAY;AACzB,MAAI,CAAC1K,UAAL,EAAiB;AACbA,IAAAA,UAAU,GAAG,IAAIJ,WAAJ,EAAb;AACH;;AACD,SAAOI,UAAP;AACH,CALD","sourceRoot":"/","sourcesContent":["let\r\n    GameListCfg = function () {\r\n        this.resetData();\r\n    },\r\n    gameListCfg = GameListCfg.prototype,\r\n    g_instance = null;\r\n\r\ngameListCfg.resetData = function () {\r\n    this.gameList = null;\r\n    this.loadedGame = {};\r\n    this.gameupdate = [];\r\n    if (cc.sys.isNative) {\r\n\r\n        let base_path = \"master/subpackages/\";//\"master/res/raw-assets/modules/games/\";\r\n        let rootPath = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : \"/\") + base_path;\r\n        this.gamesSearchPaths = {\r\n            2: rootPath + \"plaza\", 15: rootPath + \"zhajinhua\", 18: rootPath + \"qznn\",\r\n            22: rootPath + \"brnn\", 27: rootPath + \"sangong\", 28: rootPath + \"honghei\",\r\n            29: rootPath + \"shuiguoji\", 30: rootPath + \"longhudou\", 31: rootPath + \"laba\",\r\n            32: rootPath + \"baijiale\", 33: rootPath + \"paijiu\", 34: rootPath + \"luckturntable\",\r\n            35: rootPath + \"dzpk\", 36: rootPath + \"ddz\",\r\n            37: rootPath + \"jszjh\", 38: rootPath + \"esyd\", 39: rootPath + \"ebg\", 40: rootPath + \"fish\",\r\n            41: rootPath + \"qhbjl\", 42: rootPath + \"sss\", 43: rootPath + 'hcpy', 44: rootPath + 'slwh',\r\n            48: rootPath + 'hbsl'\r\n        }\r\n    }\r\n};\r\ngameListCfg.initGameList = function (next) {\r\n    // glGame.gameNet.send_msg(\"http.reqGameList\", null, (route, data) => {\r\n        this.gameList = glGame.user.get('gameList')//data.result;\r\n        next();\r\n    // })\r\n};\r\n\r\ngameListCfg.reqGameGroup = function (next) {\r\n    // glGame.gameNet.send_msg(\"http.ReqGameGroup\", null, (route, data) => {\r\n        this.gameList = glGame.user.get('gameList');\r\n        this.webGameUrl = glGame.user.get('webGameUrl');// data.url;\r\n        this.reqPlayerExtensionPromoUrl()\r\n\r\n        // 新分类数据\r\n        this.interFaceMode =  glGame.user.get('interFaceMode');\r\n        this.gameDisplayType = glGame.user.get(\"gameDisplayType\");\r\n        this.gameDisplayToken = glGame.user.get(\"gameDisplayToken\");\r\n        this.gameDisplayTypeList = glGame.user.get(\"gameDisplayTypeList\");\r\n\r\n        // cc.log(data);\r\n        next();\r\n    // })\r\n};\r\n\r\n// 获取推广链接地址\r\ngameListCfg.reqPlayerExtensionPromoUrl = function (trye, next) {\r\n    glGame.gameNet.send_msg(\"http.ReqPlayerExtensionPromoUrl\", null, (route, data) => {\r\n        console.log(\"返回的游戏列表数据：\", data);\r\n        glGame.user.get(\"url\").promote_url = data.result.promoUrl;\r\n    })\r\n}\r\n\r\n// 获取大厅游戏列表\r\ngameListCfg.reqGamesList = function (trye, next) {\r\n    glGame.gameNet.send_msg(\"http.ReqGames\", trye, (route, data) => {\r\n        console.log(\"返回的游戏列表数据：\", data);\r\n        this.gamesList = data;\r\n        this.selfGameList(data);\r\n        next();\r\n    })\r\n}\r\n\r\n// 获取自己的游戏列表\r\ngameListCfg.selfGameList = function (gamesList) {\r\n    let gameListArray= Object.values(gamesList)\r\n    .map(item=>{\r\n        if(item.platList){\r\n            return [].concat(...Object.values(item.platList).map(item=> Object.values(item.gameList)))\r\n        }\r\n        return Object.values(item.gameList)\r\n    })\r\n    \r\n    this.gameTypeList = [];\r\n    let usedIdMap={}\r\n    gameListArray.forEach(item=>{\r\n        item.forEach(item=>{\r\n            if (item.id < 10000 && item.id != 45) {\r\n                if(usedIdMap[item.id]){\r\n                    return\r\n                }\r\n                usedIdMap[item.id] = item\r\n                this.gameTypeList.push(item)\r\n            }\r\n        })\r\n    })\r\n    console.log(\"抽取自己游戏id\", this.gameTypeList);\r\n}\r\n\r\n//通过对比，拿到有用的游戏数据\r\ngameListCfg.getGameGroup = function () {\r\n    this.GameGroup = [];\r\n    let gametypeList = this.gametypeList[0].gameList;\r\n    for (let j = 0; j < gametypeList.length; j++) {\r\n        for (let i = 0; i < this.gameList.length; i++) {\r\n            if (gametypeList[j] == this.gameList[i].id) {\r\n                this.GameGroup.push(gametypeList[j])\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return this.GameGroup;\r\n};\r\n\r\n// 没有使用\r\ngameListCfg.getGamelistType = function (type) {\r\n    for (let i = 0; i < this.gametypeList.length; i++) {\r\n        if (this.gametypeList[i].id == type) {\r\n            return this.gametypeList[i].game;\r\n        }\r\n    }\r\n};\r\n\r\n// 没有使用\r\ngameListCfg.getWebGamelistType = function () {\r\n    for (let i = 0; i < this.gametypeList.length; i++) {\r\n        if (this.gametypeList[i].id == 1) {\r\n            return this.gametypeList[i].external_game;\r\n        }\r\n    }\r\n};\r\n\r\ngameListCfg.getWebGameUrl = function () {\r\n    return this.webGameUrl;\r\n};\r\n\r\ngameListCfg.setGameUpdate = function (gameName, isUpdate = true) {\r\n    this.gameupdate[gameName] = isUpdate;\r\n};\r\n\r\ngameListCfg.getGameUpdate = function (gameName) {\r\n    return this.gameupdate[gameName];\r\n};\r\n\r\ngameListCfg.closeGameUpdate = function () {\r\n    this.gameupdate = [];\r\n};\r\n\r\ngameListCfg.enterSubGame = function (gameid) {\r\n    if (!cc.sys.isNative) return;\r\n    if (this.loadedGame[gameid]) return;\r\n    //window.require(`${this.gamesSearchPaths[gameid]}`+\"/game.js\")\r\n    this.loadedGame[gameid] = true;\r\n};\r\n\r\n\r\n/**\r\n * 获取已经下载的游戏列表\r\n */\r\ngameListCfg.checkDownloadGames = function () {\r\n    let keys = Object.keys(this.gamesSearchPaths);\r\n    let count = keys.length;\r\n    let downloadGameIDArr = [];\r\n    for (let i = 0; i < count; i++) {\r\n        let key = keys[i];\r\n        let gamesSearchPath = this.gamesSearchPaths[key];\r\n        if (jsb.fileUtils.isDirectoryExist(gamesSearchPath) && key !== \"2\")\r\n            downloadGameIDArr.push(key);\r\n    }\r\n    return downloadGameIDArr.sort(function (a, b) {\r\n        return a > b;\r\n    });\r\n};\r\n/**\r\n * 获取游戏列表, 将已经下载的游戏排列到前面\r\n */\r\ngameListCfg.getGameList = function () {\r\n    if (!cc.sys.isNative) return this.gameList;\r\n    let downloadGameIDArr = this.checkDownloadGames();\r\n    let count = downloadGameIDArr.length - 1;\r\n    for (let i = count; i >= 0; i--) {\r\n        let gameID = Number(downloadGameIDArr[i]);\r\n        let num = this.gameList.length;\r\n        for (let c = 0; c < num; c++) {\r\n            if (this.gameList[c][\"id\"] === gameID) {\r\n                this.gameList.unshift(this.gameList.splice(c, 1)[0]);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return this.gameList;\r\n};\r\ngameListCfg.getGameSearchPaths = function (gameID) {\r\n    return this.gamesSearchPaths[gameID];\r\n};\r\n\r\n\r\ngameListCfg.getGameVersion = function (wholeurl) {\r\n    console.log(\"getGameVersion\");\r\n    return new Promise(function (resolve, reject) {\r\n        let xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = () => {\r\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n                let respone = xhr.responseText;\r\n                let data = JSON.parse(respone);\r\n                console.log(\"version=\", data, data.version);\r\n                resolve(data);\r\n            }\r\n        };\r\n        xhr.timeout = 5000;\r\n        console.log(\"getGameVersion wholeurl=\", wholeurl);\r\n        xhr.open(\"GET\", wholeurl, true);\r\n        xhr.send();\r\n    })\r\n};\r\n\r\n// 打开三方游戏\r\ngameListCfg.openTripartiteGame = function (data) {\r\n    // 判断是否是真机打开\r\n    // if (!isEnableHotUpdate) { return; }\r\n    // 判断是否是游客\r\n    if (glGame.user.isTourist()) {\r\n        glGame.panel.showRegisteredGift(true);\r\n        return;\r\n    }\r\n\r\n    // 可疑账号判断\r\n    if (glGame.panel.showSuspicious(\"game\")) return;\r\n\r\n\r\n    if (!glGame.user.checkEnterWebGame()) {\r\n        glGame.panel.showTip(glGame.tips.WEBGAME.ENTER_ERROR.format(`${glGame.user.getEnterWebGameCoin()}`));\r\n        return;\r\n    }\r\n\r\n    glGame.logon.ReqGameState(data.gamesList.id, gameid => {\r\n        if (data.nature == 2) {\r\n            gameid = data.gamesList.defaultGameId\r\n        }\r\n        glGame.emitter.emit(MESSAGE.UI.WEBVIEW_ON, { gameid: gameid });\r\n\r\n    }, data.type)\r\n}\r\n\r\n\r\n// 检查游戏是否需要热更\r\ngameListCfg.isNeedUpdate = function (gameId) {\r\n    return new Promise((resolve, reject) => {\r\n        if (!cc.sys.isNative) return resolve(false);\r\n        var gameName = glGame.scene.getSceneNameByID(gameId);\r\n        console.log(\"gameName=====>\", gameName);\r\n        let update_data = glGame.storage.getItem('update_data');\r\n        if (update_data && update_data[gameName]) {\r\n            let hotUpdateURL = glGame.servercfg.getHotupdateVersionUrl();\r\n            let url = `${hotUpdateURL}${gameName}/${gameName}version.manifest`\r\n            console.log(url);\r\n            glGame.gamelistcfg.getGameVersion(url).then(data => {\r\n                console.log(data.version);\r\n                if (data.version === update_data[gameName]) resolve(false);\r\n                else resolve(true);\r\n            }, () => { resolve(true) });\r\n        } else resolve(true);\r\n    })\r\n};\r\n\r\n// 进入游戏\r\ngameListCfg.onEnterGame = function (gameId, isShow) {\r\n    console.log(\"进入游戏====》onEnterGame\")\r\n    \r\n    // 原生平台游戏下载判定\r\n    if (cc.sys.isNative) {\r\n        // 检查当前游戏是否已经在更新队列\r\n        if (glGame.assetsManager.isUpdateQueue(gameId)) return;\r\n\r\n        let gameName = glGame.scene.getSceneNameByID(gameId);\r\n\r\n        // 如果没有这个游戏的路径则说明游戏未下载\r\n        let update_data = glGame.storage.getItem('update_data');\r\n        if (!update_data || !update_data[gameName]) {\r\n            if (isShow) {\r\n                glGame.panel.showTip(glGame.tips.UPDATE.STARTUPATE.format(`${glGame.room.getGameDictById(gameId)}`));\r\n            }\r\n            glGame.assetsManager.gameUpdata({gameID: gameId, manifestUrl: null});\r\n            return;\r\n        }\r\n        // 游戏已下载需要更新\r\n        if (!glGame.gamelistcfg.getGameUpdate(gameName)) {\r\n            if (isShow) {\r\n                glGame.panel.showTip(glGame.tips.UPDATE.STARTUPATE.format(`${glGame.room.getGameDictById(gameId)}`));\r\n            }\r\n            glGame.assetsManager.gameUpdata({gameID: gameId, manifestUrl: null});\r\n            return;\r\n        }\r\n    }\r\n    // 可疑账号判断\r\n    if (glGame.panel.showSuspicious(\"game\")) return;\r\n    // 记录打开的游戏\r\n    glGame.gamelistcfg.enterSubGame(gameId);\r\n    // 单机游戏进入逻辑\r\n    if (gameId === glGame.scenetag.LABA) {\r\n        if (glGame.user.isTourist()) {\r\n            glGame.panel.showRegisteredGift(true);\r\n            return;\r\n        }\r\n        glGame.room.reqMyGameState(gameId).then(() => {\r\n            glGame.logon.ReqGameState(gameId, () => {\r\n                // TODO 修改进入房间的方式\r\n                if (glGame.enterRoomVerification) {\r\n                    glGame.room.reqGoldRoomVerify(glGame.scenetag.LABA, 1);\r\n                } else {\r\n                    glGame.room.setGoldRoomInfo(glGame.scenetag.LABA, 1);\r\n                }\r\n            })\r\n        });\r\n        return;\r\n    }\r\n    // 正常游戏进入\r\n    glGame.logon.ReqGameState(gameId, gameid => {\r\n        glGame.panel.showPanelByName(`${glGame.scene.entryGame[gameId]}entry`).then(panel => {\r\n            cc.game.addPersistRootNode(panel);\r\n            let script = panel.getComponent(`${glGame.scene.entryGame[gameId]}entry`);\r\n            script.setGameId(gameid);\r\n            script.updateBgInfo();\r\n            //播放选场音乐\r\n            if(script.BGM)glGame.audio.playBGM(script.BGM);\r\n        });\r\n    })\r\n}\r\n\r\ngameListCfg.get = function (key) {\r\n    return this[key];\r\n};\r\ngameListCfg.setGamesUpdateData = function (gameid, key, value) {\r\n    this.gamesUpdateData[gameid][key] = value;\r\n}\r\nmodule.exports = function () {\r\n    if (!g_instance) {\r\n        g_instance = new GameListCfg();\r\n    }\r\n    return g_instance;\r\n};\r\n"]}