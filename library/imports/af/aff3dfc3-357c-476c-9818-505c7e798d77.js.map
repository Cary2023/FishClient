{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\room_field.js"],"names":["CORNER_MARK","ROOM_ICON","rqznn","rddz","rdzpk","rkpqz","rpj","rsss","rzjh","glGame","baseclass","extend","properties","appointment","cc","Node","room_item","url_txt","Label","bg","atlas_corner_mark","SpriteAtlas","atlas_room_icon","onLoad","emitter","on","hotUIRefresh","start","gamegroup","node","parent","getChildByName","width","winSize","initData","list","gameItemWidth","gameList","initRoomList","onClick","name","console","log","string","platform","copyToClip","user","isTourist","panel","showRegisteredGift","showPanelByName","indexOf","str","split","id","Number","length","room_gamedata","onEnterRoomGame","room_scrollTime","room_everyTime","room_distance","room_distanceTime","url","get","promote_url","game_list","Object","values","forEach","item","push","keys","icon","game","gameName","room_posArr","getPosArr","getComponent","ScrollView","stopAutoScroll","room_view","Widget","updateAlignment","content","destroyAllChildren","removeAllChildren","x","viewWidth","room_width","Math","ceil","initUI","i","children","position","v2","y","runAction","sequence","moveTo","instantiate","active","tag","room_cornerMark","corner_mark","getSpriteFrame","Sprite","spriteFrame","scene","getSceneNameByID","isHotStatus","posX","posY","posArr","index","gameId","assetsManager","isUpdateQueue","gamelistcfg","isNeedUpdate","then","bol","sys","isNative","setGameUpdate","gameUpdata","gameID","manifestUrl","create_room","setGameButton","is_update_queue","isBeingUpdate","data","isActive","isStatus","processNew","progressPic","schedule","fillRange","parseInt","process","OnDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["const CORNER_MARK = {\r\n    0: \"无\",\r\n    1: \"推荐\",\r\n    2: \"火爆\",\r\n    3: \"最新\",\r\n}\r\nconst ROOM_ICON = {\r\n    rqznn: \"看牌抢庄\",\r\n    rddz: \"斗地主\",\r\n    rdzpk: \"德州扑克\",\r\n    rkpqz: \"抢庄牛牛\",\r\n    rpj: \"牌九\",\r\n    rsss: \"十三水\",\r\n    rzjh: \"炸金花\",\r\n}\r\n\r\nglGame.baseclass.extend({\r\n    properties: {\r\n        appointment: cc.Node,\r\n        room_item: cc.Node,\r\n        url_txt: cc.Label,\r\n        bg: cc.Node,\r\n\r\n        atlas_corner_mark: cc.SpriteAtlas,\r\n        atlas_room_icon: cc.SpriteAtlas,\r\n    },\r\n\r\n    onLoad() {\r\n        glGame.emitter.on(\"hotUIRefresh\", this.hotUIRefresh, this);\r\n    },\r\n    \r\n    start() {\r\n        let gamegroup = this.node.parent.getChildByName(\"gamegroup\").width;\r\n        let width = cc.winSize.width - gamegroup;\r\n        this.node.width = width;\r\n        // let bg_width = this.bg.width;\r\n        // if (width >= bg_width) {\r\n        //     this.bg.getComponent(cc.Widget).left = 0;\r\n        //     this.bg.getComponent(cc.Widget).updateAlignment();\r\n        // }\r\n    },\r\n\r\n    initData(list) {\r\n        this.gameItemWidth = this.room_item.width; //item大小\r\n        this.gameList = list.gameList;\r\n        this.initRoomList();\r\n    },\r\n\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_invite\":\r\n                console.log(this.url_txt.string);\r\n                glGame.platform.copyToClip(this.url_txt.string, \"推广链接复制成功\");\r\n                break;\r\n            default:\r\n                // 判断是否是游客\r\n                if (glGame.user.isTourist()) {\r\n                    glGame.panel.showRegisteredGift(true);\r\n                    break;\r\n                }\r\n                if (name == \"btn_jiaruzidi\") glGame.panel.showPanelByName(\"joinRoom\");  //加入房间\r\n                else if (name == \"btn_duihuanzuanshianniu\") glGame.panel.showPanelByName(\"exchangeDiamond\");    //砖石\r\n                else if (name == \"btn_chaxunzhanjianniu\") glGame.panel.showPanelByName(\"roomRecord\");   //战绩\r\n                else if (name.indexOf(\"room\") !== -1) {\r\n                    // 创建房间\r\n                    let str = name.split(\"room\"),\r\n                        id = Number(str[str.length - 1]),\r\n                        room_gamedata = this.gameList[`_${id}`];\r\n                    if (id != 0) {\r\n                        this.onEnterRoomGame(id);\r\n                    } else {\r\n                        glGame.platform.copyToClip(this.url_txt.string, \"敬请期待\");\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n    },\r\n\r\n    initRoomList() {\r\n        let room_scrollTime = 0.25,   //图标移动时间\r\n            room_everyTime = 0.05,    //图标移动间隔时间\r\n            room_distance = 30,       //图标弹动距离\r\n            room_distanceTime = 0.1;  //图标弹动时间\r\n\r\n        // 设置推广链接地址\r\n        let url = glGame.user.get(\"url\");\r\n        if (url){\r\n            this.url_txt.string = url.promote_url;\r\n        }\r\n\r\n        // 屏蔽web版网页游戏\r\n        this.game_list = [];\r\n        Object.values(this.gameList).forEach(item=>{\r\n            // if (!isEnableHotUpdate && item.id > 9999) return;\r\n            this.game_list.push(item)\r\n        })\r\n\r\n        Object.keys(ROOM_ICON).forEach(item=>{\r\n            if (item == \"rqznn\") {\r\n                this.game_list[0].icon = item;\r\n            } else {\r\n                let game = {}\r\n                game.id = 0;\r\n                game.icon = item;\r\n                game.gameName = ROOM_ICON[item];\r\n                this.game_list.push(game)\r\n            }\r\n        })\r\n\r\n        let length = this.game_list.length;\r\n        // 获取需要展示节点的位置\r\n        let room_posArr = this.getPosArr()\r\n\r\n        // 设置\r\n        this.appointment.getComponent(cc.ScrollView).stopAutoScroll();\r\n        let room_view = this.appointment.getChildByName(\"view\");\r\n        room_view.getComponent(cc.Widget).updateAlignment();\r\n        let content = room_view.getChildByName(\"content\");\r\n        content.destroyAllChildren();\r\n        content.removeAllChildren();\r\n        content.x = 0;\r\n\r\n        //设置scrollview.width\r\n        let viewWidth = room_view.width;\r\n        let room_width = Math.ceil(length / 2) * this.gameItemWidth;\r\n        content.width = room_width < viewWidth ? viewWidth : room_width;\r\n\r\n        // 初始化UI\r\n        // if (content.childrenCount == 0) {\r\n            this.initUI(content);\r\n        // }\r\n\r\n        // 执行动作\r\n        for (let i = 0; i < length; i++) {\r\n            let item = content.children[i];\r\n            if (item) {\r\n                item.position = cc.v2(room_posArr[i].x + viewWidth, room_posArr[i].y);\r\n                item.runAction(cc.sequence(\r\n                    cc.moveTo(room_scrollTime + room_everyTime * i, room_posArr[i].x - room_distance, room_posArr[i].y),\r\n                    cc.moveTo(room_distanceTime, room_posArr[i]),\r\n                ))\r\n            }\r\n        }\r\n    },\r\n\r\n    // 初始化UI\r\n    initUI(content) {\r\n        this.gameList = {};\r\n        for (let i = 0; i < this.game_list.length; i++) {\r\n            let id = this.game_list[i].id;\r\n            let item = cc.instantiate(this.room_item);\r\n            item.parent = content;\r\n            item.name = \"room\" + id;\r\n            item.active = true;\r\n            // 设置游戏名称\r\n            item.getChildByName(\"game_name\").getComponent(cc.Label).string = this.game_list[i].gameName;\r\n            // 设置角标\r\n            if (this.game_list[i].tag > 0) {\r\n                let room_cornerMark = item.getChildByName(\"cornerMark\");\r\n                let corner_mark = this.atlas_corner_mark.getSpriteFrame(`img_corner_mark${this.game_list[i].tag}`);\r\n                room_cornerMark.getComponent(cc.Sprite).spriteFrame = corner_mark;\r\n                room_cornerMark.getChildByName(\"txt\").getComponent(cc.Label).string = CORNER_MARK[this.game_list[i].tag];\r\n                room_cornerMark.active = true;\r\n            }\r\n            // 设置游戏图标\r\n            if (this.game_list[i].icon) {\r\n                item.getChildByName(\"game_icon\").getComponent(cc.Sprite).spriteFrame = this.atlas_room_icon.getSpriteFrame(`icon_${this.game_list[i].icon}`);\r\n                // let url = glGame.user.get('url').resource_url;\r\n                // glGame.panel.showRemoteImage(item.getChildByName(\"game_icon\"), url + this.game_list[i].icon);\r\n            }\r\n\r\n            let gameName = \"rqznn_\" + i;\r\n            if (id > 0) {\r\n                gameName = glGame.scene.getSceneNameByID(id);\r\n            }\r\n            this.gameList[gameName] = item;\r\n        }\r\n\r\n        // 检查游戏是否有正在更新的\r\n        this.isHotStatus();\r\n    },\r\n\r\n    //获得展示节点的位置\r\n    getPosArr() {\r\n        let posX = this.gameItemWidth/2, posY = [95, -95], posArr = [];\r\n        for (let i = 0; i < this.game_list.length; i++) {\r\n            let index = i % 2;\r\n            posArr.push(cc.v2(index == 0 && i != 0 ? posX += this.gameItemWidth : posX, posY[index]));\r\n        }\r\n        console.log(\"房间分类下的游戏展示位置列表\", posArr)\r\n        return posArr;\r\n    },\r\n\r\n    onEnterRoomGame(gameId) {\r\n        // glGame.panel.showPanelByName(\"createRoom\").then(create_room => {\r\n        //     console.log(\"create_room ====> \", create_room.name);\r\n        //     create_room.getComponent(create_room.name).setGameButton(42)\r\n        // });\r\n        // return;\r\n        // 检查当前游戏是否已经在更新队列\r\n        if (glGame.assetsManager.isUpdateQueue(gameId)) return;\r\n\r\n        // 检查游戏是否需要更新\r\n        glGame.gamelistcfg.isNeedUpdate(gameId).then(bol => {\r\n            if (bol && cc.sys.isNative) {\r\n                // 开始更新【%s(游戏名称)】，请耐心等待...\r\n                // glGame.panel.showTip(`开始更新【${glGame.room.getGameDictById(gameId)}】，请耐心等待...`);\r\n                let gameName = glGame.scene.getSceneNameByID(gameId);\r\n                glGame.gamelistcfg.setGameUpdate(gameName, false);\r\n                glGame.assetsManager.gameUpdata({gameID: gameId, manifestUrl: null});\r\n            } else {\r\n                // 不需要更新\r\n                // glGame.panel.showPanelByName(\"createRoom\")\r\n                glGame.panel.showPanelByName(\"createRoom\").then(create_room => {\r\n                    console.log(\"create_room ====> \", create_room.name);\r\n                    create_room.getComponent(create_room.name).setGameButton(gameId)\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    // 判断游戏是否在热更\r\n    isHotStatus() {\r\n        if (!cc.sys.isNative) return;\r\n        Object.keys(this.gameList).forEach(gameName=>{\r\n            // 检查当前是否有游戏正在跟新\r\n            let is_update_queue = glGame.assetsManager.isBeingUpdate(gameName);\r\n            if (is_update_queue != null) {\r\n                let data = {gameName:gameName, isActive:true}\r\n                if (is_update_queue) {\r\n                    data.isStatus = 0;\r\n                }\r\n                this.hotUIRefresh(data);\r\n            } else {\r\n                // 查找是否需要更新\r\n                glGame.assetsManager.isNeedUpdate(gameName);\r\n            }\r\n        });\r\n    },\r\n\r\n    // 热更刷新UI\r\n    hotUIRefresh(data) {\r\n        Object.keys(this.gameList).forEach(gameName=>{\r\n            if (data.gameName == gameName) {\r\n                let item = this.gameList[gameName];\r\n                let processNew = item.getChildByName(\"process\");\r\n                let progressPic = processNew.getChildByName(\"pro\").getChildByName(\"bar\").getComponent(cc.Sprite);\r\n                // 进度条\r\n                processNew.active = data.isActive;\r\n                // 显示下载进度\r\n                let schedule = processNew.getChildByName(\"label\").getComponent(cc.Label)\r\n                switch (data.isStatus) {\r\n                    case 0:\r\n                        // 热更接续\r\n                        schedule.string = \"0%\";\r\n                        progressPic.fillRange = 0;\r\n                        break;\r\n                    case 1:\r\n                        // 下载中\r\n                        schedule.string = `${parseInt(data.process * 100) || 0}%`;\r\n                        progressPic.fillRange = data.process;\r\n                        break;\r\n                    default:\r\n                        // 下载列表大于最大同时下载量的时候显示等待中\r\n                        schedule.string = \"等待中\";\r\n                        progressPic.fillRange = 0;\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    OnDestroy() {\r\n        glGame.emitter.off(\"hotUIRefresh\", this);\r\n    },\r\n});"]}