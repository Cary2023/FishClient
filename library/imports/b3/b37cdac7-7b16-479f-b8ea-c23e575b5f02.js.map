{"version":3,"sources":["assets\\modules\\plaza\\script\\prefab\\withdrawal\\popup\\modifyPass.js"],"names":["glGame","baseclass","extend","properties","phoneNumber","cc","EditBox","passWord","surePassWord","verificaCode","btn_sendCode","Node","onLoad","VerificaCD","onClick","name","node","remove","sure","sendCode","setCutDown","getComponent","Button","interactable","getChildByName","active","runAction","repeatForever","sequence","delayTime","callFunc","Label","string","stopAllActions","checkPhone","acc","panel","showErrorTip","tips","REGISTRATION","PHONENULL","reg","isacc_matcher","test","PHONETYPE","pingf","phone","msg","type","gameNet","send_msg","route","data","showTip","psw","checkPassword","confirm","COMMON","CODE_NULL","verif","VERIFICA","pwd","md5","code","confimpsw","LOGPSWNULL","length","EXCHANGE","PSWLENGTH","PSWWRONGFUL","PSWCOFAIL","OnDestroy"],"mappings":";;;;;;AACAA,MAAM,CAACC,SAAP,CAAiBC,MAAjB,CAAwB;AAEpBC,EAAAA,UAAU,EAAE;AACRC,IAAAA,WAAW,EAAEC,EAAE,CAACC,OADR;AAERC,IAAAA,QAAQ,EAAEF,EAAE,CAACC,OAFL;AAGRE,IAAAA,YAAY,EAAEH,EAAE,CAACC,OAHT;AAIRG,IAAAA,YAAY,EAAEJ,EAAE,CAACC,OAJT;AAKRI,IAAAA,YAAY,EAAEL,EAAE,CAACM;AALT,GAFQ;AAUpB;AAEAC,EAAAA,MAZoB,oBAYX;AACL,SAAKC,UAAL,GAAkB,EAAlB;AACH,GAdmB;AAepBC,EAAAA,OAfoB,mBAeZC,IAfY,EAeNC,IAfM,EAeA;AAChB,YAAQD,IAAR;AACI,WAAK,WAAL;AAAkB,aAAKE,MAAL;AAAe;;AACjC,WAAK,UAAL;AAAiB,aAAKC,IAAL;AAAa;;AAC9B,WAAK,cAAL;AAAqB,aAAKC,QAAL;AAAiB;AAH1C;AAKH,GArBmB;AAsBpB;AACAC,EAAAA,UAvBoB,wBAuBP;AAAA;;AACT,SAAKV,YAAL,CAAkBW,YAAlB,CAA+BhB,EAAE,CAACiB,MAAlC,EAA0CC,YAA1C,GAAyD,KAAzD;AACA,SAAKb,YAAL,CAAkBc,cAAlB,CAAiC,MAAjC,EAAyCC,MAAzC,GAAkD,IAAlD;AACA,SAAKf,YAAL,CAAkBc,cAAlB,CAAiC,KAAjC,EAAwCC,MAAxC,GAAiD,KAAjD;AACA,SAAKT,IAAL,CAAUU,SAAV,CAAoBrB,EAAE,CAACsB,aAAH,CAAiBtB,EAAE,CAACuB,QAAH,CACjCvB,EAAE,CAACwB,SAAH,CAAa,CAAb,CADiC,EAEjCxB,EAAE,CAACyB,QAAH,CAAY,YAAM;AACd,MAAA,KAAI,CAACjB,UAAL;AACA,MAAA,KAAI,CAACH,YAAL,CAAkBc,cAAlB,CAAiC,MAAjC,EAAyCH,YAAzC,CAAsDhB,EAAE,CAAC0B,KAAzD,EAAgEC,MAAhE,aAA4E,KAAI,CAACnB,UAAjF;;AACA,UAAI,KAAI,CAACA,UAAL,IAAmB,CAAvB,EAA0B;AACtB,QAAA,KAAI,CAACG,IAAL,CAAUiB,cAAV;;AACA,QAAA,KAAI,CAACpB,UAAL,GAAkB,EAAlB;AACA,QAAA,KAAI,CAACH,YAAL,CAAkBc,cAAlB,CAAiC,MAAjC,EAAyCC,MAAzC,GAAkD,KAAlD;AACA,QAAA,KAAI,CAACf,YAAL,CAAkBc,cAAlB,CAAiC,KAAjC,EAAwCC,MAAxC,GAAiD,IAAjD;AACA,QAAA,KAAI,CAACf,YAAL,CAAkBW,YAAlB,CAA+BhB,EAAE,CAACiB,MAAlC,EAA0CC,YAA1C,GAAyD,IAAzD;AACH;AACJ,KAVD,CAFiC,CAAjB,CAApB;AAeH,GA1CmB;AA2CpB;AACAW,EAAAA,UA5CoB,sBA4CTC,GA5CS,EA4CJ;AACZ,QAAI,CAACA,GAAL,EAAU;AACNnC,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyBC,SAAnD;AACA,aAAO,IAAP;AACH;;AAED,QAAIC,GAAG,GAAG,UAAV,CANY,CAMU;;AACtB,QAAIC,aAAa,GAAGD,GAAG,CAACE,IAAJ,CAASR,GAAT,CAApB;;AACA,QAAI,CAACO,aAAL,EAAoB;AAChB1C,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyBK,SAAnD;AAA+DC,MAAAA,KAAK;AACpE,aAAO,KAAP;AACH;;AACD,WAAOV,GAAP;AACH,GAzDmB;AA0DpBhB,EAAAA,QA1DoB,sBA0DT;AAAA;;AACP,QAAI2B,KAAK,GAAG,KAAKZ,UAAL,CAAgB,KAAK9B,WAAL,CAAiB4B,MAAjC,CAAZ;AACA,QAAI,CAACc,KAAL,EAAY;AACZ,QAAIC,GAAG,GAAG;AACND,MAAAA,KAAK,EAAEA,KADD;AAENE,MAAAA,IAAI,EAAE;AAFA,KAAV;AAIAhD,IAAAA,MAAM,CAACiD,OAAP,CAAeC,QAAf,CAAwB,uBAAxB,EAAiDH,GAAjD,EAAsD,UAACI,KAAD,EAAQC,IAAR,EAAiB;AACnEpD,MAAAA,MAAM,CAACoC,KAAP,CAAaiB,OAAb,CAAqB,SAArB;;AACA,MAAA,MAAI,CAACjC,UAAL;AACH,KAHD;AAIH,GArEmB;AAsEpBF,EAAAA,IAtEoB,kBAsEb;AAAA;;AACH,QAAIoC,GAAG,GAAG,KAAKC,aAAL,CAAmB,KAAKhD,QAAL,CAAcyB,MAAjC,CAAV;AACA,QAAIwB,OAAO,GAAG,KAAKD,aAAL,CAAmB,KAAKhD,QAAL,CAAcyB,MAAjC,EAAyC,KAAKxB,YAAL,CAAkBwB,MAA3D,CAAd;AACA,QAAIc,KAAK,GAAG,KAAKZ,UAAL,CAAgB,KAAK9B,WAAL,CAAiB4B,MAAjC,CAAZ;AACA,QAAI,CAACsB,GAAL,EAAU;AACV,QAAI,CAACE,OAAL,EAAc;AACd,QAAI,CAACV,KAAL,EAAY;AACZ,QAAI,KAAKrC,YAAL,CAAkBuB,MAAlB,IAA4B,EAAhC,EAAoC,OAAOhC,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYmB,MAAZ,CAAmBC,SAA7C,CAAP;AACpC,QAAIjB,GAAG,GAAG,cAAV,CARG,CAQsB;;AACzB,QAAIkB,KAAK,GAAGlB,GAAG,CAACE,IAAJ,CAAS,KAAKlC,YAAL,CAAkBuB,MAA3B,CAAZ;;AACA,QAAI,CAAC2B,KAAL,EAAY;AACR,aAAO3D,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyBqB,QAAnD,CAAP;AACH;;AACD,QAAIb,GAAG,GAAG;AACNc,MAAAA,GAAG,EAAEC,GAAG,CAACR,GAAD,CADF;AAENR,MAAAA,KAAK,EAAEA,KAFD;AAGNE,MAAAA,IAAI,EAAE,CAHA;AAINe,MAAAA,IAAI,EAAEJ;AAJA,KAAV;AAMA3D,IAAAA,MAAM,CAACiD,OAAP,CAAeC,QAAf,CAAwB,iBAAxB,EAA2CH,GAA3C,EAAgD,UAACI,KAAD,EAAQC,IAAR,EAAiB;AAC7D,MAAA,MAAI,CAACnC,MAAL;;AACAjB,MAAAA,MAAM,CAACoC,KAAP,CAAaiB,OAAb,CAAqB,MAArB;AACH,KAHD;AAIH,GA7FmB;AA8FpB;AACAE,EAAAA,aA/FoB,yBA+FND,GA/FM,EA+FDU,SA/FC,EA+FU;AAC1B,QAAI,CAACV,GAAL,EAAU;AACNtD,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyB0B,UAAnD;AACA,aAAO,IAAP;AACH;;AACD,QAAIX,GAAG,CAACY,MAAJ,GAAa,CAAjB,EAAoB;AAChBlE,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAY6B,QAAZ,CAAqBC,SAA/C;AACA,aAAO,KAAP;AACH;;AACD,QAAI,CAAC,MAAMzB,IAAN,CAAWW,GAAX,CAAL,EAAsB;AAClBtD,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyB8B,WAAnD;AACA,aAAO,IAAP;AACH;;AACD,QAAIL,SAAS,IAAI,IAAjB,EAAuB,OAAOV,GAAP;;AACvB,QAAI,CAACU,SAAD,IAAcV,GAAG,KAAKU,SAA1B,EAAqC;AACjChE,MAAAA,MAAM,CAACoC,KAAP,CAAaC,YAAb,CAA0BrC,MAAM,CAACsC,IAAP,CAAYC,YAAZ,CAAyB+B,SAAnD;AACA,aAAO,IAAP;AACH;;AACD,WAAOhB,GAAP;AACH,GAlHmB;AAmHpBiB,EAAAA,SAnHoB,uBAmHR,CACX,CApHmB,CAqHpB;;AArHoB,CAAxB","sourceRoot":"/","sourcesContent":["\r\nglGame.baseclass.extend({\r\n\r\n    properties: {\r\n        phoneNumber: cc.EditBox,\r\n        passWord: cc.EditBox,\r\n        surePassWord: cc.EditBox,\r\n        verificaCode: cc.EditBox,\r\n        btn_sendCode: cc.Node\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.VerificaCD = 60;\r\n    },\r\n    onClick(name, node) {\r\n        switch (name) {\r\n            case \"btn_close\": this.remove(); break;\r\n            case \"btn_sure\": this.sure(); break;\r\n            case \"btn_sendCode\": this.sendCode(); break;\r\n        }\r\n    },\r\n    //设置60秒倒计时\r\n    setCutDown() {\r\n        this.btn_sendCode.getComponent(cc.Button).interactable = false;\r\n        this.btn_sendCode.getChildByName(\"time\").active = true;\r\n        this.btn_sendCode.getChildByName(\"tip\").active = false;\r\n        this.node.runAction(cc.repeatForever(cc.sequence(\r\n            cc.delayTime(1),\r\n            cc.callFunc(() => {\r\n                this.VerificaCD--\r\n                this.btn_sendCode.getChildByName(\"time\").getComponent(cc.Label).string = `${this.VerificaCD}秒`;\r\n                if (this.VerificaCD == 0) {\r\n                    this.node.stopAllActions();\r\n                    this.VerificaCD = 60;\r\n                    this.btn_sendCode.getChildByName(\"time\").active = false;\r\n                    this.btn_sendCode.getChildByName(\"tip\").active = true;\r\n                    this.btn_sendCode.getComponent(cc.Button).interactable = true;\r\n                }\r\n            })\r\n        )\r\n        ))\r\n    },\r\n    // 手机号码检查\r\n    checkPhone(acc) {\r\n        if (!acc) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PHONENULL);\r\n            return null;\r\n        }\r\n\r\n        let reg = /^\\d{11}$/; //验证规则\r\n        let isacc_matcher = reg.test(acc);\r\n        if (!isacc_matcher) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PHONETYPE); pingf\r\n            return false;\r\n        }\r\n        return acc;\r\n    },\r\n    sendCode() {\r\n        let phone = this.checkPhone(this.phoneNumber.string)\r\n        if (!phone) return;\r\n        let msg = {\r\n            phone: phone,\r\n            type: 11,\r\n        }\r\n        glGame.gameNet.send_msg(\"http.ReqPostPhoneCode\", msg, (route, data) => {\r\n            glGame.panel.showTip(\"验证码发送成功\");\r\n            this.setCutDown();\r\n        })\r\n    },\r\n    sure() {\r\n        let psw = this.checkPassword(this.passWord.string)\r\n        let confirm = this.checkPassword(this.passWord.string, this.surePassWord.string)\r\n        let phone = this.checkPhone(this.phoneNumber.string)\r\n        if (!psw) return;\r\n        if (!confirm) return;\r\n        if (!phone) return;\r\n        if (this.verificaCode.string == \"\") return glGame.panel.showErrorTip(glGame.tips.COMMON.CODE_NULL);\r\n        let reg = /^[0-9]{0,6}$/;//验证规则\r\n        let verif = reg.test(this.verificaCode.string);\r\n        if (!verif) {\r\n            return glGame.panel.showErrorTip(glGame.tips.REGISTRATION.VERIFICA);\r\n        }\r\n        let msg = {\r\n            pwd: md5(psw),\r\n            phone: phone,\r\n            type: 3,\r\n            code: verif,\r\n        }\r\n        glGame.gameNet.send_msg(\"http.ReqEditPwd\", msg, (route, data) => {\r\n            this.remove();\r\n            glGame.panel.showTip(\"修改成功\");\r\n        })\r\n    },\r\n    // 密码检查\r\n    checkPassword(psw, confimpsw) {\r\n        if (!psw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.LOGPSWNULL);\r\n            return null;\r\n        }\r\n        if (psw.length < 4) {\r\n            glGame.panel.showErrorTip(glGame.tips.EXCHANGE.PSWLENGTH);\r\n            return false;\r\n        }\r\n        if (!/\\w$/.test(psw)) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWWRONGFUL);\r\n            return null;\r\n        }\r\n        if (confimpsw == null) return psw;\r\n        if (!confimpsw || psw !== confimpsw) {\r\n            glGame.panel.showErrorTip(glGame.tips.REGISTRATION.PSWCOFAIL);\r\n            return null;\r\n        }\r\n        return psw;\r\n    },\r\n    OnDestroy() {\r\n    }\r\n    // update (dt) {},\r\n});\r\n"]}